import{i as Ie,x as fa,f as Ke,aa as va,B as ha,w as _a,q as ya}from"./index-0.0.0-dataease.js";import{E as ga}from"./el-drawer-0.0.0-dataease.js";import{ak as Le,k as ba,j as R,o as wa,n as de,S as ce,D as C,G as ka,y as Ea}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./el-virtual-list-0.0.0-dataease.js";import{a as Sa,E as Na}from"./el-table-v2-0.0.0-dataease.js";import{E as Va}from"./el-input-number-0.0.0-dataease.js";import{E as xa}from"./el-checkbox-0.0.0-dataease.js";import{E as Ca}from"./el-row-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import{a as Pa,E as Ta}from"./el-table-column-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{E as ja,a as $a}from"./el-select-0.0.0-dataease.js";import{a as Fa,E as qa}from"./el-form-item-0.0.0-dataease.js";import{d as le,r as h,w as Se,R as ze,f as v,L as $,$ as pe,U as b,j as e,Q as Ua,o as Da,a as Ja,G as U,Z as A,a0 as K,M as p,V as Ne,g as S,i,m as Ve,k as u,a6 as _,a5 as D,B as Oa,s as be,aa as Ma,T as P,W as j,Y as we,a9 as ke,n as Je}from"./vue-0.0.0-dataease.js";import{i as Oe}from"./icon_expand-right_filled-0.0.0-dataease.js";import Ia from"./ApiHttpRequestForm-0.0.0-dataease.js";import{g as Z}from"./base64-0.0.0-dataease.js";import{E as Ka}from"./EmptyBackground-0.0.0-dataease.js";import{c as Ee}from"./datasource-0.0.0-dataease.js";import{f as X}from"./attr-0.0.0-dataease20.js";import{i as Me}from"./field-list-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import{_ as La}from"./PluginComponent.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as za}from"./lodash-0.0.0-dataease.js";const Aa=Ie({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),Ra={[Le]:(B,L)=>[B,L].every(fa)},Ba=le({name:"ElSteps"}),Ga=le({...Ba,props:Aa,emits:Ra,setup(B,{emit:L}){const f=B,n=Ke("steps"),J=h([]);return Se(J,()=>{J.value.forEach((w,d)=>{w.setIndex(d)})}),ze("ElSteps",{props:f,steps:J}),Se(()=>f.active,(w,d)=>{L(Le,w,d)}),(w,d)=>(v(),$("div",{class:b([e(n).b(),e(n).m(w.simple?"simple":w.direction)])},[pe(w.$slots,"default")],2))}}),Qa=Ie({title:{type:String,default:""},icon:{type:ba},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),Ha=le({name:"ElStep"}),Ae=le({...Ha,props:Qa,setup(B){const L=B,f=Ke("step"),n=h(-1),J=h({}),w=h(""),d=Ua("ElSteps"),N=Oa();Da(()=>{Se([()=>d.props.active,()=>d.props.processStatus,()=>d.props.finishStatus],([c])=>{z(c)},{immediate:!0})}),Ja(()=>{d.steps.value=d.steps.value.filter(c=>c.uid!==(N==null?void 0:N.uid))});const t=U(()=>L.status||w.value),G=U(()=>{const c=d.steps.value[n.value-1];return c?c.currentStatus:"wait"}),ee=U(()=>d.props.alignCenter),Q=U(()=>d.props.direction==="vertical"),V=U(()=>d.props.simple),k=U(()=>d.steps.value.length),H=U(()=>{var c;return((c=d.steps.value[k.value-1])==null?void 0:c.uid)===(N==null?void 0:N.uid)}),F=U(()=>V.value?"":d.props.space),se=U(()=>{const c={flexBasis:typeof F.value=="number"?`${F.value}px`:F.value?F.value:`${100/(k.value-(ee.value?0:1))}%`};return Q.value||H.value&&(c.maxWidth=`${100/k.value}%`),c}),W=c=>{n.value=c},ae=c=>{let q=100;const O={};O.transitionDelay=`${150*n.value}ms`,c===d.props.processStatus?q=0:c==="wait"&&(q=0,O.transitionDelay=`${-150*n.value}ms`),O.borderWidth=q&&!V.value?"1px":0,O[d.props.direction==="vertical"?"height":"width"]=`${q}%`,J.value=O},z=c=>{c>n.value?w.value=d.props.finishStatus:c===n.value&&G.value!=="error"?w.value=d.props.processStatus:w.value="wait";const q=d.steps.value[n.value-1];q&&q.calcProgress(w.value)},g=A({uid:U(()=>N==null?void 0:N.uid),currentStatus:t,setIndex:W,calcProgress:ae});return d.steps.value=[...d.steps.value,g],(c,q)=>(v(),$("div",{style:Ne(e(se)),class:b([e(f).b(),e(f).is(e(V)?"simple":e(d).props.direction),e(f).is("flex",e(H)&&!e(F)&&!e(ee)),e(f).is("center",e(ee)&&!e(Q)&&!e(V))])},[K(" icon & line "),p("div",{class:b([e(f).e("head"),e(f).is(e(t))])},[e(V)?K("v-if",!0):(v(),$("div",{key:0,class:b(e(f).e("line"))},[p("i",{class:b(e(f).e("line-inner")),style:Ne(J.value)},null,6)],2)),p("div",{class:b([e(f).e("icon"),e(f).is(c.icon||c.$slots.icon?"icon":"text")])},[pe(c.$slots,"icon",{},()=>[c.icon?(v(),S(e(R),{key:0,class:b(e(f).e("icon-inner"))},{default:i(()=>[(v(),S(Ve(c.icon)))]),_:1},8,["class"])):e(t)==="success"?(v(),S(e(R),{key:1,class:b([e(f).e("icon-inner"),e(f).is("status")])},{default:i(()=>[u(e(va))]),_:1},8,["class"])):e(t)==="error"?(v(),S(e(R),{key:2,class:b([e(f).e("icon-inner"),e(f).is("status")])},{default:i(()=>[u(e(ha))]),_:1},8,["class"])):e(t)==="finish"?(v(),$("div",{key:3,class:b(e(f).e("icon-inner"))},null,2)):e(V)?K("v-if",!0):(v(),$("div",{key:4,class:b(e(f).e("icon-inner"))},_(n.value+1),3))])],2)],2),K(" title & description "),p("div",{class:b(e(f).e("main"))},[p("div",{class:b([e(f).e("title"),e(f).is(e(t))])},[pe(c.$slots,"title",{},()=>[D(_(c.title),1)])],2),e(V)?(v(),$("div",{key:0,class:b(e(f).e("arrow"))},null,2)):(v(),$("div",{key:1,class:b([e(f).e("description"),e(f).is(e(t))])},[pe(c.$slots,"description",{},()=>[D(_(c.description),1)])],2))],2)],6))}}),Wa=_a(Ga,{Step:Ae}),Ya=ya(Ae);const Za={class:"flex-center"},Xa={class:"step-icon"},et={class:"icon"},at={class:"title"},tt={class:"step-icon"},lt={class:"icon"},st={class:"title"},nt={class:"title-form_primary base-info"},ot={class:"title-form_primary request-info"},rt={class:"title-form_primary request-info"},it={class:"title-form_primary request-info"},ut={class:"table-container de-svg-in-table"},dt={class:"name"},ct={class:"de-svg-in-table"},pt=["title"],mt={style:{float:"left"}},ft={style:{float:"left","font-size":"12px",color:"#8492a6"}},vt={class:"name"},At=le({__name:"ApiHttpRequestDraw",emits:["returnItem"],setup(B,{expose:L,emit:f}){const{t:n}=wa(),J=A({jsonFields:[],fields:[]});let w=A([]),d=A([]),N=A([]),t=A({status:"",name:"",type:"table",url:"",method:"GET",request:{changeId:"",rest:[],headers:[],arguments:[],body:{typeChange:"",raw:"",kvs:[]},authManager:{verification:"",username:"",password:""}},fields:[],jsonFields:[],useJsonPath:!1,apiQueryTimeout:10,showApiStructure:!1,jsonPath:"",serialNumber:-1}),G=[];const ee=h(),Q=h(!1),V=h(!1),k=h(1),H=h(!1),F=h(!1),se=be([]),W=be([]),ae=be([]),z=h(),g=h(),c=h(!1),q=(l,a,s)=>{if(!a){s(new Error(n("datasource.please_input_query_timeout")));return}let o=!1;var m=/^\d+$/;if(o=m.test(a),!o){s(new Error(n("datasource.please_input_query_timeout")));return}if(a<=0||a>300){s(new Error(n("datasource.please_input_query_timeout")));return}s()},O=A({name:[{required:!0,message:n("datasource.input_name"),trigger:"blur"},{min:2,max:64,message:n("datasource.input_limit_2_25",[2,64]),trigger:"blur"}],apiQueryTimeout:[{required:!0,validator:q,trigger:["blur","change"]}],url:[{required:!0,message:n("data_source.the_request_address"),trigger:"blur"}],desc:[{required:!0,trigger:"blur"}]}),ne=h("table"),me=h(!1),fe=h(!1),M=h("API"),xe=h(""),I=h(!1),ve=h([]),he=h(""),_e=h(!1);ze("api-active-name",ne);const Re=(l,a,s,o,m,x,te,Y)=>{if(ve.value=x,he.value=te,Y)I.value=Y;else{const E=ve.value.filter(T=>T.type===a.type);E&&E.length>0&&(I.value=!0)}if(fe.value=l.copy,_e.value=a.copy,M.value=a.type,c.value=m,ne.value=s,me.value=o,w=a.apiConfiguration,N=l.fields,a.paramsConfiguration&&(d=a.paramsConfiguration),I.value&&(xe.value=ia()),W.value=[],l.type!=="params"&&d)for(let E=0;E<d.length;E++)W.value=W.value.concat(d[E].fields);Object.assign(t,l),V.value=!0,k.value=0,Je(()=>{var E,T;I.value?((E=g==null?void 0:g.value)==null||E.invokeMethod({methodName:"clearForm",args:[]}),(T=g==null?void 0:g.value)==null||T.invokeMethod({methodName:"initForm",args:[]})):z.value.clearValidate()})},Be=()=>{z.value.validate(l=>{var a,s;if(l){const o=Z.encode(JSON.stringify(t)),m=Z.encode(JSON.stringify(d));H.value=!0,(s=(a=ce)["/datasource/checkApiDatasource"])==null||s.call(a),Ee({dsType:M.value,data:o,type:"apiStructure",paramsList:m}).then(x=>{J.jsonFields=x.data.jsonFields}).catch(x=>{console.warn(x==null?void 0:x.message)}),H.value=!1}else return!1})},Ge=[{id:"GET",label:"GET"},{id:"POST",label:"POST"}],Qe=[{id:!0,label:n("common.yes")},{id:!1,label:n("common.no")}],He=[{label:n("dataset.text"),value:0},{label:n("dataset.value"),value:2},{label:n("dataset.value")+"("+n("dataset.float")+")",value:3}],oe=h(!1),We=()=>{var l;if(t.type!=="params"&&t.fields.length===0){C.error(n("datasource.api_field_not_empty"));return}if(t.type==="params"){for(let a=0;a<t.fields.length;a++)for(let s=0;s<d.length;s++)for(let o=0;o<d[s].fields.length;o++)if(t.fields[a].name===d[s].fields[o].name&&t.serialNumber!==d[s].serialNumber){C.error(n("data_source.name_already_exists")+t.fields[a].name);return}}for(let a=0;a<t.fields.length-1;a++)for(let s=a+1;s<t.fields.length;s++)if(t.fields[a].name===t.fields[s].name){C.error(t.fields[a].name+", "+n("datasource.has_repeat_field_name"));return}if(me.value){let a="";for(let s=0;s<t.fields.length;s++)if(t.fields[s].primaryKey){let o=!1;for(let m=0;m<N.length;m++)N[m].name===t.fields[s].name&&N[m].primaryKey&&(o=!0);o||(a=a+" "+t.fields[s].name)}for(let s=0;s<N.length;s++)if(N[s].primaryKey){let o=!1;for(let m=0;m<t.fields.length;m++)N[s].name===t.fields[m].name&&t.fields[m].primaryKey&&(o=!0);o||(a=a+" "+N[s].name)}if(a!==""&&!(_e.value||fe.value)){C.error(n("datasource.primary_key_change")+a);return}for(let s=0;s<t.fields.length;s++)if(t.fields[s].primaryKey&&!t.fields[s].length&&t.fields[s].deExtractType===0){C.error(n("datasource.primary_key_length")+t.fields[s].name);return}}else for(let a=0;a<t.fields.length;a++)if(t.fields[a].primaryKey&&!t.fields[a].length&&t.fields[a].deExtractType===0){C.error(n("datasource.primary_key_length")+t.fields[a].name);return}ua("returnItem",za(t)),I.value&&((l=g==null?void 0:g.value)==null||l.invokeMethod({methodName:"resetForm",args:[]})),V.value=!1},Ye=()=>{k.value-=1},Ze=()=>{var l;I.value?(l=g==null?void 0:g.value)==null||l.invokeMethod({methodName:"submitForm",args:[{eventName:"stepNext",args:t}]}):z.value.validate(a=>{a&&Ce()})},Ce=()=>{var a,s;if(t.useJsonPath&&!t.jsonPath){C.error(n("datasource.please_input_dataPath"));return}if(t.type==="params"){for(let o=0;o<d.length;o++)if(d[o].name===t.name&&t.serialNumber!==d[o].serialNumber){C.error(n("data_source.name_already_exists_de"));return}}else for(let o=0;o<w.length;o++)if(w[o].name===t.name&&t.serialNumber!==w[o].serialNumber){C.error(n("datasource.has_repeat_name"));return}(s=(a=ce)["/datasource/checkApiDatasource"])==null||s.call(a);const l=Z.encode(JSON.stringify(d));oe.value=!0,F.value=!0,Ee({dsType:M.value,data:Z.encode(JSON.stringify(t)),paramsList:l}).then(o=>{oe.value=!1,F.value=!1,t.jsonFields=o.data.jsonFields,t.fields=[],t.name=o.data.name,ye(t),re(),k.value+=1}).catch(o=>{oe.value=!1,F.value=!1,console.warn(o==null?void 0:o.message)})},Xe=()=>{var l;I.value?(l=g==null?void 0:g.value)==null||l.invokeMethod({methodName:"submitForm",args:[{eventName:"validateItem",args:t}]}):z.value.validate(a=>{if(a)Pe();else return})},Pe=()=>{var a,s;if(t.useJsonPath&&!t.jsonPath){C.error(n("datasource.please_input_dataPath"));return}(s=(a=ce)["/datasource/checkApiDatasource"])==null||s.call(a);const l=Z.encode(JSON.stringify(d));Ee({dsType:M.value,data:Z.encode(JSON.stringify(t)),paramsList:l}).then(o=>{t.jsonFields=o.data.jsonFields,t.fields=[],t.name=o.data.name,ye(t),re(),C.success(n("datasource.validate_success"))}).catch(()=>{C.error(n("data_source.verification_failed"))})},ea=l=>{const a=l.validate;a(s=>{s&&(l.eventName==="validateItem"?Pe():Ce())})},Te=()=>{var l,a,s;(a=(l=ce)["/datasource/checkApiDatasource"])==null||a.call(l),I.value&&((s=g==null?void 0:g.value)==null||s.invokeMethod({methodName:"resetForm",args:[]})),V.value=!1},aa=l=>!!(l.hasOwnProperty("children")&&l.children.length>0),ta=l=>l.hasOwnProperty("children")&&l.children.length>0?!0:l.deExtractType!==0,la=l=>l.hasOwnProperty("children")&&l.children.length>0?!0:fe.value||_e.value?!1:!!(me.value||!l.checked),sa=l=>!!(t.type=="params"||l.hasOwnProperty("children")&&l.children.length>0),na=l=>{l.deExtractType!==0&&(l.length="")},re=()=>{Q.value=!1;const l=[],a=[];let s=0;for(let o=0;o<t.fields.length;o++)t.fields[o].value&&t.fields[o].value.length>s&&(s=t.fields[o].value.length);for(let o=0;o<s;o++)l.push({});for(let o=0;o<t.fields.length;o++){for(let m=0;m<t.fields[o].value.length;m++)l[m][t.fields[o].name]=t.fields[o].value[m];a.push({key:t.fields[o].name,dataKey:t.fields[o].name,title:t.fields[o].name,width:150})}ae.value=l,se.value=a,Q.value=t.fields.length===0},je=(l,a)=>{var s;(s=a.children)!=null&&s.length&&a.children.forEach(o=>{o.checked=a.checked,je(l,o)})},ye=l=>{for(var a=0;a<l.jsonFields.length;a++)l.jsonFields[a].checked&&l.jsonFields[a].children===void 0&&l.fields.push(l.jsonFields[a]),l.jsonFields[a].children!==void 0&&$e(l,l.jsonFields[a].children)},$e=(l,a)=>{var m;for(var s=0;s<a.length;s++){if(a[s].checked&&a[s].children===void 0){for(var o=0;o<l.fields.length;o++)l.fields[o].name===a[s].name&&(a[s].checked=!1,Je(()=>{a[s].checked=!1}),G.push(a[s].name));l.fields.push(a[s])}(m=a[s].children)!=null&&m.length&&$e(l,a[s].children)}},oa=l=>{G=[],je(t,l),t.fields=[],ye(t),re(),G.length&&C.error([...new Set(G)].join(",")+", "+n("datasource.has_repeat_field_name"))},ra=l=>{t.request.body.typeChange=l},ie=h(!0),ue=h(!0),ia=()=>{var a;const l=ve.value.filter(s=>s.type===M.value);return he.value?he.value:l&&l.length>0?(a=l[0].staticMap)==null?void 0:a.index:null},ua=f;return L({initApiItem:Re}),(l,a)=>{const s=Ya,o=Wa,m=ka,x=Fa,te=ja,Y=$a,E=Ea,T=Pa,Fe=Ta,qe=qa,ge=Ca,Ue=xa,da=Va,ca=Sa,pa=Na,ma=ga,De=Ma("loading");return v(),S(ma,{title:ne.value==="table"?e(n)("datasource.data_table"):e(n)("data_source.interface_parameters"),modelValue:V.value,"onUpdate:modelValue":a[9]||(a[9]=r=>V.value=r),"custom-class":"api-datasource-drawer",size:"1000px","before-close":Te,direction:"rtl"},{footer:i(()=>[u(E,{secondary:"",onClick:Te},{default:i(()=>[D(_(e(n)("common.cancel")),1)]),_:1}),P(u(E,{secondary:"",onClick:Xe},{default:i(()=>[D(_(e(n)("commons.validate")),1)]),_:1},512),[[j,k.value===0]]),P(u(E,{type:"primary",disabled:oe.value,onClick:Ze},{default:i(()=>[D(_(e(n)("common.next")),1)]),_:1},8,["disabled"]),[[j,k.value===0]]),P(u(E,{secondary:"",onClick:Ye},{default:i(()=>[D(_(e(n)("common.prev")),1)]),_:1},512),[[j,k.value===1]]),P(u(E,{type:"primary",onClick:We},{default:i(()=>[D(_(e(n)("commons.save")),1)]),_:1},512),[[j,k.value===1]])]),default:i(()=>[p("div",Za,[u(o,{active:k.value,"align-center":""},{default:i(()=>[u(s,null,{icon:i(()=>[p("div",Xa,[p("span",et,_(k.value<=0?"1":""),1),p("span",at,_(e(n)("datasource.api_step_1")),1)])]),_:1}),u(s,null,{icon:i(()=>[p("div",tt,[p("span",lt,_(k.value<=1?"2":""),1),p("span",st,_(ne.value==="table"?e(n)("datasource.api_step_2"):e(n)("data_source.extract_parameters")),1)])]),_:1})]),_:1},8,["active"])]),P(u(ge,null,{default:i(()=>[P((v(),S(qe,{ref_key:"apiItemBasicInfo",ref:z,model:e(t),"label-position":"top","label-width":"100px","require-asterisk-position":"right",rules:O},{default:i(()=>[p("div",nt,[p("span",null,_(e(n)("datasource.base_info")),1)]),u(x,{label:e(n)("common.name"),prop:"name"},{default:i(()=>[u(m,{modelValue:e(t).name,"onUpdate:modelValue":a[0]||(a[0]=r=>e(t).name=r),placeholder:e(n)("common.input_name"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),u(x,{label:e(n)("datasource.request"),prop:"url"},{default:i(()=>[u(m,{modelValue:e(t).url,"onUpdate:modelValue":a[2]||(a[2]=r=>e(t).url=r),placeholder:e(n)("datasource.path_all_info"),class:"input-with-select"},{prepend:i(()=>[u(Y,{modelValue:e(t).method,"onUpdate:modelValue":a[1]||(a[1]=r=>e(t).method=r)},{default:i(()=>[(v(),$(we,null,ke(Ge,r=>u(te,{key:r.id,label:r.label,value:r.id},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),P((v(),$("div",null,[p("div",ot,[p("span",null,_(e(n)("datasource.req_param")),1)]),u(x,{class:"line-height_18"},{default:i(()=>[V.value?(v(),S(Ia,{key:0,request:e(t).request,"value-list":W.value,onChangeId:ra},null,8,["request","value-list"])):K("",!0)]),_:1})])),[[De,H.value]]),u(x,{label:l.$t("datasource.query_timeout"),prop:"apiQueryTimeout"},{default:i(()=>[u(m,{modelValue:e(t).apiQueryTimeout,"onUpdate:modelValue":a[3]||(a[3]=r=>e(t).apiQueryTimeout=r),autocomplete:"off",type:"number",min:0},{append:i(()=>[D(_(l.$t("chart.second")),1)]),_:1},8,["modelValue"])]),_:1},8,["label"]),p("div",rt,[p("span",null,_(e(n)("datasource.isUseJsonPath")),1)]),u(x,null,{default:i(()=>[u(m,{modelValue:e(t).jsonPath,"onUpdate:modelValue":a[5]||(a[5]=r=>e(t).jsonPath=r),placeholder:e(n)("datasource.jsonpath_info"),class:"input-with-select"},{prepend:i(()=>[u(Y,{modelValue:e(t).useJsonPath,"onUpdate:modelValue":a[4]||(a[4]=r=>e(t).useJsonPath=r),style:{width:"100px"}},{default:i(()=>[(v(),$(we,null,ke(Qe,r=>u(te,{key:r.label,label:r.label,value:r.id},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),append:i(()=>[u(E,{onClick:Be},{default:i(()=>[D(_(e(n)("data_source.view_data_structure")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),P(p("div",it,[p("span",null,_(e(n)("datasource.column_info")),1)],512),[[j,e(t).useJsonPath]]),P(p("div",ut,[u(Fe,{data:J.jsonFields,style:{width:"100%"},"row-key":"jsonPath"},{default:i(()=>[u(T,{"class-name":"checkbox-table",prop:"originName",label:e(n)("datasource.parse_filed"),"show-overflow-tooltip":""},{default:i(r=>[D(_(r.row.originName),1)]),_:1},8,["label"])]),_:1},8,["data"])],512),[[j,e(t).useJsonPath]])]),_:1},8,["model","rules"])),[[De,F.value]])]),_:1},512),[[j,k.value===0&&M.value==="API"]]),P(u(ge,null,{default:i(()=>[M.value!=="API"?(v(),S(e(La),{key:0,jsname:xe.value,"api-item":e(t),ref_key:"xpackApiItemBasicInfo",ref:g,onSubmitForm:ea},null,8,["jsname","api-item"])):K("",!0)]),_:1},512),[[j,k.value===0&&M.value!=="API"]]),P(u(ge,null,{default:i(()=>[u(qe,{style:{width:"100%"},ref_key:"apiItemForm",ref:ee,model:e(t),"label-position":"top","label-width":"100px",rules:O},{default:i(()=>[p("p",{class:b([ie.value?"active":"deactivate","column-info-title"]),onClick:a[6]||(a[6]=r=>ie.value=!ie.value)},[u(e(R),{style:{"font-size":"10px"}},{default:i(()=>[u(e(de),{name:"icon_expand-right_filled"},{default:i(()=>[u(e(Oe),{class:"svg-icon"})]),_:1})]),_:1}),p("span",dt,_(e(n)("datasource.column_info")),1)],2),P(p("div",ct,[u(Fe,{"header-cell-class-name":"header-cell",data:e(t).jsonFields,style:{width:"100%"},"row-key":"jsonPath"},{default:i(()=>[u(T,{"class-name":"checkbox-table",prop:"originName",label:e(n)("datasource.parse_filed"),width:"200"},{default:i(r=>[(v(),S(Ue,{style:{display:"inline-block","max-width":"80px","white-space":"nowrap"},key:r.row.jsonPath,modelValue:r.row.checked,"onUpdate:modelValue":y=>r.row.checked=y,disabled:e(t).useJsonPath,onChange:y=>oa(r.row)},{default:i(()=>[p("span",{title:r.row.originName,class:"ellipsis",style:{display:"inline-block","max-width":"80px"}},_(r.row.originName),9,pt)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"]))]),_:1},8,["label"]),u(T,{prop:"name",label:e(n)("datasource.field_rename")},{default:i(r=>[u(m,{modelValue:r.row.name,"onUpdate:modelValue":y=>r.row.name=y,disabled:aa(r.row),text:"",onChange:a[7]||(a[7]=y=>re())},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["label"]),u(T,{prop:"deExtractType",label:e(n)("datasource.field_type"),disabled:e(t).type==="params"},{default:i(r=>[u(Y,{modelValue:r.row.deExtractType,"onUpdate:modelValue":y=>r.row.deExtractType=y,disabled:sa(r.row),class:"select-type",style:{display:"inline-block",width:"120px"},onChange:y=>na(r.row)},{prefix:i(()=>[u(e(R),null,{default:i(()=>[u(e(de),{className:`field-icon-${e(X)[r.row.deExtractType]}`},{default:i(()=>[(v(),S(Ve(e(Me)[e(X)[r.row.deExtractType]]),{class:b(["svg-icon",`field-icon-${e(X)[r.row.deExtractType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024)]),default:i(()=>[(v(),$(we,null,ke(He,y=>u(te,{key:y.value,label:y.label,value:y.value},{default:i(()=>[p("span",mt,[u(e(R),null,{default:i(()=>[u(e(de),{className:`field-icon-${e(X)[y.value]}`},{default:i(()=>[(v(),S(Ve(e(Me)[e(X)[y.value]]),{class:b(["svg-icon",`field-icon-${e(X)[y.value]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024)]),p("span",ft,_(y.label),1)]),_:2},1032,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:1},8,["label","disabled"]),e(t).type!=="params"?(v(),S(T,{key:0,prop:"length",label:e(n)("datasource.length")},{default:i(r=>[u(da,{disabled:ta(r.row),modelValue:r.row.length,"onUpdate:modelValue":y=>r.row.length=y,autocomplete:"off","step-strictly":"",class:"text-left edit-all-line",min:1,max:512,placeholder:e(n)("common.inputText"),"controls-position":"right",type:"number"},null,8,["disabled","modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["label"])):K("",!0),e(t).type!=="params"&&c.value?(v(),S(T,{key:1,prop:"primaryKey","class-name":"checkbox-table",label:e(n)("datasource.set_key"),width:"100"},{default:i(r=>[(v(),S(Ue,{key:r.row.jsonPath,modelValue:r.row.primaryKey,"onUpdate:modelValue":y=>r.row.primaryKey=y,disabled:la(r.row)},null,8,["modelValue","onUpdate:modelValue","disabled"]))]),_:1},8,["label"])):K("",!0)]),_:1},8,["data"])],512),[[j,ie.value]]),p("p",{class:b([ue.value?"active":"deactivate","column-info-title"]),onClick:a[8]||(a[8]=r=>ue.value=!ue.value)},[u(e(R),{style:{"font-size":"10px"}},{default:i(()=>[u(e(de),{name:"icon_expand-right_filled"},{default:i(()=>[u(e(Oe),{class:"svg-icon"})]),_:1})]),_:1}),p("span",vt,_(e(n)("datasource.data_preview")),1)],2),P(p("div",{class:"info-table",style:Ne({height:Math.min(ae.value.length,20)*40+"px"})},[Q.value?(v(),S(Ka,{key:0,description:e(n)("data_source.the_data_structure"),"img-type":"select"},null,8,["description"])):(v(),S(pa,{key:1},{default:i(({height:r,width:y})=>[u(ca,{columns:se.value,"header-class":"header-cell",data:ae.value,width:y,height:r,fixed:""},null,8,["columns","data","width","height"])]),_:1}))],4),[[j,ue.value]])]),_:1},8,["model","rules"])]),_:1},512),[[j,k.value===1]])]),_:1},8,["title","modelValue"])}}});export{Ya as E,At as _,Wa as a};

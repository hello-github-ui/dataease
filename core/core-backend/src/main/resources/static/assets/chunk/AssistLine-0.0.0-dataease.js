import{d as S,p as h,B as K,o as U,e as G,h as P,L as Q}from"./element-plus-secondary-0.0.0-dataease.js";import{j as R,h as Y}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as Z,k as x,l as $,w as H,b as W,o as c,c as u,a as d,z as g,a2 as r,u as a,Y as y,a0 as l,_ as n,M as X,ab as tt,Z as L,a4 as N,a1 as F}from"./@vue-0.0.0-dataease.js";import{i as et}from"./icon_edit_outlined-0.0.0-dataease.js";import{i as st}from"./icon_info_outlined-0.0.0-dataease.js";import it from"./AssistLineEdit-0.0.0-dataease.js";import{P as at}from"./chart-0.0.0-dataease.js";import{z as k,A as nt}from"./lodash-es-0.0.0-dataease.js";import{_ as ot}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./vue-router-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./attr-0.0.0-dataease20.js";import"./field-list-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";const rt={class:"inner-container"},lt={class:"right-btns"},ct=["disabled"],dt=["title"],pt=["title"],mt=["title"],ut=["title"],ft=["title"],_t={key:1,style:{color:"red"}},ht={class:"assist-line-cfg-header"},gt={class:"ed-dialog__title"},yt={class:"dialog-footer"},Lt=Z({__name:"AssistLine",props:{chart:{type:Object,required:!0},quotaData:{type:Array,required:!0},quotaExtData:{type:Array,required:!0},themes:{type:String,default:"dark"},propertyInner:{type:Array}},emits:["onAssistLineChange"],setup(v,{emit:I}){const{t:i}=R(),w=I,p=v,C=x(()=>p.quotaData.filter(s=>s.summary!==""&&s.id!=="-1")),A=x(()=>p.quotaExtData.filter(s=>s.summary!==""&&s.id!=="-1")),b=x(()=>p.chart.type.includes("chart-mix")),e=$({assistLineCfg:{enable:!1,assistLine:[]},editLineDialog:!1,lineArr:[],quotaFields:[]});H(()=>p.chart.senior.assistLineCfg,()=>{D()},{deep:!0});const O=()=>{const s=e.assistLineCfg.assistLine.findIndex(t=>t.field==="1")!==-1;w("onAssistLineChange",{data:e.assistLineCfg,requestData:s})},V=s=>{e.lineArr=s},z=()=>{e.editLineDialog=!0},q=()=>{e.editLineDialog=!1},B=()=>{for(let s=0;s<e.lineArr.length;s++){const t=e.lineArr[s];if(!t.name||t.name===""){h.error(i("chart.name_can_not_empty"));return}if(t.field==="0"){if(t.value===null||t.value===void 0||t.value===""){h.error(i("chart.value_can_not_empty"));return}if(parseFloat(t.value).toString()==="NaN"){h.error(i("chart.value_error"));return}}else{if(!t.fieldId||t.fieldId===""){h.error(i("chart.field_not_empty"));return}if(!t.summary||t.summary===""){h.error(i("chart.summary_not_empty"));return}}}e.assistLineCfg.assistLine=JSON.parse(JSON.stringify(e.lineArr)),O(),q()};function J(s){return b.value?!!k(C.value,t=>t.id===s.id)||!!k(A.value,t=>t.id===s.id):!!k(C.value,t=>t.id===s.id)}const D=()=>{var t;const s=JSON.parse(JSON.stringify(p.chart));if(s.senior){const f=s.senior;if((t=f.assistLineCfg)!=null&&t.assistLine){const m=f.assistLineCfg.assistLine;for(let _=0;_<m.length;_++)m[_].fontSize||(m[_].fontSize=10);e.assistLineCfg=nt(f.assistLineCfg,at)}e.lineArr=JSON.parse(JSON.stringify(e.assistLineCfg.assistLine))}};return W(()=>{D()}),(s,t)=>{const f=Y,m=K,_=U,M=G,E=P,T=Q;return c(),u("div",{onKeydown:t[1]||(t[1]=F(()=>{},["stop"])),onKeyup:t[2]||(t[2]=F(()=>{},["stop"])),class:"assist-line-container"},[d("div",rt,[d("span",{class:g(["label","label-"+p.themes])},r(a(i)("chart.assist_line_settings")),3),d("span",lt,[e.assistLineCfg.assistLine.length>0?(c(),u("span",{key:0,class:g(["set-text-info",{"set-text-info-dark":v.themes==="dark"}])},r(a(i)("visualization.already_setting")),3)):y("",!0),d("button",{class:g(["label-"+p.themes,"circle-button_icon"]),style:{marginLeft:"6px"},disabled:!e.assistLineCfg.enable,onClick:z},[l(a(S),null,{default:n(()=>[l(f,null,{default:n(()=>[l(a(et),{class:g([e.assistLineCfg.enable&&"primary-color","svg-icon"])},null,8,["class"])]),_:1})]),_:1})],10,ct)])]),(c(!0),u(X,null,tt(e.assistLineCfg.assistLine,(o,j)=>(c(),L(_,{key:j,class:"line-style"},{default:n(()=>[l(m,{span:8,class:"line-style"},{default:n(()=>[d("span",{title:o.name},r(o.name),9,dt)]),_:2},1024),l(m,{span:6,class:"line-style"},{default:n(()=>[o.field==="0"?(c(),u("span",{key:0,title:a(i)("chart.field_fixed")},r(a(i)("chart.field_fixed")),9,pt)):y("",!0),o.field==="1"?(c(),u("span",{key:1,title:a(i)("chart.field_dynamic")},r(a(i)("chart.field_dynamic")),9,mt)):y("",!0)]),_:2},1024),o.field==="0"?(c(),L(m,{key:0,span:10,class:"line-style"},{default:n(()=>[d("span",{title:o.value},r(o.value),9,ut)]),_:2},1024)):o.field==="1"?(c(),L(m,{key:1,span:10,class:"line-style"},{default:n(()=>[J(o.curField)?(c(),u("span",{key:0,title:o.curField.name+"("+a(i)("chart."+o.summary)+")"},r(o.curField.name+"("+a(i)("chart."+o.summary)+")"),9,ft)):(c(),u("span",_t,r(a(i)("chart.invalid_field")),1))]),_:2},1024)):y("",!0)]),_:2},1024))),128)),e.editLineDialog?(c(),L(T,{key:0,modelValue:e.editLineDialog,"onUpdate:modelValue":t[0]||(t[0]=o=>e.editLineDialog=o),visible:e.editLineDialog,width:"1000px",class:"dialog-css"},{header:n(()=>[d("div",ht,[d("span",gt,r(a(i)("chart.assist_line")),1),l(M,{class:"item",effect:"ndark",placement:"top"},{content:n(()=>[d("span",null,r(a(i)("chart.assist_line_tip")),1)]),default:n(()=>[l(a(S),{class:g(["hint-icon",{"hint-icon--dark":v.themes==="dark"}])},{default:n(()=>[l(f,{name:"icon_info_outlined"},{default:n(()=>[l(a(st),{class:"svg-icon"})]),_:1})]),_:1},8,["class"])]),_:1})])]),footer:n(()=>[d("div",yt,[l(E,{onClick:q},{default:n(()=>[N(r(a(i)("chart.cancel")),1)]),_:1}),l(E,{type:"primary",onClick:B},{default:n(()=>[N(r(a(i)("chart.confirm")),1)]),_:1})])]),default:n(()=>[l(it,{chart:p.chart,line:e.assistLineCfg.assistLine,"quota-fields":C.value,"quota-ext-fields":A.value,"use-quota-ext":b.value,onOnAssistLineChange:V},null,8,["chart","line","quota-fields","quota-ext-fields","use-quota-ext"])]),_:1},8,["modelValue","visible"])):y("",!0)],32)}}});const Se=ot(Lt,[["__scopeId","data-v-93fceb26"]]);export{Se as default};

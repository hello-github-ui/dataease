import{j as H}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import J from"./AuthTree-0.0.0-dataease2.js";import{d as K,r as k,k as I,o as V,c as A,a0 as Q,a as N}from"./@vue-0.0.0-dataease.js";import{_ as W}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./element-plus-secondary-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./vue-router-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./FilterFiled-0.0.0-dataease2.js";import"./icon_search-outline_outlined-0.0.0-dataease.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./options-0.0.0-dataease.js";import"./field-list-0.0.0-dataease.js";import"./icon_down_outlined-0.0.0-dataease.js";const Z={class:"rowAuth"},b={width:"388",height:"100%",class:"real-line"},j=["d"],tt={width:"388",height:"100%",class:"dash-line"},et=["d"],it=K({__name:"RowAuth",emits:["save"],setup(lt,{expose:B,emit:Y}){const{t:u}=H(),p=k(""),v=k("or"),a=k([]),O=I(()=>{const i=a.value.length;let t={x:0,y:0,child:a.value};return t.y=Math.floor(M(t,0)/2),i?w(t):""}),P=I(()=>{const i=a.value.length;let t={x:0,y:0,child:a.value};return t.y=Math.floor(M(t,0)/2),i?R(t):"M48 20 L68 20"}),S=i=>{const{items:t}=i;v.value=i.logic||"or",a.value=x(t||[])},z=()=>{p.value="",G("save",{logic:v.value,items:E(a.value),errorMessage:p.value})},F=({enumValue:i,deType:t,filterType:e,term:l,value:o,name:r,timeValue:n})=>{if(!r){p.value=u("data_set.cannot_be_empty_");return}if(e==="logic"){if(!l){p.value=u("data_set.cannot_be_empty_de_ruler");return}if(!l.includes("null")&&!l.includes("empty")&&["",null,void 0].includes(o)&&t!==1){p.value=u("chart.filter_value_can_null");return}if(!l.includes("null")&&!l.includes("empty")&&["",null,void 0].includes(n)&&t===1){p.value=u("chart.filter_value_can_null");return}if([2,3].includes(t)&&parseFloat(o).toString()==="NaN"){p.value=u("chart.filter_value_can_not_str");return}}if(e==="enum"&&i.length<1){p.value=u("chart.enum_value_can_not_null");return}},x=i=>{const t=[];return i.forEach(e=>{const{subTree:l}=e;if(l){const{items:o=[],logic:r}=l,n=x(o);t.push({logic:r,child:n})}else{const{enumValue:o,fieldId:r,filterType:n,term:s,value:c,timeValue:d,field:f}=e,{name:h,deType:y}=f||{};t.push({enumValue:o.join(","),fieldId:r,filterType:n,term:s,timeValue:d,value:c,name:h,deType:y})}}),t},E=i=>{const t=[];return i.forEach(e=>{const{child:l=[]}=e;if(l.length){const{logic:o}=e,r=E(l);t.push({enumValue:[],fieldId:"",filterType:"",term:"",type:"tree",value:"",timeValue:"",subTree:{logic:o,items:r}})}else{const{enumValue:o,fieldId:r,filterType:n,deType:s,term:c,value:d,name:f,timeValue:h}=e;F({deType:s,enumValue:o,filterType:n,term:c,value:d,name:f,timeValue:h}),r&&t.push({enumValue:o?o.split(","):[],fieldId:r,timeValue:h,filterType:n,term:c,value:d,type:"item",subTree:null})}}),t},U=()=>{a.value=[]},g=i=>{var e;const[t]=i;return(e=t.child)!=null&&e.length?g(t.child):t.y},R=i=>{var l,o;const t=(l=i.child)==null?void 0:l.length;let e="";if(!t&&Array.isArray(i.child)){const{x:r,y:n}=i;e+=`M${48+r*68} ${n*41.4+20} L${88+r*68} ${n*41.4+20}`}else if((o=i.child)!=null&&o.length){let r=Math.max(T(i,0),m(i.child,0)+g(i.child)-1),n=m(i.child,0)*41.4/2+(g(i.child)||0)*41.4;const{x:s}=i;e+=`M${24+s*68} ${n} L${24+s*68} ${r*41.4+20} L${64+s*68} ${r*41.4+20}`,i.child.forEach(c=>{e+=R(c)})}return e},w=i=>{const t=i.child.length;if(!t)return"";let e="";const{x:l,y:o}=i;return i.child.forEach((r,n)=>{var d,f,h,y;const{y:s,z:c}=r;if((d=r.child)!=null&&d.length){let $=m(i.child,0)*41.4/2+(g(i.child)||0)*41.4,L=m(r.child,0)*41.4/2+g(r.child)*41.4,C=0,_=0;$<L?(C=$,_=L):[C,_]=[L,$],o>=s&&(C=$,_=L),e+=`M${24+l*68} ${C} L${24+l*68} ${_} L${68+l*68} ${_}`,e+=w(r)}(f=r.child)!=null&&f.length||(s>=o?e+=`M${24+l*68} ${o*40} L${24+l*68} ${(s+1)*41.4-20.69921875} L${68+l*68} ${(s+1)*41.4-20.69921875}`:e+=`M${24+l*68} ${(s+(t===1&&n===0?0:1)+((y=(h=i.child[n+1])==null?void 0:h.child)!=null&&y.length?o-s-1:0))*41.4+20+(t===1&&n===0?26:0)} L${24+l*68} ${(s+1)*41.4-20.69921875-(t===1&&n===0?(c||0)*1.4:0)} L${68+l*68} ${(s+1)*41.4-20.69921875-(t===1&&n===0?(c||0)*1.4:0)}`)}),e},D=(i,t)=>{i.forEach(e=>{e.child&&(e.logic=t==="and"?"or":"and",D(e.child,e.logic))})},m=(i,t)=>(i.forEach(e=>{var l;(l=e.child)!=null&&l.length?t=m(e.child,t):t+=1}),t+=1,t),T=(i,t)=>(i.child.forEach(e=>{var l;(l=e.child)!=null&&l.length?t=T(e,t):t=Math.max(t,e.y,i.y)}),t),M=(i,t)=>(i.child.forEach(e=>{var l;if(e.x=i.x+1,(l=e.child)!=null&&l.length){let o=m(e.child,0);e.y=Math.floor(o/2)+t,t=M(e,t)}else t+=1,e.y=t-1}),t+=1,t),X=(i,t)=>{a.value.push(i==="condition"?{fieldId:"",value:"",enumValue:"",term:"",filterType:"logic",name:"",timeValue:"",deType:""}:{child:[],logic:t})},q=i=>{a.value.splice(i,1)};B({init:S,submit:z});const G=Y;return(i,t)=>(V(),A("div",Z,[Q(J,{onDel:t[0]||(t[0]=e=>q(e)),onAddCondReal:X,onRemoveRelationList:U,onChangeAndOrDfs:t[1]||(t[1]=e=>D(a.value,e)),relationList:a.value,logic:v.value,"onUpdate:logic":t[2]||(t[2]=e=>v.value=e)},null,8,["relationList","logic"]),(V(),A("svg",b,[N("path",{"stroke-linejoin":"round","stroke-linecap":"round",d:O.value,fill:"none",stroke:"#CCCCCC","stroke-width":"0.5"},null,8,j)])),(V(),A("svg",tt,[N("path",{"stroke-linejoin":"round","stroke-linecap":"round",d:P.value,fill:"none",stroke:"#CCCCCC","stroke-width":"0.5","stroke-dasharray":"4,4"},null,8,et)]))]))}});const ue=W(it,[["__scopeId","data-v-b6b60d4e"]]);export{ue as default};

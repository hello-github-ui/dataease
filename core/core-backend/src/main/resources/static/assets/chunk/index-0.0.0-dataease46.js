import{E as q}from"./EmptyBackground-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import{o as A,D as L,F as G,n as O,j as U,G as z,y as H}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as K}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{i as W}from"./icon_add_outlined-0.0.0-dataease.js";import{_ as Y}from"./UploadDetail.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{useAppearanceStoreWithOut as J}from"./appearance-0.0.0-dataease.js";import{a as Q,e as R,d as X}from"./font-0.0.0-dataease.js";import{d as E}from"./lodash-0.0.0-dataease.js";import{d as Z,r as h,G as tt,o as et,aa as ot,f as i,L as u,T as st,M as c,a5 as _,a6 as a,j as s,k as d,i as l,Y as B,a9 as nt,a0 as p,U as at,g}from"./vue-0.0.0-dataease.js";import{_ as it}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./el-dialog-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-upload-0.0.0-dataease.js";import"./el-progress-0.0.0-dataease.js";import"./el-form-item-0.0.0-dataease.js";import"./icon_upload_outlined-0.0.0-dataease.js";import"./FontInfo-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./antv-0.0.0-dataease.js";const lt={class:"font-management_system"},rt={class:"route-title"},ct={class:"search-font"},dt={class:"font-content_overflow"},ut={key:0,class:"font-content_list"},mt={key:0,class:"font-default"},_t={class:"font-name"},ft=["title"],pt={key:0,class:"font-type"},yt=["title"],vt=["title"],ht={class:"font-upload_btn"},gt={key:1,style:{height:"178px","margin-top":"142px"}},kt=Z({__name:"index",setup(Ct){const v=J(),{t:o}=A(),k=h(""),C=h([]),N="./de2api",$=h(),r=h(!1),w=(n,t,f)=>{$.value.init(n,t,f)},x=async()=>{r.value=!0,await v.setFontList(),C.value=E(v.fontList),r.value=!1},b=tt(()=>C.value.filter(n=>{var t;return(t=n.name)==null?void 0:t.toLocaleLowerCase().includes(k.value.trim().toLocaleLowerCase())})),T=n=>{if(n.isDefault){L.warning(o("system.fonts_before_deleting"));return}G.confirm(o("system.sure_to_delete"),{confirmButtonType:"danger",type:"warning",autofocus:!1,showClose:!1}).then(()=>{r.value=!0,Q(n.id).then(()=>{L.success(o("common.delete_success")),x(),D()}).finally(()=>{r.value=!1})})},S=n=>{n.isDefault=1,r.value=!0,R(n).then(()=>{L.success(o("system.setting_successful")),D(),x()}).finally(()=>{r.value=!1})},V=(n,t,f)=>{let m=document.querySelector("#de-custom_font");!m&&t&&(m=document.createElement("style"),m.setAttribute("id","de-custom_font"),document.querySelector("head").appendChild(m)),m.innerHTML=t&&f?`@font-face {
              font-family: '${t}';
              src: url(${n});
              font-weight: normal;
              font-style: normal;
              }`:"",document.documentElement.style.setProperty("--de-custom_font",`${t||""}`),document.documentElement.style.setProperty("--van-base-font",`${t||""}`)},D=()=>{X().then(n=>{const[t]=n||[];V(`${N}/typeface/download/${t==null?void 0:t.fileTransName}`,t==null?void 0:t.name,t==null?void 0:t.fileTransName)})},I=async()=>{r.value=!0,await v.setFontList(),C.value=E(v.fontList),r.value=!1,D()};return et(()=>{x()}),(n,t)=>{const f=O,m=U,M=z,y=H,P=q,j=ot("loading");return i(),u(B,null,[st((i(),u("div",lt,[c("div",rt,[_(a(s(o)("system.font_management"))+" ",1),c("div",ct,[d(M,{modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=e=>k.value=e),clearable:"",style:{width:"240px"},placeholder:s(o)("system.search_font_name")},{prefix:l(()=>[d(m,null,{default:l(()=>[d(f,{name:"icon_search-outline_outlined"},{default:l(()=>[d(s(K),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"]),d(y,{type:"primary",onClick:t[1]||(t[1]=e=>w(s(o)("system.a_new_font"),"create",{}))},{icon:l(()=>[d(f,{name:"icon_add_outlined"},{default:l(()=>[d(s(W),{class:"svg-icon"})]),_:1})]),default:l(()=>[_(" "+a(s(o)("system.add_font")),1)]),_:1})])]),c("div",dt,[b.value.length?(i(),u("div",ut,[(i(!0),u(B,null,nt(b.value,e=>(i(),u("div",{class:"font-content_item",key:e},[e.isDefault?(i(),u("span",mt,a(s(o)("system.default_font")),1)):p("",!0),c("div",_t,[c("span",{title:e.name,class:at(!e.isBuiltin&&"font-name_text")},a(e.name),11,ft),e.isBuiltin?(i(),u("span",pt,a(s(o)("system.system_built_in")),1)):p("",!0)]),c("div",{title:e.fileName,class:"font-update_time"},[_(a(s(o)("system.update_time"))+" "+a(new Date(e.updateTime).toLocaleString())+" ",1),t[2]||(t[2]=c("span",{class:"line"},null,-1)),c("span",{title:e.fileName,class:"font-update_text"},a(s(o)("system.font_file"))+" "+a(e.fileName),9,vt)],8,yt),c("div",ht,[e.fileTransName?p("",!0):(i(),g(y,{key:0,onClick:F=>w(s(o)("system.upload_font_file"),"uploadFile",e),secondary:""},{default:l(()=>[_(a(s(o)("system.upload_font_file")),1)]),_:2},1032,["onClick"])),e.fileTransName?(i(),g(y,{key:1,onClick:F=>w(s(o)("system.replace_font_file"),"uploadFile",e),secondary:""},{default:l(()=>[_(a(s(o)("system.replace_font_file")),1)]),_:2},1032,["onClick"])):p("",!0),e.isDefault?p("",!0):(i(),g(y,{key:2,onClick:F=>S(e),secondary:""},{default:l(()=>[_(a(s(o)("system.as_default_font")),1)]),_:2},1032,["onClick"])),e.id!=="1"?(i(),g(y,{key:3,onClick:F=>T(e),secondary:""},{default:l(()=>[_(a(s(o)("common.delete")),1)]),_:2},1032,["onClick"])):p("",!0)])]))),128))])):(i(),u("div",gt,[d(P,{description:n.$t("work_branch.relevant_content_found"),"img-type":"tree"},null,8,["description"])]))])])),[[j,r.value]]),d(Y,{onFinish:I,ref_key:"uploadDetail",ref:$},null,512)],64)}}});const Rt=it(kt,[["__scopeId","data-v-7a6b7398"]]);export{Rt as default};

import{E as z}from"./EmptyBackground-0.0.0-dataease.js";import{p as $,q as A,d as O,r as W,h as j}from"./element-plus-secondary-0.0.0-dataease.js";import{j as H,h as K}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as U}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{i as Y}from"./icon_add_outlined-0.0.0-dataease.js";import{_ as Z}from"./UploadDetail.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{useAppearanceStoreWithOut as G}from"./appearance-0.0.0-dataease.js";import{a as J,e as Q,d as R}from"./font-0.0.0-dataease.js";import{e as E}from"./lodash-es-0.0.0-dataease.js";import{d as X,r as h,k as tt,b as et,ak as ot,o as a,c as p,W as st,a as m,a4 as d,a2 as i,u as s,a0 as c,_ as r,M as B,ab as nt,Y as f,z as it,Z as k}from"./@vue-0.0.0-dataease.js";import{_ as at}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./vue-router-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./icon_upload_outlined-0.0.0-dataease.js";import"./FontInfo-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";const rt={class:"font-management_system"},lt={class:"route-title"},mt={class:"search-font"},ct={class:"font-content_overflow"},pt={key:0,class:"font-content_list"},ut={key:0,class:"font-default"},dt={class:"font-name"},_t=["title"],ft={key:0,class:"font-type"},yt=["title"],vt=["title"],ht={class:"font-upload_btn"},kt={key:1,style:{height:"178px","margin-top":"142px"}},gt=X({__name:"index",setup(Ct){const v=G(),{t:o}=H(),g=h(""),C=h([]),N="./de2api",F=h(),l=h(!1),w=(n,t,_)=>{F.value.init(n,t,_)},x=async()=>{l.value=!0,await v.setFontList(),C.value=E(v.fontList),l.value=!1},L=tt(()=>C.value.filter(n=>{var t;return(t=n.name)==null?void 0:t.toLocaleLowerCase().includes(g.value.trim().toLocaleLowerCase())})),T=n=>{if(n.isDefault){$.warning(o("system.fonts_before_deleting"));return}A.confirm(o("system.sure_to_delete"),{confirmButtonType:"danger",type:"warning",autofocus:!1,showClose:!1}).then(()=>{l.value=!0,J(n.id).then(()=>{$.success(o("common.delete_success")),x(),b()}).finally(()=>{l.value=!1})})},S=n=>{n.isDefault=1,l.value=!0,Q(n).then(()=>{$.success(o("system.setting_successful")),b(),x()}).finally(()=>{l.value=!1})},V=(n,t,_)=>{let u=document.querySelector("#de-custom_font");!u&&t&&(u=document.createElement("style"),u.setAttribute("id","de-custom_font"),document.querySelector("head").appendChild(u)),u.innerHTML=t&&_?`@font-face {
              font-family: '${t}';
              src: url(${n});
              font-weight: normal;
              font-style: normal;
              }`:"",document.documentElement.style.setProperty("--de-custom_font",`${t||""}`),document.documentElement.style.setProperty("--van-base-font",`${t||""}`)},b=()=>{R().then(n=>{const[t]=n||[];V(`${N}/typeface/download/${t==null?void 0:t.fileTransName}`,t==null?void 0:t.name,t==null?void 0:t.fileTransName)})},I=async()=>{l.value=!0,await v.setFontList(),C.value=E(v.fontList),l.value=!1,b()};return et(()=>{x()}),(n,t)=>{const _=K,u=O,M=W,y=j,q=z,P=ot("loading");return a(),p(B,null,[st((a(),p("div",rt,[m("div",lt,[d(i(s(o)("system.font_management"))+" ",1),m("div",mt,[c(M,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),clearable:"",style:{width:"240px"},placeholder:s(o)("system.search_font_name")},{prefix:r(()=>[c(u,null,{default:r(()=>[c(_,{name:"icon_search-outline_outlined"},{default:r(()=>[c(s(U),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"]),c(y,{type:"primary",onClick:t[1]||(t[1]=e=>w(s(o)("system.a_new_font"),"create",{}))},{icon:r(()=>[c(_,{name:"icon_add_outlined"},{default:r(()=>[c(s(Y),{class:"svg-icon"})]),_:1})]),default:r(()=>[d(" "+i(s(o)("system.add_font")),1)]),_:1})])]),m("div",ct,[L.value.length?(a(),p("div",pt,[(a(!0),p(B,null,nt(L.value,e=>(a(),p("div",{class:"font-content_item",key:e},[e.isDefault?(a(),p("span",ut,i(s(o)("system.default_font")),1)):f("",!0),m("div",dt,[m("span",{title:e.name,class:it(!e.isBuiltin&&"font-name_text")},i(e.name),11,_t),e.isBuiltin?(a(),p("span",ft,i(s(o)("system.system_built_in")),1)):f("",!0)]),m("div",{title:e.fileName,class:"font-update_time"},[d(i(s(o)("system.update_time"))+" "+i(new Date(e.updateTime).toLocaleString())+" ",1),t[2]||(t[2]=m("span",{class:"line"},null,-1)),m("span",{title:e.fileName,class:"font-update_text"},i(s(o)("system.font_file"))+" "+i(e.fileName),9,vt)],8,yt),m("div",ht,[e.fileTransName?f("",!0):(a(),k(y,{key:0,onClick:D=>w(s(o)("system.upload_font_file"),"uploadFile",e),secondary:""},{default:r(()=>[d(i(s(o)("system.upload_font_file")),1)]),_:2},1032,["onClick"])),e.fileTransName?(a(),k(y,{key:1,onClick:D=>w(s(o)("system.replace_font_file"),"uploadFile",e),secondary:""},{default:r(()=>[d(i(s(o)("system.replace_font_file")),1)]),_:2},1032,["onClick"])):f("",!0),e.isDefault?f("",!0):(a(),k(y,{key:2,onClick:D=>S(e),secondary:""},{default:r(()=>[d(i(s(o)("system.as_default_font")),1)]),_:2},1032,["onClick"])),e.id!=="1"?(a(),k(y,{key:3,onClick:D=>T(e),secondary:""},{default:r(()=>[d(i(s(o)("common.delete")),1)]),_:2},1032,["onClick"])):f("",!0)])]))),128))])):(a(),p("div",kt,[c(q,{description:n.$t("work_branch.relevant_content_found"),"img-type":"tree"},null,8,["description"])]))])])),[[P,l.value]]),c(Z,{onFinish:I,ref_key:"uploadDetail",ref:F},null,512)],64)}}});const qe=at(gt,[["__scopeId","data-v-7a6b7398"]]);export{qe as default};

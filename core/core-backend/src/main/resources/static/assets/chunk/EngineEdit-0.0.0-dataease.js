import{an as Q}from"./index-0.0.0-dataease.js";import{E as W}from"./el-drawer-0.0.0-dataease.js";import{o as X,aT as ee,x as C,D as I,G as oe,n as te,j as ae,y as le}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import{E as re}from"./el-row-0.0.0-dataease.js";import{E as ne}from"./el-col-0.0.0-dataease.js";import{E as ie}from"./el-input-number-0.0.0-dataease.js";import{a as se,E as ue}from"./el-form-item-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{E as me,a as de}from"./el-select-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{i as pe}from"./icon_down_outlined-1-0.0.0-dataease.js";import{i as ce}from"./icon_down_outlined-0.0.0-dataease.js";import{d as fe}from"./option-0.0.0-dataease.js";import{g as ge}from"./datasource-0.0.0-dataease.js";import{_ as _e}from"./CustomPassword.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{g as O}from"./base64-0.0.0-dataease.js";import{s as be}from"./encryption-0.0.0-dataease.js";import{d as v}from"./lodash-0.0.0-dataease.js";import{d as ye,r as x,Z as Ve,f as m,g as f,i as n,M as $,k as l,a5 as E,a6 as S,j as o,L as D,Y as F,a9 as ve,a0 as w,m as xe}from"./vue-0.0.0-dataease.js";import{_ as Ee}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./index-0.0.0-dataease17.js";import"./index-0.0.0-dataease3.js";import"./index-0.0.0-dataease16.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./icon_visible_outlined-0.0.0-dataease.js";import"./icon_invisible_outlined-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";const Se={class:"dialog-footer"},we=ye({__name:"EngineEdit",emits:["saved"],setup(ze,{expose:J,emit:L}){const{t:e}=X(),_=x(!1),N=x(null),R={name:[{required:!0,message:e("datasource.input_name"),trigger:"blur"},{min:2,max:64,message:e("datasource.input_limit_2_25",[2,64]),trigger:"blur"}]},M={"configuration.dataBase":[{required:!0,message:e("datasource.please_input_data_base"),trigger:"blur"}],"configuration.username":[{required:!0,message:e("datasource.please_input_user_name"),trigger:"blur"}],"configuration.password":[{required:!0,message:e("datasource.please_input_password"),trigger:"blur"}],"configuration.host":[{required:!0,message:e("datasource._ip_address"),trigger:"blur"}],"configuration.jdbc":[{required:!0,message:e("datasource.please_input_jdbc_url"),trigger:"blur"}],"configuration.extraParams":[{required:!1,message:e("datasource.please_input_url"),trigger:"blur"}],"configuration.port":[{required:!0,message:e("datasource.please_input_port"),trigger:"blur"}],"configuration.initialPoolSize":[{required:!0,message:e("common.inputText")+" "+e("datasource.initial_pool_size"),trigger:"blur"}],"configuration.minPoolSize":[{required:!0,message:e("common.inputText")+" "+e("datasource.min_pool_size"),trigger:"blur"}],"configuration.maxPoolSize":[{required:!0,message:e("common.inputText")+" "+e("datasource.max_pool_size"),trigger:"blur"}],"configuration.queryTimeout":[{required:!0,message:e("common.inputText")+" "+e("datasource.query_timeout"),trigger:"blur"}]},G={...v(M),...v(R)},K=L,B=()=>{_.value=!1,Object.assign(r,v(j))},Y=()=>{B()},U=()=>{N.value=Q.service({target:".basic-param-drawer"})},b=()=>{var s;(s=N.value)==null||s.close()},y=x(!1),j={name:"",createBy:"",creator:"",createTime:"",description:"",id:0,size:0,nodeType:"",type:"",fileName:"",configuration:{host:"",jdbc:"",port:8081,dataBase:"",username:"",password:"",extraParams:"",initialPoolSize:5,minPoolSize:5,maxPoolSize:5,queryTimeout:30},syncSetting:null,apiConfiguration:[],weight:0},r=Ve(v(j)),Z=()=>{ee().then(s=>{ge().then(t=>{let{name:d,createBy:T,id:i,createTime:p,creator:c,type:q,pid:P,configuration:u,syncSetting:V,fileName:h,size:g,description:k,lastSyncTime:a}=t.data;u&&(u=JSON.parse(be(u,s.data))),Object.assign(r,{name:d,pid:P,description:k,fileName:h,size:g,createTime:p,creator:c,createBy:T,id:i,type:q,configuration:u,syncSetting:V,lastSyncTime:a})}).finally(()=>{_.value=!0})})},z=x(),A=async()=>{let s=JSON.parse(JSON.stringify(r));s.configuration=O.encode(JSON.stringify(s.configuration)),z.value.validate(t=>{t&&(U(),C.post({url:"/engine/save",data:s}).then(d=>{d!==void 0&&(I.success(e("common.save_success")),K("saved"),Y()),b()}).catch(()=>{b()}))})},H=async()=>{let s=JSON.parse(JSON.stringify(r));s.configuration=O.encode(JSON.stringify(s.configuration)),z.value.validate(t=>{t&&(U(),C.post({url:"/engine/validate",data:s}).then(d=>{d!==void 0&&I.success(e("datasource.validate_success")),b()}).catch(()=>{b()}))})};return J({edit:Z}),(s,t)=>{const d=me,T=de,i=se,p=oe,c=ie,q=te,P=ae,u=ne,V=re,h=ue,g=le,k=W;return m(),f(k,{title:o(e)("system.engine_settings"),modelValue:_.value,"onUpdate:modelValue":t[16]||(t[16]=a=>_.value=a),"custom-class":"basic-param-drawer",size:"600px",direction:"rtl"},{footer:n(()=>[$("span",Se,[l(g,{secondary:"",onClick:t[13]||(t[13]=a=>B())},{default:n(()=>[E(S(o(e)("common.cancel")),1)]),_:1}),l(g,{secondary:"",onClick:t[14]||(t[14]=a=>H())},{default:n(()=>[E(S(o(e)("datasource.validate")),1)]),_:1}),l(g,{type:"primary",onClick:t[15]||(t[15]=a=>A())},{default:n(()=>[E(S(o(e)("commons.save")),1)]),_:1})])]),default:n(()=>[l(h,{ref_key:"basicForm",ref:z,"require-asterisk-position":"right",model:r,rules:G,"label-width":"80px","label-position":"top"},{default:n(()=>[l(i,{label:o(e)("datasource.type")},{default:n(()=>[l(T,{modelValue:r.type,"onUpdate:modelValue":t[0]||(t[0]=a=>r.type=a),class:"de-select",disabled:""},{default:n(()=>[(m(!0),D(F,null,ve(o(fe),a=>(m(),f(d,{key:a.type,label:a.name,value:a.type},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),r.type==="h2"?(m(),f(i,{key:0,label:o(e)("datasource.host"),prop:"configuration.jdbc"},{default:n(()=>[l(p,{modelValue:r.configuration.jdbc,"onUpdate:modelValue":t[1]||(t[1]=a=>r.configuration.jdbc=a),placeholder:o(e)("data_source.jdbc_connection_string"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),r.type!=="h2"?(m(),f(i,{key:1,label:o(e)("datasource.host"),prop:"configuration.host"},{default:n(()=>[l(p,{modelValue:r.configuration.host,"onUpdate:modelValue":t[2]||(t[2]=a=>r.configuration.host=a),placeholder:o(e)("datasource._ip_address"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),r.type!=="h2"?(m(),f(i,{key:2,label:o(e)("datasource.port"),prop:"configuration.port"},{default:n(()=>[l(c,{modelValue:r.configuration.port,"onUpdate:modelValue":t[3]||(t[3]=a=>r.configuration.port=a),autocomplete:"off","step-strictly":"",class:"text-left",min:0,placeholder:o(e)("common.inputText")+o(e)("datasource.port"),"controls-position":"right",type:"number"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),l(i,{label:o(e)("datasource.data_base"),prop:"configuration.dataBase"},{default:n(()=>[l(p,{modelValue:r.configuration.dataBase,"onUpdate:modelValue":t[4]||(t[4]=a=>r.configuration.dataBase=a),placeholder:o(e)("datasource.please_input_data_base"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(i,{label:o(e)("datasource.user_name")},{default:n(()=>[l(p,{placeholder:o(e)("common.inputText")+o(e)("datasource.user_name"),modelValue:r.configuration.username,"onUpdate:modelValue":t[5]||(t[5]=a=>r.configuration.username=a),autocomplete:"off"},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),l(i,{label:o(e)("datasource.password")},{default:n(()=>[l(o(_e),{placeholder:o(e)("common.inputText")+o(e)("datasource.password"),"show-password":"",type:"password",modelValue:r.configuration.password,"onUpdate:modelValue":t[6]||(t[6]=a=>r.configuration.password=a)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),l(i,{label:o(e)("datasource.extra_params")},{default:n(()=>[l(p,{placeholder:o(e)("common.inputText")+o(e)("datasource.extra_params"),modelValue:r.configuration.extraParams,"onUpdate:modelValue":t[7]||(t[7]=a=>r.configuration.extraParams=a),autocomplete:"off"},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),l(i,null,{default:n(()=>[$("span",{class:"de-expand_engine",onClick:t[8]||(t[8]=a=>y.value=!y.value)},[E(S(o(e)("datasource.priority"))+" ",1),l(P,null,{default:n(()=>[l(q,null,{default:n(()=>[(m(),f(xe(y.value?o(ce):o(pe)),{class:"svg-icon"}))]),_:1})]),_:1})])]),_:1}),y.value?(m(),D(F,{key:3},[l(V,{gutter:24,class:"mb16"},{default:n(()=>[l(u,{span:12},{default:n(()=>[l(i,{label:o(e)("datasource.initial_pool_size"),prop:"configuration.initialPoolSize"},{default:n(()=>[l(c,{modelValue:r.configuration.initialPoolSize,"onUpdate:modelValue":t[9]||(t[9]=a=>r.configuration.initialPoolSize=a),"controls-position":"right",autocomplete:"off",class:"w100-input",placeholder:o(e)("common.inputText")+o(e)("datasource.initial_pool_size"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),l(u,{span:12},{default:n(()=>[l(i,{label:o(e)("datasource.min_pool_size"),prop:"configuration.minPoolSize"},{default:n(()=>[l(c,{modelValue:r.configuration.minPoolSize,"onUpdate:modelValue":t[10]||(t[10]=a=>r.configuration.minPoolSize=a),"controls-position":"right",autocomplete:"off",class:"w100-input",placeholder:o(e)("common.inputText")+o(e)("datasource.min_pool_size"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),l(V,{gutter:24},{default:n(()=>[l(u,{span:12},{default:n(()=>[l(i,{label:o(e)("datasource.max_pool_size"),prop:"configuration.maxPoolSize"},{default:n(()=>[l(c,{modelValue:r.configuration.maxPoolSize,"onUpdate:modelValue":t[11]||(t[11]=a=>r.configuration.maxPoolSize=a),class:"w100-input","controls-position":"right",autocomplete:"off",placeholder:o(e)("common.inputText")+o(e)("datasource.max_pool_size"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),l(u,{span:12},{default:n(()=>[l(i,{label:`${o(e)("datasource.query_timeout")}(${o(e)("common.second")})`,prop:"configuration.queryTimeout"},{default:n(()=>[l(c,{class:"w100-input",modelValue:r.configuration.queryTimeout,"onUpdate:modelValue":t[12]||(t[12]=a=>r.configuration.queryTimeout=a),"controls-position":"right",autocomplete:"off",placeholder:o(e)("common.inputText")+o(e)("datasource.query_timeout"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})],64)):w("",!0)]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}});const so=Ee(we,[["__scopeId","data-v-02b25a24"]]);export{so as default};

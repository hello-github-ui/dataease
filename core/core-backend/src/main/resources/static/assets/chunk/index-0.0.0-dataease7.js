import{a as Jt,b as Qt,u as oe,F as ea,M as ta}from"./index-0.0.0-dataease.js";import{E as aa}from"./el-dialog-0.0.0-dataease.js";import{Q as oa,j as b,n as f,o as sa,D as N,y as x,R as na,v as he,F as ge,G as la}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import{a as ia,E as ra}from"./el-form-item-0.0.0-dataease.js";import{E as da,a as ca}from"./el-table-column-0.0.0-dataease.js";import"./el-checkbox-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./el-virtual-list-0.0.0-dataease.js";import{E as ua,a as ma}from"./el-table-v2-0.0.0-dataease.js";import{a as pa,E as _a}from"./el-tabs-0.0.0-dataease.js";import{E as fa}from"./el-popover-0.0.0-dataease.js";import{E as va}from"./el-divider-0.0.0-dataease.js";import{E as ha}from"./el-tree-0.0.0-dataease.js";import{a as ga,b as ya,E as wa}from"./el-dropdown-menu-0.0.0-dataease.js";import"./el-dropdown-item-0.0.0-dataease.js";import{d as ba,r as u,Z as Ze,G as I,s as ye,k as o,h as C,ak as Ta,w as ka,aa as Je,f as d,L as y,T as R,U as V,V as we,j as t,i as s,M as p,g as m,Y as $,a6 as h,a0 as v,al as xa,u as Ca,n as be,R as Da,a7 as Sa,a9 as Te,a5 as D,ab as Qe,m as Ea}from"./vue-0.0.0-dataease.js";import{i as Na}from"./icon_copy_filled-0.0.0-dataease.js";import{i as et}from"./icon_dataset-0.0.0-dataease.js";import{i as Ia}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as La,_ as Aa,t as Fa}from"./index.vue_vue_type_style_index_0_lang-0.0.0-dataease2.js";import{i as Pa}from"./icon_rename_outlined-0.0.0-dataease.js";import{d as Ra,i as Va}from"./icon_file-add_outlined-0.0.0-dataease.js";import{e as $a,f as za,h as Ma,i as Oa,j as Ba,p as Ga,k as ke,m as ja}from"./dataset-0.0.0-dataease.js";import{i as Ua}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{d as Ka,a as Wa}from"./dv-sort-desc-0.0.0-dataease.js";import{d as tt}from"./dv-folder-0.0.0-dataease.js";import{i as at}from"./icon_add_outlined-0.0.0-dataease.js";import{i as qa}from"./icon_info_outlined-0.0.0-dataease.js";import{i as Ha}from"./icon_dashboard_outlined-0.0.0-dataease.js";import{i as Ya}from"./icon_operation-analysis_outlined-0.0.0-dataease.js";import{i as Xa}from"./icon_download_outlined-0.0.0-dataease.js";import{i as ot}from"./icon_edit_outlined-0.0.0-dataease.js";import st from"./DeResourceArrow-0.0.0-dataease.js";import"./el-aside-0.0.0-dataease.js";import{_ as nt}from"./HandleMore.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{u as Za}from"./useMoveLine-0.0.0-dataease.js";import Ja from"./CreatDsGroup-0.0.0-dataease.js";import{E as se}from"./EmptyBackground-0.0.0-dataease.js";import Qa from"./DeResourceGroupOpt-0.0.0-dataease.js";import eo from"./DatasetDetail-0.0.0-dataease.js";import{t as to,g as ao}from"./util-0.0.0-dataease.js";import{f as S}from"./attr-0.0.0-dataease20.js";import{useAppStoreWithOut as oo}from"./app-0.0.0-dataease.js";import{t as lt}from"./treeSortUtils-0.0.0-dataease.js";import so from"./RowAuth-0.0.0-dataease2.js";import{D as no,b as lo}from"./dataVisualization-0.0.0-dataease2.js";import{i as io}from"./interactive-0.0.0-dataease.js";import{i as xe}from"./field-list-0.0.0-dataease.js";import{d as ne,e as ro}from"./lodash-0.0.0-dataease.js";import{a as co}from"./index-0.0.0-dataease14.js";import{E as uo}from"./index-0.0.0-dataease3.js";import{_ as mo}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./browser-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./dropdown-0.0.0-dataease.js";import"./index-0.0.0-dataease13.js";import"./el-drawer-0.0.0-dataease.js";import"./icon_left_outlined-0.0.0-dataease.js";import"./icon_right_outlined-0.0.0-dataease.js";import"./icon_more_outlined-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease16.js";import"./el-tree-select-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./AuthTree-0.0.0-dataease2.js";import"./FilterFiled-0.0.0-dataease2.js";import"./el-checkbox-group-0.0.0-dataease.js";import"./el-input-number-0.0.0-dataease.js";import"./index-0.0.0-dataease17.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./options-0.0.0-dataease.js";import"./icon_down_outlined-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";const po={class:"resource-tree"},_o={class:"tree-header"},fo={class:"icon-methods"},vo={class:"title"},ho={key:0,class:"flex-align-center"},go={key:0,class:"ed-dropdown-menu__item--divided"},yo={class:"custom-tree-node"},wo=["title"],bo={key:2,class:"icon-more"},To={class:"dataset-info"},ko={class:"info-method"},xo=["title"],Co={class:"create-user"},Do={class:"right-btn"},So={class:"tab-border"},Eo={class:"dataset-table-info"},No={key:0,class:"preview-num"},Io={class:"flex-align-center"},Lo=["title"],Ao={key:2,class:"table-row-column"},Fo={class:"tree-cont"},Po={class:"content"},Ro={class:"tip"},Vo={class:"dialog-footer"};function it(Y){return typeof Y=="function"||Object.prototype.toString.call(Y)==="[object Object]"&&!xa(Y)}const $o=ba({__name:"index",setup(Y){const{t:n}=sa(),rt=io(),{wsCache:T}=Jt(),z=oo(),le=u(!1),L=u(!1),M=u(),ie=u(!1),Ce=u(n("data_set.ten_wan")),A=u({}),O=u({}),De=u(),dt={name:[{required:!0,message:n("commons.input_content"),trigger:"change"},{max:50,message:n("commons.char_can_not_more_50"),trigger:"change"}]},Se=u([]);Da("filedList",Se);const B=u(""),re=Sa(),Ee=Ca(),_=Ze({datasetTree:[],curSortType:"time_desc"}),ct=u(),X=u(""),de=u(!1),Ne=T.get("open-backend")==="1"?"_self":"_blank",Z=I(()=>z.getIsDataEaseBi),Ie=I(()=>z.getIsIframe),ut=I(()=>oa(c.weight,c.ext)),Le=e=>{const a=`#/${e}?opt=create&id=${c.id}`;T.set("dataset-info-id",c.id),window.open(a,Ne)},mt=e=>{e&&e.opt==="newLeaf"&&_t(e.pid,e.name)},G=ye([]),pt=e=>{_.datasetTree=lt(G.value,e),_.curSortType=e,T.set("TreeSort-dataset",_.curSortType)},Ae=e=>{_.datasetTree=lt(G.value,e),_.curSortType=e},_t=(e,a)=>{const l=ao(),r={dataState:"ready",id:l,name:a,pid:e,type:X.value,status:1,selfWatermarkStatus:!0},k=X.value==="dashboard"?no:lo,q={canvasStyleData:JSON.stringify(k),componentData:JSON.stringify([]),canvasViewInfo:{},...r};Me(q).then(()=>{const H=X.value==="dataV"?"#/dvCanvas?dvId=":"#/dashboard?resourceId=";window.open(H+l,Ne)})},ce=u(),Fe={name:"",createBy:"",creator:"",id:"",nodeType:"",createTime:0,weight:0},c=Ze(ne(Fe));let ue=[],j=[],J=[];const ft=[{key:"name",dataKey:"name",title:n("data_set.field_name"),width:250},{key:"deType",dataKey:"deType",title:n("data_set.field_type"),width:250,cellRenderer:({cellData:e})=>{let a;return o("div",{style:{width:"100%",display:"flex",alignItems:"center"}},[o(b,{style:{marginRight:"6px"}},{default:()=>[o(f,null,it(a=C(xe[S[e]],{class:`svg-icon field-icon-${S[e]}`}))?a:{default:()=>[a]})]}),n(`dataset.${S[e]}`)+`${e===3?"("+n("dataset.float")+")":""}`])}},{key:"description",dataKey:"description",title:n("data_set.field_notes"),width:250}],Q=u(!1),{width:me,node:vt}=Za("DATASOURCE"),Pe=I(()=>({creator:c.creator,createTime:c.createTime&&to(c.createTime)})),{handleDrop:ht,allowDrop:gt,handleDragStart:yt}=Fa(_,"datasetTree",ja,"dataset",G),wt=e=>e.map(a=>({key:a.dataeaseName,deType:a.deType,dataKey:a.dataeaseName,title:a.name,width:150,headerCellRenderer:({column:l})=>{let r;return o("div",{class:"flex-align-center"},[o(b,{style:{marginRight:"6px"}},{default:()=>[o(f,null,it(r=C(xe[S[l.deType]],{class:`svg-icon field-icon-${S[l.deType]}`}))?r:{default:()=>[r]})]}),o("span",{class:"ellipsis",title:l.title,style:{width:"120px"}},[l.title])])}})),pe=u(!1),Re=u(!1),U=()=>{pe.value=!0;let e=ve[Number(T.get("TreeSort-backend"))??1].value;e=T.get("TreeSort-dataset")??e;const a={busiFlag:"dataset"};rt.setInteractive(a).then(l=>{const r=l||[];if(r.length&&r[0].id==="0"&&r[0].name==="root"){le.value=r[0].weight>=7,_.datasetTree=r[0].children||[],G.value=ne(t(_.datasetTree)),Ae(e);return}_.datasetTree=r,G.value=ne(t(_.datasetTree)),Ae(e)}).finally(()=>{pe.value=!1,de.value=!0,be(()=>{B.value.length&&W.value.filter(B.value)});const l=c.id;l&&(Object.assign(c,ne(Fe)),Ve(_.datasetTree,l),be(()=>{Re.value||(Re.value=!0,W.value.setCurrentKey(l,!0))}))})},Ve=(e,a)=>{e.some(l=>{var r;return l.id===a?($e(l),!0):((r=l.children)!=null&&r.length&&Ve(l.children,a),!1)})};Ta(()=>{const e=T.get("dataset-info-id")||Ee.params.id;c.id=e||Ee.query.id||"",T.delete("dataset-info-id"),T.delete("db-info-id"),T.delete("dv-info-id"),At(),U(),Ft()});const F=ye([]),K=ye([]),_e=u(null),$e=e=>{if(!e.leaf){W.value.setCurrentKey(null);return}za(e.id).then(a=>{Object.assign(c,a),c.weight=e.weight,c.ext=e.ext||0,j=[],J=[],w.value="dataPreview",Be(w.value)})},bt=()=>{L.value=!0,A.value.name=c.name,A.value.expressionTree="",be(()=>{M.value.init({}),M.value.relationList=[],M.value.logic="or"})},ze=()=>{L.value=!1},Me=({logic:e,items:a,errorMessage:l})=>{if(O.value.id=c.id,O.value.row=1e5,O.value.filename=A.value.name,l){N.error(l);return}O.value.expressionTree=JSON.stringify({items:a,logic:e}),ie.value=!0,Ma(O.value).then(r=>{r.code===0?Ct(kt):N.error(r.msg)}).finally(()=>{ie.value=!1,L.value=!1})},Tt=()=>{De.value.validate(e=>{if(e)M.value.submit();else return!1})},kt=()=>{oe().emitter.emit("data-export-center",{activeName:"IN_PROGRESS"})},xt=(e,a,l)=>{const r=l.target.parentNode.parentNode;if([...r.classList].includes("no-hide")){r.classList.remove("no-hide");return}r.classList.add("no-hide")},Ct=e=>{const a="el-icon-loading",l="de-message-loading de-message-export";N({message:C("p",null,[n("data_set.can_go_to"),C(x,{text:!0,size:"small",class:"btn-text",onClick:()=>{e()}},n("data_export.export_center")),n("data_set.progress_and_download")]),iconClass:a,icon:C(ea),showClose:!0,customClass:l})},Dt=()=>{Oe(c.id)},E=Qt(),Oe=e=>{if(Z.value){E.clearState(),E.setDatasetId(e),oe().emitter.emit("changeCurrentComponent","DatasetEditor");return}re.push({path:"/dataset-form",query:{id:e}})},fe=e=>{if(Z.value){E.clearState(),E.setdatasetPid(e==null?void 0:e.id),oe().emitter.emit("changeCurrentComponent","DatasetEditor");return}re.push({path:"/dataset-form",query:{pid:e==null?void 0:e.id}})},Be=e=>{switch(e){case"dataPreview":if(j.length){F.value=j,K.value=J;break}Q.value=!0,_e.value=null,Oa(c.id).then(a=>{var l,r;ue=(a==null?void 0:a.allFields)||[],Se.value=ue,j=wt(((l=a==null?void 0:a.data)==null?void 0:l.fields)||[]),J=((r=a==null?void 0:a.data)==null?void 0:r.data)||[],F.value=j,K.value=J}).finally(()=>{Q.value=!1}),Ba(c.id).then(a=>{_e.value=a});break;case"structPreview":F.value=ft,K.value=ue;break}},Ge=u(),St=(e,a,l)=>{var r;if(e==="copy"){if(Z.value){E.clearState(),E.setDatasetCopyId(a.id),oe().emitter.emit("changeCurrentComponent","DatasetEditor");return}re.push({name:E.getToken&&z.getIsIframe?"dataset-embedded-form":"dataset-form",params:{id:a.id}});return}if(e==="delete"){let k={confirmButtonType:"danger",type:"warning",autofocus:!1,showClose:!1,tip:""};(r=a.children)!=null&&r.length?k.tip=n("data_set.operate_with_caution"):delete k.tip,l!=="folder"?Ga(a.id).then(q=>{if(q===!0){const H=()=>{Ge.value.getChartData({queryType:"dataset",num:a.id,label:a.name})};ge.confirm("",{confirmButtonType:"danger",type:"warning",autofocus:!1,confirmButtonText:n("userimport.sure"),showClose:!1,dangerouslyUseHTMLString:!0,message:C("div",null,[C("p",{style:"margin-bottom: 8px;"},n("data_set.this_data_set")),C("p",{class:"tip"},n("data_set.to_delete_them")),C(x,{text:!0,onClick:H,style:"margin-left: -4px;"},n("data_set.check_blood_relationship"))])}).then(()=>{ke(a.id).then(()=>{U(),N.success(n("dataset.delete_success"))})})}else ge.confirm(n("datasource.delete_this_dataset"),k).then(()=>{ke(a.id).then(()=>{U(),N.success(n("dataset.delete_success"))})})}):ge.confirm(n("data_set.delete_this_folder"),k).then(()=>{ke(a.id).then(()=>{U(),N.success(n("dataset.delete_success"))})})}else ce.value.createInit(l,a,e)},je=(e,a)=>{e==="dataset"&&fe(a),e==="folder"&&ce.value.createInit(e,a||{})},w=u("dataPreview"),Ue=[{label:n("visualization.move_to"),svgName:La,command:"move"},{label:n("visualization.rename"),svgName:Pa,command:"rename"},{label:n("common.delete"),divided:!0,svgName:Ia,command:"delete"}],ee=u([]),Et=e=>{e.id&&ee.value.push(e.id)},Nt=e=>{e.id&&ee.value.splice(ee.value.indexOf(e.id),1)},It=I(()=>[{label:n("data_set.a_new_dataset"),svgName:et,command:"dataset"},{label:n("deDataset.new_folder"),divided:!0,svgName:tt,command:"folder"}]),Lt={children:"children",label:"name"},Ke=[{title:n("chart.data_preview"),name:"dataPreview"},{title:n("data_set.structure_preview"),name:"structPreview"}],ve=[{name:n("visualization.time_asc"),value:"time_asc"},{name:n("visualization.time_desc"),value:"time_desc",divided:!0},{name:n("visualization.name_asc"),value:"name_asc"},{name:n("visualization.name_desc"),value:"name_desc"}],At=()=>{const e=T.get("TreeSort-dataset");e&&(_.curSortType=e)},Ft=()=>{$a().then(e=>{Ce.value=e})},We=I(()=>ve.find(e=>e.value===_.curSortType).name),qe=u([]),Pt=I(()=>c.weight>=7?[...Ke,...qe.value]:[...Ke]),Rt=e=>{qe.value=e},W=u();ka(B,e=>{W.value.filter(e)});const P=u(!0),He=e=>{P.value=e},Vt=(e,a)=>{var l;return e?(l=a.name)==null?void 0:l.toLowerCase().includes(e.toLowerCase()):!0},$t=()=>{z.setArrowSide(!0)},zt=()=>{z.setArrowSide(!1)},Mt=e=>e?[{label:n("common.copy"),svgName:Na,command:"copy"}].concat(Ue):Ue,Ot=ro((e,a)=>{const r=["dashboard","dataV","dataset","datasource"].findIndex(k=>k==="dataset");return r<0||!na(a,r+1)?gt(e,a):(N.warning(n("free.save_error")),!1)},300);return(e,a)=>{const l=uo,r=la,k=ga,q=ya,H=wa,Bt=ha,Gt=va,jt=fa,Ut=_a,Kt=pa,Wt=ma,qt=ua,Ht=ca,Yt=da,Ye=ia,Xt=ra,Zt=aa,Xe=Je("permission"),te=Je("loading");return d(),y($,null,[R((d(),y("div",{class:V(["dataset-manage",Ie.value&&"de-100vh"])},[o(st,{style:we({left:(P.value?t(me)-12:0)+"px"}),onChangeSideTreeStatus:He,isInside:!P.value},null,8,["style","isInside"]),o(t(co),{class:V(["resource-area",{retract:!P.value}]),onMouseenter:$t,onMouseleave:zt,ref_key:"node",ref:vt,style:we({width:t(me)+"px"})},{default:s(()=>[o(st,{isInside:!P.value,style:we({left:(P.value?t(me)-12:0)+"px"}),onChangeSideTreeStatus:He},null,8,["isInside","style"]),p("div",po,[p("div",_o,[p("div",fo,[p("span",vo,h(t(n)("auth.dataset")),1),le.value?(d(),y("div",ho,[o(l,{class:"box-item",effect:"dark",content:t(n)("deDataset.new_folder"),placement:"top"},{default:s(()=>[o(t(b),{class:"custom-icon btn",style:{"margin-right":"20px"},onClick:a[0]||(a[0]=i=>je("folder"))},{default:s(()=>[o(t(f),{name:"dv-new-folder"},{default:s(()=>[o(t(Ra),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["content"]),o(l,{class:"box-item",effect:"dark",content:t(n)("data_set.a_new_dataset"),placement:"top"},{default:s(()=>[o(t(b),{class:"custom-icon btn",onClick:fe},{default:s(()=>[o(t(f),{name:"icon_file-add_outlined"},{default:s(()=>[o(t(Va),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["content"])])):v("",!0)]),o(r,{placeholder:t(n)("commons.search"),modelValue:B.value,"onUpdate:modelValue":a[1]||(a[1]=i=>B.value=i),clearable:"",class:"search-bar"},{prefix:s(()=>[o(t(b),null,{default:s(()=>[o(t(f),{name:"icon_search-outline_outlined"},{default:s(()=>[o(t(Ua),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["placeholder","modelValue"]),o(H,{onCommand:pt,trigger:"click"},{dropdown:s(()=>[o(q,{style:{width:"246px"}},{default:s(()=>[(d(),y($,null,Te(ve,i=>(d(),y($,{key:i.value},[o(k,{class:V(["ed-select-dropdown__item",i.value===_.curSortType&&"selected"]),command:i.value},{default:s(()=>[D(h(i.name),1)]),_:2},1032,["class","command"]),i.divided?(d(),y("li",go)):v("",!0)],64))),64))]),_:1})]),default:s(()=>[o(t(b),{class:"filter-icon-span"},{default:s(()=>[o(l,{offset:16,effect:"dark",content:We.value,placement:"top"},{default:s(()=>[o(t(f),{name:"dv-sort-asc",class:"opt-icon"},{default:s(()=>[_.curSortType.includes("asc")?(d(),m(t(Ka),{key:0,class:"svg-icon opt-icon"})):v("",!0)]),_:1})]),_:1},8,["content"]),o(l,{offset:16,effect:"dark",content:We.value,placement:"top"},{default:s(()=>[o(t(f),{name:"dv-sort-desc",class:"opt-icon"},{default:s(()=>[_.curSortType.includes("desc")?(d(),m(t(Wa),{key:0,class:"svg-icon"})):v("",!0)]),_:1})]),_:1},8,["content"])]),_:1})]),_:1})]),o(t(ta),{class:"custom-tree"},{default:s(()=>[o(Bt,{menu:"",ref_key:"datasetListTree",ref:W,"node-key":"id",data:_.datasetTree,"filter-node-method":Vt,"expand-on-click-node":"","highlight-current":"",onNodeDragStart:t(yt),"allow-drop":t(Ot),onNodeDrop:t(ht),draggable:"",onNodeExpand:Et,onNodeCollapse:Nt,"default-expanded-keys":ee.value,props:Lt,onNodeClick:$e},{default:s(({node:i,data:g})=>[p("span",yo,[g.leaf?v("",!0):(d(),m(t(b),{key:0,style:{"font-size":"18px"}},{default:s(()=>[o(t(f),{name:"dv-folder"},{default:s(()=>[o(t(tt),{class:"svg-icon"})]),_:1})]),_:1})),g.leaf?(d(),m(t(b),{key:1,style:{"font-size":"18px"}},{default:s(()=>[o(t(f),{name:"icon_dataset"},{default:s(()=>[o(t(et),{class:"svg-icon"})]),_:1})]),_:1})):v("",!0),p("span",{title:i.label,class:"label-tooltip ellipsis"},h(i.label),9,wo),g.weight>=7?(d(),y("div",bo,[g.leaf?(d(),m(t(b),{key:1,class:"hover-icon",onClick:Qe(ae=>Oe(g.id),["stop"])},{default:s(()=>[o(t(f),{name:"icon_edit_outlined"},{default:s(()=>[o(t(ot),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])):(d(),m(t(nt),{key:0,"icon-size":"24px",onHandleCommand:ae=>je(ae,g),"menu-list":It.value,"icon-name":t(at),placement:"bottom-start"},null,8,["onHandleCommand","menu-list","icon-name"])),o(t(nt),{onHandleCommand:ae=>St(ae,g,g.leaf?"dataset":"folder"),"menu-list":Mt(g.leaf)},null,8,["onHandleCommand","menu-list"])])):v("",!0)])]),_:1},8,["data","onNodeDragStart","allow-drop","onNodeDrop","default-expanded-keys"])]),_:1})])]),_:1},8,["class","style"]),p("div",{class:V(["dataset-content",{auto:Ie.value||Z.value}])},[!_.datasetTree.length&&de.value?(d(),m(se,{key:0,description:t(n)("data_set.data_set_yet"),"img-type":"none"},{default:s(()=>[le.value?(d(),m(t(x),{key:0,onClick:a[2]||(a[2]=()=>fe()),type:"primary"},{icon:s(()=>[o(t(f),{name:"icon_add_outlined"},{default:s(()=>[o(t(at),{class:"svg-icon"})]),_:1})]),default:s(()=>[D(" "+h(t(n)("deDataset.create")+t(n)("auth.dataset")),1)]),_:1})):v("",!0)]),_:1},8,["description"])):c.id?(d(),y($,{key:1},[p("div",To,[p("div",ko,[p("span",{title:c.name,class:"dataset-name ellipsis"},h(c.name),9,xo),o(Gt,{style:{margin:"0 12px"},direction:"vertical"}),p("span",Co,h(t(n)("visualization.create_by"))+":"+h(c.creator),1),o(jt,{"show-arrow":"",offset:8,placement:"bottom",width:"290",trigger:"hover"},{reference:s(()=>[o(t(b),{size:"16px",class:"create-user"},{default:s(()=>[o(t(f),{name:"icon_info_outlined"},{default:s(()=>[o(t(qa),{class:"svg-icon"})]),_:1})]),_:1})]),default:s(()=>[o(eo,{"create-time":Pe.value.createTime,creator:Pe.value.creator},null,8,["create-time","creator"])]),_:1}),p("div",Do,[R((d(),m(t(x),{secondary:"",onClick:a[3]||(a[3]=i=>Le("dashboard"))},{icon:s(()=>[o(t(f),{name:"icon_dashboard_outlined"},{default:s(()=>[o(t(Ha),{class:"svg-icon"})]),_:1})]),default:s(()=>[D(" "+h(t(n)("visualization.panelAdd")),1)]),_:1})),[[Xe,["panel"]]]),R((d(),m(t(x),{secondary:"",onClick:a[4]||(a[4]=i=>Le("dvCanvas"))},{icon:s(()=>[o(t(f),{name:"icon_operation-analysis_outlined"},{default:s(()=>[o(t(Ya),{class:"svg-icon"})]),_:1})]),default:s(()=>[D(h(t(n)("data_set.new_data_screen")),1)]),_:1})),[[Xe,["screen"]]]),ut.value[0]?(d(),m(t(x),{key:0,secondary:"",onClick:bt},{icon:s(()=>[o(t(f),{name:"icon_download_outlined"},{default:s(()=>[o(t(Xa),{class:"svg-icon"})]),_:1})]),default:s(()=>[D(" "+h(t(n)("data_set.dataset_export")),1)]),_:1})):v("",!0),c.weight>=7?(d(),m(t(x),{key:1,type:"primary",onClick:Dt},{icon:s(()=>[o(t(f),{name:"icon_edit_outlined"},{default:s(()=>[o(t(ot),{class:"svg-icon"})]),_:1})]),default:s(()=>[D(" "+h(t(n)("visualization.edit")),1)]),_:1})):v("",!0)])]),p("div",So,[o(Kt,{modelValue:w.value,"onUpdate:modelValue":a[5]||(a[5]=i=>w.value=i),onTabChange:Be},{default:s(()=>[(d(!0),y($,null,Te(Pt.value,i=>(d(),m(Ut,{key:i.name,label:i.title,name:i.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),o(t(he),{jsname:"L2NvbXBvbmVudC9yb3ctY29sLXBlcm1pc3Npb24vcGFuZS9pbmRleA==",onLoaded:Rt})])]),p("div",Eo,[w.value==="dataPreview"?(d(),y("div",No,h(t(n)("data_set.pieces_in_total",{msg:_e.value})),1)):v("",!0),["dataPreview","structPreview"].includes(w.value)?(d(),y("div",{key:1,class:V(["info-table",[{"struct-preview":w.value==="structPreview"}]])},[w.value==="structPreview"?(d(),m(qt,{key:0},{default:s(({height:i,width:g})=>[R((d(),m(Wt,{key:"structPreview",columns:F.value,"header-class":"header-cell",data:K.value,width:g,height:i,fixed:""},{empty:s(()=>[o(se,{description:t(n)("data_set.no_data"),"img-type":"noneWhite"},null,8,["description"])]),_:2},1032,["columns","data","width","height"])),[[te,Q.value]])]),_:1})):v("",!0),w.value==="dataPreview"?R((d(),m(Yt,{class:"dataset-preview_table","header-class":"header-cell",data:K.value,onRowClick:xt,key:"dataPreview",border:"",style:{width:"100%",height:"100%"}},{empty:s(()=>[o(se,{description:t(n)("data_set.no_data"),"img-type":"noneWhite"},null,8,["description"])]),default:s(()=>[(d(!0),y($,null,Te(F.value,(i,g)=>(d(),m(Ht,{key:i.dataKey,prop:i.dataKey,label:i.title,"min-width":150,fixed:F.value.length-1===g?"right":!1},{header:s(()=>[p("div",Io,[o(t(b),{style:{"margin-right":"6px"}},{default:s(()=>[o(t(f),{className:`field-icon-${t(S)[i.deType]}`},{default:s(()=>[(d(),m(Ea(t(xe)[t(S)[i.deType]]),{class:V(["svg-icon",`field-icon-${t(S)[i.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024),p("span",{class:"ellipsis",title:i.title,style:{width:"120px"}},h(i.title),9,Lo)])]),_:2},1032,["prop","label","fixed"]))),128))]),_:1},8,["data"])),[[te,Q.value]]):v("",!0)],2)):v("",!0),["row","column"].includes(w.value)?(d(),y("div",Ao,[o(t(he),{"active-name":w.value,"dataset-id":c.id,jsname:"ZGF0YXNldC1yb3ctcGVybWlzc2lvbnM="},null,8,["active-name","dataset-id"]),o(t(he),{"active-name":w.value,"dataset-id":c.id,jsname:"ZGF0YXNldC1jb2x1bW4tcGVybWlzc2lvbnM="},null,8,["active-name","dataset-id"])])):v("",!0)])],64)):de.value?(d(),m(se,{key:2,description:t(n)("deDataset.on_the_left"),"img-type":"select"},null,8,["description"])):v("",!0)],2),o(Aa,{ref_key:"relationChartRef",ref:Ge},null,512),o(Qa,{"cur-canvas-type":X.value,onFinish:mt,ref_key:"resourceGroupOpt",ref:ct},null,8,["cur-canvas-type"]),o(Ja,{onFinish:a[6]||(a[6]=i=>U()),ref_key:"creatDsFolder",ref:ce},null,512)],2)),[[te,pe.value]]),L.value?(d(),m(Zt,{key:0,modelValue:L.value,"onUpdate:modelValue":a[9]||(a[9]=i=>L.value=i),width:"800px",class:"de-dialog-form form-tree-cont",title:e.$t("dataset.export_dataset"),"append-to-body":""},{footer:s(()=>[p("div",Vo,[o(t(x),{secondary:"",onClick:ze},{default:s(()=>[D(h(e.$t("dataset.cancel")),1)]),_:1}),R((d(),m(t(x),{type:"primary",onClick:Tt},{default:s(()=>[D(h(e.$t("dataset.confirm")),1)]),_:1})),[[te,ie.value]])])]),default:s(()=>[o(Xt,{ref_key:"exportFormRef",ref:De,class:"de-form-item",onSubmit:a[8]||(a[8]=Qe(()=>{},["prevent"])),model:A.value,rules:dt,"before-close":ze},{default:s(()=>[o(Ye,{label:e.$t("dataset.filename"),prop:"name"},{default:s(()=>[o(r,{modelValue:A.value.name,"onUpdate:modelValue":a[7]||(a[7]=i=>A.value.name=i),modelModifiers:{trim:!0},placeholder:e.$t("dataset.pls_input_filename")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(Ye,{label:e.$t("dataset.export_filter"),prop:"expressionTree"},{default:s(()=>[p("div",Fo,[p("div",Po,[o(so,{onSave:Me,ref_key:"rowAuth",ref:M},null,512)])])]),_:1},8,["label"])]),_:1},8,["model"]),p("span",Ro,h(t(n)("data_set.pieces_of_data",{limit:Ce.value})),1)]),_:1},8,["modelValue","title"])):v("",!0)],64)}}});const yn=mo($o,[["__scopeId","data-v-6f60c2b4"]]);export{yn as default};

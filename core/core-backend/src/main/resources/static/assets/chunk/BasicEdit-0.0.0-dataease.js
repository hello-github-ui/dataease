import{an as pe}from"./index-0.0.0-dataease.js";import{E as ue}from"./el-drawer-0.0.0-dataease.js";import{o as de,D as R,x as j,n as me,j as ce,y as fe}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import{a as _e,E as ye}from"./el-form-item-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import{E as ve,a as ke}from"./el-radio-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{E as ge,a as be}from"./el-select-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-tree-0.0.0-dataease.js";import"./el-checkbox-0.0.0-dataease.js";import{E as he}from"./el-tree-select-0.0.0-dataease.js";import{E as Ve}from"./el-input-number-0.0.0-dataease.js";import{E as Te}from"./el-switch-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import{d as Ee}from"./dv-info-0.0.0-dataease.js";import{E as Oe}from"./index-0.0.0-dataease3.js";import{d as xe,r as h,Z as $,e as Le,f as n,g as k,i,M as O,k as r,a5 as x,a6 as y,j as _,L as p,Y as V,a9 as T,U as Ue,a0 as M}from"./vue-0.0.0-dataease.js";import{_ as Ie}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./index-0.0.0-dataease16.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease13.js";import"./index-0.0.0-dataease17.js";const we={class:"basic-form-info-tips"},qe={class:"custom-form-item__label"},Ce={key:1,class:"ds-task-form-inline"},Re={class:"ds-span"},$e={key:2},Be={key:3},Fe={key:4},Ne={key:5},Se={key:6},Ae={key:7},De={key:8},je={key:9},Me={key:10},Pe={class:"dialog-footer"},ze=xe({__name:"BasicEdit",props:{labelTooltips:{type:Array,default:()=>[]}},emits:["saved"],setup(P,{expose:z,emit:W}){const{t}=de(),B=P,L=h(!1),F=h(null),U=h(),G=[{value:"minute",label:t("system.time_0_seconds")},{value:"hour",label:t("system.and_0_seconds_de")}],K=[{value:"0",label:t("commons.date.permanent")},{value:"1",label:t("commons.date.one_year")},{value:"2",label:t("commons.date.six_months")},{value:"3",label:t("commons.date.three_months")},{value:"4",label:t("commons.date.one_month")}],Y=["logLiveTime","thresholdLogLiveTime","exportFileLiveTime","frontTimeOut","loginLimitTime","loginLimitRate"],e=$({form:$({dsIntervalTime:"30",dsExecuteTime:"minute",frontTimeOut:"30"}),settingList:[],orgOptions:[],roleOptions:[],loginOptions:[{value:"0",label:t("system.normal_login")},{value:"1",label:"LDAP"},{value:"2",label:"OIDC"},{value:"3",label:"CAS"},{value:"9",label:"OAuth2"}],sortOptions:[{value:"0",label:t("resource_sort.time_asc")},{value:"1",label:t("resource_sort.time_desc")},{value:"2",label:t("resource_sort.name_asc")},{value:"3",label:t("resource_sort.name_desc")}],openOptions:[{value:"0",label:t("open_opt.new_page")},{value:"1",label:t("open_opt.local_page")}]}),w=h({}),Z=()=>{var a;(a=B.labelTooltips)!=null&&a.length&&B.labelTooltips.forEach(s=>{w.value[s.key]=s.val})},g=$({dsIntervalTime:[{required:!0,message:t("common.require"),trigger:"blur"}]}),H=()=>e.settingList.map(a=>{const s=a.pkey.startsWith("basic.")?a.pkey:`basic.${a.pkey}`,u=a.sort,m=a.type;let c=e.form[a.pkey];return Array.isArray(c)&&(c=c.join(",")),{pkey:s,pval:c,type:m,sort:u}}),J=W,Q=async a=>{a&&await a.validate(s=>{if(s){if(e.form.dsExecuteTime==="minute"&&(Number(e.form.dsIntervalTime)<1||Number(e.form.dsIntervalTime)>59)){R.error(t("commons.date.of_range_1_59"));return}if(e.form.dsExecuteTime==="hour"&&(Number(e.form.dsIntervalTime)<1||Number(e.form.dsIntervalTime)>23)){R.error(t("commons.date.of_range_1_23"));return}const u=H();if(u.length<2)return;ee(),j.post({url:"/sysParameter/basic/save",data:u}).then(m=>{m.msg||(R.success(t("common.save_success")),J("saved"),X()),S()}).catch(()=>{S()})}})},N=a=>{e.settingList=[],q.value=[],a&&(a.resetFields(),L.value=!1)},X=()=>{N(U.value)},ee=()=>{F.value=pe.service({target:".basic-param-drawer"})},S=()=>{var a;(a=F.value)==null||a.close()},A=h(),q=h([]),oe=(a,s,u,m,c,C,b,I)=>{A.value=b,e.orgOptions=s||[],e.roleOptions=u||[],e.loginOptions=m||[],e.sortOptions=c||[],e.openOptions=C||[],e.settingList=a.map(d=>{const v=d.pkey;Y.some(E=>`basic.${E}`===v)&&(g[v.split(".")[1]]=[{required:!0,message:t("common.require"),trigger:["blur","change"]}]),d.label=`setting_${v}`,d.pkey=v.split(".")[1];let f=d.pval;return d.pkey.includes("platformRid")&&(f!=null&&f.length)&&(f=f.split(","),g.platformRid||(g.platformRid=[{required:!0,message:t("common.require"),trigger:["blur","change"]}])),d.pkey.includes("platformOid")&&(g.platformOid||(g.platformOid=[{required:!0,message:t("common.require"),trigger:["blur","change"]}])),e.form[d.pkey]=f||e.form[d.pkey],d}),q.value=e.settingList.filter(d=>I.includes(d.pkey)),L.value=!0},le=async()=>{const a=e.form.platformOid;if(!a)return;const u=(await j.get({url:`/role/queryWithOid/${a}`})).data,m=te(u);e.roleOptions[0].children=m.get(!1),e.roleOptions[1].children=m.get(!0)},te=a=>{const s=new Map;return a.forEach(u=>{const m=u.readonly;let c=s.get(m);c||(c=[]),c.push({value:u.id,label:u.name,disabled:!1}),s.set(m,c)}),s},ae=()=>{e.form.platformRid=[],le()};return Z(),z({edit:oe}),(a,s)=>{const u=me,m=ce,c=Oe,C=Te,b=Ve,I=ge,d=be,v=he,f=ve,E=ke,se=Le("v-else"),ne=_e,re=ye,D=fe,ie=ue;return n(),k(ie,{title:A.value,modelValue:L.value,"onUpdate:modelValue":s[5]||(s[5]=o=>L.value=o),"custom-class":"basic-param-drawer",size:"600px",direction:"rtl"},{footer:i(()=>[O("span",Pe,[r(D,{secondary:"",onClick:s[3]||(s[3]=o=>N(U.value))},{default:i(()=>[x(y(_(t)("common.cancel")),1)]),_:1}),r(D,{type:"primary",onClick:s[4]||(s[4]=o=>Q(U.value))},{default:i(()=>[x(y(_(t)("commons.save")),1)]),_:1})])]),default:i(()=>[r(re,{ref_key:"basicForm",ref:U,"require-asterisk-position":"right",model:e.form,rules:g,"label-width":"80px","label-position":"top"},{default:i(()=>[(n(!0),p(V,null,T(q.value,o=>(n(),k(ne,{key:o.pkey,prop:o.pkey,class:Ue({"setting-hidden-item":o.pkey==="dsExecuteTime"})},{label:i(()=>[O("div",we,[O("span",qe,y(_(t)(o.label)),1),w.value[`setting_basic.${o.pkey}`]?(n(),k(c,{key:0,effect:"dark",content:w.value[`setting_basic.${o.pkey}`],placement:"top"},{default:i(()=>[r(m,null,{default:i(()=>[r(u,{name:"dv-info"},{default:i(()=>[r(_(Ee),{class:"svg-icon"})]),_:1})]),_:1})]),_:2},1032,["content"])):M("",!0)])]),default:i(()=>[o.pkey==="autoCreateUser"||o.pkey==="pwdStrategy"||o.pkey==="dip"||o.pkey==="shareDisable"||o.pkey==="sharePeRequire"||o.pkey==="loginLimit"?(n(),k(C,{key:0,class:"de-basic-switch","active-value":"true","inactive-value":"false",modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l},null,8,["modelValue","onUpdate:modelValue"])):o.pkey==="dsIntervalTime"?(n(),p("div",Ce,[O("span",null,y(_(t)("cron.every")),1),r(b,{modelValue:e.form.dsIntervalTime,"onUpdate:modelValue":s[0]||(s[0]=l=>e.form.dsIntervalTime=l),autocomplete:"off","step-strictly":"",class:"text-left",min:1,placeholder:_(t)("common.inputText"),"controls-position":"right",type:"number"},null,8,["modelValue","placeholder"]),r(d,{modelValue:e.form.dsExecuteTime,"onUpdate:modelValue":s[1]||(s[1]=l=>e.form.dsExecuteTime=l)},{default:i(()=>[(n(),p(V,null,T(G,l=>r(I,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:2},1032,["modelValue"]),O("span",Re,y(_(t)("cron.every_exec")),1)])):o.pkey==="frontTimeOut"?(n(),p("div",$e,[r(b,{modelValue:e.form.frontTimeOut,"onUpdate:modelValue":s[2]||(s[2]=l=>e.form.frontTimeOut=l),autocomplete:"off","step-strictly":"",class:"text-left edit-all-line",min:1,placeholder:_(t)("common.inputText"),"controls-position":"right",type:"number"},null,8,["modelValue","placeholder"])])):o.pkey==="logLiveTime"||o.pkey==="thresholdLogLiveTime"||o.pkey==="loginLimitRate"||o.pkey==="loginLimitTime"?(n(),p("div",Be,[r(b,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l,autocomplete:"off","step-strictly":"",class:"text-left edit-all-line",min:1,max:4e3,placeholder:_(t)("common.inputText"),"controls-position":"right",type:"number"},null,8,["modelValue","onUpdate:modelValue","placeholder"])])):o.pkey==="platformOid"?(n(),p("div",Fe,[r(v,{class:"edit-all-line",modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l,data:e.orgOptions,"check-strictly":"","render-after-expand":!1,onChange:ae},null,8,["modelValue","onUpdate:modelValue","data"])])):o.pkey==="platformRid"?(n(),p("div",Ne,[r(v,{class:"edit-all-line",modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l,data:e.roleOptions,"highlight-current":!0,multiple:"","render-after-expand":!1,placeholder:a.$t("common.please_select")+a.$t("user.role"),"show-checkbox":"","check-on-click-node":""},null,8,["modelValue","onUpdate:modelValue","data","placeholder"])])):o.pkey==="pvp"?(n(),p("div",Se,[r(d,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l,class:"edit-all-line"},{default:i(()=>[(n(),p(V,null,T(K,l=>r(I,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):o.pkey==="exportFileLiveTime"?(n(),p("div",Ae,[r(b,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l,autocomplete:"off","step-strictly":"",class:"text-left edit-all-line",min:1,max:4e3,placeholder:_(t)("common.inputText"),"controls-position":"right",type:"number"},null,8,["modelValue","onUpdate:modelValue","placeholder"])])):o.pkey==="defaultLogin"?(n(),p("div",De,[r(E,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l},{default:i(()=>[(n(!0),p(V,null,T(e.loginOptions,l=>(n(),k(f,{key:l.value,label:l.value},{default:i(()=>[x(y(l.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):o.pkey==="defaultSort"?(n(),p("div",je,[r(E,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l},{default:i(()=>[(n(!0),p(V,null,T(e.sortOptions,l=>(n(),k(f,{key:l.value,label:l.value},{default:i(()=>[x(y(l.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):o.pkey==="defaultOpen"?(n(),p("div",Me,[r(E,{modelValue:e.form[o.pkey],"onUpdate:modelValue":l=>e.form[o.pkey]=l},{default:i(()=>[(n(!0),p(V,null,T(e.openOptions,l=>(n(),k(f,{key:l.value,label:l.value},{default:i(()=>[x(y(l.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):M("",!0),r(se)]),_:2},1032,["prop","class"]))),128))]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}});const To=Ie(ze,[["__scopeId","data-v-7c920922"]]);export{To as default};

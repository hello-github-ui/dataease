var ml=Object.defineProperty;var pl=(f,u,t)=>u in f?ml(f,u,{enumerable:!0,configurable:!0,writable:!0,value:t}):f[u]=t;var v=(f,u,t)=>(pl(f,typeof u!="symbol"?u+"":u,t),t);import{_ as Z}from"./jspdf-0.0.0-dataease.js";import{p as L,m as hl,h as P,a as Pe,b as gl,g as yl,c as xl,d as bl,e as Sl,s as Al,f as U,i as Co,j as oi,k as ii,l as li,n as si,o as ne,u as Cl,q as De,r as mo,t as wl,v as $o,w as vl,x as Ho,y as be,z as Wo,A as _t,B as no,C as _l,D as Ll}from"./util-0.0.0-dataease2.js";import{p as ni,q as wo,r as Tl,s as Lt,t as Gt,b as ot,u as qt,v as $t,w as El,x as Fl,y as K,z as Tt}from"./chart-0.0.0-dataease.js";import{v as D,f as Ue}from"./formatter-0.0.0-dataease.js";import{o as W,q as ce,e as G,v as zl,w as kl,x as bt,y as vo,z as ye,A as Ft,B as $e,u as Ol,n as xt,g as st,C as Xe,D as Il,E as Nl,F as He,b as Bl,G as Dl,H as Ml,I as Rl}from"./lodash-es-0.0.0-dataease.js";import{_ as Yt}from"./lodash-0.0.0-dataease.js";import{s as _o,c as xe,C as ai,L as ri,I as ci,Z as Pl,a as $l,P as Hl,G as Ut,b as ui,d as Wl,D as Vo,T as di,S as Lo,e as To,f as Vl,g as oe,H as Yl,h as ql,F as fi,B as jl,i as Gl,j as Ul,k as mi,l as Xl,m as Jl,n as pi,u as de,o as Eo,p as Zl,r as Ql,q as j,t as hi,M as gi,v as Kl,w as ts,x as fe,y as We,z as yi,A as ge,E as ao,J as dt,K as es,N as os,Q as is,V as Yo}from"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import{e as Ve}from"./@turf-0.0.0-dataease.js";import{j as Y,i as ls,A as J}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{a as Ye}from"./mathjs-0.0.0-dataease.js";import{q as ss}from"./sysParameter-0.0.0-dataease.js";import{a0 as ns,ax as as}from"./@vue-0.0.0-dataease.js";import rs from"./TableTooltip-0.0.0-dataease.js";import{E as qe}from"./exceljs-0.0.0-dataease.js";import{a as je}from"./file-saver-0.0.0-dataease.js";import{p as Je}from"./element-plus-secondary-0.0.0-dataease.js";import{g as qo}from"./chart-0.0.0-dataease2.js";import{D as Ze}from"./decimal.js-0.0.0-dataease.js";const{t:cs}=Y();function nt(f){return f.drill?[0,10,22,10]:[0,10,10,10]}function us(f){const u=[];let t,e,o,i,l,n,a,s,r;if(f.customAttr){if(r=L(f.customAttr),r.basicStyle){const c=JSON.parse(JSON.stringify(r.basicStyle));c.colors.forEach(p=>{u.push(P(p,c.alpha))})}if(r.label){const c=JSON.parse(JSON.stringify(r.label));e=c.fontSize,o=c.color}if(r.tooltip){const c=JSON.parse(JSON.stringify(r.tooltip));i=c.color,l=c.fontSize,n=c.backgroundColor}}let d;if(f.customStyle&&(d=L(f.customStyle),d.background&&(t=P(d.background.color,d.background.alpha)),d.legend)){const c=d.legend;a=c.color,s=c.fontSize}const m={styleSheet:{brandColor:u[0],paletteQualitative10:u,paletteQualitative20:u,backgroundColor:t},labels:{offset:4,style:{fill:o,fontSize:e}},innerLabels:{offset:4,style:{fill:o,fontSize:e}},pieLabels:{offset:4,style:{fill:o,fontSize:e}},components:{tooltip:{domStyles:{"g2-tooltip":{color:i,fontSize:l+"px",background:n,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.1)","z-index":2e3,position:"fixed"},"g2-tooltip-list-item":{display:"flex","align-items":"flex-start","line-height":l+"px"},"g2-tooltip-name":{display:"inline-block","line-height":l+"px",flex:1},"g2-tooltip-value":{display:"inline-block","line-height":l+"px"},"g2-tooltip-marker":{"margin-top":(l-8)/2+"px","min-width":"8px","min-height":"8px"}}},legend:{common:{itemName:{style:{fill:a,fontSize:s}}}}}};return f.fontFamily&&(m.styleSheet.fontFamily=f.fontFamily),m}function Se(f){let u,t;if(f.customAttr&&(t=L(f.customAttr),t.label)){const e=t.label;if(e.show){const o=[];e.fullDisplay||(f.type==="bar-stack"?o.push({type:"interval-hide-overlap"}):f.type.indexOf("-horizontal")>-1||["bidirectional-bar","progress-bar","pie-donut","radar","waterfall","t-heatmap","bar"].includes(f.type)?(o.push({type:"limit-in-canvas"}),o.push({type:"hide-overlap"})):f.type.includes("chart-mix")?(o.push({type:"limit-in-canvas"}),o.push({type:"limit-in-plot"}),o.push({type:"hide-overlap"})):(o.push({type:"limit-in-plot"}),o.push({type:"hide-overlap"}))),u={position:e.position,layout:o,style:{fill:e.color,fontSize:e.fontSize,fontFamily:f.fontFamily},formatter:function(i){return D(i.value,e.labelFormatter)}}}else u=!1}return u}function ds(f){let u,t;if(f.customAttr&&(t=L(f.customAttr),t.tooltip)){const e=JSON.parse(JSON.stringify(t.tooltip));e.show?u={formatter:function(o){const i=D(o.value,e.tooltipFormatter);return{name:o.field,value:i}},container:at(`tooltip-${f.id}`),itemTpl:rt,enterable:!0}:u=!1}return u}function fs(f){var i;const t=L(f.customAttr).tooltip;if(!t.show)return!1;const e=(i=t.seriesTooltipFormatter)==null?void 0:i.filter(l=>l.show).reduce((l,n)=>(l[n.id]=n,l),{});return{showTitle:!0,customItems(l){var s,r;if(!((s=t.seriesTooltipFormatter)!=null&&s.length))return l;const n=l[0];if(!n.data.quotaList)return l;const a=[];return l.filter(d=>e[d.data.quotaList[0].id]).forEach(d=>{const m=e[d.data.quotaList[0].id],c=D(parseFloat(d.value),m.formatterCfg),p=W(m.chartShowName)?m.name:m.chartShowName,h=Fo(d);a.push({...d,name:p,value:c,...h?{color:h}:{}})}),(r=n.data.dynamicTooltipValue)==null||r.forEach(d=>{const m=e[d.fieldId];if(m){const c=D(parseFloat(d.value),m.formatterCfg),p=W(m.chartShowName)?m.name:m.chartShowName;a.push({color:"grey",name:p,value:c})}}),a},container:at(`tooltip-${f.id}`),itemTpl:rt,enterable:!0}}function ms(f){let u={},t;if(f.customStyle&&(t=L(f.customStyle),t.legend)){const e=ce(JSON.parse(JSON.stringify(t.legend)),Lt);if(e.show){let o,i,l;const n=e.orient,a=e.icon;e.hPosition==="center"?l=e.vPosition==="center"?"top":e.vPosition:e.vPosition==="center"?l=e.hPosition==="center"?"left":e.hPosition:n==="horizontal"?l=e.vPosition+"-"+e.hPosition:l=e.hPosition+"-"+e.vPosition,n==="horizontal"?(e.hPosition==="left"?o=16:e.hPosition==="right"?o=-16:o=0,e.vPosition==="top"?i=0:e.vPosition==="bottom"?f.drill&&(i=-12):i=0):(e.hPosition==="left"?o=10:e.hPosition==="right"?o=-10:o=0,e.vPosition==="top"?i=0:e.vPosition==="bottom"?f.drill?i=-18:i=-10:i=0),u={layout:n,position:l,offsetX:o,offsetY:i,marker:{symbol:a,style:{r:e.size}},itemName:{style:{fill:e.color,fontSize:e.fontSize}},itemHeight:(e.fontSize>e.size*2?e.fontSize:e.size*2)+4,radio:!1,pageNavigator:{marker:{style:{fill:"rgba(0,0,0,0.65)",stroke:"rgba(192,192,192,0.52)",size:e.size*2}},text:{style:{fill:e.color,fontSize:e.fontSize}}}}}else u=!1}return u}function xi(f){let u={},t;if(f.customStyle&&(t=L(f.customStyle),t.xAxis)){const e=JSON.parse(JSON.stringify(t.xAxis));if(e.show){const o=e.nameShow&&e.name&&e.name!==""?{text:e.name,style:{fill:e.color,fontSize:e.fontSize},spacing:8}:null,i=e.splitLine.show?{line:{style:{stroke:e.splitLine.lineStyle.color,lineWidth:e.splitLine.lineStyle.width,lineDash:Mt(e.splitLine.lineStyle.style)}}}:null,l=e.axisLine?e.axisLine:ni.axisLine,n=l.show?{style:{stroke:l.lineStyle.color,lineWidth:l.lineStyle.width,lineDash:Mt(l.lineStyle.style)}}:null,a=l.show?{style:{stroke:l.lineStyle.color,lineWidth:l.lineStyle.width}}:null;let s="center";const r=e.axisLabel.rotate;e.position==="top"&&(s=r>20?"end":r<-20?"start":"center"),e.position==="bottom"&&(s=r>20?"start":r<-20?"end":"center");const d=e.axisLabel.show?{rotate:r*Math.PI/180,style:{fill:e.axisLabel.color,fontSize:e.axisLabel.fontSize,textAlign:s},formatter:m=>f.type==="bidirectional-bar"&&m.length>e.axisLabel.lengthLimit?m.substring(0,e.axisLabel.lengthLimit)+"...":m}:null;u={position:e.position,title:o,grid:i,label:d,line:n,tickLine:a}}else u=!1}return u}function Qe(f){let u={};const t=L(f.customStyle).yAxis;if(!t.show)return!1;const e=t.nameShow&&t.name&&t.name!==""?{text:t.name,style:{fill:t.color,fontSize:t.fontSize},spacing:8}:null,o=t.splitLine.show?{line:{style:{stroke:t.splitLine.lineStyle.color,lineWidth:t.splitLine.lineStyle.width,lineDash:Mt(t.splitLine.lineStyle.style)}}}:null,i=t.axisLine?t.axisLine:wo.axisLine,l=i.show?{style:{stroke:i.lineStyle.color,lineWidth:i.lineStyle.width,lineDash:Mt(i.lineStyle.style)}}:null,n=i.show?{style:{stroke:i.lineStyle.color,lineWidth:i.lineStyle.width}}:null,a=t.axisLabel.rotate;let s="end",r="middle";t.position==="right"&&(s="start",Math.abs(a)>75&&(s="center"),a>75&&(r="bottom"),a<-75&&(r="top")),t.position==="left"&&(Math.abs(a)>75&&(s="center"),a>75&&(r="top"),a<-75&&(r="bottom"));const d=t.axisLabel.show?{rotate:a*Math.PI/180,style:{fill:t.axisLabel.color,fontSize:t.axisLabel.fontSize,textBaseline:r,textAlign:s},formatter:m=>m.length>t.axisLabel.lengthLimit?m.substring(0,t.axisLabel.lengthLimit)+"...":m}:null;return u={position:t.position,title:e,grid:o,label:d,line:l,tickLine:n,nice:!0},u}function bi(f){let u={};const t=L(f.customStyle).yAxisExt;if(!t.show)return!1;const e=t.nameShow&&t.name&&t.name!==""?{text:t.name,style:{fill:t.color,fontSize:t.fontSize},spacing:8}:null,o=t.splitLine.show?{line:{style:{stroke:t.splitLine.lineStyle.color,lineWidth:t.splitLine.lineStyle.width,lineDash:Mt(t.splitLine.lineStyle.style)}}}:null,i=t.axisLine?t.axisLine:wo.axisLine,l=i.show?{style:{stroke:i.lineStyle.color,lineWidth:i.lineStyle.width,lineDash:Mt(i.lineStyle.style)}}:null,n=i.show?{style:{stroke:i.lineStyle.color,lineWidth:i.lineStyle.width}}:null,a=t.axisLabel.rotate;let s="end",r="middle";t.position==="right"&&(s="start",Math.abs(a)>75&&(s="center"),a>75&&(r="bottom"),a<-75&&(r="top")),t.position==="left"&&(Math.abs(a)>75&&(s="center"),a>75&&(r="top"),a<-75&&(r="bottom"));const d=t.axisLabel.show?{rotate:a*Math.PI/180,style:{fill:t.axisLabel.color,fontSize:t.axisLabel.fontSize,textBaseline:r,textAlign:s}}:null;return u={position:t.position,title:e,grid:o,label:d,line:l,tickLine:n,nice:!0},u}function ps(f){let u;const t=L(f.senior);return t.functionCfg&&t.functionCfg.sliderShow&&(u={start:t.functionCfg.sliderRange[0]/100,end:t.functionCfg.sliderRange[1]/100},t.functionCfg.sliderBg&&(u.backgroundStyle={fill:t.functionCfg.sliderBg,stroke:t.functionCfg.sliderBg,lineWidth:1,strokeOpacity:.5}),t.functionCfg.sliderFillBg&&(u.foregroundStyle={fill:t.functionCfg.sliderFillBg,fillOpacity:.5}),t.functionCfg.sliderTextColor&&(u.textStyle={fill:t.functionCfg.sliderTextColor,fontFamily:f.fontFamily},u.handlerStyle={fill:t.functionCfg.sliderTextColor,fillOpacity:.5,highLightFill:t.functionCfg.sliderTextColor})),u}function Si(f){var o,i;const u=[],t=L(f.senior);if(!((o=t.assistLineCfg)!=null&&o.enable))return u;const e=t.assistLineCfg.assistLine;if((e==null?void 0:e.length)>0){const l=L(f.customStyle);let n,a,s,r;if(l.yAxis){const y=JSON.parse(JSON.stringify(l.yAxis));n=y.position,a=y.axisLabelFormatter?y.axisLabelFormatter:wo.axisLabelFormatter}if(l.yAxisExt){const y=JSON.parse(JSON.stringify(l.yAxisExt));s=y.position,r=y.axisLabelFormatter?y.axisLabelFormatter:Tl.axisLabelFormatter}const d=e.filter(y=>y.field==="0"),m=e.filter(y=>y.field==="1").map(y=>y.fieldId),c=Yt.filter(f.yAxis,y=>y.summary!==""&&y.id!=="-1"),p=Yt.filter(f.yAxisExt,y=>y.summary!==""&&y.id!=="-1"),h=(i=f.data.dynamicAssistLines)==null?void 0:i.filter(y=>(m==null?void 0:m.includes(y.fieldId))&&(!!Yt.find(c,x=>x.id===y.fieldId)||!!Yt.find(p,x=>x.id===y.fieldId)&&f.type.includes("chart-mix")));d.concat(h||[]).forEach(y=>{const x=parseFloat(y.value),b=y.name+" : "+D(x,y.yAxisType==="left"?a:r);u.push({type:"line",yAxisType:y.yAxisType,start:["start",x],end:["end",x],style:{stroke:y.color,lineDash:Mt(y.lineType)}}),u.push({type:"text",yAxisType:y.yAxisType,position:[(y.yAxisType==="left"?n:s)==="left"?"start":"end",x],content:b,offsetY:-2,offsetX:(y.yAxisType==="left"?n:s)==="left"?2:-10*(b.length-2),style:{textBaseline:"bottom",fill:y.color,fontSize:y.fontSize?y.fontSize:10}})})}return u}function hs(f){var o,i;const u=[],t=L(f.senior);if(!((o=t.assistLineCfg)!=null&&o.enable))return u;const e=t.assistLineCfg.assistLine;if((e==null?void 0:e.length)>0){const l=L(f.customStyle);let n;if(l.xAxis){const c=JSON.parse(JSON.stringify(l.xAxis));gs(c.position),n=c.axisLabelFormatter?c.axisLabelFormatter:ni.axisLabelFormatter}const a=e.filter(c=>c.field==="0"),s=e.filter(c=>c.field==="1").map(c=>c.fieldId),r=Yt.filter(f.yAxis,c=>c.summary!==""&&c.id!=="-1"),d=(i=f.data.dynamicAssistLines)==null?void 0:i.filter(c=>(s==null?void 0:s.includes(c.fieldId))&&!!Yt.find(r,p=>p.id===c.fieldId));a.concat(d||[]).forEach(c=>{const p=parseFloat(c.value),h=c.name+" : "+D(p,n);u.push({type:"line",start:["start",p],end:["end",p],style:{stroke:c.color,lineDash:Mt(c.lineType)}}),u.push({type:"text",position:["start",p],content:h,offsetY:5,offsetX:2,rotate:Math.PI/2,style:{textBaseline:"bottom",fill:c.color,fontSize:c.fontSize?c.fontSize:10}})})}return u}function Mt(f){switch(f){case"solid":return[0,0];case"dashed":return[10,8];case"dotted":return[2,2];default:return[0,0]}}function tt(f,u=!1,t=0,e=0){const o=f.split(","),l=parseFloat(o[3].replace(")",""))*.3;o.splice(3,1,`${l})`);let n;return e==0?n=`l(${t}) 0:${o.join(",")} 1:${f}`:e>0?n=`l(${t}) 0:rgba(255,255,255,0) ${e}:${o.join(",")} 1:${f}`:n=`l(${t}) 0:rgba(255,255,255,0) 0.1:${o.join(",")} 1:${f}`,u?n:f}function gs(f){switch(f){case"top":return"left";case"bottom":return"right";case"left":return"bottom";case"right":return"top";default:return f}}function Ai(f){const t=L(f.customAttr).label,e={fill:t.color,fontSize:t.fontSize,textAllowOverlap:!0,fontWeight:"bold"};return t.fullDisplay||(e.textAllowOverlap=!1,e.padding=[2,2]),f.fontFamily&&(e.fontFamily=f.fontFamily),{visible:t.show,style:e}}function ys(f){return{stroke:L(f.customAttr).basicStyle.areaBorderColor}}function Ci(f){var i;const t=L(f.customAttr).tooltip,e=(i=t.seriesTooltipFormatter)==null?void 0:i.filter(l=>l.show).reduce((l,n)=>(l[n.id]=n,l),{}),o=document.getElementById(f.container);return o&&o.addEventListener("mousemove",l=>{const n=o.getBoundingClientRect(),a=l.clientX-n.left,s=l.clientY-n.top,r=o.getElementsByClassName("l7plot-tooltip-container");for(let d=0;d<(r==null?void 0:r.length);d++){const m=r[d],c=o.clientWidth-a<=m.clientWidth,p=o.clientHeight-s<=m.clientHeight;let h="";c&&(h+="translateX(-120%) "),p&&(h+="translateY(-100%) "),h&&(m.style.transform=h.trim())}}),{customTitle(l){return l.name},customItems(l){var r,d,m;const n=[];if(W(e))return n;const a=l.properties,s=e[(d=(r=a.quotaList)==null?void 0:r[0])==null?void 0:d.id];if(!W(s)){const c=parseFloat(a.value),p=D(c,s.formatterCfg),h=W(s.chartShowName)?s.name:s.chartShowName;n.push({...a,name:h,value:`${p??""}`})}return(m=a.dynamicTooltipValue)==null||m.forEach(c=>{const p=e[c.fieldId];if(p){const h=D(parseFloat(c.value),p.formatterCfg),g=W(p.chartShowName)?p.name:p.chartShowName;n.push({color:"grey",name:g,value:`${h??""}`})}}),n},showComponent:t.show,domStyles:{"l7plot-tooltip":{"background-color":t.backgroundColor,"font-size":`${t.fontSize}px`,"line-height":1.6,"font-family":f.fontFamily?f.fontFamily:void 0},"l7plot-tooltip__name":{color:t.color},"l7plot-tooltip__value":{color:t.color},"l7plot-tooltip__title":{color:t.color}}}}function wi(f,u){f.features.forEach(t=>{if(!t.properties.centroid)if(t.properties.center)t.properties.centroid=t.properties.center;else{const o=Ve(t.geometry);t.properties.centroid=o.geometry.coordinates}let e=t.properties.name;u!=null&&u[e]&&(e=u[e],t.properties.name=e)})}function Ke(f){const u={};return f==null||f.forEach(t=>{var e;(e=t.dynamicTooltipValue)==null||e.forEach(o=>{u[o.fieldId]||(u[o.fieldId]=0),o.value&&(u[o.fieldId]=Ye(u[o.fieldId],o.value))})}),u}const xs={circle:{borderRadius:"50%"},square:{},triangle:{borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottom:"10px solid var(--bgColor)",background:"unset"},diamond:{transform:"rotate(45deg)"}};function bs(f){const{basicStyle:u}=L(f.customAttr);if(u.suspension===!1&&u.showZoom===void 0)return!1;const{legend:t}=L(f.customStyle);return t.show?{position:"bottomleft",customContent:(e,o)=>{const i=(o==null?void 0:o.length)>30?o.slice(0,30):o;if(i!=null&&i.length){const n=xe(ai).getElementsByClassName(ri)[0];return i.forEach(a=>{let s="-";if(a.value!=="")if(Array.isArray(a.value))a.value.forEach((c,p)=>{a.value[p]=Number.isNaN(c)||c==="NaN"?"NaN":parseFloat(c).toFixed(0)}),s=a.value.join("-");else{const c=a.value;s=Number.isNaN(c)||c==="NaN"?"NaN":parseFloat(c).toFixed(0)}const r={...a,value:s},d=_o(ci,r),m=xe(d);m.style.setProperty("--bgColor",a.color),n.appendChild(m)}),n}return""},domStyles:{"l7plot-legend__category-value":{fontSize:t.fontSize+"px",color:t.color},"l7plot-legend__category-marker":{...xs[t.icon]}}}:!1}const Ss='<svg t="1717484429999" fill="${fill}" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9332" width="14px" height="14px"><path d="M47.653 439.326c-24.501 0-44.368 19.881-44.368 44.4v56.548c0 24.492 19.862 44.4 44.368 44.4h928.694c24.501 0 44.368-19.881 44.368-44.4v-56.548c0-24.497-19.862-44.4-44.368-44.4H47.653z" p-id="9333"></path><path d="M586.326 47.653c0-24.501-19.881-44.368-44.4-44.368h-56.548c-24.492 0-44.4 19.862-44.4 44.368v928.694c0 24.501 19.881 44.368 44.4 44.368h56.548c24.497 0 44.4-19.862 44.4-44.368V47.653z" p-id="9334"></path></svg>',As='<svg t="1717487786436" fill="${fill}" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="18361" width="14px" height="14px"><path d="M127.594667 503.274667a383.573333 383.573333 0 0 1 112.426666-263.04 380.864 380.864 0 0 1 122.24-82.474667 382.421333 382.421333 0 0 1 149.632-30.165333c51.946667 0 102.250667 10.176 149.504 30.165333a381.610667 381.610667 0 0 1 122.133334 82.474667 385.152 385.152 0 0 1 31.082666 35.093333l-67.285333 52.501333a8.96 8.96 0 0 0 3.349333 15.765334l196.352 48.042666a8.96 8.96 0 0 0 11.050667-8.597333l0.896-202.154667c0-7.466667-8.597333-11.733333-14.421333-7.04l-63.018667 49.28C795.605333 113.173333 661.973333 42.666667 511.786667 42.666667 255.786667 42.666667 47.488 247.829333 42.666667 502.826667a8.96 8.96 0 0 0 8.96 9.173333h67.029333c4.906667 0 8.832-3.925333 8.96-8.725333z m844.8 8.725333h-67.050667a8.917333 8.917333 0 0 0-8.96 8.704 381.76 381.76 0 0 1-30.037333 140.8 382.336 382.336 0 0 1-82.346667 122.24 382.656 382.656 0 0 1-271.893333 112.64 382.421333 382.421333 0 0 1-271.765334-112.64 385.152 385.152 0 0 1-31.061333-35.072l67.264-52.522667a8.96 8.96 0 0 0-3.349333-15.765333l-196.330667-48.042667a8.96 8.96 0 0 0-11.050667 8.597334l-0.789333 202.261333c0 7.488 8.597333 11.733333 14.421333 7.04l63.018667-49.28C228.394667 910.826667 362.026667 981.333333 512.213333 981.333333 768.341333 981.333333 976.512 776.042667 981.333333 521.173333a8.96 8.96 0 0 0-8.96-9.173333z" p-id="18362"></path></svg>',Cs='<svg t="1717486240292" fill="${fill}" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="13641" width="14px" height="14px"><path d="M935 423.3H89C40.2 423.3 0.3 463.2 0.3 512c0 48.8 39.9 88.7 88.7 88.7h846c48.8 0 88.7-39.9 88.7-88.7 0-48.8-39.9-88.7-88.7-88.7z" p-id="13642"></path></svg>';class po extends Pl{resetButtonGroup(u){$l(u),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",u,this.zoomIn),this.zoomResetButton=this.createButton(this.controlOption.resetText,"Reset","l7-button-control",u,()=>{this.controlOption.bounds?this.mapsService.fitBounds(this.controlOption.bounds,{animate:!0}):this.mapsService.setZoomAndCenter(this.controlOption.initZoom,this.controlOption.center)}),this.controlOption.showZoom&&(this.zoomNumDiv=this.createButton("0","","l7-button-control l7-control-zoom__number",u)),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",u,this.zoomOut);const{buttonBackground:t}=this.controlOption,e=[this.zoomResetButton,this.zoomInButton,this.zoomOutButton];t&&jo(e,"background",t),jo(e,"border-bottom","none"),this.updateDisabled()}getDefault(u){const{buttonColor:t}=u;let e=Ss,o=Cs,i=As;return t&&(e=e.replace("${fill}",t),o=o.replace("${fill}",t),i=i.replace("${fill}",t)),{...u,position:Hl.BOTTOMRIGHT,name:"zoom",zoomInText:e,zoomInTitle:"Zoom in",zoomOutText:o,zoomOutTitle:"Zoom out",resetText:i,showZoom:!1}}}function ws(f,u){var o,i,l,n,a,s;const{basicStyle:t}=L(f.customAttr),e=u==null?void 0:u.getControlByName("zoom");if(e&&u.removeControl(e),!vi(t)&&!(u!=null&&u.getControlByName("zoom")))if(!u.map)u.once("loaded",()=>{u.map.on("complete",()=>{const r=t.autoFit===!1?t.zoomLevel:u.getZoom(),d=t.autoFit===!1?[t.mapCenter.longitude,t.mapCenter.latitude]:[u.map.getCenter().lng,u.map.getCenter().lat],m={initZoom:r,center:d,buttonColor:t.zoomButtonColor,buttonBackground:t.zoomBackground};u.addControl(new po(m))})});else{const r={buttonColor:t.zoomButtonColor,buttonBackground:t.zoomBackground};if(t.autoFit===!1)r.initZoom=t.zoomLevel,r.center=[t.mapCenter.longitude,t.mapCenter.latitude];else{const d=[];if(f.type==="flow-map"){const m=f.xAxis,c=f.xAxisExt;(m==null?void 0:m.length)===2&&((i=(o=f.data)==null?void 0:o.tableRow)==null||i.forEach(p=>{d.push([p[m[0].dataeaseName],p[m[1].dataeaseName]])})),(c==null?void 0:c.length)===2&&((n=(l=f.data)==null?void 0:l.tableRow)==null||n.forEach(p=>{d.push([p[c[0].dataeaseName],p[c[1].dataeaseName]])}))}else{const m=f.xAxis;(m==null?void 0:m.length)===2&&((s=(a=f.data)==null?void 0:a.tableRow)==null||s.forEach(c=>{d.push([c[m[0].dataeaseName],c[m[1].dataeaseName]])}))}r.bounds=vs(d)}u.addControl(new po(r))}}function vs(f){if(!f||f.length===0)return{northEast:[180,90],southWest:[-180,-90]};let u=-180,t=180,e=-90,o=90;return f.forEach(([i,l])=>{u=Math.max(u,i),t=Math.min(t,i),e=Math.max(e,l),o=Math.min(o,l)}),[[u,e],[t,o]]}function _s(f,u){const{basicStyle:t}=L(f.customAttr);vi(t)||u.once("loaded",()=>{const e={initZoom:u.scene.getZoom(),center:u.scene.getCenter(),buttonColor:t.zoomButtonColor,buttonBackground:t.zoomBackground};u.scene.addControl(new po(e))})}function jo(f,u,t){f.forEach(e=>{e.style[u]=t})}function Ae(f){typeof f=="string"&&(f=document.getElementById(f)),f.classList.add("de-map-rendering")}function re(f){typeof f=="string"&&(f=document.getElementById(f)),f.classList.add("de-map-rendered")}function vi(f){return f.suspension===!1&&f.showZoom===void 0||f.showZoom===!1}const Ge="g2-tooltip-wrapper";function at(f){let u=document.getElementById(Ge);u||(u=document.createElement("div"),u.style.position="absolute",u.style.zIndex="9999",u.id=Ge,document.body.appendChild(u));const t=document.getElementById(f);t&&t.remove();const e=document.createElement("div");e.setAttribute("id",f),e.classList.add("g2-tooltip"),e.style.maxHeight="50%",ls()?e.style.maxWidth="50%":e.style.maxWidth="25%",e.style.overflowY="auto",e.style.display="none",e.style.position="fixed",e.style.left="0px",e.style.top="0px";const o=document.createElement("div");o.classList.add("g2-tooltip-title"),e.appendChild(o);const i=document.createElement("ul");i.classList.add("g2-tooltip-list"),e.appendChild(i);const l=document.getElementsByClassName("fullscreen");return l.length?l.item(0).appendChild(e):u.appendChild(e),e}function ft(f,u){const{tooltip:t}=L(f.customAttr);t.show&&(u.options.tooltip.container.addEventListener("mouseenter",e=>{e.target.style.visibility="visible",e.target.style.display="block"}),u.options.tooltip.container.addEventListener("mouseleave",e=>{e.target.style.visibility="hidden",e.target.style.display="none"}),u.on("tooltip:show",()=>{var i,l;const e=u.chart.getController("tooltip");if(!e)return;const o=(l=(i=u.chart.interactions.tooltip)==null?void 0:i.context)==null?void 0:l.event;if(e.tooltip){const n=e.tooltip.cfg.container;if(n.style.display="block",!document.getElementById(n.id)){const s=document.getElementsByClassName("fullscreen");s.length?s.item(0).appendChild(n):document.getElementById(Ge).appendChild(n)}}u.chart.getOptions().tooltip.follow=!1,e.title=Math.random().toString(),u.chart.getTheme().components.tooltip.x=o.clientX,u.chart.getTheme().components.tooltip.y=o.clientY}),u.on("plot:leave",()=>{var i,l;const e=u.chart.getController("tooltip");if(!e)return;u.chart.getOptions().tooltip.follow=!0;const o=(l=(i=e.tooltip)==null?void 0:i.cfg)==null?void 0:l.container;o&&(o.style.display="none"),e.hideTooltip()}),u.on("plot:touchstart",()=>{var o;const e=document.getElementById(Ge);if(e){const i=u.chart.getController("tooltip");if(!i)return;const l=(o=i.tooltip)==null?void 0:o.cfg.container;for(const n of e.children)(!l||l.id!==n.id)&&(n.style.display="none")}}),u.on("tooltip:hidden",()=>{var i;const e=u.chart.getController("tooltip");if(!e)return;const o=(i=e.tooltip)==null?void 0:i.cfg.container;o&&(o.style.display="none")}))}const rt='<li class="g2-tooltip-list-item" data-index={index}><span class="g2-tooltip-marker" style="background:{color}"></span><span class="g2-tooltip-name">{name}</span>:<span class="g2-tooltip-value">{value}</span></li>';function Ls(f){const{threshold:u}=L(f.senior),t=[];if(!u.enable||f.type==="area-stack"||f.type==="symbolic-map")return t;const e=u.lineThreshold??[],o=f.yAxis.map(i=>i.id);for(const i of e)if(o.includes(i.fieldId))for(const l of i.conditions){const n={type:"regionFilter",start:["start","median"],end:["end","min"],color:l.color},a={type:"line",start:["start",l.value],end:["end",l.value],style:{stroke:l.color,lineDash:[2,2]}};l.term==="between"?(n.start=["start",parseFloat(l.min)],n.end=["end",parseFloat(l.max)],a.start=["start",parseFloat(l.min)],a.end=["end",parseFloat(l.min)],t.push(JSON.parse(JSON.stringify(a))),a.start=["start",parseFloat(l.max)],a.end=["end",parseFloat(l.max)],t.push(a)):["lt","le"].includes(l.term)?(n.start=["start",l.value],n.end=["end","min"],t.push(a)):["gt","ge"].includes(l.term)&&(n.start=["start",l.value],n.end=["end","max"],t.push(a)),t.push(n)}return t}const Le={transition:"left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s",backgroundColor:"rgb(255, 255, 255)",boxShadow:"rgb(174, 174, 174) 0px 0px 10px",borderRadius:"3px",padding:"8px 12px",opacity:"0.95",position:"absolute",visibility:"visible"},Ts='<div class="g2-axis-label-tooltip"><div class="g2-tooltip-title">{title}</div></div>';function Xt(f,u,t){const e=t||"axis-label",o=e==="axis-title",{customStyle:i,customAttr:l}=L(f),{lengthLimit:n,fontSize:a,color:s,show:r}=i.yAxis.axisLabel,{tooltip:d}=l;!o&&(!n||!r||!i.yAxis.show||f.type==="bidirectional-bar")||(u.on(e+":mouseenter",m=>{var O;const c=m.target.cfg.delegateObject.component.cfg.field,p=m.target.cfg.delegateObject.component.cfg.position;if(c!=="field"&&c!=="title"&&!(p==="left"||p==="right"))return;const g=m.target.attrs.text;if(!o&&(g.length<n||g.slice(-3)!=="..."))return;const{x:y,y:x}=m,b=m.event.target.parentNode;let S=b.getElementsByClassName("g2-axis-label-tooltip")[0];const A=((O=m.target.cfg.delegateObject.item)==null?void 0:O.name)||m.target.cfg.delegateObject.axis.cfg.title.originalText;if(S)S.getElementsByClassName("g2-tooltip-title")[0].innerHTML=A,S.style.visibility="visible";else{const _=_o(Ts,{title:A});S=xe(_),Le.backgroundColor=d.backgroundColor,Le.boxShadow=`${d.backgroundColor} 0px 0px 5px`,Le.maxWidth="200px",Yt.assign(S.style,Le),b.appendChild(S)}const{height:C,width:w}=b.getBoundingClientRect(),{offsetHeight:T,offsetWidth:z}=S;if(T>C||z>w){S.style.left=S.style.top="0px";return}const N={left:y+10,top:x+15};N.left+z>w&&(N.left=w-z-10),N.top+T>C&&(N.top-=T+15),S.style.left=`${N.left}px`,S.style.top=`${N.top}px`,S.style.color=s,S.style.fontSize=`${a}px`}),u.on(e+":mouseleave",m=>{const c=m.target.cfg.delegateObject.component.cfg.field,p=m.target.cfg.delegateObject.component.cfg.position;if(c!=="field"&&c!=="title"&&!(p==="left"||p==="right"))return;const g=m.target.attrs.text;if(!o&&(g.length<n||g.slice(-3)!=="..."))return;const x=m.event.target.parentNode.getElementsByClassName("g2-axis-label-tooltip")[0];x&&(x.style.visibility="hidden")}))}function Es(f,u){u.on("beforerender",t=>{const{yAxis:e}=L(f.customStyle),o=.8*(t.view.canvas.cfg.height-(t.view.canvas.cfg.height<120?60:30)),i=hl(f,e.name,{fontSize:e.fontSize,fontFamily:f.fontFamily},"height");let l="";for(let n=0;n<e.name.length&&(n+1)*i<=o;n++)l+=e.name[n];e.name.length>l.length&&(l=l.length>2?l.slice(0,l.length-2)+"...":l+"..."),t.view.options.axes.yAxisExt.title.originalText=e.name,t.view.options.axes.yAxisExt.title.text=l})}const Fs=(f,u)=>{const{threshold:t}=L(f.senior);return t.enable&&u.data.forEach(e=>{var i;e.conditionColor=[];const o=f.type==="bar-horizontal"?u.xField:u.yField;f.type==="bidirectional-bar"?o.forEach(l=>{var s;const n=l==="value"?f.yAxis:f.yAxisExt,a=ho([(s=n[0])==null?void 0:s.id],e[l],f);a&&(e[e[u.xField]+"-"+l]=a)}):(i=e.quotaList)!=null&&i.length&&(e.quotaList.map(n=>n.id)??[]).forEach((n,a)=>{let s=e[o];f.type==="progress-bar"&&(s=e.originalValue);const r=ho([n],s,f);r?e.conditionColor.push(r):e.conditionColor=void 0})}),u},ho=(f,u,t)=>{var n,a;const{threshold:e}=L(t.senior),{basicStyle:o}=L(t.customAttr),i=Array.isArray(u)?u[1]-u[0]:u;if(!i)return;const l=new Map;for(const s of e.lineThreshold??[])l.set(s.fieldId,s);for(const s of l.values())if(!(t.type==="progress-bar"&&((a=(n=t.yAxisExt)==null?void 0:n[0])==null?void 0:a.id)!==f[0])&&!(!f.includes(s.fieldId)&&t.type!=="waterfall")){for(const r of s.conditions)if(r.term==="between"&&i>=r.min&&i<=r.max||r.term==="lt"&&i<r.value||r.term==="le"&&i<=r.value||r.term==="gt"&&i>r.value||r.term==="ge"&&i>=r.value){let d=Pe(r.color,o.alpha);if(o.gradient){let m=["bar-horizontal","progress-bar"].includes(t.type)?0:270;if(t.type==="bidirectional-bar"){const c=t.yAxis.find(p=>p.id===s.fieldId);m=Li(o,c?0:1)}d=tt(d,!0,m)}return d}}};function zs(f,u){const{threshold:t}=L(f.senior);if(!t.enable)return u;const{basicStyle:e}=L(f.customAttr),o="conditionColor",i=u.rawFields||[];i.push(o);const l=s=>{var r;return{...u.columnStyle,...u.barStyle,...(r=s[o])!=null&&r[0]?{fill:s[o][0]}:{}}};let n;return f.type==="bidirectional-bar"?(i.push(u.xField),n=Os(f,e,u)):f.type==="waterfall"&&(n=ks(e,f)),{...u,rawFields:i,columnStyle:l,barStyle:l,tooltip:{...u.tooltip,...u.tooltip.customItems?{}:{customItems:s=>(s.forEach(r=>{var d;(d=r.data)!=null&&d[o]&&(r.color=r.data[o][0])}),s)}},...n?{color:n}:{}}}const ks=(f,u)=>{const t=_i(u,f,270);return e=>{if(e.$$isTotal$$)return t[2];const o=e.$$yField$$;return ho([],o,u)??(o[1]>o[0]?t[0]:t[1])}},Os=(f,u,t)=>{const e=_i(f,u,270);return o=>{const i=t.data.find(l=>l[o[t.xField]+"-"+o["series-field-key"]]);return i?i[o[t.xField]+"-"+o["series-field-key"]]:o["series-field-key"]==="value"?e[0]:e[1]}},_i=(f,u,t)=>{var o;const e=[];return(o=u.colors)==null||o.forEach((i,l)=>{f.type==="bidirectional-bar"?e.push(tt(Pe(i,u.alpha),!0,Li(u,l))):e.push(tt(Pe(i,u.alpha),!0,t))}),u.gradient?e:u.colors},Li=(f,u)=>{let t=180-u*180;return f.layout==="vertical"&&(t=u===0?280:90),t},Fo=f=>{var t;let u=f.color;return(t=f.data)!=null&&t.conditionColor&&(u=f.data.conditionColor[0]),u},Is=(f,u,t,e)=>{if((()=>{const i=document.getElementById(u+"_empty");i&&i.parentElement.removeChild(i)})(),!(f.length>0)&&!f.length){const i=document.createElement("div");i.id=u+"_empty",i.textContent=e||cs("data_set.no_data"),i.setAttribute("style",`position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        color: darkgray;
        textAlign: center;`);const l=document.getElementById(u);l.insertBefore(i,l.firstChild),t==null||t.destroy()}},br=f=>{if(f<=0||f>99||!Number.isInteger(f))throw new Error("请输入1-99之间的整数");const u=["","一","二","三","四","五","六","七","八","九"];if(f<10)return u[f];const t=Math.floor(f/10),e=f%10;return e===0?t===1?"十":u[t]+"十":t===1?"十"+u[e]:u[t]+"十"+u[e]},{t:wt}=Y();var to=(f=>(f.ANT_V="antv",f.ECHARTS="echarts",f.CUSTOM="custom",f))(to||{}),Pt=(f=>(f.G2_PLOT="g2plot",f.L7_PLOT="l7plot",f.L7="l7",f.ECHARTS="echarts",f.S2="s2",f.RICH_TEXT="rich-text",f.PICTURE_GROUP="picture-group",f.INDICATOR="indicator",f))(Pt||{});class Ns{constructor(){v(this,"chartInstance")}}class Ce{constructor(u,t,e,o){v(this,"render");v(this,"library");v(this,"name");v(this,"title");v(this,"defaultData");this.render=u,this.library=t,this.name=e,this.defaultData=o}setupDefaultOptions(u){return u}}class eo extends Ce{constructor(t,e,o){super("antv",t,e,o);v(this,"axisConfig",{xAxis:{name:`${wt("chart.drag_block_type_axis")} / ${wt("chart.dimension")}`,type:"d",allowEmpty:!0},xAxisExt:{name:`${wt("chart.chart_group")} / ${wt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},extStack:{name:`${wt("chart.stack_item")} / ${wt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},yAxis:{name:`${wt("chart.drag_block_value_axis")} / ${wt("chart.quota")}`,type:"q",limit:1,allowEmpty:!0}});v(this,"selectorSpec",{"misc-style-selector":{title:`${wt("chart.size")}`},"dual-y-axis-selector":{title:`${wt("chart.yAxis")}`},"x-axis-selector":{title:`${wt("chart.xAxis")}`}})}}class Q extends eo{configTheme(u,t){const e=us(u);return{...t,theme:e}}configLabel(u,t){const e=Se(u);return{...t,label:e}}configMultiSeriesTooltip(u,t){const e=fs(u);return{...t,tooltip:e}}configTooltip(u,t){const e=ds(u);return{...t,tooltip:e}}configLegend(u,t){const e=ms(u);return{...t,legend:e}}configXAxis(u,t){const e=xi(u);return{...t,xAxis:e}}configYAxis(u,t){const e=Qe(u);return{...t,yAxis:e}}configSlider(u,t){const e=ps(u);return{...t,slider:e}}configAnalyse(u,t){const e=Si(u);return{...t,annotations:[...e,...t.annotations||[]]}}configAnalyseHorizontal(u,t){const e=hs(u);return{...t,annotations:e}}configEmptyDataStrategy(u,t){return gl(u,t)}configColor(u,t){const e=yl(u);return{...t,color:e}}configGroupColor(u,t){const e=xl(u,t);return{...t,color:e}}configStackColor(u,t){const e=bl(u,t);return{...t,color:e}}configSingleDimensionColor(u,t){const e=Sl(u,t);return{...t,color:e}}setupSeriesColor(u,t){return Al(u)}setupSubSeriesColor(u,t){}configConditions(u,t){const e=Ls(u);return{...t,annotations:[...e,...t.annotations||[]]}}configBarConditions(u,t){return zs(u,t)}addConditionsStyleColorToData(u,t){return Fs(u,t)}configEmptyDataStyle(u,t,e,o){Is(u,t,e,o)}constructor(u,t){super(Pt.G2_PLOT,u,t)}}const we=["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","x-axis-selector","y-axis-selector","title-selector","legend-selector","function-cfg","assist-line","jump-set","linkage","threshold"],Bs=["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","x-axis-selector","y-axis-selector","title-selector","legend-selector","function-cfg","jump-set","linkage","threshold"],St={"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","radiusColumnBar","columnWidthRatio"],"label-selector":["fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","tooltipFormatter","show"],"x-axis-selector":["name","color","fontSize","axisLine","splitLine","axisForm","axisLabel","position"],"y-axis-selector":["name","color","fontSize","axisValue","axisLine","splitLine","axisForm","axisLabel","position"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["slider","emptyDataStrategy"],threshold:["lineThreshold"]},ue=["xAxis","yAxis","filter","drill","extLabel","extTooltip"],ve=f=>{var t;const u=document.getElementById(Et(f));u&&(u.remove(),(t=u.parentNode)==null||t.removeChild(u))},Ds=(f,u=128)=>{const t=Ti(f);return W(t)?!1:t.r*.299+t.g*.587+t.b*.114>=u},Ti=f=>{const u=/rgba\((\d+),\s*(\d+),\s*(\d+),\s*([\d.]+)\)/g;let t,e=null;for(;(t=u.exec(f))!==null;){const o=parseInt(t[1]),i=parseInt(t[2]),l=parseInt(t[3]),n=parseFloat(t[4]);e={r:o,g:i,b:l,a:n}}return e};function Go(f,u,t,e){var i;if(!u&&u!=0)return;const o=document.getElementById(Et(e));if(o){const l=document.getElementById(f);l&&(l.remove(),(i=l.parentNode)==null||i.removeChild(l));const n=document.createElement("div");n.id=f,n.className="child",n.setAttribute("style",`width: auto;
        height: auto;
        border-radius: 2px;
        position: relative;
        padding: 4px 5px 4px 5px;
        display:none;
        transform: translateX(-50%);
        opacity: 1;
        transition: opacity 0.2s ease-in-out;
        white-space:nowrap;
        overflow:auto;`),n.textContent=D(u,t);const a=document.createElement("span");a.setAttribute("style",`width: 0px;
        height: 0px;
        border: 4px solid transparent;
        border-top-color: red;
        position: absolute;
        left: calc(50% - 4px);
        margin-top:4px;`),n.appendChild(a),o.appendChild(n)}}const Ei=f=>["area","bar"].includes(f.type),Ms=f=>["line","area","bar","bar-group"].includes(f.type),Me=f=>f.container+"_",Et=f=>f.container+"_point_"+f.id+"_";function Rs(f,u){const t=document.getElementById(f);if(!t){console.error("Parent div not found");return}const e=t.getElementsByTagName("div");for(let o=e.length-1;o>=0;o--){const i=e[o];i.id&&i.id.startsWith(u)&&i.parentNode.removeChild(i)}}const zo=(f,u,t,e)=>{if(u.container=e,ve(u),!Ms(u))return;const{label:o}=L(u.customAttr),{yAxis:i}=L(u);f.once("beforerender",l=>{l.view.on("beforepaint",()=>{var n;(n=f.chart.geometries[0])==null||n.beforeMappingData.forEach(a=>{var m;a.forEach(c=>{delete c._origin.EXTREME});const{minItem:s,maxItem:r}=Ps(a.filter(c=>{var p,h;return((p=c==null?void 0:c._origin)==null?void 0:p.value)!==null&&((h=c==null?void 0:c._origin)==null?void 0:h.value)!==void 0}));if(!s||!r)return;let d=!1;if(Ei(u)||i.length>1){const c=o.seriesLabelFormatter.find(p=>(p.chartShowName?p.chartShowName:p.name===s._origin.category)||(p.chartShowName?p.chartShowName:p.name===r._origin.category));d=c==null?void 0:c.showExtremum}else["bar-group"].includes(u.type)?d=o.showExtremum:d=(m=o.seriesLabelFormatter[0])==null?void 0:m.showExtremum;d&&(s._origin.EXTREME=!0,r._origin.EXTREME=!0)})}),f.chart.geometries[0].on("afteranimate",()=>{$s(u,l)})}),f.on("legend-item:click",l=>{const n=l.view.getController("legend").components[0].component.cfg.items.filter(a=>a.unchecked);n.length>0&&n.forEach(a=>{const s=Me(u)+Et(u)+a.id;Rs(Et(u),s)})})},Ps=f=>f.reduce(({minItem:u,maxItem:t},e)=>((u===void 0||e._origin.value<u._origin.value)&&(u=e),(t===void 0||e._origin.value>t._origin.value)&&(t=e),u==null||delete u._origin.EXTREME,t==null||delete t._origin.EXTREME,{minItem:u,maxItem:t}),{minItem:void 0,maxItem:void 0}),$s=(f,u)=>{const{label:t,basicStyle:e}=L(f.customAttr),o=e.lineSymbolSize,{yAxis:i}=L(f);if(ve(f),!document.getElementById(Et(f))){const r=document.createElement("div");r.id=Et(f),r.style.position="fixed",r.style.zIndex="1",r.style.opacity="0",r.style.transition="opacity 0.2s ease-in-out",r.style.overflow="visible";const d=document.getElementById(f.container);d.insertBefore(r,d.firstChild);let m=0;const c=()=>{if(m+=.19,m>=1){cancelAnimationFrame(p);return}r.style.opacity=m+"",p=requestAnimationFrame(c)};let p=requestAnimationFrame(c)}let n=[];const a=u.view.getGeometries().find(r=>r.type==="interval");a&&(n=a.dataArray);const s=u.view.getGeometries().find(r=>r.type==="point");s&&(n=s.dataArray),Hs(n,r=>{var d;if(r&&r.length>0){const m=r[0],[c,p]=r.filter(S=>S._origin.EXTREME);let h,g=!1;if(Ei(f)||i.length>1){const S=t.seriesLabelFormatter.find(A=>A.chartShowName?A.chartShowName===m._origin.category:A.name===m._origin.category);g=S==null?void 0:S.showExtremum,h=S}else["bar-group"].includes(f.type)?g=t.showExtremum:(g=(d=t.seriesLabelFormatter[0])==null?void 0:d.showExtremum,h=t.seriesLabelFormatter[0]);const y=h?h.fontSize:t.fontSize;if(!c)return;const x=Me(f)+Et(f)+m._origin.category+"_"+(p?p._origin.value:c._origin.value),b=Me(f)+Et(f)+m._origin.category+"_"+c._origin.value;g&&t.show?(p&&Go(x,p._origin.value,h?h.formatterCfg:t.labelFormatter,f),Go(b,c._origin.value,h?h.formatterCfg:t.labelFormatter,f),r.forEach(S=>{const A=document.getElementById(Me(f)+Et(f)+S._origin.category+"_"+S._origin.value);if(A&&S._origin.EXTREME){A.style.position="absolute";const C=(S.y[1]?S.y[1]:S.y)-(y+(o||0)+12);A.style.top=C+"px",A.style.left=S.x+"px",A.style.zIndex="10",A.style.fontSize=y+"px",A.style.lineHeight=y+"px";const w=S.color.startsWith("#")?Pe(S.color,e.alpha/100):Ti(S.color),{r:T,b:z,g:N,a:O}=w;A.style.backgroundColor="rgba("+T+","+N+","+z+","+O+")",A.style.color=Ds(S.color)?"#000":"#fff",A.children[0].style.borderTopColor="rgba("+T+","+N+","+z+","+O+")",A.style.display="table";const _=A.childNodes[1],k=Math.ceil(S.y+Math.abs(Math.floor(C))+6);C<0&&Math.abs(C)/S.y*100>=50?(A.style.transform=`translateX(-50%) translateY(${k}px)`,_.style.marginTop="-12px",_.style.transform="rotate(180deg)"):_.style.display="block"}})):(Uo(x),Uo(b))}})};function Uo(f){var t;const u=document.getElementById(f);u&&(u.remove(),(t=u.parentNode)==null||t.removeChild(u))}function Hs(f,u){if(typeof f=="number"&&(f={length:f}),f.length===0)return;let t=0;function e(){t>=f.length||requestIdleCallback(o=>{for(;o.timeRemaining()>0&&t<f.length;)u(f[t],t),t++;e()})}e()}const{t:ie}=Y(),Ws=[];class Fi extends Q{constructor(t="bar",e=Ws){super(t,e);v(this,"properties",we);v(this,"propertyInner",{...St,"basic-style-selector":[...St["basic-style-selector"],"seriesColor"],"label-selector":["vPosition","seriesLabelFormatter","showExtremum"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"y-axis-selector":[...St["y-axis-selector"],"axisLabelFormatter"]});v(this,"baseOptions",{xField:"field",yField:"value",seriesField:"category",isGroup:!0,data:[]});v(this,"axis",[...ue]);v(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${ie("chart.drag_block_type_axis")} / ${ie("chart.dimension")}`,type:"d"},yAxis:{name:`${ie("chart.drag_block_value_axis")} / ${ie("chart.quota")}`,type:"q"}})}async drawChart(t){var d,m,c;const{chart:e,container:o,action:i}=t;if(!((m=(d=e==null?void 0:e.data)==null?void 0:d.data)!=null&&m.length)){e.container=o,ve(e);return}const l=G((c=t.chart.data)==null?void 0:c.data),n={...this.baseOptions,appendPadding:nt(e),data:l},a=this.setupOptions(e,n);let s=null;const{Column:r}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(p=>p.$),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url);return s=new r(o,a),s.on("interval:click",i),zo(s,e,a,o),ft(e,s),s}configLabel(t,e){var a;const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const{label:i}=L(t.customAttr),l=(a=i.seriesLabelFormatter)==null?void 0:a.reduce((s,r)=>(s[r.id]=r,s),{});o.label.style.fill=Gt.color;const n={fields:[],...o.label,formatter:(s,r)=>{var p;if(s.EXTREME)return"";if(!((p=i.seriesLabelFormatter)!=null&&p.length))return s.value;const d=l==null?void 0:l[s.quotaList[0].id];if(!d)return s.value;if(!d.show)return;const m=D(s.value,d.formatterCfg),c=new Ut({});return c.addShape({type:"text",attrs:{x:0,y:0,text:m,textAlign:"start",textBaseline:"top",fontSize:d.fontSize,fontFamily:t.fontFamily,fill:d.color}}),c},position:s=>{var r,d,m;if(s.value<0){if(((r=o.label)==null?void 0:r.position)==="top")return"bottom";if(((d=o.label)==null?void 0:d.position)==="bottom")return"top"}return(m=o.label)==null?void 0:m.position}};return{...o,label:n}}configTooltip(t,e){return super.configMultiSeriesTooltip(t,e)}configBasicStyle(t,e){const o=L(t.customAttr).basicStyle;if(o.gradient){let n=o.colors;n=n.map(a=>{const s=P(a,o.alpha);return tt(s,!0,270)}),e={...e,color:n}}if(o.radiusColumnBar==="roundAngle"){const n={radius:[o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius]};e={...e,columnStyle:n}}let i;const l=o.columnWidthRatio??ot.columnWidthRatio;return l>=1&&l<=100?i=l/100:l<1?i=1/100:l>100&&(i=1),i&&(e.columnWidthRatio=i),e}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const i=L(t.customStyle).yAxis,l=i.axisValue;if(o.yAxis.label&&(o.yAxis.label.formatter=n=>D(n,i.axisLabelFormatter)),!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}},{data:a}=e,s=a.filter(r=>r.value>=l.min);return{...o,data:s,...n}}return o}setupOptions(t,e){return U(this.addConditionsStyleColorToData,this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configBarConditions)(t,e,{},this)}setupDefaultOptions(t){return t.senior.functionCfg.emptyDataStrategy="ignoreData",t}}class ko extends Fi{constructor(t="bar-stack"){super(t);v(this,"properties",we.filter(t=>t!=="threshold"));v(this,"propertyInner",{...this.propertyInner,"label-selector":[...St["label-selector"],"vPosition","showTotal","totalColor","totalFontSize","totalFormatter","showStackQuota"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show"]});this.baseOptions={...this.baseOptions,isStack:!0,isGroup:!1,meta:{category:{type:"cat"}}},this.axis=[...this.axis,"extStack"]}configLabel(t,e){let o=Se(t);if(!o)return e;e={...e,label:o};const{label:i}=L(t.customAttr);if(i.showStackQuota||i.showStackQuota===void 0?(o.style.fill=i.color,o={...o,formatter:function(l){return D(l.value,i.labelFormatter)}}):o=!1,i.showTotal){const l=i.labelFormatter??Ue;zl(kl(e.data,"field"),(n,a)=>{const s=n.reduce((d,m)=>d+m.value,0),r=D(s,l);e.annotations||(e={...e,annotations:[]}),e.annotations.push({type:"text",position:[a,s],content:`${r}`,style:{textAlign:"center",fontSize:i.fontSize,fill:i.color},offsetY:-(parseInt(i.fontSize)/2)})})}return{...e,label:o}}configTooltip(t,e){const o=L(t.customAttr).tooltip;if(!o.show)return{...e,tooltip:!1};const i={formatter:l=>{const a={name:W(l.category)?l.field:l.category,value:l.value},s=D(l.value,o.tooltipFormatter);return a.value=s??"",a},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:i}}configColor(t,e){return this.configStackColor(t,e)}configData(t,e){const{xAxis:o,extStack:i,yAxis:l}=t,n=o.some(c=>c.sort!=="none"),a=i.some(c=>c.sort!=="none");if(n||a||!((l==null?void 0:l[0].sort)!=="none")||!i.length||!l.length)return e;const{data:r}=e,d=r.reduce((c,p)=>(c[p.field]=c[p.field]?c[p.field]+p.value:p.value||0,c),{}),m=l[0].sort;return r.sort((c,p)=>m==="asc"?d[c.field]-d[p.field]:d[p.field]-d[c.field]),e}setupSeriesColor(t,e){return Co(t,e)}setupOptions(t,e){return U(this.configTheme,this.configEmptyDataStrategy,this.configData,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse)(t,e,{},this)}}class Vs extends ko{constructor(t="bar-group"){super(t);v(this,"properties",we);v(this,"propertyInner",{...this.propertyInner,"label-selector":[...St["label-selector"],"vPosition","showExtremum"]});v(this,"axisConfig",{...this.axisConfig,yAxis:{name:`${ie("chart.drag_block_value_axis")} / ${ie("chart.quota")}`,type:"q",limit:1}});this.baseOptions={...this.baseOptions,isGroup:!0,isStack:!1,meta:{category:{type:"cat"}}},this.axis=[...ue,"xAxisExt"]}configLabel(t,e){const o=Se(t);if(!o)return e;const i={...e,label:o},{label:l}=L(t.customAttr);i.label.style.fill=l.color;const n={...i.label,formatter:function(a,s){if(a.EXTREME)return"";const r=D(a.value,l.labelFormatter);return l.childrenShow?r:null}};return{...i,label:n}}configColor(t,e){return this.configGroupColor(t,e)}setupSeriesColor(t,e){return oi(t,e)}setupOptions(t,e){return U(this.addConditionsStyleColorToData,this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configBarConditions)(t,e,{},this)}}class zi extends ko{constructor(t="bar-group-stack"){super(t);v(this,"propertyInner",{...this.propertyInner,"label-selector":[...St["label-selector"],"vPosition"]});this.baseOptions={...this.baseOptions,isGroup:!0,groupField:"group"},this.axis=[...this.axis,"xAxisExt","extStack"]}configTheme(t,e){const l={...super.configTheme(t,e).theme,innerLabels:{offset:0}};return{...e,theme:l}}configLabel(t,e){const o=Se(t);if(!o)return e;const i={...e,label:o},{label:l}=L(t.customAttr);i.label.style.fill=l.color;const n={...i.label,formatter:function(a){return D(a.value,l.labelFormatter)}};return{...i,label:n}}configTooltip(t,e){const o=L(t.customAttr).tooltip;if(!o.show)return{...e,tooltip:!1};const i={fields:[],formatter:l=>{const n={name:`${l.category} - ${l.group}`,value:l.value};return n.value=D(l.value,o.tooltipFormatter),n},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:i}}setupOptions(t,e){return U(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse)(t,e,{},this)}}class Ys extends zi{constructor(){super("percentage-bar-stack");v(this,"propertyInner",{...this.propertyInner,"label-selector":["color","fontSize","vPosition","reserveDecimalCount"],"tooltip-selector":["color","fontSize","backgroundColor","show"]});this.baseOptions={...this.baseOptions,isStack:!0,isPercent:!0,isGroup:!1,groupField:void 0,meta:{category:{type:"cat"}}},this.axis=[...ue,"extStack"]}configLabel(t,e){const o=super.configLabel(t,e);if(!o.label)return o;const{customAttr:i}=t,l=L(i).label,n={...o.label,formatter:function(a){return a.value?(Math.round(a.value*1e4)/100).toFixed(l.reserveDecimalCount)+"%":"0%"}};return{...o,label:n}}configTooltip(t,e){if(!L(t.customAttr).tooltip.show)return{...e,tooltip:{showContent:!1}};const{customAttr:i}=t,l=L(i).label,n={formatter:a=>{const s={name:a.category,value:a.value};return s.value=(Math.round(a.value*1e4)/100).toFixed(l.reserveDecimalCount)+"%",s},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:n}}setupOptions(t,e){return U(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse)(t,e,{},this)}}const qs=Object.freeze(Object.defineProperty({__proto__:null,Bar:Fi,GroupBar:Vs,GroupStackBar:zi,PercentageStackBar:Ys,StackBar:ko},Symbol.toStringTag,{value:"Module"})),{t:Ot}=Y();class js extends Q{constructor(){super("bidirectional-bar",[]);v(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${Ot("chart.drag_block_type_axis")} / ${Ot("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Ot("chart.drag_block_value_axis")} / ${Ot("chart.quota")}`,type:"q",limit:1},yAxisExt:{name:`${Ot("chart.drag_block_value_axis_ext")} / ${Ot("chart.quota")}`,type:"q",limit:1}});v(this,"axis",["xAxis","yAxis","yAxisExt","filter","drill","extLabel","extTooltip"]);v(this,"properties",["background-overall-component","border-style","basic-style-selector","x-axis-selector","dual-y-axis-selector","title-selector","legend-selector","label-selector","tooltip-selector","function-cfg","jump-set","linkage","threshold"]);v(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","layout","radiusColumnBar"],"x-axis-selector":["position","axisLabel","axisLine","splitLine"],"dual-y-axis-selector":["name","position","color","fontSize","axisLabel","axisLine","splitLine","axisValue","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["emptyDataStrategy"],"label-selector":["hPosition","vPosition","seriesLabelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],threshold:["lineThreshold"]});v(this,"selectorSpec",{...this.selectorSpec,"dual-y-axis-selector":{title:`${Ot("chart.xAxis")}`},"x-axis-selector":{title:`${Ot("chart.yAxis")}`}})}async drawChart(t){var h,g,y,x;const{chart:e,container:o,action:i}=t;if(!((g=(h=e.data)==null?void 0:h.data)!=null&&g.length))return;const l=G(e.data.data),n=bt((y=l[0])==null?void 0:y.data,[]),a=vo(bt((x=l[1])==null?void 0:x.data,[]),b=>{var S;return{...b,category:b.field,value:(S=n.find(A=>A.field===b.field))==null?void 0:S.value,valueExt:b.value}}),s={xField:"field",data:a,xAxis:{label:{style:{}},position:"bottom"},yField:["value","valueExt"],appendPadding:nt(e),meta:{field:{type:"cat"}}},d={...this.setupOptions(e,s)},m=e.xAxis;if((m==null?void 0:m.length)===1&&m[0].deType===1){const b=a.map(S=>S.field);d.meta={field:{type:"cat",values:b.reverse()}}}const{BidirectionalBar:c}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(b=>b.a6),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),p=new c(o,d);return p.on("interval:click",i),p.on("element:click",b=>{const S=p.options.data.filter(A=>A.field===b.data.data.field&&A[b.data.data["series-field-key"]]===b.data.data[b.data.data["series-field-key"]]);b.data.data={...b.data.data,...S[0]}}),ft(e,p),Xt(e,p),p}configBasicStyle(t,e){var i;const o=L(t.customAttr).basicStyle;if(o.gradient){const l=(i=o.colors)==null?void 0:i.map((n,a)=>{const s=P(n,o.alpha);let r=180-a*180;return o.layout==="vertical"&&(a===0&&(r=280),a===1&&(r=90)),tt(s,!0,r)});e={...e,color:l}}if(e={...e,layout:o.layout},o.radiusColumnBar==="roundAngle"){const l={radius:[o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius]};e={...e,barStyle:l}}return e}configXAxis(t,e){const o=super.configXAxis(t,e);return o.xAxis&&o.xAxis.label&&delete o.xAxis.label.style.textAlign,o}configTooltip(t,e){var m;const i=L(t.customAttr).tooltip;if(!i.show)return{...e,tooltip:!1};const l=G(t.yAxis),n=G(t.yAxisExt),a=(m=i.seriesTooltipFormatter)==null?void 0:m.filter(c=>c.show).reduce((c,p)=>(c[p.seriesId]=p,c),{}),s=G(e.data),r=c=>{const p=c.data;let h=l[0],g="yAxis";return p["series-field-key"]==="valueExt"&&(h=n[0],g="yAxisExt"),{id:h.id,name:h.name,axisType:g,value:p[p["series-field-key"]]}},d={shared:!0,showTitle:!0,customItems(c){var g,y;if(!((g=i.seriesTooltipFormatter)!=null&&g.length))return c;const p=[];c.filter(x=>{const b=r(x);return a[b.id+"-"+b.axisType]}).forEach(x=>{const b=r(x),S=a[b.id+"-"+b.axisType],A=D(parseFloat(x.value),S.formatterCfg),C=W(S.chartShowName)?S.name:S.chartShowName,w=Fo(x);p.push({...x,name:C,value:A,color:w})});const h=(y=s.find(x=>x.field===c[0].title))==null?void 0:y.dynamicTooltipValue;return h.length>0&&h.forEach(x=>{const b=i.seriesTooltipFormatter.filter(S=>S.id===x.fieldId);if(b&&b.length>0){const S=D(parseFloat(x.value),b[0].formatterCfg),A=W(b[0].chartShowName)?b[0].name:b[0].chartShowName;p.push({color:"grey",name:A,value:S})}}),p},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:d}}configLegend(t,e){const o=super.configLegend(t,e);return o.legend&&(o.legend.itemName.formatter=(i,l,n)=>{const a=t.yAxis[0],s=t.yAxisExt[0];return n===0?a.chartShowName?a.chartShowName:a.name:s.chartShowName?s.chartShowName:s.name}),o}configYAxis(t,e){const o=Qe(t);let i=bi(t);const l={...e};o?l.yAxis={value:void 0,valueExt:void 0}:(i=!1,l.yAxis={value:!1,valueExt:!1});const n=e.layout==="horizontal";o&&o.title&&n&&(o.title.autoRotate=!1);const a=L(t.customStyle).yAxis;o.label&&(o.label.formatter=m=>D(m,a.axisLabelFormatter));const s=a.axisValue;s!=null&&s.auto?l.yAxis.value=o:l.yAxis.value={...o,min:s.min,max:s.max,minLimit:s.min,maxLimit:s.max,tickCount:s.splitCount};const r=L(t.customStyle).yAxisExt;i.label&&(i.label.formatter=m=>D(m,r.axisLabelFormatter));const d=r.axisValue;return d!=null&&d.auto?l.yAxis.valueExt=i:l.yAxis.valueExt={...i,min:d.min,max:d.max,minLimit:d.min,maxLimit:d.max,tickCount:d.splitCount},l}setupDefaultOptions(t){return t.customStyle.yAxis={...t.customStyle.yAxis,position:"left"},t.customStyle.yAxisExt={...t.customStyle.yAxisExt,position:"left",splitLine:t.customStyle.yAxis.splitLine},t.customAttr.label={...t.customAttr.label,position:"right"},t.customAttr.basicStyle.layout="horizontal",t}configLabel(t,e){var d;let o;const i=t.yAxis,l=t.yAxisExt,n=L(t.customAttr).label,a=(d=n.seriesLabelFormatter)==null?void 0:d.reduce((m,c)=>(m[c.id]=c,m),{});let s;const r=e.layout==="horizontal";if(t.customAttr&&(s=L(t.customAttr),s.label)){const m=s.label;if(m.show){const c=[];if(!n.fullDisplay){const p=super.configLabel(t,e);c.push(...p.label.layout)}o={position:m.position,layout:c,style:{fill:m.color,fontSize:m.fontSize,fontFamily:t.fontFamily},formatter:p=>{let h=i[0],g=p.value;p["series-field-key"]==="valueExt"&&(h=l[0]);const y=p[p["series-field-key"]],x=a==null?void 0:a[h.id];if(h.formatterCfg&&(g=D(y,h.formatterCfg)),!x)return g;if(!x.show)return;x?g=D(y,x.formatterCfg):g=D(y,m.labelFormatter);const b=new Ut({}),S=p["series-field-key"]==="value",A=S&&r?"end":"start",C=o.position==="middle";return b.addShape({type:"text",attrs:{x:S&&r&&!C?-6:!S&&r&&!C?6:0,y:S&&!r&&!C?-8:!S&&!r&&!C?8:0,text:g,textAlign:o.position==="middle"?"start":A,textBaseline:"top",fontSize:x.fontSize,fontFamily:t.fontFamily,fill:x.color}}),b}}}else o=!1}return r||(o.position==="left"&&(o.position="bottom"),o.position==="right"&&(o.position="top")),{...e,label:o}}configEmptyDataStrategy(t,e){const{data:o}=e;if(!(o!=null&&o.length))return e;const i=L(t.senior).functionCfg.emptyDataStrategy;if(i==="ignoreData"){const n=o.filter(a=>a.value===null||a.valueExt===null).map(a=>a.field);return{...e,data:o.filter(a=>!n.includes(a.field))}}return(i==="breakLine"||i==="setZero")&&((n,a)=>{a.forEach(s=>{s.value===null&&(s.value=n==="breakLine"?null:0),s.valueExt===null&&(s.valueExt=n==="breakLine"?null:0)})})(i,o),e}setupOptions(t,e){return U(this.addConditionsStyleColorToData,this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configAnalyse,this.configSlider,this.configEmptyDataStrategy,this.configBarConditions)(t,e)}}const Gs=Object.freeze(Object.defineProperty({__proto__:null,BidirectionalHorizontalBar:js},Symbol.toStringTag,{value:"Module"})),{t:le}=Y(),Us=[];class ki extends Q{constructor(t="bar-horizontal"){super(t,Us);v(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${le("chart.drag_block_type_axis")} / ${le("chart.dimension")}`,type:"d"},yAxis:{name:`${le("chart.drag_block_value_axis")} / ${le("chart.quota")}`,type:"q"}});v(this,"properties",we);v(this,"propertyInner",{...St,"basic-style-selector":[...St["basic-style-selector"],"seriesColor"],"label-selector":["hPosition","seriesLabelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"x-axis-selector":[...St["x-axis-selector"],"axisLabelFormatter","axisValue"],"y-axis-selector":["name","color","fontSize","axisLine","splitLine","axisForm","axisLabel","position","showLengthLimit"]});v(this,"axis",[...ue]);v(this,"baseOptions",{data:[],xField:"value",yField:"field",seriesField:"category",isGroup:!0})}async drawChart(t){var d,m;const{chart:e,container:o,action:i}=t;if(!((m=(d=e.data)==null?void 0:d.data)!=null&&m.length))return;const l=G(e.data.data),n={...this.baseOptions,appendPadding:nt(e),data:l},a=this.setupOptions(e,n),{Bar:s}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(c=>c._),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("interval:click",i),ft(e,r),Xt(e,r),r}configXAxis(t,e){const o=super.configXAxis(t,e);if(!o.xAxis)return o;const i=L(t.customStyle).xAxis,l=i.axisValue;if(o.xAxis.label&&(o.xAxis.label.formatter=n=>D(n,i.axisLabelFormatter)),o.xAxis.position==="top"&&(o.xAxis.position="left"),o.xAxis.position==="bottom"&&(o.xAxis.position="right"),!(l!=null&&l.auto)){const n={xAxis:{...o.xAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}},{data:a}=e,s=a.filter(r=>r.value>=l.min);return{...o,data:s,...n}}return o}configTooltip(t,e){return super.configMultiSeriesTooltip(t,e)}configBasicStyle(t,e){const o=L(t.customAttr).basicStyle;if(o.gradient){let n=o.colors;n=n.map(a=>{const s=P(a,o.alpha);return tt(s,!0)}),e={...e,color:n}}if(o.radiusColumnBar==="roundAngle"){const n={radius:[o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius]};e={...e,barStyle:n}}let i;const l=o.columnWidthRatio??ot.columnWidthRatio;return l>=1&&l<=100?i=l/100:l<1?i=1/100:l>100&&(i=1),i&&(e.barWidthRatio=i),e}setupDefaultOptions(t){const{customAttr:e,senior:o}=t,{label:i}=e;return["left","middle","right"].includes(i.position)||(i.position="middle"),o.functionCfg.emptyDataStrategy="ignoreData",t}configLabel(t,e){var a;const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const i=L(t.customAttr).label,l=(a=i.seriesLabelFormatter)==null?void 0:a.reduce((s,r)=>(s[r.id]=r,s),{});o.label.style.fill=Gt.color;const n={fields:[],...o.label,formatter:s=>{var c;if(!((c=i.seriesLabelFormatter)!=null&&c.length))return s.value;const r=l==null?void 0:l[s.quotaList[0].id];if(!r)return s.value;if(!r.show)return;const d=D(s.value,r.formatterCfg),m=new Ut({});return m.addShape({type:"text",attrs:{x:0,y:0,text:d,textAlign:"start",textBaseline:"top",fontSize:r.fontSize,fontFamily:t.fontFamily,fill:r.color}}),m}};return{...o,label:n}}configYAxis(t,e){const o=super.configYAxis(t,e);return o.yAxis&&(o.yAxis.position==="left"&&(o.yAxis.position="bottom"),o.yAxis.position==="right"&&(o.yAxis.position="top")),o}setupOptions(t,e){return U(this.addConditionsStyleColorToData,this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyseHorizontal,this.configBarConditions)(t,e,{},this)}}class Oi extends ki{constructor(t="bar-stack-horizontal"){super(t);v(this,"properties",we.filter(t=>t!=="threshold"));v(this,"axisConfig",{...this.axisConfig,extStack:{name:`${le("chart.stack_item")} / ${le("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}});v(this,"propertyInner",{...this.propertyInner,"label-selector":["color","fontSize","hPosition","labelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show"]});this.baseOptions={...this.baseOptions,isGroup:!1,isStack:!0,meta:{category:{type:"cat"}}},this.axis=[...this.axis,"extStack"]}configLabel(t,e){const o=super.configLabel(t,e);if(!o.label)return o;const{label:i}=L(t.customAttr);o.label.style.fill=i.color;const l={...o.label,formatter:function(n){return D(n.value,i.labelFormatter)}};return{...o,label:l}}configTooltip(t,e){const o=L(t.customAttr).tooltip;if(!o.show)return{...e,tooltip:!1};const i={formatter:l=>{const n={name:l.category,value:l.value},a=D(l.value,o.tooltipFormatter);return n.value=a??"",n},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:i}}configColor(t,e){return this.configStackColor(t,e)}setupSeriesColor(t,e){return Co(t,e)}configData(t,e){var c;const{xAxis:o,extStack:i,yAxis:l}=t,n=o.some(p=>p.sort!=="none"),a=i.some(p=>p.sort!=="none");if(n||a||!(((c=l==null?void 0:l[0])==null?void 0:c.sort)!=="none")||!i.length||!l.length)return e;const{data:r}=e,d=r.reduce((p,h)=>(p[h.field]=p[h.field]?p[h.field]+h.value:h.value||0,p),{}),m=l[0].sort;return r.sort((p,h)=>m==="asc"?d[p.field]-d[h.field]:d[h.field]-d[p.field]),e}setupOptions(t,e){return U(this.configTheme,this.configEmptyDataStrategy,this.configData,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyseHorizontal)(t,e,{},this)}}class Xs extends Oi{constructor(){super("percentage-bar-stack-horizontal");v(this,"propertyInner",{...this.propertyInner,"label-selector":["color","fontSize","hPosition","reserveDecimalCount"],"tooltip-selector":["color","fontSize","backgroundColor","show"]});this.baseOptions={...this.baseOptions,isPercent:!0}}configLabel(t,e){const o=super.configLabel(t,e);if(!o.label)return o;const{customAttr:i}=t,l=L(i).label,n={...o.label,formatter:function(a){return a.value?(Math.round(a.value*1e4)/100).toFixed(l.reserveDecimalCount)+"%":"0%"}};return{...o,label:n}}configTooltip(t,e){if(!L(t.customAttr).tooltip.show)return{...e,tooltip:{showContent:!1}};const{customAttr:i}=t,l=L(i).label,n={formatter:a=>{const s={name:a.category,value:a.value};return s.value=(Math.round(a.value*1e4)/100).toFixed(l.reserveDecimalCount)+"%",s},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:n}}setupOptions(t,e){return U(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyseHorizontal)(t,e,{},this)}}const Js=Object.freeze(Object.defineProperty({__proto__:null,HorizontalBar:ki,HorizontalPercentageStackBar:Xs,HorizontalStackBar:Oi},Symbol.toStringTag,{value:"Module"})),{t:Jt}=Y();class Zs extends Q{constructor(){super("progress-bar",[]);v(this,"axisConfig",{xAxis:{name:`${Jt("chart.form_type")} / ${Jt("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Jt("chart.progress_target")} / ${Jt("chart.quota")}`,type:"q",limit:1},yAxisExt:{name:`${Jt("chart.progress_current")} / ${Jt("chart.quota")}`,type:"q",limit:1}});v(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","y-axis-selector","title-selector","function-cfg","jump-set","linkage","threshold"]);v(this,"propertyInner",{...St,"legend-selector":null,"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","radiusColumnBar","columnWidthRatio"],"label-selector":["hPosition","color","fontSize","showQuota","showProportion"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show"],"y-axis-selector":["name","color","fontSize","axisForm","axisLabel","showLengthLimit"],"function-cfg":["emptyDataStrategy"],threshold:["lineThreshold"]});v(this,"axis",[...ue,"yAxisExt"]);v(this,"baseOptions",{data:[],xField:"progress",yField:"title",seriesField:"type",isGroup:!1,isPercent:!0,isStack:!0,xAxis:!1,appendPadding:[0,0,10,0]})}async drawChart(t){var g,y,x,b;const{chart:e,container:o,action:i}=t;if(!((y=(g=e.data)==null?void 0:g.data)!=null&&y.length))return;const l=(S,A)=>{if(S===0)return 100;if(S>0&&A<0)return 0;if(S<0&&A>0||S<0&&A===0)return(2-A/S)*100;if(S>0&&A>0)return A/S*100;if(S<0&&A<0){const C=(2-A/S)*100;return Number(Math.max(C,0).toFixed(2))}return 0},n=G(e.data.data),a=bt((x=n[0])==null?void 0:x.data,[]),r=bt((b=n[1])==null?void 0:b.data,[]).map(S=>{var C;const A=l((C=a.find(w=>w.field===S.field))==null?void 0:C.value,S.value);return{...S,type:"current",title:S.field,id:S.quotaList[0].id,originalValue:S.value,originalProgress:A,progress:A>=100?100:A}}),d=a.map(S=>{var C;const A=100-((C=r.find(w=>w.title===S.field))==null?void 0:C.progress);return{...S,type:"target",title:S.field,id:S.quotaList[0].id,originalValue:S.value,progress:A}}),m={...this.baseOptions,data:r.concat(d).flat()},c=this.setupOptions(e,m),{Bar:p}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(S=>S._),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),h=new p(o,c);return h.on("interval:click",i),ft(e,h),Xt(e,h),h}configBasicStyle(t,e){var a;const o=L(t.customAttr).basicStyle;let i=(a=o.colors)==null?void 0:a.map((s,r)=>r===1?P(s,o.alpha>10?10:o.alpha):P(s,o.alpha));if(o.gradient&&(i=i.map((s,r)=>tt(s,!0,0))),e={...e,color:s=>s.type==="target"?"rgba(0, 0, 0, 0)":i[0],barBackground:{style:{fill:i[1]}}},o.radiusColumnBar==="roundAngle"){const s={radius:[o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius]};e={...e,barStyle:s}}let l;const n=o.columnWidthRatio??ot.columnWidthRatio;return n>=1&&n<=100?l=n/100:n<1?l=1/100:n>100&&(l=1),l&&(e.barWidthRatio=l),e}configTooltip(t,e){const o=L(t.customAttr).tooltip;if(!o.show)return{...e,tooltip:{showContent:!1}};const i=G(t.yAxis)[0],l=G(t.yAxisExt)[0];return{...e,tooltip:{showContent:!0,domStyles:{"g2-tooltip-marker":null},customItems(n){const a=[];return n.forEach(s=>{if(s.data){const r=D(s.data.value,o.tooltipFormatter);s.data.id===i.id&&a.push({...s,marker:!1,name:i.chartShowName?i.chartShowName:i.name,value:r}),s.data.id===l.id&&a.push({...s,marker:!1,name:l.chartShowName?l.chartShowName:l.name,value:r})}}),a.length==0?n:a},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0}}}configLabel(t,e){var n;const o=super.configLabel(t,e);if(!o.label)return o;(n=o.label.layout)!=null&&n[0]||(o.label.layout=[{type:"limit-in-canvas"}]);const{label:i}=L(t.customAttr);o.label.style.fill=i.color;const l={...o.label,content:a=>{if(a.type==="target")return"";let s="";if(i.showQuota&&(s+=D(a.value,i.quotaLabelFormatter)),i.showProportion){let r=a.originalProgress.toFixed(i.reserveDecimalCount)+"%";i.showQuota&&(r=` (${r}) `),s+=r}return s}};return l.position==="top"&&(l.position="right"),{...o,label:l}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;o.yAxis.position="bottom";const i=L(t.customStyle).yAxis;if(i.axisLabel.show){const l=i.axisLabel.rotate;let n="end",a="middle";Math.abs(l)>75&&(n="center"),l>75&&(a="top"),l<-75&&(a="bottom"),o.yAxis.label.style.textBaseline=a,o.yAxis.label.style.textAlign=n}return o}setupDefaultOptions(t){return t.customStyle.yAxis={...t.customStyle.yAxis,position:"left",axisLine:{show:!1,lineStyle:t.customStyle.yAxis.axisLine.lineStyle},splitLine:{show:!1,lineStyle:t.customStyle.yAxis.axisLine.lineStyle}},t.customStyle.legend.show=!1,t.customAttr.label.show=!0,t.customAttr.label.position="right",t.customAttr.label.showQuota=!1,t.customAttr.label.showProportion=!0,t}configLegend(t,e){return{...super.configLegend(t,e),legend:!1}}configEmptyDataStrategy(t,e){const{data:o}=e;if(!(o!=null&&o.length))return e;const i=L(t.senior).functionCfg.emptyDataStrategy;if(i==="ignoreData"){const l=o.filter(n=>n.value===null).map(n=>n.field);return{...e,data:o.filter(n=>!l.includes(n.field))}}return i==="breakLine"&&o.forEach(l=>{l.value===null&&(l.value=null)}),i==="setZero"&&o.forEach(l=>{l.value===null&&(l.value=0)}),e}setupOptions(t,e){return U(this.addConditionsStyleColorToData,this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configYAxis,this.configEmptyDataStrategy,this.configBarConditions)(t,e)}}const Qs=Object.freeze(Object.defineProperty({__proto__:null,ProgressBar:Zs},Symbol.toStringTag,{value:"Module"})),{t:Zt}=Y(),Ks=[];class tn extends Q{constructor(t="bar-range"){super(t,Ks);v(this,"axisConfig",{xAxis:{name:`${Zt("chart.drag_block_type_axis")} / ${Zt("chart.dimension")}`,type:"d"},yAxis:{name:`${Zt("chart.drag_block_value_start")} / ${Zt("chart.time_dimension_or_quota")}`,limit:1,type:"q"},yAxisExt:{name:`${Zt("chart.drag_block_value_end")} / ${Zt("chart.time_dimension_or_quota")}`,limit:1,type:"q"}});v(this,"properties",Bs.filter(t=>t!=="threshold"));v(this,"propertyInner",{...St,"label-selector":["hPosition","color","fontSize","labelFormatter","showGap"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","showGap","show"],"x-axis-selector":[...St["x-axis-selector"],"axisLabelFormatter"],"y-axis-selector":["name","color","fontSize","axisLine","splitLine","axisForm","axisLabel","position","showLengthLimit"]});v(this,"axis",[...ue,"yAxisExt"]);v(this,"baseOptions",{data:[],xField:"values",yField:"field",colorField:"category",isGroup:!0})}async drawChart(t){var S,A,C,w;const{chart:e,container:o,action:i}=t;if(!((A=(S=e.data)==null?void 0:S.data)!=null&&A.length))return;const l=G(e.data.data);l.forEach(T=>{T.tempId=(Math.random()*1e7).toString()});const n=!!e.aggregate,a=!!e.data.isDate,s=e.yAxis??e.yAxisExt??[];let r;const d=((C=s[0])==null?void 0:C.datePattern)==="date_split"?"/":"-";switch((w=s[0])==null?void 0:w.dateStyle){case"y":r="YYYY";break;case"y_M":r="YYYY"+d+"MM";break;case"y_M_d":r="YYYY"+d+"MM"+d+"DD";break;case"y_M_d_H":r="YYYY"+d+"MM"+d+"DD HH";break;case"y_M_d_H_m":r="YYYY"+d+"MM"+d+"DD HH:mm";break;case"y_M_d_H_m_s":r="YYYY"+d+"MM"+d+"DD HH:mm:ss";break;default:r="YYYY-MM-dd HH:mm:ss"}const m=e.data.minTime,c=e.data.maxTime,p=e.data.min,h=e.data.max,g={...this.baseOptions,appendPadding:nt(e),data:l,seriesField:a?n?"category":void 0:"category",isGroup:a?!n:!1,isStack:a?!n:!1,meta:a?{values:{type:"time",min:m,max:c,mask:r},tempId:{key:!0}}:{values:{min:p,max:h,mask:r},tempId:{key:!0}}},y=this.setupOptions(e,g),{Bar:x}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(T=>T._),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),b=new x(o,y);return b.on("interval:click",i),ft(e,b),Xt(e,b),b}configXAxis(t,e){const o=super.configXAxis(t,e);if(!o.xAxis)return o;const i=L(t.customStyle).xAxis,l=i.axisValue,n=!!t.data.isDate;if(o.xAxis.label&&(o.xAxis.label.formatter=a=>n?a:D(a,i.axisLabelFormatter)),o.xAxis.position==="top"&&(o.xAxis.position="left"),o.xAxis.position==="bottom"&&(o.xAxis.position="right"),!(l!=null&&l.auto)){const a={xAxis:{...o.xAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...a}}return o}configTooltip(t,e){const o=!!t.data.isDate;let i,l;if(t.customAttr&&(l=L(t.customAttr),l.tooltip)){const n=JSON.parse(JSON.stringify(l.tooltip));n.show?i={fields:["values","field","gap"],formatter:function(a){let s;return o?(s=a.values[0]+" ~ "+a.values[1],n.showGap&&(s=s+" ("+a.gap+")")):(s=D(a.values[0],n.tooltipFormatter)+" ~ "+D(a.values[1],n.tooltipFormatter),n.showGap&&(s=s+" ("+D(a.gap,n.tooltipFormatter)+")")),{value:s,values:a.values,name:a.field}},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0}:i=!1}return{...e,tooltip:i}}configBasicStyle(t,e){const o=!!t.data.isDate,i=!!t.aggregate,l=L(t.customAttr).basicStyle;if(o&&!i){const s=[],r=[];for(let m=0;m<t.data.data.length;m++){const c=t.data.data[m].field;r.indexOf(c)<0&&r.push(c)}for(let m=0;m<r.length;m++){const c=r[m];s.push({name:c,color:l.colors[m%l.colors.length],isCustom:!1})}e={...e,color:m=>{const c=ye(s,h=>h.name===m.field);if(c===void 0)return;const p=P(c.color,l.alpha);return l.gradient?tt(p,!0):p}}}else if(l.gradient){let s=l.colors;s=s.map(r=>{const d=P(r,l.alpha);return tt(d,!0)}),e={...e,color:s}}if(l.radiusColumnBar==="roundAngle"){const s={radius:[l.columnBarRightAngleRadius,l.columnBarRightAngleRadius,l.columnBarRightAngleRadius,l.columnBarRightAngleRadius]};e={...e,barStyle:s}}let n;const a=l.columnWidthRatio??ot.columnWidthRatio;return a>=1&&a<=100?n=a/100:a<1?n=1/100:a>100&&(n=1),n&&(e.barWidthRatio=n),e}setupDefaultOptions(t){const{customAttr:e,senior:o}=t,{label:i}=e;return["left","middle","right"].includes(i.position)||(i.position="middle"),o.functionCfg.emptyDataStrategy="ignoreData",t}configLabel(t,e){const o=!!t.data.isDate,i=!!t.aggregate,l=super.configLabel(t,e);if(!l.label)return{...l,label:!1};const n=L(t.customAttr).label;o&&!i&&(l.label.layout||(l.label.layout=[]),l.label.layout.push({type:"interval-hide-overlap"}),l.label.layout.push({type:"limit-in-plot",cfg:{action:"hide"}}));const a={fields:[],...l.label,formatter:s=>{let r;return o?n.showGap?r=s.gap:r=s.values[0]+" ~ "+s.values[1]:n.showGap?r=D(s.gap,n.labelFormatter):r=D(s.values[0],n.labelFormatter)+" ~ "+D(s.values[1],n.labelFormatter),r}};return{...l,label:a}}configYAxis(t,e){const o=super.configYAxis(t,e);return o.yAxis&&(o.yAxis.position==="left"&&(o.yAxis.position="bottom"),o.yAxis.position==="right"&&(o.yAxis.position="top")),o}setupOptions(t,e){return U(this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configEmptyDataStrategy)(t,e)}}const en=Object.freeze(Object.defineProperty({__proto__:null,RangeBar:tn},Symbol.toStringTag,{value:"Module"})),{t:It}=Y();class on extends Q{constructor(){super("waterfall",[]);v(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","legend-selector","x-axis-selector","y-axis-selector","threshold"]);v(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","columnWidthRatio"],"label-selector":["fontSize","color","vPosition","labelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"x-axis-selector":["position","name","color","fontSize","axisLine","splitLine","axisForm","axisLabel"],"y-axis-selector":["position","name","color","fontSize","axisValue","splitLine","axisForm","axisLabel","axisLabelFormatter","showLengthLimit","axisLine"],threshold:["lineThreshold"]});v(this,"axis",["xAxis","yAxis","filter","drill","extLabel","extTooltip"]);v(this,"axisConfig",{xAxis:{name:`${It("chart.drag_block_type_axis")} / ${It("chart.dimension")}`,type:"d"},yAxis:{name:`${It("chart.drag_block_value_axis")} / ${It("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var d;const{chart:e,container:o,action:i}=t;if(!((d=e.data)!=null&&d.data))return;const n={data:e.data.data,xField:"field",yField:"value",seriesField:"category",appendPadding:nt(e)},a=this.setupOptions(e,n),{Waterfall:s}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(m=>m.af),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("interval:click",i),ft(e,r),Xt(e,r),r}configMeta(t,e){const o=t.yAxis,i={field:{type:"cat"}};if(!(o!=null&&o.length))return{...e,meta:i};const l=o[0],n=L(t.customStyle).yAxis;return i.value={alias:l.name,formatter:a=>D(a,n.axisLabelFormatter)},{...e,meta:i}}configBasicStyle(t,e){const o=L(t.customAttr),{colors:i,gradient:l,alpha:n}=o.basicStyle,[a,s,r]=i;let d;const m=o.basicStyle.columnWidthRatio??ot.columnWidthRatio;return m>=1&&m<=100?d=m/100:m<1?d=1/100:m>100&&(d=1),d&&(e.columnWidthRatio=d),{...e,total:{label:It("chart.waterfall_total"),style:{fill:tt(P(r,n),l,270)}},risingFill:tt(P(a,n),l,270),fallingFill:tt(P(s,n),l,270)}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const l=L(t.customStyle).yAxis.axisValue;if(!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configTooltip(t,e){var r;const i=L(t.customAttr).tooltip,l=t.yAxis;if(!i.show)return{...e,tooltip:!1};const n=(r=i.seriesTooltipFormatter)==null?void 0:r.filter(d=>d.show).reduce((d,m)=>(d[m.id]=m,d),{}),a=Ke(e.data),s={showTitle:!0,customItems(d){var p,h;if(!((p=i.seriesTooltipFormatter)!=null&&p.length))return d;const m=[],c=d[0];return c.data.quotaList?(d.filter(g=>n[g.data.quotaList[0].id]).forEach(g=>{const y=n[g.data.quotaList[0].id],x=(g.value+"").replace(/,/g,"");y.formatterCfg.type="value";const b=D(parseFloat(x),y.formatterCfg),S=W(y.chartShowName)?y.name:y.chartShowName;m.push({...g,name:S,value:b})}),(h=c.data.dynamicTooltipValue)==null||h.forEach(g=>{const y=n[g.fieldId];if(y){const x=(g.value+"").replace(/,/g,""),b=D(parseFloat(x),y.formatterCfg),S=W(y.chartShowName)?y.name:y.chartShowName;m.push({color:"grey",name:S,value:b})}}),m.forEach(g=>{const y=Fo(g);g.color=y}),m):(Object.keys(n).forEach(g=>{const y=n[g];let x=a[g],b="grey";g===l[0].id&&(x=c.data.value,b=c.color);const S=D(x,y.formatterCfg),A=W(y.chartShowName)?y.name:y.chartShowName;if(g===l[0].id){m.unshift({color:b,name:A,value:S});return}m.push({color:b,name:A,value:S})}),m)},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:s}}configLegend(t,e){const o=super.configLegend(t,e);if(!o.legend)return o;const i=L(t.customAttr),{colors:l,gradient:n,alpha:a}=i.basicStyle,[s,r,d]=l;return{...o,legend:{...o.legend,items:[{name:It("chart.increase"),value:"",marker:{style:{fill:tt(P(s,a),n,270)}}},{name:It("chart.decrease"),value:"",marker:{style:{fill:tt(P(r,a),n,270)}}},{name:It("chart.waterfall_total"),value:"",marker:{style:{fill:tt(P(d,a),n,270)}}}]}}}setupOptions(t,e){return U(this.addConditionsStyleColorToData,this.configTheme,this.configLegend,this.configBasicStyle,this.configLabel,this.configTooltip,this.configXAxis,this.configYAxis,this.configMeta,this.configBarConditions)(t,e)}}const ln=Object.freeze(Object.defineProperty({__proto__:null,Waterfall:on},Symbol.toStringTag,{value:"Module"})),Ii=["background-overall-component","border-style","basic-style-selector","x-axis-selector","y-axis-selector","title-selector","legend-selector","label-selector","tooltip-selector","assist-line","function-cfg","jump-set","linkage","threshold"],jt={"background-overall-component":["all"],"border-style":["all"],"label-selector":["fontSize","color"],"tooltip-selector":["fontSize","color","backgroundColor","show"],"basic-style-selector":["colors","alpha","lineWidth","lineSymbol","lineSymbolSize","lineSmooth"],"x-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine"],"y-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine","axisValue","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["slider","emptyDataStrategy"],threshold:["lineThreshold"]},Ni=["xAxis","yAxis","drill","filter","extLabel","extTooltip"],{t:se}=Y(),sn=[];class Bi extends Q{constructor(t="area"){super(t,sn);v(this,"properties",Ii);v(this,"propertyInner",{...jt,"basic-style-selector":[...jt["basic-style-selector"],"gradient","seriesColor"],"label-selector":["seriesLabelVPosition","seriesLabelFormatter","showExtremum"],"tooltip-selector":[...jt["tooltip-selector"],"seriesTooltipFormatter"]});v(this,"axis",[...Ni]);v(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${se("chart.drag_block_type_axis")} / ${se("chart.dimension")}`,type:"d"},yAxis:{name:`${se("chart.drag_block_value_axis")} / ${se("chart.quota")}`,type:"q"}});v(this,"baseOptions",{data:[],xField:"field",yField:"value",seriesField:"category",isStack:!1,interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region",cfg:{start:[{trigger:"element:mousemove",action:"active-region:show"}],end:[{trigger:"element:mouseleave",action:"active-region:hide"}]}}]})}async drawChart(t){var d,m;const{chart:e,container:o,action:i}=t;if(!((m=(d=e.data)==null?void 0:d.data)!=null&&m.length)){e.container=o,ve(e);return}const l=G(e.data.data),n={...this.baseOptions,data:l,appendPadding:nt(e)},a=this.setupOptions(e,n),{Area:s}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(c=>c.Y),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("point:click",i),zo(r,e,a,o),ft(e,r),r}configLabel(t,e){var r;const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const{label:i,basicStyle:l}=L(t.customAttr),n=ii(t),a=(r=i.seriesLabelFormatter)==null?void 0:r.reduce((d,m)=>(d[m.id]=m,d),{});o.label.style.fill=Gt.color;const s={fields:[],...o.label,layout:i.fullDisplay?[{type:"limit-in-plot"}]:o.label.layout,formatter:(d,m)=>{var x;if(d.EXTREME)return"";if(!((x=i.seriesLabelFormatter)!=null&&x.length))return d.value;const c=a==null?void 0:a[d.quotaList[0].id];if(!c)return d.value;if(!c.show)return;const p=c.position==="top"?-2-l.lineSymbolSize:10+l.lineSymbolSize,h=D(d.value,c.formatterCfg),g=li(n,d.value,d.quotaList[0].id)||c.color,y=new Ut({});return y.addShape({type:"text",attrs:{x:0,y:p,text:h,textAlign:"start",textBaseline:"top",fontSize:c.fontSize,fontFamily:t.fontFamily,fill:g}}),y}};return{...o,label:s}}configBasicStyle(t,e){const o=L(t.customAttr),i=JSON.parse(JSON.stringify(o.basicStyle)),l=i.lineSmooth,n={size:i.lineSymbolSize,shape:i.lineSymbol},a={style:{lineWidth:i.lineWidth}},{colors:s,alpha:r}=o.basicStyle,d=[...s,...s];let m;if(o.basicStyle.gradient){const c=new Map,h=L(t.customStyle).yAxis.axisValue,g=!(h!=null&&h.auto)&&h.min&&h.max?h.min/h.max:0;m=y=>{let x;const b=`${y.field}-${y.category}`;return c.has(b)?x=c.get(b):(x=d.shift(),c.set(b,x)),x?{fill:tt(P(x,r),!0,270,g)}:{fill:"rgba(255,255,255,0)"}}}return{...e,smooth:l,line:a,point:n,areaStyle:m}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const i=L(t.customStyle).yAxis;o.yAxis.label&&(o.yAxis.label.formatter=n=>D(n,i.axisLabelFormatter));const l=i.axisValue;if(!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configTooltip(t,e){return super.configMultiSeriesTooltip(t,e)}setupOptions(t,e){return U(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configLabel,this.configTooltip,this.configBasicStyle,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configConditions)(t,e,{},this)}}class nn extends Bi{constructor(){super("area-stack");v(this,"propertyInner",{...this.propertyInner,"label-selector":["vPosition","fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","tooltipFormatter","show"]});v(this,"axisConfig",{...this.axisConfig,extStack:{name:`${se("chart.stack_item")} / ${se("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}});this.baseOptions={...this.baseOptions,isStack:!0},delete this.propertyInner.threshold,this.properties=this.properties.filter(t=>t!=="threshold"),this.axis.push("extStack")}configLabel(t,e){const{label:o,basicStyle:i}=L(t.customAttr);if(!(o!=null&&o.show))return{...e,label:!1};const l=[];if(o.fullDisplay)l.push({type:"limit-in-plot"});else{const s=super.configLabel(t,e);l.push(...s.label.layout)}const n=o.position==="top"?-2-i.lineSymbolSize:8+i.lineSymbolSize,a={position:o.position,offsetY:n,layout:l,style:{fill:o.color,fontSize:o.fontSize},formatter:function(s){return D(s.value,o.labelFormatter)}};return{...e,label:a}}setupDefaultOptions(t){return t.senior.functionCfg.emptyDataStrategy="ignoreData",t}configColor(t,e){return this.configStackColor(t,e)}setupSeriesColor(t,e){return Co(t,e)}configTooltip(t,e){const i=L(t.customAttr).tooltip;if(!i.show)return{...e,tooltip:!1};const l={formatter:function(n){return{name:n.category,value:D(n.value,i.tooltipFormatter)}},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:l}}}const an=Object.freeze(Object.defineProperty({__proto__:null,Area:Bi,StackArea:nn},Symbol.toStringTag,{value:"Module"})),{t:Qt}=Y(),rn=[];class cn extends Q{constructor(t="line"){super(t,rn);v(this,"properties",Ii);v(this,"propertyInner",{...jt,"basic-style-selector":[...jt["basic-style-selector"],"seriesColor"],"label-selector":["seriesLabelVPosition","seriesLabelFormatter","showExtremum"],"tooltip-selector":[...jt["tooltip-selector"],"seriesTooltipFormatter"]});v(this,"axis",[...Ni,"xAxisExt"]);v(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${Qt("chart.drag_block_type_axis")} / ${Qt("chart.dimension")}`,type:"d"},xAxisExt:{name:`${Qt("chart.chart_group")} / ${Qt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},yAxis:{name:`${Qt("chart.drag_block_value_axis")} / ${Qt("chart.quota")}`,type:"q"}})}async drawChart(t){var c,p;const{chart:e,action:o,container:i}=t;if(!((p=(c=e.data)==null?void 0:c.data)!=null&&p.length)){e.container=i,ve(e);return}const l=G(e.data.data),a=L(e.customAttr).basicStyle.colors,s={data:l,xField:"field",yField:"value",seriesField:"category",appendPadding:nt(e),color:a,interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region",cfg:{start:[{trigger:"element:mousemove",action:"active-region:show"}],end:[{trigger:"element:mouseleave",action:"active-region:hide"}]}}]},r=this.setupOptions(e,s),{Line:d}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(h=>h.a2),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),m=new d(i,r);return m.on("point:click",o),zo(m,e,r,i),ft(e,m),m}configLabel(t,e){var r;const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const{label:i,basicStyle:l}=L(t.customAttr),n=ii(t),a=(r=i.seriesLabelFormatter)==null?void 0:r.reduce((d,m)=>(d[m.id]=m,d),{});o.label.style.fill=Gt.color;const s={fields:[],...o.label,layout:i.fullDisplay?[{type:"limit-in-plot"}]:o.label.layout,formatter:(d,m)=>{var x;if(d.EXTREME)return"";if(!((x=i.seriesLabelFormatter)!=null&&x.length))return d.value;const c=a==null?void 0:a[d.quotaList[0].id];if(!c)return d.value;if(!c.show)return;const p=c.position==="top"?-2-l.lineSymbolSize:10+l.lineSymbolSize,h=D(d.value,c.formatterCfg),g=li(n,d.value,d.quotaList[0].id)||c.color,y=new Ut({});return y.addShape({type:"text",attrs:{x:0,y:p,text:h,textAlign:"start",textBaseline:"top",fontSize:c.fontSize,fontFamily:t.fontFamily,fill:g}}),y}};return{...o,label:s}}configBasicStyle(t,e){const o=L(t.customAttr),i=JSON.parse(JSON.stringify(o.basicStyle)),l=i.lineSmooth,n={size:i.lineSymbolSize,shape:i.lineSymbol},a={lineWidth:i.lineWidth};return{...e,smooth:l,point:n,lineStyle:a}}configCustomColors(t,e){const o=L(t.customAttr).basicStyle,i=o.colors.map(l=>P(l,o.alpha));return{...e,color:i}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const i=L(t.customStyle).yAxis;o.yAxis.label&&(o.yAxis.label.formatter=n=>D(n,i.axisLabelFormatter));const l=i.axisValue;if(!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configTooltip(t,e){var s;const i=L(t.customAttr).tooltip;if(!i.show)return{...e,tooltip:!1};const l=t.xAxisExt,n=(s=i.seriesTooltipFormatter)==null?void 0:s.filter(r=>r.show).reduce((r,d)=>(r[d.id]=d,r),{}),a={showTitle:!0,customItems(r){var c,p;if(!((c=i.seriesTooltipFormatter)!=null&&c.length))return r;const d=r[0];if(!d.data.quotaList)return r;const m=[];return r.filter(h=>n[h.data.quotaList[0].id]).forEach(h=>{const g=n[h.data.quotaList[0].id],y=D(parseFloat(h.value),g.formatterCfg);let x=W(g.chartShowName)?g.name:g.chartShowName;(l==null?void 0:l.length)>0&&(x=h.data.category),m.push({...h,name:x,value:y})}),(p=d.data.dynamicTooltipValue)==null||p.forEach(h=>{const g=n[h.fieldId];if(g){const y=D(parseFloat(h.value),g.formatterCfg),x=W(g.chartShowName)?g.name:g.chartShowName;m.push({color:"grey",name:x,value:y})}}),m},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:a}}setupSeriesColor(t,e){return oi(t,e)}configLegend(t,e){var a;const o=super.configLegend(t,e);if(!o.legend)return o;const i=t.xAxisExt[0];if(((a=i==null?void 0:i.customSort)==null?void 0:a.length)>0){const s=i.customSort??[];if(s!=null&&s.length){const r=o.data;r==null||r.forEach(d=>{const m=d.category;m&&!s.includes(m)&&s.push(m)}),o.meta={...o.meta,category:{type:"cat",values:s}}}}const l=L(t.customStyle);let n;return l&&l.legend?n=ce(JSON.parse(JSON.stringify(l.legend)),Lt).size:n=Lt.size,o.legend.marker.style=s=>({r:n,fill:s.stroke}),o}setupOptions(t,e){return U(this.configTheme,this.configEmptyDataStrategy,this.configGroupColor,this.configLabel,this.configTooltip,this.configBasicStyle,this.configCustomColors,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configConditions)(t,e)}}const un=Object.freeze(Object.defineProperty({__proto__:null,Line:cn},Symbol.toStringTag,{value:"Module"})),{t:Te}=Y(),dn=[];class fn extends Q{constructor(t="stock-line"){super(t,dn);v(this,"properties",["background-overall-component","border-style","basic-style-selector","legend-selector","x-axis-selector","y-axis-selector","title-selector","tooltip-selector","function-cfg","jump-set","linkage"]);v(this,"propertyInner",{...jt,"function-cfg":["emptyDataStrategy"],"y-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine","axisLabelFormatter"],"legend-selector":["fontSize","color","show"]});v(this,"axis",["xAxis","yAxis","filter","extLabel","extTooltip"]);v(this,"axisConfig",{xAxis:{name:`${Te("common.component.date")} / ${Te("chart.dimension")}`,limit:1,type:"d"},yAxis:{name:`${Te("chart.k_line_yaxis_tip")} / ${Te("chart.quota")}`,limit:4,type:"q"}});v(this,"calculateMovingAverage",(t,e,o)=>{const i=o.xAxis,l=o.yAxis,n=i[0].dataeaseName,a=l[1].dataeaseName,s=[];for(let r=0;r<t.length;r++)if(r<e)s.push({[n]:t[r][n],value:null});else{const d=t.slice(r-e+1,r+1).reduce((m,c)=>m+c[a],0);s.push({[n]:t[r][n],value:parseFloat((d/e).toFixed(3))})}return s});v(this,"calculateMinMax",t=>t.reduce((e,o)=>{const l=Object.values(o).filter(n=>typeof n=="number");if(l.length>0){const n=Math.max(...l),a=Math.min(...l);e.maxValue=Math.max(e.maxValue,n),e.minValue=Math.min(e.minValue,a)}return e},{maxValue:Number.NEGATIVE_INFINITY,minValue:Number.POSITIVE_INFINITY}));v(this,"registerEvent",(t,e,o)=>{let i=!0;e.on("legend-item:click",l=>{const{value:n}=l.target.get("delegateObject").item;if(n==="k")i=!i,e.chart.geometries.forEach(a=>{a.type==="schema"&&a.changeVisible(i)});else{const a=e.chart.geometries.filter(d=>d.type==="line"),s=e.chart.geometries.filter(d=>d.type==="point");let r=0;for(const d of o.keys())r++,d===n&&(a[r-1].changeVisible(!a[r-1].visible),s[r-1].changeVisible(!s[r-1].visible))}}),e.on("afterrender",l=>{var a,s;let n=!1;if(e.chart.options.slider.start===.5&&e.chart.options.slider.end===1&&(n=!0),(s=(a=l.view)==null?void 0:a.options)!=null&&s.scales){const r=Math.floor(.5*t.length),d=Math.ceil(1*t.length),m=t.slice(r,d),{maxValue:c,minValue:p}=this.calculateMinMax(n?m:l.view.filteredData),h=l.view.options.scales;Object.keys(h).forEach(g=>{h[g].max&&(h[g].max=c),h[g].min&&(h[g].min=p)})}}),e.on("legend-item-group:click",l=>{var n,a;if((a=(n=l.view)==null?void 0:n.options)!=null&&a.scales){const{maxValue:s,minValue:r}=this.calculateMinMax(l.view.filteredData),d=l.view.options.scales;Object.keys(d).forEach(m=>{d[m].max&&(d[m].max=s),d[m].min&&(d[m].min=r)})}}),e.on("slider:valuechanged",l=>{const n=l.gEvent.currentTarget.cfg.component.cfg.start,a=l.gEvent.currentTarget.cfg.component.cfg.end;e.chart.options.slider.start=n,e.chart.options.slider.end=a;const s=Math.floor(n*t.length),r=Math.ceil(a*t.length),d=t.slice(s,r),{maxValue:m,minValue:c}=this.calculateMinMax(d),p=l.view.options.scales;Object.keys(p).forEach(h=>{p[h].max&&(p[h].max=m),p[h].min&&(p[h].min=c)})})})}async drawChart(t){var I,B,F,M,$;const{chart:e,action:o,container:i}=t;if(!((B=(I=e.data)==null?void 0:I.data)!=null&&B.length))return;const l=e.xAxis,n=e.yAxis;if(n.length!=4)return;const a=L(e.customAttr).basicStyle,s=[],r=a.alpha;a.colors.forEach(R=>{s.push(P(R,r))});const d=L((F=e.data)==null?void 0:F.tableRow),m=l[0].dataeaseName,c=[5,10,20,60,120,180],p=[{name:"日K",value:"k",marker:{symbol:(R,V,X)=>{const H=X*1,q=X;return[["M",R-H-1/2,V-q/2],["L",R+H+1/2,V-q/2],["L",R+H+1/2,V+q/2],["L",R-H-1/2,V+q/2],["Z"],["M",R,V+10/2],["L",R,V-10/2]]},style:{fill:"red",stroke:"red",lineWidth:2}}}],h=new Map;c.forEach(R=>{h.set("ma"+R,this.calculateMovingAverage(d,R,e))}),d.forEach(R=>{var X;const V=R[m];for(const[H,q]of h)R[H]=(X=q.find(At=>At[m]===V))==null?void 0:X.value});const g=[];let y=0;const x=.5,b=1,S=Math.floor(x*d.length),A=Math.ceil(b*d.length),C=d.slice(S,A),{maxValue:w,minValue:T}=this.calculateMinMax(C);for(const R of h.keys())y++,g.push({type:"line",top:!0,options:{smooth:!1,xField:m,yField:R,color:s[y-1],xAxis:null,yAxis:{label:!1,min:T,max:w,grid:null,line:null},lineStyle:{lineWidth:2}}}),p.push({name:R.toUpperCase(),value:R,marker:{symbol:"hyphen",style:{stroke:s[y-1],lineWidth:2}}});const z=e.xAxis??[];let N;const O=((M=z[0])==null?void 0:M.datePattern)==="date_split"?"/":"-";switch(($=z[0])==null?void 0:$.dateStyle){case"y":N="YYYY";break;case"y_M":N="YYYY"+O+"MM";break;case"y_M_d":N="YYYY"+O+"MM"+O+"DD";break;case"y_M_d_H":N="YYYY"+O+"MM"+O+"DD HH";break;case"y_M_d_H_m":N="YYYY"+O+"MM"+O+"DD HH:mm";break;case"y_M_d_H_m_s":N="YYYY"+O+"MM"+O+"DD HH:mm:ss";break;default:N="YYYY-MM-dd HH:mm:ss"}const _=this.setupOptions(e,{data:d,slider:{start:.5,end:1,textStyle:{fontFamily:e.fontFamily}},plots:[{type:"stock",top:!0,options:{meta:{[m]:{mask:N}},stockStyle:{stroke:"black",lineWidth:.5},yAxis:{label:{},position:"left",min:T,max:w},xField:m,yField:[n[0].dataeaseName,n[1].dataeaseName,n[2].dataeaseName,n[3].dataeaseName],legend:{position:"top",custom:!0,items:p}}},...g]}),{Mix:k}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(R=>R.a5),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),E=new k(i,_);return this.registerEvent(d,E,h),E.on("schema:click",R=>{var At;const V=R.data.data[m],H=L((At=e.data)==null?void 0:At.data).filter(et=>et.field===V),q=[];if(H.forEach(et=>{q.push({...et.quotaList[0],value:et.value})}),H.length){const et={x:R.x,y:R.y,data:{data:{...R.data.data,value:q[0].value,name:V,dimensionList:H[0].dimensionList,quotaList:q}}};o(et)}}),E}configBasicStyle(t,e){const o=L(t.customAttr),i=JSON.parse(JSON.stringify(o.basicStyle)),l=i.lineSmooth,n={size:i.lineSymbolSize,shape:i.lineSymbol},a={lineWidth:i.lineWidth},s=[];return e.plots.forEach(r=>{r.type==="stock"&&s.push({...r}),r.type==="line"&&s.push({...r,options:{...r.options,smooth:l,point:n,lineStyle:a}})}),{...e,plots:s}}configTooltip(t,e){const o=L(t.customAttr).tooltip;t.xAxis;const i=[];e.plots.filter(c=>c.type==="line").forEach(c=>{i.push(c)});const n=e.plots.filter(c=>c.type==="stock")[0];if(!o.show){const c={...n.options,tooltip:{showContent:!1}};return i.push({...n,options:c}),{...e,plots:i}}const a=t.data.fields,s=c=>{var y;const p=c.map(x=>{const b=a.find(w=>w.dataeaseName===x.name),S=(b==null?void 0:b.chartShowName)||(b==null?void 0:b.name)||x.name,A=S.startsWith("ma")?S.toUpperCase():S;o.tooltipFormatter.decimalCount=3;const C=D(x.value,o.tooltipFormatter);return{...x,name:A,value:C,color:x.color}}),h=p.some(x=>!x.name.startsWith("MA")),g=p.filter(x=>!x.name.startsWith("MA"));return h?[{name:"日K",value:"",marker:!0,color:(y=g[0])==null?void 0:y.color},...g,...p.filter(x=>x.name.startsWith("MA"))]:p},r=c=>{const p=c.name.startsWith("MA")||!c.value?10:5,h=c.name.startsWith("MA")||!c.value?5:9,g=c.name.startsWith("MA")||!c.value?0:2;return`
        <li style="display: flex; align-items: center; margin-bottom: 10px;">
          <div>
            <span
              style="
                background-color: ${c.color};
                width: ${p}px;
                height: ${p}px;
                border-radius: 50%;
                display: inline-block;
                margin-right: ${h}px;
                margin-left: ${g}px;
              "></span>
          </div>
          <div style="display: flex; justify-content: space-between; width: 100%;">
            <span style="margin-right: 15px;">${c.name}</span>
            <span>${c.name.startsWith("MA")&&c.value==="0"?"-":c.value}</span>
          </div>
        </li>
      `},d=(c,p)=>`
        <div style="padding: 10px 0;">
          <div style="margin-bottom: 10px;">${c}</div>
          <ul style="list-style: none; padding: 0;">
            ${p.map(r).join("")}
          </ul>
        </div>
      `,m={...n.options,tooltip:{showMarkers:!0,showCrosshairs:!0,showNil:!0,crosshairs:{follow:!0,text:(c,p,h)=>c==="y"?{content:p&&p.toFixed(0)}:{content:h[0].title,position:"end"}},showContent:!0,customItems:s,customContent:d}};return i.push({...n,options:m}),{...e,plots:i}}configXAxis(t,e){const o=super.configXAxis(t,e);if(!o)return e;const i=[],l=e.plots.filter(s=>s.type==="line"),n=e.plots.filter(s=>s.type==="stock")[0],a={...n,options:{...n.options,xAxis:o.xAxis?{...n.options.xAxis,...o.xAxis}:{label:!1,line:null}}};return i.push(a),l.forEach(s=>{i.push(s)}),{...e,plots:i}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o)return e;const i=L(t.customStyle).yAxis,l=[],n=e.plots.filter(d=>d.type==="line"),a=e.plots.filter(d=>d.type==="stock")[0];let s=!1;o.yAxis.label&&(s={...o.yAxis.label,formatter:d=>D(d,i.axisLabelFormatter)});const r={...a,options:{...a.options,yAxis:s?{...a.options.yAxis,...o.yAxis,label:s}:{...o.yAxis,label:s,grid:null,line:null}}};return l.push(r),n.forEach(d=>{l.push(d)}),{...e,plots:l}}customConfigEmptyDataStrategy(t,e){const{data:o}=e;if(!(o!=null&&o.length))return e;const i=L(t.senior).functionCfg.emptyDataStrategy;if(i==="ignoreData")for(let n=o.length-1;n>=0;n--){const a=o[n];Object.keys(a).forEach(s=>{s.startsWith("f_")&&a[s]===null&&o.splice(n,1)})}return(i==="breakLine"||i==="setZero")&&((n,a)=>{a.forEach(s=>{Object.keys(s).forEach(r=>{r.startsWith("f_")&&s[r]===null&&(s[r]=n==="breakLine"?null:0)})})})(i,o),e}configLegend(t,e){let o={},i;const l=e.plots.filter(r=>r.type==="stock")[0];if(t.customStyle&&(i=L(t.customStyle),i.legend)){const r=JSON.parse(JSON.stringify(i.legend));r.show?o={...l.options.legend,itemName:{style:{fill:r.color,fontSize:r.fontSize}}}:o=!1}const n=[],a={...l.options,legend:o};return e.plots.filter(r=>r.type==="line").forEach(r=>{n.push(r)}),n.push({...l,options:a}),{...e,plots:n}}setupOptions(t,e){return U(this.configTheme,this.configBasicStyle,this.configXAxis,this.configYAxis,this.configTooltip,this.configLegend,this.customConfigEmptyDataStrategy)(t,e)}}const mn=Object.freeze(Object.defineProperty({__proto__:null,StockLine:fn},Symbol.toStringTag,{value:"Module"})),{t:Xo}=Y(),pn=[];class hn extends Q{constructor(){super("liquid",pn);v(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","misc-selector","title-selector","threshold"]);v(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha"],"label-selector":["fontSize","color","labelFormatter"],"misc-selector":["liquidShape","liquidSize","liquidMaxType","liquidMaxField"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],threshold:["liquidThreshold"]});v(this,"axis",["yAxis","filter"]);v(this,"axisConfig",{yAxis:{name:`${Xo("chart.drag_block_progress")} / ${Xo("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var d,m;const{chart:e,container:o,action:i}=t;if(!((d=e.data)!=null&&d.series)||!e.yAxis.length)return;const l={percent:0},n=this.setupOptions(e,l),{Liquid:a}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(c=>c.aa),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),s=new a(o,n);s.on("afterrender",()=>{var c,p;i({from:"liquid",data:{type:"liquid",max:(p=(c=e.data)==null?void 0:c.series[0])==null?void 0:p.data[0]}})});const r=(m=e.data)==null?void 0:m.series.some(c=>{var p;return!((p=c.data)!=null&&p[0])});if(this.configEmptyDataStyle(r?[]:[1],o,s),!r)return s}configTheme(t,e){const o=L(t.customAttr),i=[];if(o.basicStyle){const s=o.basicStyle;s.colors.forEach(r=>{i.push(P(r,s.alpha))})}const l=L(t.customStyle);let n;l.background&&(n=P(l.background.color,l.background.alpha));const a={styleSheet:{brandColor:i[0],paletteQualitative10:i,paletteQualitative20:i,backgroundColor:n}};return{...e,theme:a}}configMisc(t,e){var r,d,m;const o=L(t.customAttr);let i=0;t.data.series.length>0&&(i=t.data.series[0].data[0]);let l,n,a;if(o.misc){const c=o.misc,p=(m=(d=t.data)==null?void 0:d.series[((r=t.data)==null?void 0:r.series.length)-1])==null?void 0:m.data[0];c.liquidMaxType==="dynamic"?l=p:l=c.liquidMax?c.liquidMax:p,n=(c.liquidSize?c.liquidSize:qt.liquidSize)/100,a=c.liquidShape??qt.liquidShape}const s={percent:i/l,radius:n,shape:a};return{...e,...s}}configLabel(t,e){var a;const o=L(t.customAttr),i=e.percent;if(i>1&&(e={...e,percent:1}),!((a=o.label)!=null&&a.show))return{...e,statistic:{content:!1}};const l=o.label,n=l.labelFormatter;return{...e,statistic:{content:{style:{fontSize:l.fontSize.toString()+"px",color:l.color},formatter:()=>D(i,n)}}}}configThreshold(t,e){var i;const o=L(t.senior);if((i=o==null?void 0:o.threshold)!=null&&i.enable){const{liquidThreshold:l}=o==null?void 0:o.threshold;if(l){const{paletteQualitative10:n}=e.theme.styleSheet;return{...e,liquidStyle:()=>{const s=l.split(",");let r=0;return s.forEach((d,m)=>{e.percent>parseFloat(d)/100&&(r=m+1)}),{fill:n[r%n.length],stroke:n[r%n.length]}}}}}return e}setupDefaultOptions(t){return t.customAttr.label={...t.customAttr.label,fontSize:12,show:!0,labelFormatter:{type:"percent",thousandSeparator:!0,decimalCount:2}},t}setupOptions(t,e){return U(this.configTheme,this.configMisc,this.configLabel,this.configThreshold)(t,e)}}const gn=Object.freeze(Object.defineProperty({__proto__:null,Liquid:hn},Symbol.toStringTag,{value:"Module"}));class Di extends eo{configLabel(u,t){const e=Ai(u);return Ft(t.label,e),t}configStyle(u,t){const e=ys(u);return Ft(t.style,e),t}configTooltip(u,t){const e=Ci(u);return Ft(t.tooltip,e),t}configLegend(u,t){const e=bs(u);return Ft(t,{legend:e}),t}configEmptyDataStrategy(u,t){var l,n;const{functionCfg:e}=L(u.senior),o=e.emptyDataStrategy;if(!o||o==="breakLine")return t;const i=G(t.source.data);if(o==="setZero"&&i.forEach(a=>{var s;a.value===null&&(a.value=0),((s=a.dynamicTooltipValue)==null?void 0:s.length)>0&&a.dynamicTooltipValue.forEach(r=>{r.value===null&&(r.value=0)})}),o==="ignoreData")for(let a=i.length-1;a>=0;a--){i[a].value===null&&i.splice(a,1);for(let s=((n=(l=i[a])==null?void 0:l.dynamicTooltipValue)==null?void 0:n.length)-1;s>=0;s--)i[a].dynamicTooltipValue[s].value===null&&i[a].dynamicTooltipValue.splice(s,1)}return t.source.data=i,t}configZoomButton(u,t){_s(u,t)}constructor(u,t){super(Pt.L7_PLOT,u),this.defaultData=t}}const Mi=["background-overall-component","border-style","basic-style-selector","title-selector","label-selector","tooltip-selector","function-cfg","map-mapping","jump-set","linkage"],Dt={"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","areaBorderColor","zoom"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"label-selector":["color","fontSize","labelBgColor","labelShadow","labelShadowColor","showDimension","showQuota"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"],"function-cfg":["emptyDataStrategy"],"map-mapping":[""]},Ri=["xAxis","yAxis","area","drill","filter","extLabel","extTooltip"],oo=(f,u,t,e,o,i)=>{var l;["bubble-map","map"].includes(f.type)&&(t=(l=u.source.data.dataArray)==null?void 0:l.filter(n=>{var a;return((a=n.dimensionList)==null?void 0:a.length)>0}).reduce((n,a)=>(n.find(r=>{var d;return(d=i==null?void 0:i.areaId)!=null&&d.startsWith("custom_")?r.areaName===a.areaName:r.name===a.name||r.adcode&&r.adcode===a.adcode})||n.push(a),n),[])),ae[f.container]?ae[f.container].update(e,f,u,t,o,i):new Pi(e,f,u,t,o,i)},ae={};class Pi{constructor(u,t,e,o,i,l){v(this,"popupTimeoutId",null);v(this,"popupIntervalId",null);v(this,"isPaused",!1);v(this,"currentIndex",0);v(this,"scene");v(this,"chart");v(this,"view");v(this,"data");v(this,"stayTime");v(this,"intervalTime");v(this,"popup");v(this,"customSubArea");v(this,"drawOption");v(this,"onMouseEnterHandler");v(this,"onMouseLeaveHandler");v(this,"onVisibilityChangeHandler");v(this,"handleVisibilityChange",()=>{document.hidden?this.clearPreviousInstance(this.chart.container):this.startCarouselPopups()});v(this,"pauseCarouselPopups",()=>{var u;this.popup&&((u=this.popup)==null||u.remove()),this.removeStyle(),this.isPaused=!0,this.clearExistingTimers()});v(this,"resumeCarouselPopups",()=>{this.isPaused&&(this.isPaused=!1,this.startCarouselPopups())});v(this,"clearExistingTimers",()=>{this.popupTimeoutId!==null&&(clearTimeout(this.popupTimeoutId),this.popupTimeoutId=0),this.popupIntervalId!==null&&(clearInterval(this.popupIntervalId),this.popupIntervalId=0)});this.onMouseEnterHandler=this.pauseCarouselPopups.bind(this),this.onMouseLeaveHandler=this.resumeCarouselPopups.bind(this),this.onVisibilityChangeHandler=this.handleVisibilityChange.bind(this),this.clearExistingTimers=this.clearExistingTimers.bind(this),this.init(u,t,e,o,i,l)}update(u,t,e,o,i,l){this.init(u,t,e,o,i,l)}init(u,t,e,o,i,l){var n,a,s,r,d,m,c,p,h,g;if(this.view=e,this.chart=t,this.scene=u,this.data=o,this.popup=null,this.currentIndex=0,this.customSubArea=i,this.drawOption=l,this.clearPreviousInstance(this.chart.container),(a=(n=this.chart.customAttr)==null?void 0:n.tooltip)!=null&&a.show&&((d=(r=(s=this.chart.customAttr)==null?void 0:s.tooltip)==null?void 0:r.carousel)!=null&&d.enable)&&this.data.length>0){this.popup=new ui({closeButton:!1,maxWidth:600});const y=(c=(m=this.chart.customAttr)==null?void 0:m.tooltip)==null?void 0:c.carousel;this.stayTime=y.stayTime*1e3,this.intervalTime=y.intervalTime*1e3,this.startCarouselPopups();const x=document.getElementById(this.chart.container);x.addEventListener("mouseenter",this.pauseCarouselPopups),x.addEventListener("mouseleave",this.resumeCarouselPopups),this.chart.type==="symbolic-map"&&((h=(p=u==null?void 0:u.getLayers())==null?void 0:p[0])==null||h.addListener("touchend",()=>{this.pauseCarouselPopups()}),(g=u==null?void 0:u.getMapCanvasContainer())==null||g.addEventListener("touchend",()=>{this.resumeCarouselPopups()})),document.addEventListener("visibilitychange",this.handleVisibilityChange),ae[this.chart.container]=this}}clearPreviousInstance(u){var t;if(ae[u]){const e=ae[u];this.clearExistingTimers(),(t=e.popup)==null||t.remove(),e.removeStyle()}}startCarouselPopups(){this.clearExistingTimers(),this.carouselPopups()}carouselPopups(){const u=t=>{this.removeStyle();const e=document.getElementById(this.chart.container);if(e){if(this.chart.type==="symbolic-map"){const o=e.getElementsByClassName("l7-popup-"+this.chart.container);for(const i of Array.from(o))i.classList.add("l7-popup-hide");this.createSymbolicMapPopup(t)}else{if(this.chart.type==="map"){const o=e.getElementsByClassName("l7plot-tooltip-container");for(const i of Array.from(o)){const l=i;l.style.display="none"}}this.createPopup(t)}this.clearExistingTimers(),this.popupTimeoutId=window.setTimeout(()=>{var o;this.currentIndex++,(o=this.popup)==null||o.remove(),this.cancelHighlightLayer(t),this.currentIndex>=this.data.length&&(this.currentIndex=0),this.popupIntervalId=window.setTimeout(()=>{u(this.currentIndex)},this.intervalTime)},this.stayTime)}else this.clearExistingTimers()};u(this.currentIndex)}removeStyle(){var t;const u=document.getElementById("style-"+this.chart.container);u&&(u.remove(),(t=u.parentNode)==null||t.removeChild(u))}createPopup(u){var n,a,s,r,d,m;const t=this.view.tooltip.options.domStyles,e=t["l7plot-tooltip"]["background-color"],o=t["l7plot-tooltip"]["font-size"],i=document.createElement("style");i.id="style-"+this.chart.container,i.innerHTML=`
            #${this.chart.container} .l7-popup-content {
                background-color: ${e} !important;
                font-size: ${o};
                padding: 10px 10px 6px;
                line-height: 1.6;
            }
            #${this.chart.container} .l7-popup-tip {
                border-top-color: ${e} !important;
            }
        `,document.head.appendChild(i);const l=this.getPopupData(u);if(l.data){let c="";this.getTooltipItems(l.data).forEach(h=>{c+=`
                    <li style="list-style-type: none; margin-bottom: 4px; white-space: nowrap; display: flex; justify-content: space-between;">
                        <span style="${this.objectToSemicolonSeparated(t["l7plot-tooltip__name"])}">${h.name}</span>
                        <span style="${this.objectToSemicolonSeparated(t["l7plot-tooltip__value"])}">${h.value}</span>
                    </li>`});const p=`
                <div>
                <div style="${this.objectToSemicolonSeparated(t["l7plot-tooltip__title"])}">${l.data.name}</div>
                    <ul style="${this.objectToSemicolonSeparated(t["l7plot-tooltip__list"])}">
                        ${c}
                    </ul>
                </div>
            `;if(this.popup.setLngLat({lng:l.centroid[0],lat:l.centroid[1]}),this.popup.setHTML(p),this.popup.closeButton=!1,this.view.addLayer(this.popup),(a=(n=this.view.scene.getLayers())==null?void 0:n.find(h=>h.name==="highlightLayer"))==null||a.setData(this.getActiveData(u)),this.chart.type==="bubble-map"){const{_id:h}=(r=(s=this.view.scene.getLayers())==null?void 0:s.find(g=>g.name==="bubbleLayer"))==null?void 0:r.layerSource.data.dataArray.find(g=>g.name===this.data[u].name);(m=(d=this.view.scene.getLayers())==null?void 0:d.find(g=>g.name==="bubbleLayer"&&g.coordCenter))==null||m.setActive(h,{color:"rgba(30,90,255,1)"})}}}getActiveData(u){var t,e,o;if((e=(t=this.drawOption)==null?void 0:t.areaId)!=null&&e.startsWith("custom_")){const i={type:"FeatureCollection",features:[]},l=this.customSubArea.find(a=>a.name===this.data[u].areaName),n=this.view.currentDistrictData.features.reduce((a,s)=>(a["156"+s.properties.adcode]=s,a),{});return(o=l==null?void 0:l.scopeArr)==null||o.forEach(a=>{n[a]&&i.features.push(n[a])}),i}return{type:"FeatureCollection",features:[this.view.currentDistrictData.features.find(i=>i.properties.name===this.data[u].name)]}}getPopupData(u){var t,e,o,i;if((e=(t=this.drawOption)==null?void 0:t.areaId)!=null&&e.startsWith("custom_")){const l=this.data[u],n=(o=this.customSubArea)==null?void 0:o.find(a=>a.name===l.areaName);return l.name=l.areaName,{data:l,centroid:n.centroid}}else return{data:this.data[u],centroid:(i=this.view.currentDistrictData.features.find(l=>l.properties.name===this.data[u].name))==null?void 0:i.properties.centroid}}objectToSemicolonSeparated(u){let t="";for(const e in u)u.hasOwnProperty(e)&&(t+=`${this.convertToSnakeCase(e)}:${u[e]};`);return t}cancelHighlightLayer(u){var t,e,o,i,l,n,a,s,r,d,m,c,p;if((o=(e=(t=this.view.scene)==null?void 0:t.getLayers())==null?void 0:e.find(h=>h.name==="highlightLayer"))==null||o.setData({type:"FeatureCollection",features:[]}),this.chart.type==="bubble-map"){const{_id:h}=(n=(l=(i=this.view.scene)==null?void 0:i.getLayers())==null?void 0:l.find(g=>g.name==="bubbleLayer"))==null?void 0:n.layerSource.data.dataArray.find(g=>g.name===this.data[u].name);(s=(a=this.view.scene.getLayers())==null?void 0:a.find(g=>g.name==="bubbleLayer"&&g.coordCenter))==null||s.setActive(h,{color:this.view.scene.getLayers().find(g=>g.name==="bubbleLayer").styleAttributeService.getLayerStyleAttribute("color").scale.field})}if(this.chart.type==="symbolic-map"){const h=this.chart.xAxis[0].dataeaseName,g=this.chart.xAxis[1].dataeaseName,{_id:y}=(m=(d=(r=this.scene)==null?void 0:r.getLayers())==null?void 0:d.find(x=>x.type==="PointLayer"))==null?void 0:m.layerSource.data.dataArray.find(x=>{const b=this.data[u][h],S=this.data[u][g];return x[h]===b&&x[g]===S});(p=(c=this.scene.getLayers())==null?void 0:c.find(x=>x.type==="PointLayer"&&x.coordCenter))==null||p.setActive(y,{color:this.scene.getLayers().find(x=>x.type==="PointLayer").styleAttributeService.getLayerStyleAttribute("color").scale.field})}}convertToSnakeCase(u){return u.replace(/([A-Z])/g,t=>"-"+t.toLowerCase())}getTooltipItems(u){var a,s,r,d;const t=[],i=(a=L(this.chart.customAttr).tooltip.seriesTooltipFormatter)==null?void 0:a.filter(m=>m.show).reduce((m,c)=>(m[c.id]=c,m),{});if(W(i))return t;const l=u,n=i[(r=(s=l.quotaList)==null?void 0:s[0])==null?void 0:r.id];if(!W(n)){const m=parseFloat(l.value),c=D(m,n.formatterCfg),p=W(n.chartShowName)?n.name:n.chartShowName;t.push({...l,name:p,value:`${c??""}`})}return(d=l.dynamicTooltipValue)==null||d.forEach(m=>{const c=i[m.fieldId];if(c){const p=D(parseFloat(m.value),c.formatterCfg),h=W(c.chartShowName)?c.name:c.chartShowName;t.push({color:"grey",name:h,value:`${p??""}`})}}),t}createSymbolicMapPopup(u){const t=()=>{var l,n,a,s,r,d;const i=this.chart.customAttr?L(this.chart.customAttr):null;if((l=i==null?void 0:i.tooltip)!=null&&l.show){if(!this.popup)return;const{tooltip:m}=J(i);let c=m.showFields||[];(!m.showFields||m.showFields.length===0)&&(c=[...this.chart.xAxisExt.map(S=>`${S.dataeaseName}@${S.name}`),...this.chart.xAxis.map(S=>`${S.dataeaseName}@${S.name}`)]);const p=document.createElement("style");p.id="style-"+this.chart.container,p.innerHTML=`
          #${this.chart.container} .l7-popup-content {
            background-color: ${m.backgroundColor} !important;
            padding: 6px 10px 6px;
            line-height: 1.6;
          }
          #${this.chart.container} .l7-popup-tip {
           border-top-color: ${m.backgroundColor} !important;
          }
        `,document.head.appendChild(p);const h=this.chart.xAxis[0].dataeaseName,g=this.chart.xAxis[1].dataeaseName,y=`<div style='font-size:${m.fontSize}px;color:${m.color};'>`,x="</div>",b=this.view.sourceOption.data[u];if(b&&((n=b.details)!=null&&n.length)){const S={...b,...Object.fromEntries(o(b.details))},A=e(m,S,c),C=`${y}${A}${x}`;this.popup.setLngLat({lng:b[h],lat:b[g]}),this.popup.setHTML(C),this.popup.closeButton=!1,this.scene.addPopup(this.popup),this.popup.addTo(this.scene);const{_id:w}=(s=(a=this.scene.getLayers())==null?void 0:a.find(T=>T.type==="PointLayer"))==null?void 0:s.layerSource.data.dataArray.find(T=>{const z=this.data[u][h],N=this.data[u][g];return T[h]===z&&T[g]===N});(d=(r=this.scene.getLayers())==null?void 0:r.find(T=>T.type==="PointLayer"&&T.coordCenter))==null||d.setActive(w,{color:"rgba(30,90,255,1)"})}}},e=(i,l,n)=>{let a="";return i.customContent?(a=i.customContent,n.forEach(s=>{a=a.replace(`\${${s.split("@")[1]}}`,l[s.split("@")[0]])})):n.forEach(s=>{a+=`<span style="margin-bottom: 4px">${s.split("@")[1]}: ${l[s.split("@")[0]]}</span><br>`}),a.replace(/\n/g,"<br>")},o=i=>{const l=new Map;return i.forEach(n=>{Object.entries(n).forEach(([a,s])=>{if(l.has(a)){const r=l.get(a);r!==s&&l.set(a,`${r}, ${s}`)}else l.set(a,s)})}),l};t()}}const yn=Object.freeze(Object.defineProperty({__proto__:null,CarouselManager:Pi,carouselManagerInstances:ae,configCarouselTooltip:oo},Symbol.toStringTag,{value:"Module"})),{t:Ee}=Y();class xn extends Di{constructor(){super("bubble-map");v(this,"properties",[...Mi,"bubble-animate"]);v(this,"propertyInner",{...Dt,"tooltip-selector":[...Dt["tooltip-selector"],"carousel"],"basic-style-selector":[...Dt["basic-style-selector"],"areaBaseColor"]});v(this,"axis",Ri);v(this,"axisConfig",{xAxis:{name:`${Ee("chart.area")} / ${Ee("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Ee("chart.bubble_size")} / ${Ee("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var y;const{chart:e,level:o,areaId:i,container:l,action:n,scope:a}=t;if(!i)return;e.container=l;let s={},r=[],d=(y=e.data)==null?void 0:y.data;if(i.startsWith("custom_")){r=(await si(i)).data||[],r.forEach(C=>{var w;return C.scopeArr=((w=C.scope)==null?void 0:w.split(","))||[]}),s=G(await ne("156"));const x=s.features.reduce((C,w)=>(C["156"+w.properties.adcode]=w.properties.name,C),{}),{areaMapping:b}=L(e.senior),S=r.reduce((C,w)=>{var z,N;const T=(z=b==null?void 0:b[i])==null?void 0:z[w.name];return T&&(w.name=T),C[w.name]=w,w.scopeArr=((N=w.scope)==null?void 0:N.split(","))||[],C},{}),A=[];d==null||d.forEach(C=>{const w=S[C.name];w&&w.scopeArr.forEach(T=>{A.push({...C,name:x[T],field:x[T],scope:w.scopeArr,areaName:C.name})})}),d=A}else a?(s=G(await ne("156")),s.features=s.features.filter(x=>a.includes("156"+x.properties.adcode))):s=G(await ne(i));let m={preserveDrawingBuffer:!0,map:{type:"mapbox",style:"blank"},geoArea:{type:"geojson"},source:{data:d||[],joinBy:{sourceField:"name",geoField:"name",geoData:s}},viewLevel:{level:o,adcode:"all"},autoFit:!0,chinaBorder:!1,color:{field:"value"},style:{opacity:1,lineWidth:.6,lineOpacity:1},label:{field:"_DE_LABEL_",style:{textAnchor:"center"}},tooltip:{},legend:!1,customFetchGeoData:()=>null};const c={drawOption:t,geoJson:s,customSubArea:r};m=this.setupOptions(e,m,c);const p=J(m.tooltip);m={...m,tooltip:{...p,showComponent:!1}};const h=new Wl(l,m),g=this.getDotLayer(e,s,t,r);return i.startsWith("custom_")||(g.options={...g.options,tooltip:p}),this.configZoomButton(e,h),Ae(l),h.once("loaded",()=>{h.scene.map._canvasContainer.lastElementChild.style.cursor="default";const{layers:x}=c;x&&x.forEach(b=>{h.addLayer(b)}),g.addToScene(h.scene),g.once("add",()=>{re(l)}),h.scene.map.keyboard.disable(),g.on("dotLayer:click",b=>{var w;const S=b.feature.properties;let A,C;if(i.startsWith("custom_")){A="156";const T=r.find(z=>z.name===S.name);C=T==null?void 0:T.scopeArr}else A=(w=h.currentDistrictData.features.find(T=>T.properties.name===b.feature.properties.name))==null?void 0:w.properties.adcode;n({x:b.x,y:b.y,data:{data:S,extra:{adcode:A,scope:C}}})}),g.once("loaded",()=>{e.container=l,oo(e,h,d||[],null,r,t)})}),h}getDotLayer(t,e,o,i){var p,h,g,y,x;const{areaId:l}=o,{basicStyle:n,tooltip:a}=L(t.customAttr),{bubbleCfg:s}=L(t.senior),{offsetHeight:r,offsetWidth:d}=document.getElementById(o.container),m=[],c={source:{data:m,parser:{type:"json",x:"x",y:"y"}},shape:"circle",size:{field:"size",value:[5,Math.min(r,d)/20]},visible:!0,zIndex:.05,color:P(n.colors[0],n.alpha),name:"bubbleLayer",style:{opacity:1},state:{active:{color:"rgba(30,90,255,1)"}},tooltip:{showComponent:a.show}};if(l.startsWith("custom_")){const b=e.features.reduce((C,w)=>(w.properties.adcode&&(C["156"+w.properties.adcode]=w),C),{}),{areaMapping:S}=L(t.senior),A=i.reduce((C,w)=>{var z;const T=(z=S==null?void 0:S[l])==null?void 0:z[w.name];return T&&(w.name=T),C[w.name]=w,C},{});if((h=(p=t.data)==null?void 0:p.data)==null||h.forEach(C=>{var T;const w=A[C.name];if(w){const z=[];if((T=w.scopeArr)==null||T.forEach(N=>{const O=b[N];O&&z.push(O)}),z.length){const O=Ve({type:"FeatureCollection",features:z});w.centroid=[O.geometry.coordinates[0],O.geometry.coordinates[1]],m.push({name:w.name,size:C.value,properties:C,x:O.geometry.coordinates[0],y:O.geometry.coordinates[1]})}}}),c.tooltip&&c.tooltip.showComponent){c.tooltip.items=["name","adcode","value"],c.tooltip.customTitle=({name:w})=>w;const C=(g=a.seriesTooltipFormatter)==null?void 0:g.filter(w=>w.show).reduce((w,T)=>(w[T.id]=T,w),{});c.tooltip.customItems=w=>{var O,_,k;const T=[];if(W(C))return T;const z=w.properties,N=C[(_=(O=z.quotaList)==null?void 0:O[0])==null?void 0:_.id];if(!W(N)){const E=parseFloat(z.value),I=D(E,N.formatterCfg),B=W(N.chartShowName)?N.name:N.chartShowName;T.push({...z,name:B,value:`${I??""}`})}return(k=z.dynamicTooltipValue)==null||k.forEach(E=>{const I=C[E.fieldId];if(I){const B=D(parseFloat(E.value),I.formatterCfg),F=W(I.chartShowName)?I.name:I.chartShowName;T.push({color:"grey",name:F,value:`${B??""}`})}}),T},c.tooltip.domStyles={"l7plot-tooltip":{"background-color":a.backgroundColor,"font-size":`${a.fontSize}px`,"line-height":1.6},"l7plot-tooltip__name":{color:a.color},"l7plot-tooltip__value":{color:a.color},"l7plot-tooltip__title":{color:a.color}}}}else{const b=(x=(y=t.data)==null?void 0:y.data)==null?void 0:x.reduce((S,A)=>(S[A.field]={value:A.value,data:A},S),{});e.features.forEach(S=>{var C;const A=S.properties.name;(C=b==null?void 0:b[A])!=null&&C.value&&m.push({x:S.properties.centroid[0],y:S.properties.centroid[1],size:b[A].value,properties:b[A].data,name:A})})}return s&&s.enable?new Vo({...c,size:{field:"size",value:[10,Math.min(r,d)/10]},animate:{enable:!0,speed:s.speed,rings:s.rings}}):new Vo(c)}configBasicStyle(t,e,o){var c,p,h,g;const{areaId:i}=o.drawOption,l=o.geoJson,{basicStyle:n,label:a}=L(t.customAttr),r=(c=L(t.senior).areaMapping)==null?void 0:c[i];if(wi(l,r),e.color=n.areaBaseColor,!((h=(p=t.data)==null?void 0:p.data)!=null&&h.length)||!((g=l==null?void 0:l.features)!=null&&g.length))return e.label&&(e.label.field="name"),e;const m=t.data.data.reduce((y,x)=>(y[x.field]=x.value,y),{});return l.features.forEach(y=>{const x=y.properties.name;if(a.show){const b=[];a.showDimension&&b.push(x),a.showQuota&&(m[x]||m[x]===0)&&b.push(D(m[x],a.quotaLabelFormatter)),y.properties._DE_LABEL_=b.join(`

`)}}),e}configCustomArea(t,e,o){var m;const{drawOption:i,customSubArea:l,geoJson:n}=o;if(!i.areaId.startsWith("custom_"))return e;const a=L(t.customAttr),{label:s}=a,r=(m=t.data)==null?void 0:m.data,d=r==null?void 0:r.reduce((c,p)=>(c[p.field]=p,c),{});if(e.label={visible:!1},s.show){const c=n.features.reduce((y,x)=>(x.properties.adcode&&(y["156"+x.properties.adcode]=x),y),{}),{areaMapping:p}=L(t.senior),h=[];l.forEach(y=>{var b,S;const x=[];if((b=y.scopeArr)==null||b.forEach(A=>{const C=c[A];C&&x.push(C)}),x.length){const A={type:"FeatureCollection",features:x},C=[];if(s.showDimension){const T=(S=p==null?void 0:p[i.areaId])==null?void 0:S[y.name];T&&(y.name=T),C.push(y.name)}s.showQuota&&d[y.name]&&C.push(D(d[y.name].value,s.quotaLabelFormatter));const w=Ve(A);h.push({name:C.join(`

`),x:w.geometry.coordinates[0],y:w.geometry.coordinates[1]})}});const g=new di({name:"areaLabelLayer",source:{data:h,parser:{type:"json",x:"x",y:"y"}},field:"name",zIndex:.06,style:{fill:s.color,fontSize:s.fontSize,opacity:1,fontWeight:"bold",textAnchor:"center",textAllowOverlap:s.fullDisplay,padding:s.fullDisplay?void 0:[2,2]}});o.layers=[g]}return e}setupOptions(t,e,o){return U(this.configEmptyDataStrategy,this.configLabel,this.configStyle,this.configTooltip,this.configBasicStyle,this.configCustomArea)(t,e,o,this)}}const bn=Object.freeze(Object.defineProperty({__proto__:null,BubbleMap:xn},Symbol.toStringTag,{value:"Module"})),me=Cl();class zt extends Ns{constructor(t,e){super();v(this,"config");v(this,"scene",null);v(this,"destroy",()=>{var t;this.chartInstance&&((t=this.chartInstance)==null||t.destroy())});v(this,"render",()=>{var t;this.scene&&this.config&&(this.scene.loaded?Array.isArray(this.config)?(t=this.config)==null||t.forEach(e=>{this.handleConfig(e)}):this.handleConfig(this.config):this.scene.on("loaded",()=>{var e;Array.isArray(this.config)?(e=this.config)==null||e.forEach(o=>{this.handleConfig(o)}):this.handleConfig(this.config)}))});v(this,"handleConfig",t=>{var e;t&&(t.handleConfig?(e=t.handleConfig)==null||e.call(t,this.scene):this.scene.addLayer(t))});this.chartInstance=t,this.config=e,this.scene=t}getScene(){return this.scene}}class Oo extends eo{constructor(t,e){super(Pt.L7,t,e);v(this,"getMapKey",async()=>(me.mapKey.key||await ss().then(t=>me.setKey(t.data)),me.mapKey.securityCode&&(window._AMapSecurityConfig={securityJsCode:me.mapKey.securityCode}),me.mapKey))}configEmptyDataStrategy(t,e){const{functionCfg:o}=L(t.senior),i=o.emptyDataStrategy;if(!i||i==="breakLine")return e;const l=G(e.sourceOption.data);if(i==="setZero"&&l.forEach(n=>{n.value===null&&(n.value=0)}),i==="ignoreData")for(let n=l.length-1;n>=0;n--)l[n].value===null&&l.splice(n,1);return e.sourceOption.data=l,e}configZoomButton(t,e){ws(t,e)}configLabel(t,e){const o=Ai(t);return Ft(e.label,o),e}configTooltip(t,e){const o=Ci(t);return Ft(e.tooltip,o),e}}const{t:vt}=Y();class Sn extends Oo{constructor(){super("flow-map",[]);v(this,"properties",["background-overall-component","border-style","basic-style-selector","title-selector","flow-map-line-selector","flow-map-point-selector","bubble-animate"]);v(this,"propertyInner",{...Dt,"basic-style-selector":["mapBaseStyle","mapLineStyle","zoom","showLabel","autoFit","mapCenter","zoomLevel"]});v(this,"axis",["xAxis","xAxisExt","filter","flowMapStartName","flowMapEndName","yAxis"]);v(this,"axisConfig",{xAxis:{name:`${vt("chart.start_coordinates")} / ${vt("chart.dimension")}`,type:"d",limit:2},xAxisExt:{name:`${vt("chart.end_coordinates")} / ${vt("chart.dimension")}`,type:"d",limit:2},flowMapStartName:{name:`${vt("chart.start_name")} / ${vt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},flowMapEndName:{name:`${vt("chart.end_name")} / ${vt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},yAxis:{name:`${vt("chart.flow_map_line_width")} / ${vt("chart.quota")}`,type:"q",limit:1,tooltip:vt("chart.flow_map_line_width_tip"),allowEmpty:!0}});v(this,"lineConfig",(t,e,o,i,l)=>{var g;const n={type:l.flowMapConfig.lineConfig.mapLineType,size:l.flowMapConfig.lineConfig.mapLineType==="line"?l.flowMapConfig.lineConfig.mapLineWidth/2:l.flowMapConfig.lineConfig.mapLineWidth,animate:l.flowMapConfig.lineConfig.mapLineAnimate,animateDuration:l.flowMapConfig.lineConfig.mapLineAnimateDuration,gradient:l.flowMapConfig.lineConfig.mapLineGradient,sourceColor:l.flowMapConfig.lineConfig.mapLineSourceColor,targetColor:l.flowMapConfig.lineConfig.mapLineTargetColor,alpha:l.flowMapConfig.lineConfig.alpha},a=i.colors.map(y=>P(y,l.flowMapConfig.lineConfig.alpha));n.sourceColor=a[0],n.targetColor=a[1];let s=null;const r=J(t.yAxis);r.length>0&&(s=r[0].dataeaseName);let d=null;const m=J(t.yAxisExt);m.length>0&&(d=m[0].dataeaseName);const c="*",p=[];(g=t.data)==null||g.tableRow.forEach(y=>{const x="f_record",b=Object.keys(y).reduce((S,A)=>(A===c?S[x]=y[A]:S[A]=y[A],S),{});p.push(b)});const h=new Vl({name:"line",blend:"normal",autoFit:i.autoFit!==!1}).source(p,{parser:{type:"json",x:e[0].dataeaseName,y:e[1].dataeaseName,x1:o[0].dataeaseName,y1:o[1].dataeaseName}}).size(n.size).shape(n.type).animate({enable:n.animate,duration:n.animateDuration,interval:1,trailLength:1});return s&&h.size(s===c?"f_record":s,[1,10]),d?(h.style({opacity:n.alpha/100}),h.color(d)):n.gradient?h.style({sourceColor:n.sourceColor,targetColor:n.targetColor,opacity:n.alpha/100}):h.style({opacity:n.alpha/100}).color(n.sourceColor),h});v(this,"startAndEndNameConfig",(t,e,o,i,l)=>{var m,c;const n=J(t.flowMapStartName),a=J(t.flowMapEndName),s=i.flowMapConfig.pointConfig.text.color,r=i.flowMapConfig.pointConfig.text.fontSize,d=new Map;if((n==null?void 0:n.length)>0){const p=new oe().source((m=t.data)==null?void 0:m.tableRow,{parser:{type:"json",x:e[0].dataeaseName,y:e[1].dataeaseName}}).shape(n[0].dataeaseName,h=>d.has("from-"+h)?"":(d.set("from-"+h,h),h)).size(r).color(s).style({textAnchor:"top",textOffset:[0,0],spacing:2,padding:[1,1],textAllowOverlap:!0,fontFamily:t.fontFamily?t.fontFamily:void 0});l.push(p)}if((a==null?void 0:a.length)>0){const p=new oe().source((c=t.data)==null?void 0:c.tableRow,{parser:{type:"json",x:o[0].dataeaseName,y:o[1].dataeaseName}}).shape(a[0].dataeaseName,h=>d.has("from-"+h)||d.has("to-"+h)?"":(d.set("to-"+h,h),h)).size(r).color(s).style({textAnchor:"top",textOffset:[0,0],spacing:2,padding:[1,1],textAllowOverlap:!0,fontFamily:t.fontFamily?t.fontFamily:void 0});l.push(p)}});v(this,"pointConfig",(t,e,o,i,l)=>{var m,c;const n=i.flowMapConfig.pointConfig.point.color,a=i.flowMapConfig.pointConfig.point.size,{bubbleCfg:s}=L(t.senior),r=new oe({zIndex:-1}).source((m=t.data)==null?void 0:m.tableRow,{parser:{type:"json",x:e[0].dataeaseName,y:e[1].dataeaseName}}).shape("circle").size(a).color(n).style({blur:.6}),d=new oe({zIndex:-1}).source((c=t.data)==null?void 0:c.tableRow,{parser:{type:"json",x:o[0].dataeaseName,y:o[1].dataeaseName}}).shape("circle").size(a).color(n).style({blur:.6});if(s&&s.enable){const p={enable:!0,speed:s.speed,rings:s.rings};r.size(a*2),r.animate(p),d.size(a*2),d.animate(p)}l.push(r),l.push(d)})}async drawChart(t){var y,x;const{chart:e,container:o}=t,i=document.getElementById(o),l=i==null?void 0:i.getBoundingClientRect();if((l==null?void 0:l.height)<=0)return new zt((y=t.chartObj)==null?void 0:y.getScene(),[]);const n=J(e.xAxis),a=J(e.xAxisExt),{basicStyle:s,misc:r}=J(L(e.customAttr));let d=[ot.mapCenter.longitude,ot.mapCenter.latitude];s.autoFit===!1&&(d=[s.mapCenter.longitude,s.mapCenter.latitude]);let m=s.mapStyleUrl;s.mapStyle!=="custom"&&(m=`amap://styles/${s.mapStyle?s.mapStyle:"normal"}`);const c=await this.getMapKey(),p=t.chartObj;let h=p==null?void 0:p.getScene();if(h?((x=h.getLayers())!=null&&x.length&&(await h.removeAllLayer(),h.setPitch(r.mapPitch),h.setMapStyle(m),h.map.showLabel=s.showLabel!==!1),s.autoFit===!1&&h.setZoomAndCenter(s.zoomLevel,d)):h=new Lo({id:o,logoVisible:!1,map:new To({token:(c==null?void 0:c.key)??void 0,style:m,pitch:r.mapPitch,center:s.autoFit===!1?d:void 0,zoom:s.autoFit===!1?s.zoomLevel:void 0,showLabel:s.showLabel!==!1,WebGLParams:{preserveDrawingBuffer:!0}})}),Ae(o),h.once("loaded",()=>{re(o)}),this.configZoomButton(e,h),(n==null?void 0:n.length)<2||(a==null?void 0:a.length)<2)return new zt(h,void 0);const g=[];return g.push(this.lineConfig(e,n,a,s,r)),this.startAndEndNameConfig(e,n,a,r,g),this.pointConfig(e,n,a,r,g),g[0].once("inited",()=>{re(o)}),new zt(h,g)}setupDefaultOptions(t){return t.customAttr.misc.flowMapConfig.lineConfig.mapLineAnimate=!0,t}}const An=Object.freeze(Object.defineProperty({__proto__:null,FlowMap:Sn},Symbol.toStringTag,{value:"Module"})),{t:Fe}=Y();class Cn extends Oo{constructor(){super("heat-map",[]);v(this,"properties",["background-overall-component","border-style","basic-style-selector","title-selector"]);v(this,"propertyInner",{...Dt,"basic-style-selector":["colors","heatMapStyle","zoom","showLabel","autoFit","mapCenter","zoomLevel"]});v(this,"axis",["xAxis","yAxis","filter"]);v(this,"axisConfig",{xAxis:{name:`${Fe("chart.longitude_and_latitude")} / ${Fe("chart.dimension")}`,type:"d",limit:2},yAxis:{name:`${Fe("chart.chart_data")} / ${Fe("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var y,x,b;const{chart:e,container:o}=t,i=document.getElementById(o),l=i==null?void 0:i.getBoundingClientRect();if((l==null?void 0:l.height)<=0)return new zt((y=t.chartObj)==null?void 0:y.getScene(),[]);const n=J(e.xAxis),a=J(e.yAxis);let s,r;e.customAttr&&(s=L(e.customAttr).basicStyle,r=L(e.customAttr).misc);let d=[ot.mapCenter.longitude,ot.mapCenter.latitude];s.autoFit===!1&&(d=[s.mapCenter.longitude,s.mapCenter.latitude]);let m=s.mapStyleUrl;s.mapStyle!=="custom"&&(m=`amap://styles/${s.mapStyle?s.mapStyle:"normal"}`);const c=await this.getMapKey(),p=t.chartObj;let h=p==null?void 0:p.getScene();if(h?(x=h.getLayers())!=null&&x.length&&(await h.removeAllLayer(),h.setPitch(r.mapPitch),h.setMapStyle(m),h.map.showLabel=s.showLabel!==!1,s.autoFit===!1&&h.setZoomAndCenter(s.zoomLevel,d)):h=new Lo({id:o,logoVisible:!1,map:new To({token:(c==null?void 0:c.key)??void 0,style:m,pitch:r.mapPitch,center:d,zoom:s.autoFit===!1?s.zoomLevel:void 0,showLabel:s.showLabel!==!1,WebGLParams:{preserveDrawingBuffer:!0}})}),Ae(o),h.once("loaded",()=>{re(o)}),this.configZoomButton(e,h),(n==null?void 0:n.length)<2||(a==null?void 0:a.length)<1)return new zt(h,void 0);const g=new Yl({name:"line",blend:"normal",autoFit:s.autoFit!==!1}).source((b=e.data)==null?void 0:b.data,{parser:{type:"json",x:"x",y:"y"}}).size("value",[0,1]).shape(s.heatMapType??ot.heatMapType);return g.style({intensity:s.heatMapIntensity??ot.heatMapIntensity,radius:s.heatMapRadius??ot.heatMapRadius,rampColors:{colors:s.colors.reverse(),positions:[0,.11,.22,.33,.44,.55,.66,.77,.88,1]}}),new zt(h,g)}setupOptions(t,e){return U(this.configEmptyDataStrategy)(t,e)}}const wn=Object.freeze(Object.defineProperty({__proto__:null,HeatMap:Cn},Symbol.toStringTag,{value:"Module"})),{t:ze}=Y();let vn=class extends Di{constructor(){super("map",[]);v(this,"properties",[...Mi,"legend-selector"]);v(this,"propertyInner",{...Dt,"basic-style-selector":["colors","alpha","areaBorderColor","areaBaseColor","zoom","gradient-color"],"legend-selector":["icon","fontSize","color"],"tooltip-selector":[...Dt["tooltip-selector"],"carousel"]});v(this,"axis",Ri);v(this,"axisConfig",{xAxis:{name:`${ze("chart.area")} / ${ze("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${ze("chart.chart_data")} / ${ze("chart.quota")}`,type:"q",limit:1}});v(this,"createLegendCustomContent",t=>{const o=xe(ai).getElementsByClassName(ri)[0];return t.forEach(i=>{let l="-";if(i.value!=="")if(Array.isArray(i.value))i.value.forEach((r,d)=>{i.value[d]=Number.isNaN(r)||r==="NaN"?"NaN":parseFloat(r).toFixed(0)}),l=i.value.join("-");else{const r=i.value;l=Number.isNaN(r)||r==="NaN"?"NaN":parseFloat(r).toFixed(0)}const n={...i,value:l},a=_o(ci,n),s=xe(a);s.style.setProperty("--bgColor",i.color),o.appendChild(s)}),o})}async drawChart(t){var b;const{chart:e,level:o,container:i,action:l,scope:n}=t,{areaId:a}=t;if(!a)return;e.container=i;let s=JSON.parse(JSON.stringify(((b=e.data)==null?void 0:b.data)||[]));const{misc:r}=L(e.customAttr),{legend:d}=L(e.customStyle);let m={},c=[];if(a.startsWith("custom_")){c=(await si(a)).data||[],m=G(await ne("156"));const S=m.features.reduce((T,z)=>(T["156"+z.properties.adcode]=z.properties.name,T),{}),{areaMapping:A}=L(e.senior),C=c.reduce((T,z)=>{var O,_;const N=(O=A==null?void 0:A[a])==null?void 0:O[z.name];return N&&(z.name=N),T[z.name]=z,z.scopeArr=((_=z.scope)==null?void 0:_.split(","))||[],T},{}),w=[];s.forEach(T=>{const z=C[T.name];z&&z.scopeArr.forEach(N=>{w.push({...T,name:S[N],field:S[N],scope:z.scopeArr,areaName:T.name})})}),s=w}else n?(m=G(await ne("156")),m.features=m.features.filter(S=>n.includes("156"+S.properties.adcode))):m=G(await ne(a));let p=[];if(!r.mapAutoLegend&&d.show){let S=r.mapLegendMin,A=r.mapLegendMax,C=9;r.mapLegendRangeType==="custom"&&(A=0,S=0,C=r.mapLegendNumber),De(s,"value",A,S,(w,T)=>{A=w,S=T,l({from:"map",data:{max:A,min:S??$o(s,"value"),legendNumber:C}})}),p=mo(s,A,S)}else p=s;let h={preserveDrawingBuffer:!0,map:{type:"mapbox",style:"blank"},geoArea:{type:"geojson"},source:{data:p,joinBy:{sourceField:"name",geoField:"name",geoData:m}},viewLevel:{level:o,adcode:"all"},autoFit:!0,chinaBorder:!1,color:{field:"value"},style:{opacity:1,lineWidth:.6,lineOpacity:1},label:{field:"_DE_LABEL_",style:{textAnchor:"center"}},state:{active:{stroke:"green",lineWidth:1}},tooltip:{},customFetchGeoData:()=>null};const g={drawOption:t,geoJson:m,customSubArea:c};h=this.setupOptions(e,h,g);const{Choropleth:y}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(S=>S.X),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),x=new y(i,h);return this.configZoomButton(e,x),Ae(i),x.once("loaded",()=>{re(i);const{layers:S}=g;S&&S.forEach(A=>{x.addLayer(A)}),x.scene.map.keyboard.disable(),x.on("fillAreaLayer:click",A=>{const C=A.feature.properties;a.startsWith("custom_")&&(C.name=C.areaName,C.adcode="156"),l({x:A.x,y:A.y,data:{data:C,extra:{adcode:C.adcode,scope:C.scope}}})}),e.container=i,oo(e,x,p,null,c,t)}),x}configBasicStyle(t,e,o){var A,C,w,T;const{areaId:i}=o.drawOption,l=o.geoJson,{basicStyle:n,label:a,misc:s}=L(t.customAttr),d=(A=L(t.senior).areaMapping)==null?void 0:A[i];if(wi(l,d),e.color={field:"value",value:[n.colors[0]],scale:{type:"quantize",unknown:n.areaBaseColor}},!((w=(C=t.data)==null?void 0:C.data)!=null&&w.length)||!((T=l==null?void 0:l.features)!=null&&T.length))return e.label&&(e.label.field="name"),e;const m=e.source.data,c=n.colors.map(z=>P(z,n.alpha)),{legend:p}=L(t.customStyle);let h=m,g=[],y=s.mapLegendMin,x=s.mapLegendMax,b=s.mapLegendNumber;p.show?(De(m,"value",x,y,(z,N)=>{x=z,y=N,b=9}),s.mapAutoLegend?b=9:h=mo(m,x,y),g=wl(y,x,b,c)):g=c;const S=h.reduce((z,N)=>(z[N.field]=N.value,z),{});return l.features.forEach(z=>{const N=z.properties.name;if(a.show){const O=[];a.showDimension&&O.push(N),a.showQuota&&(S[N]||S[N]===0)&&O.push(D(S[N],a.quotaLabelFormatter)),z.properties._DE_LABEL_=O.join(`

`)}}),g.length&&(e.color.value=g.map(z=>z.color?z.color:z),g[0].value&&!s.mapAutoLegend&&(e.color.scale.domain=[y??$o(m,"value"),x])),e}customConfigLegend(t,e,o){const{basicStyle:i,misc:l}=L(t.customAttr),n=i.colors.map(d=>P(d,i.alpha));if(i.suspension===!1&&i.showZoom===void 0)return e;const{legend:a}=L(t.customStyle);if(!a.show)return e;const s={circle:{borderRadius:"50%"},square:{},triangle:{border:"unset",borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottom:"10px solid var(--bgColor)",background:"unset"},diamond:{transform:"rotate(45deg)"}},r={position:"bottomleft",domStyles:{"l7plot-legend__category-value":{fontSize:a.fontSize+"px",color:a.color,"font-family":t.fontFamily?t.fontFamily:void 0},"l7plot-legend__category-marker":{...s[a.icon],width:a.size+"px",height:a.size+"px",...a.icon==="triangle"?{...s[a.icon].triangle,borderLeft:`${a.size/2}px solid transparent`,borderRight:`${a.size/2}px solid transparent`,borderBottom:`${a.size}px solid var(--bgColor)`}:{border:"0.01px solid #f4f4f4"},...a.icon==="diamond"?{transform:"rotate(45deg)",marginBottom:`${a.size/4}px`}:{}}}};if(!l.mapAutoLegend&&l.mapLegendRangeType==="custom"&&!t.drill){const d=[],m=l.mapLegendCustomRange.slice(0,-1).map((c,p)=>[c,l.mapLegendCustomRange[p+1]]);m.forEach((c,p)=>{const h=[c[0],c[1]],g=p%n.length,y=c[0]<m[0][0]&&c[1]<m[0][0];let x=n[g];y&&(x=i.areaBaseColor),d.push({value:h,color:x})}),r.customContent=(c,p)=>d!=null&&d.length?this.createLegendCustomContent(d):"",e.color.value=({value:c})=>{const p=d.find(h=>c>=h.value[0]&&c<=h.value[1]);return p?p.color:i.areaBaseColor},e.color.scale.domain=[m[0][0],m[m.length-1][1]]}else r.customContent=(d,m)=>{const c=(m==null?void 0:m.length)>30?m.slice(0,30):m;return c!=null&&c.length?this.createLegendCustomContent(c):""};return t.drill&&De(e.source.data,"value",0,0,(d,m)=>{e.color.scale.domain=[m,d]}),Ft(e,{legend:r}),e}configCustomArea(t,e,o){var p;const{drawOption:i,customSubArea:l,geoJson:n}=o;if(!i.areaId.startsWith("custom_"))return e;const a=L(t.customAttr),{label:s}=a,r=t.data.data,d=r==null?void 0:r.reduce((h,g)=>(h[g.field]=g,h),{}),m=n.features.reduce((h,g)=>(g.properties.adcode&&(h["156"+g.properties.adcode]=g),h),{});if(l.forEach(h=>{var y;const g=[];if((y=h.scopeArr)==null||y.forEach(x=>{const b=m[x];b&&g.push(b)}),g.length){const b=Ve({type:"FeatureCollection",features:g});h.centroid=[b.geometry.coordinates[0],b.geometry.coordinates[1]]}}),e.label={visible:!1},s.show){const h=[];l.forEach(y=>{if(y.centroid){const x=[];s.showDimension&&x.push(y.name),s.showQuota&&(d[y.name]||d[y.name]===0)&&x.push(D(d[y.name].value,s.quotaLabelFormatter)),h.push({name:x.join(`

`),x:y.centroid[0],y:y.centroid[1]})}});const g=new di({name:"areaLabelLayer",source:{data:h,parser:{type:"json",x:"x",y:"y"}},field:"name",style:{fill:s.color,fontSize:s.fontSize,opacity:1,fontWeight:"bold",textAnchor:"center",textAllowOverlap:s.fullDisplay,padding:s.fullDisplay?void 0:[2,2]}});o.layers=[g]}const c=l.reduce((h,g)=>(g.scopeArr.forEach(y=>{h[y]=g.name}),h),{});if(e.tooltip&&e.tooltip.showComponent){e.tooltip.items=["name","adcode","value"],e.tooltip.customTitle=({name:y,adcode:x})=>(x="156"+x,c[x]??y);const g=(p=a.tooltip.seriesTooltipFormatter)==null?void 0:p.filter(y=>y.show).reduce((y,x)=>(y[x.id]=x,y),{});e.tooltip.customItems=y=>{var T,z,N;const x=[];if(W(g))return x;const b=y.properties,{adcode:S}=b,A=c["156"+S],C=d[A];if(!C)return x;const w=g[(z=(T=C.quotaList)==null?void 0:T[0])==null?void 0:z.id];if(!W(w)){const O=parseFloat(C.value),_=D(O,w.formatterCfg),k=W(w.chartShowName)?w.name:w.chartShowName;x.push({...C,name:k,value:`${_??""}`})}return(N=C.dynamicTooltipValue)==null||N.forEach(O=>{const _=g[O.fieldId];if(_){const k=D(parseFloat(O.value),_.formatterCfg),E=W(_.chartShowName)?_.name:_.chartShowName;x.push({color:"grey",name:E,value:`${k??""}`})}}),x}}return e}setupDefaultOptions(t){return t.customAttr.basicStyle.areaBaseColor="#f4f4f4",t}setupOptions(t,e,o){return U(this.configEmptyDataStrategy,this.configLabel,this.configStyle,this.configTooltip,this.configBasicStyle,this.customConfigLegend,this.configCustomArea)(t,e,o,this)}};const _n=Object.freeze(Object.defineProperty({__proto__:null,Map:vn},Symbol.toStringTag,{value:"Module"})),{t:Ht}=Y();class Ln extends Oo{constructor(){super("symbolic-map",[]);v(this,"properties",["background-overall-component","border-style","basic-style-selector","symbolic-style-selector","title-selector","label-selector","tooltip-selector","threshold"]);v(this,"propertyInner",{...Dt,"basic-style-selector":["colors","alpha","mapBaseStyle","zoom","showLabel","autoFit","mapCenter","zoomLevel"],"symbolic-style-selector":["symbolicMapStyle"],"label-selector":["color","fontSize","showFields","customContent"],"tooltip-selector":["color","fontSize","showFields","customContent","show","backgroundColor","carousel"],threshold:["lineThreshold"]});v(this,"axis",["xAxis","xAxisExt","extBubble","filter","extLabel","extTooltip"]);v(this,"axisConfig",{xAxis:{name:`${Ht("chart.symbolic_map_coordinates")} / ${Ht("chart.dimension")}`,type:"d",limit:2},xAxisExt:{name:`${Ht("chart.color")} / ${Ht("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},extBubble:{name:`${Ht("chart.bubble_size")} / ${Ht("chart.quota")}`,type:"q",limit:1,tooltip:Ht("chart.symbolic_map_bubble_size_tip"),allowEmpty:!0}});v(this,"buildSymbolicLayer",async(t,e)=>{var O,_;const{basicStyle:o}=L(t.customAttr),i=J(t.xAxis),l=J(t.xAxisExt),n=J(t.extBubble),{mapSymbolOpacity:a,mapSymbolSize:s,mapSymbol:r,mapSymbolStrokeWidth:d,colors:m,alpha:c,mapSymbolSizeMin:p,mapSymbolSizeMax:h}=J(o),g=m.map(k=>P(k,c));let y=0;const x=new Map,b=n.length>0?n[0].dataeaseName:"",{threshold:S}=L(t.senior);let A=[];S.enable&&(A=S.lineThreshold??[]);const C=t.extBubble.map(k=>k.id);A=$e(A,k=>C.includes(k.fieldId));const w=g[0],T=[],z=(O=t.data)!=null&&O.tableRow?t.data.tableRow.map((k,E)=>{var F;k._index="_index"+E;const I=k[(F=l[0])==null?void 0:F.dataeaseName];let B=x.get(I);if(B||(B=g[y++%g.length],x.set(I,B)),T[E]=B,A.length>0)for(let M=0;M<A.length;M++){const $=A[M],R=k[$.field.dataeaseName];for(const V of $.conditions){const X=V.value,H=vl(V.color);if(V.term==="between"){const q=parseFloat(V.min),At=parseFloat(V.max);q<=R&&R<=At&&(B=P(H,c),T[E]=B)}else V.term==="lt"?R<X&&(B=P(H,c),T[E]=B):V.term==="le"?R<=X&&(B=P(H,c),T[E]=B):V.term==="gt"?R>X&&(B=P(H,c),T[E]=B):V.term==="ge"?R>=X&&(B=P(H,c),T[E]=B):V.term==="eq"?R===X&&(B=P(H,c),T[E]=B):V.term==="not_eq"&&R!==X&&(B=P(H,c),T[E]=B)}}return{...k,color:B,size:parseInt(k[b])??s,name:I}}):[],N=new oe({autoFit:o.autoFit!==!1}).source(z,{parser:{type:"json",x:i[0].dataeaseName,y:i[1].dataeaseName}}).active(!0);if((_=l[0])!=null&&_.dataeaseName)if(o.mapSymbol==="custom"&&o.customIcon)if(o.customIcon.startsWith("data"))e.removeImage("customIcon"),await e.addImage("customIcon",o.customIcon),N.shape("customIcon");else{const k=new DOMParser;for(let E=0;E<Math.min(T.length,y+1);E++){const I=T[E],B=/(fill="[^"]*")/g,F=o.customIcon.replace(B,""),$=k.parseFromString(F,"image/svg+xml").documentElement;$.setAttribute("fill",I),e.removeImage(`icon-${I}`),await e.addImage(`icon-${I}`,Ho($.outerHTML))}N.shape("color",E=>`icon-${E}`)}else N.shape(r).color("_index",T),N.style({stroke:{field:"color"},strokeWidth:d,opacity:a/10});else if(o.mapSymbol==="custom"&&o.customIcon)if(e.removeImage("customIcon"),o.customIcon.startsWith("data"))await e.addImage("customIcon",o.customIcon),N.shape("customIcon");else{const k=new DOMParser,E=w,I=/(fill="[^"]*")/g,B=o.customIcon.replace(I,""),M=k.parseFromString(B,"image/svg+xml").documentElement;M.setAttribute("fill",E),await e.addImage("customIcon",Ho(M.outerHTML)),N.shape("customIcon")}else N.shape(r).color("_index",T).style({stroke:{field:"color"},strokeWidth:d,opacity:a/10});return b?N.size("size",[p,h]):N.size(s),N});v(this,"mergeDetailsToMap",t=>{const e=new Map;return t.forEach(o=>{Object.entries(o).forEach(([i,l])=>{if(e.has(i)){const n=e.get(i);n!==l&&e.set(i,`${n}, ${l}`)}else e.set(i,l)})}),e});v(this,"clearPopup",t=>{const e=document.getElementById(t);e==null||e.querySelectorAll(".l7-popup").forEach(o=>o.remove())});v(this,"buildTooltip",(t,e,o,i)=>{var n,a;const l=t.customAttr?L(t.customAttr):null;if(this.clearPopup(e),(n=l==null?void 0:l.tooltip)!=null&&n.show){const{tooltip:s}=J(l);let r=s.showFields||[];(!s.showFields||s.showFields.length===0)&&(r=[...t.xAxisExt.map(y=>`${y.dataeaseName}@${y.name}`),...t.xAxis.map(y=>`${y.dataeaseName}@${y.name}`)]);const d="tooltip-"+e,m=document.getElementById(d);m&&(m.remove(),(a=m.parentNode)==null||a.removeChild(m));const c=document.createElement("style");c.id=d,c.innerHTML=`
          #${e} .l7-popup-content {
            background-color: ${s.backgroundColor} !important;
            padding: 6px 10px 6px;
            line-height: 1.6;
            border-top-left-radius: 3px;
          }
          #${e} .l7-popup-tip {
           border-top-color: ${s.backgroundColor} !important;
          }
        `,document.head.appendChild(c);const p=`<div style='font-size:${s.fontSize}px;color:${s.color};font-family: ${t.fontFamily}'>`,h="</div>",g=document.getElementById(e);return g&&g.addEventListener("mousemove",y=>{const x=g.getBoundingClientRect(),b=y.clientX-x.left,S=y.clientY-x.top,A=g.getElementsByClassName("l7-popup");for(let C=0;C<(A==null?void 0:A.length);C++){const w=A[C];w.firstElementChild.style.display="none",w.style.transform="translate(15px, 12px)";const T=g.clientWidth-b<=w.clientWidth+10,z=g.clientHeight-S<=w.clientHeight;let N="";T&&(N+="translateX(-120%) translateY(15%) "),z&&(N+="translateX(15%) translateY(-80%) "),N&&(w.style.transform=N.trim())}}),o.on("touchend",y=>{if(y.lngLat){const x={...y.feature,...Object.fromEntries(this.mergeDetailsToMap(y.feature.details??[]))},b=this.buildTooltipContent(s,x,r),S=new ui({lngLat:y.lngLat,title:"",closeButton:!1,closeOnClick:!0,html:`${p}${b}${h}`});i.addPopup(S)}}),new ql({anchor:"top-left",className:"l7-popup-"+e,items:[{layer:o,customContent:y=>{const x={...y,...Object.fromEntries(this.mergeDetailsToMap(y.details))},b=this.buildTooltipContent(s,x,r);return`${p}${b}${h}`}}],trigger:"hover"})}});v(this,"buildTooltipContent",(t,e,o)=>{let i="";return t.customContent?(i=t.customContent,o.forEach(l=>{i=i.replace(`\${${l.split("@")[1]}}`,e[l.split("@")[0]])})):o.forEach(l=>{i+=`<span style="margin-bottom: 4px">${l.split("@")[1]}: ${e[l.split("@")[0]]}</span><br>`}),i.replace(/\n/g,"<br>")});v(this,"buildLabel",(t,e)=>{var l,n;const o=J(t.xAxis),i=t.customAttr?L(t.customAttr):null;if((l=i==null?void 0:i.label)!=null&&l.show){const{label:a}=i,s=((n=t.data)==null?void 0:n.tableRow)||[];let r=a.showFields||[];(!a.showFields||a.showFields.length===0)&&(r=[...t.xAxisExt.map(d=>`${d.dataeaseName}@${d.name}`),...t.xAxis.map(d=>`${d.dataeaseName}@${d.name}`)]),s.forEach(d=>{const m={...d,...Object.fromEntries(this.mergeDetailsToMap(d.details))};let c=a.customContent||"";c?r.forEach(p=>{const[h,g]=p.split("@");c=c.replace(`\${${g}}`,m[h])}):c=r.map(p=>m[p.split("@")[0]]).join(","),c=c.replace(/\n/g,""),d.textLayerContent=c}),e.push(new oe().source(s,{parser:{type:"json",x:o[0].dataeaseName,y:o[1].dataeaseName}}).shape("textLayerContent","text").color(a.color).size(a.fontSize).style({textAllowOverlap:a.fullDisplay,textAnchor:"center",textOffset:[0,0],fontFamily:t.fontFamily?t.fontFamily:void 0}))}})}async drawChart(t){var b,S,A,C,w,T,z,N,O;const{chart:e,container:o,action:i}=t,l=document.getElementById(o),n=l==null?void 0:l.getBoundingClientRect();if((n==null?void 0:n.height)<=0)return new zt((b=t.chartObj)==null?void 0:b.getScene(),[]);const a=J(e.xAxis);let s,r;e.customAttr&&(s=L(e.customAttr).basicStyle,r=L(e.customAttr).misc);let d=s.mapStyleUrl;s.mapStyle!=="custom"&&(d=`amap://styles/${s.mapStyle?s.mapStyle:"normal"}`);const m=await this.getMapKey();let c=[ot.mapCenter.longitude,ot.mapCenter.latitude];if(s.autoFit===!1&&(c=[s.mapCenter.longitude,s.mapCenter.latitude]),(A=(S=e.chartExtRequest)==null?void 0:S.linkageFilters)!=null&&A.length&&(a==null?void 0:a.length)===2&&((C=e.data)!=null&&C.tableRow.length)){const _=(T=(w=e.data)==null?void 0:w.tableRow)==null?void 0:T[0][e.xAxis[0].dataeaseName],k=(N=(z=e.data)==null?void 0:z.tableRow)==null?void 0:N[0][e.xAxis[1].dataeaseName];c=[_,k]}const p=t.chartObj;let h=p==null?void 0:p.getScene();if(h?((O=h.getLayers())!=null&&O.length&&(await h.removeAllLayer(),h.setPitch(r.mapPitch),h.setMapStyle(d),h.map.showLabel=s.showLabel!==!1),s.autoFit===!1&&h.setZoomAndCenter(s.zoomLevel,c)):h=new Lo({id:o,logoVisible:!1,map:new To({token:(m==null?void 0:m.key)??void 0,style:d,pitch:r.mapPitch,center:c,zoom:s.autoFit===!1?s.zoomLevel:void 0,showLabel:s.showLabel!==!1,WebGLParams:{preserveDrawingBuffer:!0}})}),Ae(o),h.once("loaded",()=>{re(o)}),this.configZoomButton(e,h),(a==null?void 0:a.length)<2)return new zt(h,void 0);const g=[],y=await this.buildSymbolicLayer(e,h);g.push(y);const x=this.buildTooltip(e,o,y,h);return x&&h.addPopup(x),this.buildLabel(e,g),y.on("inited",()=>{e.container=o,oo(e,y,y.sourceOption.data,h)}),y.on("click",_=>{const k=_.feature,E=[],I=[];e.data.fields.forEach((B,F)=>{Object.keys(k).forEach(M=>{M.startsWith("f_")&&B.dataeaseName===M&&(F===0?E.push({id:B.id,dataeaseName:B.dataeaseName,value:k[M]}):I.push({id:B.id,dataeaseName:B.dataeaseName,value:k[M]}))})}),i({x:_.x,y:_.y,data:{data:{...k,value:I[0].value,name:E[0].id,dimensionList:E,quotaList:I}}})}),new zt(h,g)}setupDefaultOptions(t){return t.customAttr.label={...t.customAttr.label,show:!1},t.customAttr.basicStyle={...t.customAttr.basicStyle,mapSymbolOpacity:5,mapStyle:"normal"},t}}const Tn=Object.freeze(Object.defineProperty({__proto__:null,SymbolicMap:Ln},Symbol.toStringTag,{value:"Module"})),$i=["background-overall-component","border-style","dual-basic-style-selector","x-axis-selector","dual-y-axis-selector","title-selector","legend-selector","label-selector","tooltip-selector","assist-line","function-cfg","jump-set","linkage"],kt={"background-overall-component":["all"],"border-style":["all"],"label-selector":["fontSize","color"],"tooltip-selector":["fontSize","color","backgroundColor","show"],"dual-basic-style-selector":["colors","alpha","gradient","lineWidth","lineSymbol","lineSymbolSize","lineSmooth","radiusColumnBar","subSeriesColor","seriesColor","columnWidthRatio"],"x-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine"],"dual-y-axis-selector":["name","color","fontSize","axisLabel","axisLine","splitLine","axisValue","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["emptyDataStrategy"]},Hi=["xAxis","yAxis","drill","filter","extLabel","extTooltip"],Re={...ot,subAlpha:100,subColorScheme:"fast",subSeriesColor:[],subColors:["#fae800","#00c039","#0482dc","#bb9581","#ff7701","#9c5ec3","#00ccdf","#00c039","#ff7701"],leftLineWidth:2,leftLineSymbol:"circle",leftLineSymbolSize:4,leftLineSmooth:!0},En=Object.freeze(Object.defineProperty({__proto__:null,CHART_MIX_AXIS_TYPE:Hi,CHART_MIX_DEFAULT_BASIC_STYLE:Re,CHART_MIX_EDITOR_PROPERTY:$i,CHART_MIX_EDITOR_PROPERTY_INNER:kt},Symbol.toStringTag,{value:"Module"})),{t:mt}=Y(),Fn=[];class io extends Q{constructor(t="chart-mix"){super(t,Fn);v(this,"properties",$i);v(this,"propertyInner",{...kt,"label-selector":["vPosition","seriesLabelFormatter"],"tooltip-selector":[...kt["tooltip-selector"],"seriesTooltipFormatter"]});v(this,"axis",[...Hi,"xAxisExtRight","yAxisExt"]);v(this,"axisConfig",{xAxis:{name:`${mt("chart.drag_block_type_axis")} / ${mt("chart.dimension")}`,type:"d"},yAxis:{name:`${mt("chart.drag_block_value_axis_left")} / ${mt("chart.column_quota")}`,limit:1,type:"q"},extBubble:{name:`${mt("chart.drag_block_type_axis_right")} / ${mt("chart.dimension")}`,limit:1,type:"d",allowEmpty:!0},yAxisExt:{name:`${mt("chart.drag_block_value_axis_right")} / ${mt("chart.line_quota")}`,limit:1,type:"q",allowEmpty:!0}})}getLeftType(){return"column"}getRightType(){return"line"}async drawChart(t){var S,A,C,w,T,z,N,O,_,k,E,I,B,F;const{chart:e,action:o,container:i}=t;if(!((C=(A=(S=e.data)==null?void 0:S.left)==null?void 0:A.data)!=null&&C.length)&&!((z=(T=(w=e.data)==null?void 0:w.right)==null?void 0:T.data)!=null&&z.length))return;const l=G((O=(N=e.data)==null?void 0:N.left)==null?void 0:O.data),n=G((k=(_=e.data)==null?void 0:_.right)==null?void 0:k.data),a=this.getLeftType(),s=this.getRightType(),r=this.name==="chart-mix-group"&&((E=e.xAxisExt)==null?void 0:E.length)>0,d=this.name==="chart-mix-stack"&&((I=e.extStack)==null?void 0:I.length)>0,m="category",c="category",p=bt((B=l[0])==null?void 0:B.data,[]),h=vo(bt((F=n[0])==null?void 0:F.data,[]),M=>({...M,valueExt:M.value})),g={data:[p,h],xField:"field",yField:["value","valueExt"],appendPadding:nt(e),geometryOptions:[{geometry:a,color:[],isGroup:r,isStack:d,seriesField:m},{geometry:s,color:[],seriesField:c}],interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region"}]},y=this.setupOptions(e,g),{DualAxes:x}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(M=>M.a8),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),b=new x(i,y);return b.on("point:click",o),b.on("interval:click",o),ft(e,b),b}configLabel(t,e){var s;const o=Se(t),i={...e};if(!o)return i.geometryOptions&&(i.geometryOptions[0].label=!1,i.geometryOptions[1].label=!1),i;const l=L(t.customAttr).label,n={};return(s=l.seriesLabelFormatter)==null||s.forEach(r=>{n[r.axisType]||(n[r.axisType]=[]),n[r.axisType].push(r)}),["yAxis","yAxisExt"].forEach(r=>{var c;const d=(c=n[r])==null?void 0:c.reduce((p,h)=>(p[h.id]=h,p),{});o.style.fill=Gt.color;const m={fields:[],...o,offsetY:-8,formatter:p=>{var x;if(!((x=l.seriesLabelFormatter)!=null&&x.length))return p.value;const h=d==null?void 0:d[p.quotaList[0].id];if(!h)return p.value;if(!h.show)return;const g=D(p.value,h.formatterCfg),y=new Ut({});return y.addShape({type:"text",attrs:{x:0,y:0,text:g,textAlign:"start",textBaseline:"top",fontSize:h.fontSize,fontFamily:t.fontFamily,fill:h.color}}),y}};i.geometryOptions&&(r==="yAxis"?i.geometryOptions[0].label=m:r==="yAxisExt"&&(i.geometryOptions[1].label=m))}),i}configBasicStyle(t,e){const o=L(t.customAttr),i=Ft(JSON.parse(JSON.stringify(o.basicStyle)),Re),l=i.lineSmooth,n={size:i.lineSymbolSize,shape:i.lineSymbol,style:{stroke:P("#FFFFFF",i.subAlpha)}},a={lineWidth:i.lineWidth},s=i.leftLineSmooth,r={size:i.leftLineSymbolSize,shape:i.leftLineSymbol,style:{stroke:P("#FFFFFF",i.alpha)}},d={lineWidth:i.leftLineWidth},m={...e,smooth:l,point:n,lineStyle:a};if(m.geometryOptions&&(m.geometryOptions[0].smooth=s,m.geometryOptions[0].point=r,m.geometryOptions[0].lineStyle=d,m.geometryOptions[1].smooth=l,m.geometryOptions[1].point=n,m.geometryOptions[1].lineStyle=a,i.radiusColumnBar==="roundAngle")){const h={radius:[i.columnBarRightAngleRadius,i.columnBarRightAngleRadius,i.columnBarRightAngleRadius,i.columnBarRightAngleRadius]};m.geometryOptions[0].columnStyle=h,m.geometryOptions[1].columnStyle=h}let c;const p=i.columnWidthRatio??ot.columnWidthRatio;return p>=1&&p<=100?c=p/100:p<1?c=1/100:p>100&&(c=1),c&&(m.geometryOptions[0].columnWidthRatio=c),super.name!=="chart-mix-dual-line"&&(m.geometryOptions[0].appendPadding=nt(t)),m}setupDefaultOptions(t){const{customAttr:e,senior:o}=t;return(o.functionCfg.emptyDataStrategy==null||o.functionCfg.emptyDataStrategy==="ignoreData")&&(o.functionCfg.emptyDataStrategy="breakLine"),t}configCustomColors(t,e){const o={...e},i=L(t.customAttr).basicStyle,{seriesColor:l}=i;if(l!=null&&l.length){const a=l.reduce((r,d)=>(r[d.id]=d,r),{}),{yAxis:s}=t;s==null||s.forEach((r,d)=>{const m=a[r.id];m&&(d+1>i.colors.length?i.colors.push(m.color):i.colors[d]=m.color)})}const n=i.colors.map(a=>{const s=P(a,i.alpha);return i.gradient?tt(s,!0,270):s});return o.geometryOptions[0].color=n,o}configSubCustomColors(t,e){var a;const o={...e},i=Ft(L(t.customAttr).basicStyle,G(Re)),{subSeriesColor:l}=i;if(l!=null&&l.length){const{yAxisExt:s,extBubble:r}=t,d=l.reduce((c,p)=>(c[p.id]=p,c),{}),{data:m}=e;if(r!=null&&r.length){const c=new Set;(a=m[1])==null||a.forEach(h=>h.category!==null&&c.add(h.category)),[...c].forEach((h,g)=>{const y=d[h];y&&(g+1>i.subColors.length?i.subColors.push(y.color):i.subColors[g]=y.color)})}else s==null||s.forEach((c,p)=>{const h=d[c.id];h&&(p+1>i.subColors.length?i.subColors.push(h.color):i.subColors[p]=h.color)})}const n=i.subColors.map(s=>P(s,i.subAlpha));return o.geometryOptions[1].color=n,o}setupSubSeriesColor(t,e){const o=[],i=new Set,l=t.customAttr.basicStyle.subColors??Re.subColors,{yAxisExt:n,extBubble:a}=t;return a!=null&&a.length?e==null||e.forEach(s=>{s.value===null||s.category===null||i.has(s.category)||(i.add(s.category),o.push({id:s.category,name:s.category,color:l[(i.size-1)%l.length]}))}):n==null||n.forEach(s=>{i.has(s.id)||(i.add(s.id),o.push({id:s.id,name:s.chartShowName??s.name,color:l[(i.size-1)%l.length]}))}),o}configYAxis(t,e){const o=Qe(t),i=bi(t),l={...e};if(l.yAxis={},!o)l.yAxis.value=!1;else{l.yAxis.value=void 0,o.position="left";const n=L(t.customStyle).yAxis;o.label&&(o.label.style.textAlign="end",o.label.formatter=s=>D(s,n.axisLabelFormatter));const a=n.axisValue;a!=null&&a.auto?l.yAxis.value=o:l.yAxis.value={...o,min:a.min,max:a.max,minLimit:a.min,maxLimit:a.max,tickCount:a.splitCount}}if(!i)l.yAxis.valueExt=!1;else{l.yAxis.valueExt=void 0,i.position="right";const n=L(t.customStyle).yAxisExt;i.label&&(i.label.style.textAlign="start",i.label.formatter=s=>D(s,n.axisLabelFormatter));const a=n.axisValue;a!=null&&a.auto?l.yAxis.valueExt=i:l.yAxis.valueExt={...i,min:a.min,max:a.max,minLimit:a.min,maxLimit:a.max,tickCount:a.splitCount}}return l}configTooltip(t,e){var a;const i=L(t.customAttr).tooltip;if(!i.show)return{...e,tooltip:!1};const l=(a=i.seriesTooltipFormatter)==null?void 0:a.filter(s=>s.show).reduce((s,r)=>(s[r.id]=r,s),{}),n={shared:!0,showTitle:!0,customItems(s){var m,c;if(!((m=i.seriesTooltipFormatter)!=null&&m.length))return s;const r=s[0];if(!r.data.quotaList)return s;const d=[];return s.filter(p=>l[p.data.quotaList[0].id]).forEach(p=>{const h=l[p.data.quotaList[0].id],g=D(parseFloat(p.value),h.formatterCfg),y=p.data.category;d.push({...p,name:y,value:g})}),(c=r.data.dynamicTooltipValue)==null||c.forEach(p=>{const h=l[p.fieldId];if(h){const g=D(parseFloat(p.value),h.formatterCfg),y=W(h.chartShowName)?h.name:h.chartShowName;d.push({color:"grey",name:y,value:g})}}),d},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:n}}configLegend(t,e){var i,l,n,a;const o=super.configLegend(t,e);if(o.legend){const s=G((l=(i=t.data)==null?void 0:i.left)==null?void 0:l.data),r=G((a=(n=t.data)==null?void 0:n.right)==null?void 0:a.data);o.legend.itemName.formatter=(c,p,h)=>{var y,x;let g;return p.viewId==="left-axes-view"&&c==="value"?g=(y=s[0])==null?void 0:y.categories[0]:p.viewId==="right-axes-view"&&c==="valueExt"&&(g=(x=r[0])==null?void 0:x.categories[0]),p.id=p.id+"__"+h,g===void 0?c:g};const d=L(t.customStyle);let m;d&&d.legend?m=ce(JSON.parse(JSON.stringify(d.legend)),Lt).size:m=Lt.size,o.legend.marker.style=c=>{const p=c.fill??c.stroke;return{r:m,fill:p}}}return o}configAnalyse(t,e){var l,n,a,s;t.data.dynamicAssistLines=Ol(bt((n=(l=t.data)==null?void 0:l.left)==null?void 0:n.dynamicAssistLines,[]),bt((s=(a=t.data)==null?void 0:a.right)==null?void 0:s.dynamicAssistLines,[]));const o=Si(t),i={value:$e(o,r=>r.yAxisType==="left"),valueExt:$e(o,r=>r.yAxisType==="right")};return{...e,annotations:i}}setupOptions(t,e){return U(this.configTheme,this.configLabel,this.configTooltip,this.configBasicStyle,this.configCustomColors,this.configSubCustomColors,this.configLegend,this.configXAxis,this.configYAxis,this.configAnalyse,this.configEmptyDataStrategy)(t,e)}}class zn extends io{constructor(t="chart-mix-group"){super(t);v(this,"axis",[...this.axis,"xAxisExt"]);v(this,"propertyInner",{...kt,"label-selector":["vPosition","seriesLabelFormatter"],"tooltip-selector":[...kt["tooltip-selector"],"seriesTooltipFormatter"]});v(this,"axisConfig",{...this.axisConfig,xAxisExt:{name:`${mt("chart.chart_group")} / ${mt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}})}configCustomColors(t,e){var a;const o={...e},i=L(t.customAttr).basicStyle,{seriesColor:l}=i;if(l!=null&&l.length){const s=l.reduce((c,p)=>(c[p.id]=p,c),{}),{yAxis:r,xAxisExt:d}=t,{data:m}=e;if(d!=null&&d.length){const c=new Set;(a=m[0])==null||a.forEach(h=>h.category!==null&&c.add(h.category)),[...c].forEach((h,g)=>{const y=s[h];y&&(g+1>i.colors.length?i.colors.push(y.color):i.colors[g]=y.color)})}else r==null||r.forEach((c,p)=>{const h=s[c.id];h&&(p+1>i.colors.length?i.colors.push(h.color):i.colors[p]=h.color)})}const n=i.colors.map(s=>{const r=P(s,i.alpha);return i.gradient?tt(r,!0,270):r});return o.geometryOptions[0].color=n,o}setupSeriesColor(t,e){const o=[],i=new Set,l=t.customAttr.basicStyle.colors,{yAxis:n,xAxisExt:a}=t;return a!=null&&a.length?e==null||e.forEach(s=>{s.value===null||s.category===null||i.has(s.category)||(i.add(s.category),o.push({id:s.category,name:s.category,color:l[(i.size-1)%l.length]}))}):n==null||n.forEach(s=>{i.has(s.id)||(i.add(s.id),o.push({id:s.id,name:s.chartShowName??s.name,color:l[(i.size-1)%l.length]}))}),o}}class kn extends io{constructor(t="chart-mix-stack"){super(t);v(this,"axis",[...this.axis,"extStack"]);v(this,"propertyInner",{...kt,"label-selector":["vPosition","seriesLabelFormatter"],"tooltip-selector":[...kt["tooltip-selector"],"seriesTooltipFormatter"]});v(this,"axisConfig",{...this.axisConfig,extStack:{name:`${mt("chart.stack_item")} / ${mt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}})}configCustomColors(t,e){var a;const o={...e},i=L(t.customAttr).basicStyle,{seriesColor:l}=i;if(l!=null&&l.length){const s=l.reduce((c,p)=>(c[p.id]=p,c),{}),{yAxis:r,extStack:d}=t,{data:m}=e;if(d!=null&&d.length){const c=new Set;(a=m[0])==null||a.forEach(h=>h.category!==null&&c.add(h.category)),[...c].forEach((h,g)=>{const y=s[h];y&&(g+1>i.colors.length?i.colors.push(y.color):i.colors[g]=y.color)})}else r==null||r.forEach((c,p)=>{const h=s[c.id];h&&(p+1>i.colors.length?i.colors.push(h.color):i.colors[p]=h.color)})}const n=i.colors.map(s=>{const r=P(s,i.alpha);return i.gradient?tt(r,!0,270):r});return o.geometryOptions[0].color=n,o}setupSeriesColor(t,e){const o=[],i=new Set,l=t.customAttr.basicStyle.colors,{yAxis:n,extStack:a}=t;return a!=null&&a.length?e==null||e.forEach(s=>{s.value===null||s.category===null||i.has(s.category)||(i.add(s.category),o.push({id:s.category,name:s.category,color:l[(i.size-1)%l.length]}))}):n==null||n.forEach(s=>{i.has(s.id)||(i.add(s.id),o.push({id:s.id,name:s.chartShowName??s.name,color:l[(i.size-1)%l.length]}))}),o}}class On extends io{constructor(t="chart-mix-dual-line"){super(t);v(this,"axis",[...this.axis,"xAxisExt"]);v(this,"propertyInner",{...kt,"label-selector":["seriesLabelFormatter"],"tooltip-selector":[...kt["tooltip-selector"],"seriesTooltipFormatter"]});v(this,"axisConfig",{...this.axisConfig,xAxisExt:{name:`${mt("chart.drag_block_type_axis_left")} / ${mt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}})}getLeftType(){return"line"}configCustomColors(t,e){var a;const o={...e},i=L(t.customAttr).basicStyle,{seriesColor:l}=i;if(l!=null&&l.length){const s=l.reduce((c,p)=>(c[p.id]=p,c),{}),{yAxis:r,xAxisExt:d}=t,{data:m}=e;if(d!=null&&d.length){const c=new Set;(a=m[0])==null||a.forEach(h=>h.category!==null&&c.add(h.category)),[...c].forEach((h,g)=>{const y=s[h];y&&(g+1>i.colors.length?i.colors.push(y.color):i.colors[g]=y.color)})}else r==null||r.forEach((c,p)=>{const h=s[c.id];h&&(p+1>i.colors.length?i.colors.push(h.color):i.colors[p]=h.color)})}const n=i.colors.map(s=>{const r=P(s,i.alpha);return i.gradient?tt(r,!0,270):r});return o.geometryOptions[0].color=n,o}setupSeriesColor(t,e){const o=[],i=new Set,l=t.customAttr.basicStyle.colors,{yAxis:n,xAxisExt:a}=t;return a!=null&&a.length?e==null||e.forEach(s=>{s.value===null||s.category===null||i.has(s.category)||(i.add(s.category),o.push({id:s.category,name:s.category,color:l[(i.size-1)%l.length]}))}):n==null||n.forEach(s=>{i.has(s.id)||(i.add(s.id),o.push({id:s.id,name:s.chartShowName??s.name,color:l[(i.size-1)%l.length]}))}),o}}const In=Object.freeze(Object.defineProperty({__proto__:null,ColumnLineMix:io,DualLineMix:On,GroupColumnLineMix:zn,StackColumnLineMix:kn},Symbol.toStringTag,{value:"Module"})),{t:Kt}=Y(),Nn=[];class Bn extends Q{constructor(){super("circle-packing",Nn);v(this,"properties",["basic-style-selector","background-overall-component","border-style","label-selector","legend-selector","title-selector","tooltip-selector","jump-set","linkage"]);v(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","circleBorderStyle"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"function-cfg":["emptyDataStrategy"],"label-selector":["color","fontSize"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"tooltip-selector":["color","fontSize","backgroundColor","tooltipFormatter","show"]});v(this,"axis",["xAxis","yAxis","filter","drill"]);v(this,"axisConfig",{xAxis:{name:`${Kt("chart.circle_packing_name")} / ${Kt("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Kt("chart.circle_packing_value")} / ${Kt("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var l,n,a;const{chart:e,container:o,action:i}=t;if((n=(l=e==null?void 0:e.data)==null?void 0:l.data)!=null&&n.length){const s=e.data.data,{xAxis:r,yAxis:d,drillFields:m}=e,c=((a=d[0])==null?void 0:a.sort)??"none",p={sort:(S,A)=>c==="asc"?S.value-A.value:c==="desc"?A.value-S.value:0},g={data:(()=>{const S=[{name:Kt("commons.all"),children:[]}],A=(C,w)=>{const T={...w,name:w.name,children:[]};C.push(T)};return s.forEach(C=>A(S[0].children,C)),S[0]})(),appendPadding:nt(e),hierarchyConfig:{...c==="none"?{}:p},interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}}]},y=this.setupOptions(e,g),{CirclePacking:x}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(S=>S.a7),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),b=new x(o,y);return b.on("element:click",S=>{var w;const A=(w=S==null?void 0:S.data)==null?void 0:w.data;if((A==null?void 0:A.name)===Kt("commons.all"))return;const C={x:S.x,y:S.y,data:{data:{...A}}};i(C)}),b}}configBasicStyle(t,e){const o=L(t.customAttr),i=JSON.parse(JSON.stringify(o.basicStyle)),l={stroke:i.circleBorderColor,lineWidth:i.circleBorderWidth??0},n=i.circlePadding;return{...e,hierarchyConfig:{...e.hierarchyConfig,padding:n/100},pointStyle:l}}configLabel(t,e){const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const{label:i}=L(t.customAttr),l={...o.label,textAlign:"center",offsetY:5,layout:i.fullDisplay?[{type:"limit-in-plot"}]:o.label.layout,formatter:(n,a)=>n.children.length===0?n.name:""};return{...o,label:l}}configTooltip(t,e){const o=super.configTooltip(t,e);if(!o.tooltip)return o;const i=L(t.customAttr).tooltip;return{...o,tooltip:{...o,fields:["name","value"],formatter:l=>{let n=l.value;return i.tooltipFormatter&&(n=D(n,i.tooltipFormatter)),{name:l.name,value:n}}}}}configEmptyDataStrategy(t,e){const{functionCfg:o}=L(t.senior),i=o.emptyDataStrategy,l=a=>{var s,r,d,m,c;if(i==="ignoreData")for(let p=a.length-1;p>=0;p--){let h=[];(s=a[p].children)!=null&&s.length&&(h=a[p].children.filter(g=>g.value!==null)),(r=a[p].children)!=null&&r.length&&h.length&&l(a[p].children),(d=a[p])!=null&&d.hasOwnProperty("value")&&a[p].value===null&&a.splice(p,1),!((m=a[p])!=null&&m.hasOwnProperty("value"))&&h.length===0&&a.splice(p,1)}else for(let p=a.length-1;p>=0;p--){let h=[];if((c=a[p].children)!=null&&c.length&&(h=a[p].children.filter(g=>g.value!==null),!h.length)){a[p].children=[];continue}l(a[p].children)}},n=G(e.data.children);return l(n),e.data.children=n,e}setupDefaultOptions(t){const{customAttr:e,customStyle:o,senior:i}=t,{label:l,basicStyle:n}=e,{legend:a}=o;return i.functionCfg.emptyDataStrategy="ignoreData",e.label={...l,show:!0},a.show=!1,n.circleBorderWidth=0,n.circleBorderColor="#fff",n.circlePadding=0,t}setupOptions(t,e){return U(this.configTheme,this.configEmptyDataStrategy,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend)(t,e)}}const Dn=Object.freeze(Object.defineProperty({__proto__:null,CirclePacking:Bn},Symbol.toStringTag,{value:"Module"})),{t:pe}=Y();class Mn extends Q{constructor(){super("funnel",[]);v(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","legend-selector","jump-set","linkage"]);v(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","seriesColor"],"label-selector":["fontSize","color","hPosition","showQuota","conversionTag"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"],"title-selector":["show","title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"]});v(this,"axis",["xAxis","yAxis","filter","drill","extLabel","extTooltip"]);v(this,"axisConfig",{xAxis:{name:`${pe("chart.drag_block_funnel_split")} / ${pe("chart.dimension")}`,type:"d"},yAxis:{name:`${pe("chart.drag_block_funnel_width")} / ${pe("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var d;const{chart:e,container:o,action:i}=t;if(!((d=e.data)!=null&&d.data))return;const n={data:e.data.data,xField:"field",yField:"value",appendPadding:nt(e),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}}],meta:{field:{type:"cat"}}},a=this.setupOptions(e,n),{Funnel:s}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(m=>m.a0),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("interval:click",i),ft(e,r),r}configLabel(t,e){var n;let o,i,l;if(t.customAttr){l=L(t.customAttr);const a=l.label.showQuota,s=l.label;if((n=l.label)!=null&&n.show){if(a){const d=[];s.fullDisplay||d.push({type:"hide-overlap"},{type:"limit-in-plot"}),o={position:s.position,layout:d,style:{fill:s.color,fontSize:s.fontSize},formatter:function(c){return D(c.value,s.quotaLabelFormatter)}},o.position==="right"&&(o.offsetX=-40)}const r=L(t.customAttr).label.conversionTag;r&&r.show&&(i={style:{fill:s.color,fontSize:s.fontSize},formatter:d=>{if(!d.$$conversion$$[0])return`${r.text??""} -`;const m=(d.$$conversion$$[1]/d.$$conversion$$[0]*100).toFixed(r.precision);return`${r.text??""} ${m}%`}})}return{...e,label:o,conversionTag:i,maxSize:i?.8:1}}return e}setupSeriesColor(t,e){return be(t,e)}setupOptions(t,e){return U(this.configTheme,this.configSingleDimensionColor,this.configLabel,this.configMultiSeriesTooltip,this.configLegend)(t,e)}setupDefaultOptions(t){const{customAttr:e,customStyle:o}=t,{label:i}=e;["left","middle","right"].includes(i.position)||(i.position="middle"),e.label={...i,show:!0,showQuota:!0,conversionTag:{show:!1,precision:2,text:pe("chart.conversion_rate")}};const{legend:l}=o;return l.show=!1,t}}const Rn=Object.freeze(Object.defineProperty({__proto__:null,Funnel:Mn},Symbol.toStringTag,{value:"Module"})),{t:ro}=Y(),Pn=[];class $n extends Q{constructor(){super("gauge",Pn);v(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","misc-selector","title-selector","threshold"]);v(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","gaugeAxisLine","gaugePercentLabel"],"label-selector":["fontSize","color","labelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"misc-selector":["gaugeMinType","gaugeMinField","gaugeMin","gaugeMaxType","gaugeMaxField","gaugeMax","gaugeStartAngle","gaugeEndAngle"],threshold:["gaugeThreshold"]});v(this,"axis",["yAxis","filter"]);v(this,"axisConfig",{yAxis:{name:`${ro("chart.drag_block_gauge_angel")} / ${ro("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var m,c;const{chart:e,container:o,scale:i,action:l}=t;if(!((m=e.data)!=null&&m.series)||!e.yAxis.length)return;const n={percent:0,appendPadding:nt(e),axis:{tickInterval:.2,label:{style:{fontSize:$t(12,i)}},tickLine:{length:$t(12,i)*-1,style:{lineWidth:$t(1,i)}},subTickLine:{count:4,length:$t(6,i)*-1,style:{lineWidth:$t(1,i)}}}},a=this.setupOptions(e,n,{scale:i}),{Gauge:s}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(p=>p.a1),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);r.on("afterrender",()=>{var p,h;l({from:"gauge",data:{type:"gauge",max:(h=(p=e.data)==null?void 0:p.series[0])==null?void 0:h.data[0]}})});const d=(c=e.data)==null?void 0:c.series.some(p=>{var h;return!((h=p.data)!=null&&h[0])});if(this.configEmptyDataStyle(d?[]:[1],o,r),!d)return r}configMisc(t,e,o){var c,p,h,g,y,x,b,S,A,C,w,T,z,N,O;const i=L(t.customAttr),l=t.data.series[0].data[0];let n,a,s,r;if(i.misc){const _=i.misc;_.gaugeMinType==="dynamic"&&_.gaugeMaxType==="dynamic"?(n=(h=(p=t.data)==null?void 0:p.series[((c=t.data)==null?void 0:c.series.length)-2])==null?void 0:h.data[0],a=(x=(y=t.data)==null?void 0:y.series[((g=t.data)==null?void 0:g.series.length)-1])==null?void 0:x.data[0]):_.gaugeMinType!=="dynamic"&&_.gaugeMaxType==="dynamic"?(n=_.gaugeMin||_.gaugeMin===0?_.gaugeMin:qt.gaugeMin,a=(A=(S=t.data)==null?void 0:S.series[((b=t.data)==null?void 0:b.series.length)-1])==null?void 0:A.data[0]):_.gaugeMinType==="dynamic"&&_.gaugeMaxType!=="dynamic"?(n=(T=(w=t.data)==null?void 0:w.series[((C=t.data)==null?void 0:C.series.length)-1])==null?void 0:T.data[0],a=_.gaugeMax?_.gaugeMax:qt.gaugeMax):(n=_.gaugeMin||_.gaugeMin===0?_.gaugeMin:qt.gaugeMin,a=_.gaugeMax?_.gaugeMax:(O=(N=t.data)==null?void 0:N.series[((z=t.data)==null?void 0:z.series.length)-1])==null?void 0:O.data[0]),s=_.gaugeStartAngle*Math.PI/180,r=_.gaugeEndAngle*Math.PI/180,o.min=n,o.max=a}const m={percent:(parseFloat(l)-parseFloat(n))/(parseFloat(a)-parseFloat(n)),startAngle:s,endAngle:r};return{...e,...m}}configRange(t,e,o){var c;const{scale:i}=o,l=[0];let n=0,a=!1,s=!1;const r=e.theme;if(t.senior){const h=L(t.senior).threshold??El;if(h.enable&&h.gaugeThreshold){s=!0;const g=h.gaugeThreshold.split(",");for(let y=0;y<g.length;y++){const x=g[y],b=parseFloat(x)/100;l.push(b),!a&&e.percent<=b&&(a=!0,n=y)}a||(n=g.length)}}l.push(1);let d;if(s?d={range:{color:r.styleSheet.paletteQualitative10,ticks:l},indicator:{pointer:{style:{stroke:r.styleSheet.paletteQualitative10[n%r.styleSheet.paletteQualitative10.length]}},pin:{style:{stroke:r.styleSheet.paletteQualitative10[n%r.styleSheet.paletteQualitative10.length],r:$t(10,i)}}}}:d={indicator:{pin:{style:{r:$t(10,i)}}}},L(t.customAttr).basicStyle.gradient){const p=(((c=r.styleSheet)==null?void 0:c.paletteQualitative10)||[]).map(h=>tt(h,!0));d.range?d.range.color=p:d.range={color:p}}return{...e,...d}}configLabel(t,e,o){const i=L(t.customAttr),l=t.data.series[0].data[0];let n=!1,a=!1;const s=i.label,r=s.labelFormatter??Gt.labelFormatter;s.show&&s.childrenShow&&(n={style:{fontSize:`${s.fontSize}px`,color:s.color},formatter:function(){let y;return r.type==="percent"?y=e.percent:y=l,D(y,r)}});const{min:d,max:m}=o;if(s.show&&s.proportionSeriesFormatter.show){const y=s.proportionSeriesFormatter;a={offsetY:y.fontSize+s.fontSize,style:{fontSize:`${y.fontSize}px`,color:y.color},formatter:function(){const x=(parseFloat(l)-d)/(m-d)*100;return ro("chart.proportion")+"： "+x.toFixed(y.formatterCfg.decimalCount)+"%"}}}const c={title:n,content:a},{gaugeAxisLine:p,gaugePercentLabel:h}=i.basicStyle;return e=xt(e,{axis:{label:{formatter:y=>{if(p===!1)return"";if(h===!1){const x=y==="0"?d:y==="1"?m:d+(m-d)*y;return r.type==="value"?D(x,r):x}return y==="0"?y:y*100+"%"}}}}),{...e,statistic:c}}setupDefaultOptions(t){return t.customAttr.label={...t.customAttr.label,show:!0,labelFormatter:{type:"value",thousandSeparator:!0,decimalCount:0,unit:1}},t}setupOptions(t,e,o){return U(this.configTheme,this.configMisc,this.configLabel,this.configRange)(t,e,o)}}const Hn=Object.freeze(Object.defineProperty({__proto__:null,Gauge:$n},Symbol.toStringTag,{value:"Module"})),{t:Wn}=Y();class Vn extends Ce{constructor(){super(to.CUSTOM,Pt.INDICATOR,"indicator");v(this,"selectorSpec");v(this,"properties",["background-overall-component","border-style","title-selector","indicator-value-selector","indicator-name-selector","threshold","function-cfg"]);v(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"indicator-value-selector":["fontSize","color","hPosition","isItalic","isBolder","fontFamily","letterSpace","fontShadow"],"indicator-name-selector":["title","fontSize","color","hPosition","isItalic","isBolder","fontFamily","letterSpace","fontShadow"],"function-cfg":["emptyDataStrategy"]});v(this,"axis",["yAxis","filter"]);v(this,"axisConfig",{yAxis:{name:`${Wn("chart.quota")}`,limit:1}})}setupDefaultOptions(t){const e=Fl[0].colors;return t.customAttr.basicStyle.colors=e,t.customAttr.indicator.color=e[0],t.customAttr.indicatorName.color=e[1],t}}const Yn=Object.freeze(Object.defineProperty({__proto__:null,IndicatorChartView:Vn},Symbol.toStringTag,{value:"Module"})),{t:Jo}=Y();class qn extends Ce{constructor(){super(to.CUSTOM,Pt.PICTURE_GROUP,"picture-group");v(this,"properties",["background-overall-component","border-style","threshold"]);v(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],threshold:["tableThreshold"]});v(this,"axis",["xAxis","yAxis","filter"]);v(this,"axisConfig",{xAxis:{name:`${Jo("chart.dimension")}`,type:"d"},yAxis:{name:`${Jo("chart.quota")}`,type:"q"}})}}const jn=Object.freeze(Object.defineProperty({__proto__:null,PictureGroupView:qn},Symbol.toStringTag,{value:"Module"})),{t:Nt}=Y();class Gn extends Q{constructor(){super("quadrant",[]);v(this,"properties",["background-overall-component","border-style","basic-style-selector","x-axis-selector","y-axis-selector","title-selector","label-selector","tooltip-selector","legend-selector","jump-set","linkage","quadrant-selector"]);v(this,"propertyInner",{"basic-style-selector":["colors","alpha","scatterSymbol","scatterSymbolSize","seriesColor"],"label-selector":["fontSize","color"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"x-axis-selector":["position","name","color","fontSize","axisLine","axisValue","splitLine","axisForm","axisLabel","axisLabelFormatter"],"y-axis-selector":["position","name","color","fontSize","axisValue","axisLine","splitLine","axisForm","axisLabel","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"],"quadrant-selector":["regionStyle","label","lineStyle"]});v(this,"axis",["xAxis","yAxis","yAxisExt","extBubble","filter","drill","extLabel","extTooltip"]);v(this,"axisConfig",{extBubble:{name:`${Nt("chart.bubble_size")} / ${Nt("chart.quota")}`,type:"q",limit:1,allowEmpty:!0},xAxis:{name:`${Nt("chart.form_type")} / ${Nt("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Nt("chart.x_axis")} / ${Nt("chart.quota")}`,type:"q",limit:1},yAxisExt:{name:`${Nt("chart.y_axis")} / ${Nt("chart.quota")}`,type:"q",limit:1}})}getFieldObject(t){var n,a,s,r,d,m,c,p;const e={id:(n=t.xAxis[0])==null?void 0:n.id,name:(a=t.xAxis[0])==null?void 0:a.originName},o={id:(s=t.extBubble[0])==null?void 0:s.id,name:(r=t.extBubble[0])==null?void 0:r.originName},i={id:(d=t.yAxis[0])==null?void 0:d.id,name:(m=t.yAxis[0])==null?void 0:m.originName},l={id:(c=t.yAxisExt[0])==null?void 0:c.id,name:(p=t.yAxisExt[0])==null?void 0:p.originName};return{colorFieldObj:e,sizeFieldObj:o,xFieldObj:i,yFieldObj:l}}getUniqueObjects(t){return[...new Set(t.map(JSON.stringify))].map(JSON.parse)}async drawChart(t){var N,O,_,k;const{chart:e,container:o,action:i,quadrantDefaultBaseline:l}=t;if(!((N=e.data)!=null&&N.data))return;const n=G(e.data.data),a=bt((O=n[0])==null?void 0:O.data,[]),s=bt((_=n[1])==null?void 0:_.data,[]),r=bt((k=n[2])==null?void 0:k.data,[]),d=a.map(E=>{var I;return{...E,id:(I=E.quotaList[0])==null?void 0:I.id,field:E.field,value:E.value}}),m=s.map(E=>{var I;return{...E,id:(I=E.quotaList[0])==null?void 0:I.id,field:E.field,value:E.value}}),c=r.map(E=>{var I;return{...E,id:(I=E.quotaList[0])==null?void 0:I.id,field:E.field,value:E.value}}),p=d.map(E=>E.value),h=((Math.max(...p)+Math.min(...p))/2).toFixed(),g=m.map(E=>E.value),y=((Math.max(...g)+Math.min(...g))/2).toFixed(),x={...e.customAttr.quadrant};x.xBaseline===void 0&&(x.xBaseline=h,x.yBaseline=y);const b=E=>{var F,M;const I=(F=c.find($=>$.field===E.field))==null?void 0:F.quotaList,B=(M=m.find($=>$.field===E.field))==null?void 0:M.quotaList;return JSON.stringify(I)===JSON.stringify(B)?B:[...I||[],...B||[]]},S=vo(bt(d,[]),E=>{var I,B;return{...E,yAxis:E.value,quotaList:b(E),yAxisExt:(I=m.find(F=>F.field===E.field))==null?void 0:I.value,extBubble:(B=c.find(F=>F.field===E.field))==null?void 0:B.value}}),A={colorField:"field",meta:{field:{type:"cat"}},quadrant:{...x},data:S,xField:"yAxis",yField:"yAxisExt",appendPadding:30,pointStyle:{fillOpacity:.8,stroke:"#bbb"}};e.container=o;const C=this.setupOptions(e,A),{Scatter:w}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(E=>E.a4),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),T=new w(o,C);T.on("point:click",i),T.on("click",()=>l(x)),T.on("afterrender",()=>l(x));const z=L(e.customStyle).yAxis;return z!=null&&z.name&&(Es(e,T),Xt(e,T,"axis-title")),ft(e,T),T}configBasicStyle(t,e){var l;const i=L(t.customAttr).basicStyle;return(l=t.extBubble)!=null&&l.length?{...e,size:[4,30],sizeField:"extBubble",shape:i.scatterSymbol}:{...e,size:i.scatterSymbolSize,shape:i.scatterSymbol}}configXAxis(t,e){const o=super.configXAxis(t,e);if(!o.xAxis)return o;const i=L(t.customStyle).xAxis;o.xAxis.label&&(o.xAxis.label.formatter=n=>D(n,i.axisLabelFormatter));const l=i.axisValue;if(!(l!=null&&l.auto)){const n={xAxis:{...o.xAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const i=L(t.customStyle).yAxis;o.yAxis.label&&(o.yAxis.label.formatter=n=>D(n,i.axisLabelFormatter));const l=i.axisValue;if(!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configLabel(t,e){let o,i;if(t.customAttr&&(i=L(t.customAttr),i.label)){const l=i.label;if(l.show){const n=[];l.fullDisplay||(n.push({type:"hide-overlap"}),n.push({type:"limit-in-shape"})),o={offset:0,style:{fill:l.color,fontSize:l.fontSize},content:a=>a.name,layout:n}}else o=!1}return{...e,label:o}}configTooltip(t,e){var m;const i=L(t.customAttr).tooltip,l=t.xAxis[0],n=t.yAxis[0],a=t.yAxisExt[0];if(!i.show||!l&&!n&&!a)return{...e,tooltip:!1};const s=(m=i.seriesTooltipFormatter)==null?void 0:m.filter(c=>c.show).reduce((c,p)=>(c[p.seriesId]=p,c),{}),r=G(e.data),d={showTitle:!0,title:(c,p)=>p==null?void 0:p.name,customItems(c){var g,y;if(!((g=i.seriesTooltipFormatter)!=null&&g.length))return c;const p=[];c.forEach(x=>{Object.keys(s).forEach(b=>{if(b.endsWith(x.name)){const S=s[b];if(S){const A=S.groupType==="q"?D(parseFloat(x.value),S.formatterCfg):x.value,C=W(S.chartShowName)?S.name:S.chartShowName;p.push({color:x.color,name:C,value:A})}}})});const h=(y=r.find(x=>x.field===c[0].title))==null?void 0:y.dynamicTooltipValue;return h.length>0&&h.forEach(x=>{const b=i.seriesTooltipFormatter.filter(S=>S.id===x.fieldId);if(b&&b.length>0){const S=D(parseFloat(x.value),b[0].formatterCfg),A=W(b[0].chartShowName)?b[0].name:b[0].chartShowName;p.push({color:"grey",name:A,value:S})}}),p},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:d}}setupDefaultOptions(t){return t.customStyle.yAxis.splitLine={...t.customStyle.yAxis.splitLine,show:!1},t.customStyle.yAxisExt.splitLine={...t.customStyle.yAxisExt.splitLine,show:!1},t.customStyle.yAxis.axisLine={...t.customStyle.yAxis.axisLine,show:!0},t.customStyle.yAxisExt.axisLine={...t.customStyle.yAxisExt.axisLine,show:!0},t}configColor(t,e){const{xAxis:o,yAxis:i,yAxisExt:l}=t;return o!=null&&o.length&&(i!=null&&i.length)&&(l!=null&&l.length)?this.configSingleDimensionColor(t,e):e}setupSeriesColor(t,e){var a;const{xAxis:o,yAxis:i,yAxisExt:l}=t;if(!(o!=null&&o.length&&(i!=null&&i.length)&&(l!=null&&l.length)))return[];const n=(a=e==null?void 0:e[0])==null?void 0:a.data;return be(t,n)}configLegend(t,e){const o=super.configLegend(t,e);if(!o.legend)return o;const i=L(t.customStyle);let l;return i&&i.legend?l=ce(JSON.parse(JSON.stringify(i.legend)),Lt).size:l=Lt.size,o.legend.marker.style=n=>({r:l,fill:n.fill}),o}setupOptions(t,e){return U(this.configTheme,this.configColor,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configAnalyse,this.configSlider,this.configBasicStyle)(t,e,{},this)}}const Un=Object.freeze(Object.defineProperty({__proto__:null,Quadrant:Gn},Symbol.toStringTag,{value:"Module"})),{t:he}=Y();class Xn extends Q{constructor(){super("radar",[]);v(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","legend-selector","misc-style-selector","jump-set","linkage"]);v(this,"propertyInner",{"basic-style-selector":["colors","alpha","radarShape","seriesColor","radarShowPoint","radarPointSize","radarAreaColor"],"label-selector":["seriesLabelFormatter"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"],"misc-style-selector":["showName","color","fontSize","axisColor","axisValue"],"title-selector":["show","title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"]});v(this,"selectorSpec",{...this.selectorSpec,"misc-style-selector":{title:`${he("chart.tooltip_axis")}`}});v(this,"axis",["xAxis","yAxis","drill","filter","extLabel","extTooltip"]);v(this,"axisConfig",{xAxis:{name:`${he("chart.drag_block_radar_label")} / ${he("chart.dimension")}`,type:"d"},yAxis:{name:`${he("chart.drag_block_radar_length")} / ${he("chart.quota")}`,type:"q"}})}async drawChart(t){var d;const{chart:e,container:o,action:i}=t;if(!((d=e.data)!=null&&d.data))return;const n={data:e.data.data,xField:"field",yField:"value",seriesField:"category",appendPadding:[10,10,10,10],interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region",cfg:{start:[{trigger:"point:mousemove",action:"active-region:show"}],end:[{trigger:"point:mouseleave",action:"active-region:hide"}]}}]},a=this.setupOptions(e,n),{Radar:s}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(m=>m.ab),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("point:click",i),a.label&&r.on("label:click",m=>{i({x:m.x,y:m.y,data:{data:m.target.attrs.data}})}),ft(e,r),r}configBasicStyle(t,e){const{radarShowPoint:o,radarPointSize:i,radarAreaColor:l}=L(t.customAttr).basicStyle,n={};return o&&(n.point={shape:"circle",size:i,style:{fill:null}}),l&&(n.area={}),{...e,...n}}configLabel(t,e){var a;const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const i=L(t.customAttr).label,l=(a=i.seriesLabelFormatter)==null?void 0:a.reduce((s,r)=>(s[r.id]=r,s),{});o.label.style.fill=Gt.color;const n={fields:[],...o.label,autoRotate:!1,autoHide:!0,formatter:s=>{var c;if(!((c=i.seriesLabelFormatter)!=null&&c.length))return s.value;const r=l==null?void 0:l[s.quotaList[0].id];if(!r)return s.value;if(!r.show)return;const d=D(s.value,r.formatterCfg),m=new Ut({});return m.addShape({type:"text",attrs:{data:s,x:0,y:0,text:d,textAlign:"start",textBaseline:"top",fontSize:r.fontSize,fill:r.color}}),m}};return{...o,label:n}}configAxis(t,e){const o=L(t.customAttr),i=L(t.customStyle),l=o.basicStyle,n=i.misc;let a={style:{fill:n.color,fontSize:n.fontSize}};n.showName||(a=!1);const s={line:null,tickLine:null,label:a,grid:{line:{style:{stroke:n.axisColor}}}},r={label:null,line:null,tickLine:null,grid:{line:{type:l.radarShape,style:{stroke:n.axisColor}}}},d=n.axisValue;if(!(d!=null&&d.auto)){const m={...r,min:d.min,max:d.max,minLimit:d.min,maxLimit:d.max,tickCount:d.splitCount};return{...e,xAxis:s,yAxis:m}}return{...e,xAxis:s,yAxis:r}}configLegend(t,e){const o=super.configLegend(t,e);if(!o.legend)return o;const i=L(t.customStyle);let l;return i&&i.legend?l=ce(JSON.parse(JSON.stringify(i.legend)),Lt).size:l=Lt.size,o.legend.marker.style=n=>({r:l,fill:n.stroke}),o}setupOptions(t,e){return U(this.configTheme,this.configColor,this.configLabel,this.configLegend,this.configMultiSeriesTooltip,this.configAxis,this.configBasicStyle)(t,e)}}const Jn=Object.freeze(Object.defineProperty({__proto__:null,Radar:Xn},Symbol.toStringTag,{value:"Module"})),{t:Zo}=Y();class Zn extends Ce{constructor(){super(to.CUSTOM,Pt.RICH_TEXT,"rich-text");v(this,"properties",["background-overall-component","border-style","threshold","function-cfg"]);v(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],threshold:["tableThreshold"],"function-cfg":["emptyDataStrategy"]});v(this,"axis",["xAxis","yAxis","filter"]);v(this,"axisConfig",{xAxis:{name:`${Zo("chart.dimension")}`,type:"d",allowEmpty:!0},yAxis:{name:`${Zo("chart.quota")}`,type:"q",allowEmpty:!0}})}}const Qn=Object.freeze(Object.defineProperty({__proto__:null,RichTextChartView:Zn},Symbol.toStringTag,{value:"Module"})),Wi=["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","jump-set","linkage"],Vi={"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient"],"label-selector":["fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","tooltipFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"function-cfg":["slider","emptyDataStrategy"]},Yi=["xAxis","xAxisExt","yAxis","filter","extLabel","extTooltip"],Kn=Object.freeze(Object.defineProperty({__proto__:null,SANKEY_AXIS_TYPE:Yi,SANKEY_EDITOR_PROPERTY:Wi,SANKEY_EDITOR_PROPERTY_INNER:Vi},Symbol.toStringTag,{value:"Module"})),{t:te}=Y(),ta=[];class ea extends Q{constructor(t="sankey"){super(t,ta);v(this,"axisConfig",{xAxis:{name:`${te("chart.drag_block_type_axis_start")} / ${te("chart.dimension")}`,limit:1,type:"d"},xAxisExt:{name:`${te("chart.drag_block_type_axis_end")} / ${te("chart.dimension")}`,limit:1,type:"d",allowEmpty:!0},yAxis:{name:`${te("chart.chart_data")} / ${te("chart.quota")}`,limit:1,type:"q"}});v(this,"properties",Wi);v(this,"propertyInner",{...Vi,"label-selector":["color","fontSize"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show"]});v(this,"axis",[...Yi]);v(this,"baseOptions",{data:[],sourceField:"source",targetField:"target",weightField:"value",rawFields:["dimensionList","quotaList"],interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}},{type:"active-region",cfg:{start:[{trigger:"interval:mousemove",action:"active-region:show"}],end:[{trigger:"interval:mouseleave",action:"active-region:hide"}]}}]})}async drawChart(t){var d,m;const{chart:e,container:o,action:i}=t;if(!((m=(d=e.data)==null?void 0:d.data)!=null&&m.length))return;const l=G(e.data.data);l.forEach(c=>{c.dimensionList&&(c.dimensionList[0]&&(c.source=c.dimensionList[0].value),c.dimensionList[1]&&(c.target=c.dimensionList[1].value))});const n={...this.baseOptions,appendPadding:nt(e),data:l,nodeSort:(c,p)=>{if(e.yAxis&&e.yAxis[0]){if(e.yAxis[0].sort==="asc")return c.value-p.value;if(e.yAxis[0].sort==="desc")return p.value-c.value}if(e.xAxis&&e.xAxis[0]&&c.sourceLinks.length>0){if(e.xAxis[0].sort==="custom_sort"&&e.xAxis[0].customSort)return e.xAxis[0].customSort.indexOf(c.name)-e.xAxis[0].customSort.indexOf(p.name);if(e.xAxis[0].sort==="asc")return c.name.localeCompare(p.name);if(e.xAxis[0].sort==="desc")return p.name.localeCompare(c.name)}if(e.xAxisExt&&e.xAxisExt[0]&&c.targetLinks.length>0){if(e.xAxisExt[0].sort==="custom_sort"&&e.xAxisExt[0].customSort)return e.xAxisExt[0].customSort.indexOf(c.name)-e.xAxisExt[0].customSort.indexOf(p.name);if(e.xAxisExt[0].sort==="asc")return c.name.localeCompare(p.name);if(e.xAxisExt[0].sort==="desc")return p.name.localeCompare(c.name)}return p.value-c.value}},a=this.setupOptions(e,n),{Sankey:s}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(c=>c.ad),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("edge:click",i),r}configTooltip(t,e){let o,i;if(t.customAttr&&(i=L(t.customAttr),i.tooltip)){const l=JSON.parse(JSON.stringify(i.tooltip));l.show?o={showTitle:!1,showMarkers:!1,shared:!1,showContent:n=>!st(n,[0,"data","isNode"]),formatter:n=>{const{source:a,target:s,value:r}=n;return{name:a+" -> "+s,value:D(r,l.tooltipFormatter)}}}:o=!1}return{...e,tooltip:o}}configBasicStyle(t,e){const o=L(t.customAttr).basicStyle;let i=o.colors;return i=i.map(l=>{const n=P(l,o.alpha);return o.gradient?tt(n,!0):n}),e={...e,color:i},e}setupDefaultOptions(t){const{customAttr:e,senior:o}=t,{label:i}=e;return["left","middle","right"].includes(i.position)||(i.position="middle"),o.functionCfg.emptyDataStrategy="ignoreData",t}configLabel(t,e){const o=L(t.customAttr).label;if(o.show){const i=[];return o.fullDisplay||i.push({type:"hide-overlap"},{type:"limit-in-canvas"}),{...e,label:{formatter:({name:n})=>n,callback:n=>{const a=n[1]===1;return{style:{fill:o.color,fontSize:o.fontSize,textAlign:a?"end":"start",fontFamily:t.fontFamily},offsetX:a?-8:8}},layout:i}}}else return{...e,label:!1}}setupOptions(t,e){return U(this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configSlider,this.configAnalyseHorizontal,this.configEmptyDataStrategy)(t,e)}}const oa=Object.freeze(Object.defineProperty({__proto__:null,SankeyBar:ea},Symbol.toStringTag,{value:"Module"})),{t:ke}=Y();class ia extends Q{constructor(){super("scatter",[]);v(this,"properties",["background-overall-component","border-style","basic-style-selector","x-axis-selector","y-axis-selector","title-selector","label-selector","tooltip-selector","legend-selector","jump-set","linkage"]);v(this,"propertyInner",{"basic-style-selector":["colors","alpha","scatterSymbol","scatterSymbolSize","seriesColor"],"label-selector":["fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"x-axis-selector":["position","name","color","fontSize","axisLine","splitLine","axisForm","axisLabel"],"y-axis-selector":["position","name","color","fontSize","axisValue","axisLine","splitLine","axisForm","axisLabel","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"]});v(this,"axis",["xAxis","yAxis","extBubble","filter","drill","extLabel","extTooltip"]);v(this,"axisConfig",{xAxis:{name:`${ke("chart.drag_block_type_axis")} / ${ke("chart.dimension")}`,type:"d"},yAxis:{...this.axisConfig.yAxis,limit:void 0,allowEmpty:!1},extBubble:{name:`${ke("chart.bubble_size")} / ${ke("chart.quota")}`,type:"q",limit:1,allowEmpty:!0}})}async drawChart(t){var d;const{chart:e,container:o,action:i}=t;if(!((d=e.data)!=null&&d.data))return;const n={data:e.data.data,xField:"field",yField:"value",colorField:"category",meta:{field:{type:"cat"}},appendPadding:nt(e),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}}]},a=this.setupOptions(e,n),{Scatter:s}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(m=>m.a4),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("point:click",i),ft(e,r),r}configBasicStyle(t,e){var l;const i=L(t.customAttr).basicStyle;return(l=t.extBubble)!=null&&l.length?{...e,size:[5,30],sizeField:"popSize",shape:i.scatterSymbol}:{...e,size:i.scatterSymbolSize,shape:i.scatterSymbol}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const i=L(t.customStyle).yAxis;o.yAxis.label&&(o.yAxis.label.formatter=n=>D(n,i.axisLabelFormatter));const l=i.axisValue;if(!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configTooltip(t,e){var s;const i=L(t.customAttr).tooltip;if(!i.show)return{...e,tooltip:!1};const l=(s=i.seriesTooltipFormatter)==null?void 0:s.filter(r=>r.show).reduce((r,d)=>(r[d.seriesId]=d,r),{}),n=["value","popSize"],a={showTitle:!0,customItems(r){var c,p;if(!((c=i.seriesTooltipFormatter)!=null&&c.length))return r;const d=r[0];if(!d.data.quotaList)return r;const m=[];return r.filter(h=>n.includes(h.name)).forEach(h=>{let g=l[`${h.data.quotaList[0].id}-yAxis`];if(h.name==="popSize"&&(g=l[`${h.data.quotaList[1].id}-extBubble`]),!g)return;const y=D(parseFloat(h.value),g.formatterCfg),x=W(g.chartShowName)?g.name:g.chartShowName;m.push({...h,name:x,value:y})}),(p=d.data.dynamicTooltipValue)==null||p.forEach(h=>{const g=l[h.fieldId];if(g){const y=D(parseFloat(h.value),g.formatterCfg),x=W(g.chartShowName)?g.name:g.chartShowName;m.push({color:"grey",name:x,value:y})}}),m},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:a}}configLegend(t,e){const o=super.configLegend(t,e);if(!o.legend)return o;const i=L(t.customStyle);let l;return i&&i.legend?l=ce(JSON.parse(JSON.stringify(i.legend)),Lt).size:l=Lt.size,o.legend.marker.style=n=>({r:l,fill:n.fill}),o}setupOptions(t,e){return U(this.configTheme,this.configColor,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configAnalyse,this.configSlider,this.configBasicStyle)(t,e)}}const la=Object.freeze(Object.defineProperty({__proto__:null,Scatter:ia},Symbol.toStringTag,{value:"Module"})),{t:Oe}=Y();class sa extends Q{constructor(){super("treemap",[]);v(this,"properties",["background-overall-component","border-style","basic-style-selector","title-selector","legend-selector","label-selector","tooltip-selector","jump-set","linkage"]);v(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","seriesColor"],"label-selector":["fontSize","color","showDimension","showQuota","showProportion"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"]});v(this,"axis",["xAxis","yAxis","filter","drill","extLabel","extTooltip"]);v(this,"axisConfig",{xAxis:{name:`${Oe("chart.drag_block_treemap_label")} / ${Oe("chart.dimension")}`,type:"d"},yAxis:{name:`${Oe("chart.drag_block_treemap_size")} / ${Oe("chart.quota")}`,limit:1}})}async drawChart(t){var d,m;const{chart:e,container:o,action:i}=t;if(!((m=(d=e.data)==null?void 0:d.data)!=null&&m.length))return;const n={data:{name:"root",children:e.data.data},colorField:"name",appendPadding:nt(e),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"element:mousemove",action:"tooltip:show"}],end:[{trigger:"element:mouseleave",action:"tooltip:hide"}]}}]},a=this.setupOptions(e,n),{Treemap:s}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(c=>c.ae),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("polygon:click",i),r}configTooltip(t,e){var d;const{tooltip:o,label:i}=L(t.customAttr),{yAxis:l}=t;if(!o.show)return{...e,tooltip:!1};const n=i.reserveDecimalCount,a=Ke(e.data.children),s=(d=o.seriesTooltipFormatter)==null?void 0:d.filter(m=>m.show).reduce((m,c)=>(m[c.id]=c,m),{});return{...e,tooltip:{showTitle:!0,title:()=>{},customItems(m){var g,y;let c=m;(g=o.seriesTooltipFormatter)!=null&&g.length&&(c=m.filter(x=>s[x.data.quotaList[0].id]));const p=[],h=m[0];return c.forEach(x=>{const b=s[x.data.quotaList[0].id]??l[0],S=D(parseFloat(x.value),b.formatterCfg),A=(Math.round(x.data.value/x.data.path[1].value*1e4)/100).toFixed(n),C=W(b.chartShowName)?b.name:b.chartShowName;p.push({...x,name:C,value:`${S??""} (${A}%)`})}),(y=h.data.dynamicTooltipValue)==null||y.forEach(x=>{const b=s[x.fieldId];if(b){const S=a[x.fieldId],A=(Math.round(x.value/S*1e4)/100).toFixed(n),C=D(parseFloat(x.value),b.formatterCfg),w=W(b.chartShowName)?b.name:b.chartShowName;p.push({color:"grey",name:w,value:`${C??""} (${A}%)`})}}),p}}}}configLabel(t,e){const i=L(t.customAttr).label;if(!i.show)return{...e,label:!1};const l={style:{fill:i.color,fontSize:i.fontSize},formatter:function(n){let a=n.value;const s=[];if(i.showDimension&&s.push(n.field),i.showQuota&&s.push(D(n.value,i.quotaLabelFormatter)),i.showProportion){const r=`${(n.value/n.parent.value*1e4/100).toFixed(i.reserveDecimalCount)}%`;s.push(r)}return a=s.join(`
`),a}};return i.fullDisplay&&(l.layout=[{type:"limit-in-plot"}]),{...e,label:l}}setupDefaultOptions(t){const{customAttr:e,customStyle:o}=t,{label:i}=e;e.label={...i,show:!0,showDimension:!0,showProportion:!0,reserveDecimalCount:2};const{legend:l}=o;return l.show=!1,t}setupSeriesColor(t,e){return e==null||e.sort((o,i)=>i.value-o.value),be(t,e)}configColor(t,e){const o=e.data.children;o.sort((l,n)=>n.value-l.value);const i=this.configSingleDimensionColor(t,{...e,data:o});return{...e,color:i.color}}setupOptions(t,e){return U(this.configTheme,this.configColor,this.configLabel,this.configTooltip,this.configLegend)(t,e,{},this)}}const na=Object.freeze(Object.defineProperty({__proto__:null,Treemap:sa},Symbol.toStringTag,{value:"Module"})),{t:Ie}=Y(),aa=[];class ra extends Q{constructor(){super("word-cloud",aa);v(this,"properties",["basic-style-selector","background-overall-component","border-style","title-selector","tooltip-selector","misc-selector","jump-set","linkage"]);v(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"misc-selector":["wordSizeRange","wordSpacing","wordCloudAxisValueRange"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"]});v(this,"axis",["xAxis","yAxis","filter"]);v(this,"axisConfig",{xAxis:{name:`${Ie("chart.drag_block_word_cloud_label")} / ${Ie("chart.dimension_or_quota")}`,type:"d",limit:1},yAxis:{name:`${Ie("chart.drag_block_word_cloud_size")} / ${Ie("chart.quota")}`,type:"q",limit:1}});v(this,"setDataRange",(t,e,o)=>{t({from:"word-cloud",data:{max:e,min:o}})})}async drawChart(t){var l,n;const{chart:e,container:o,action:i}=t;if(e!=null&&e.data){let a=e.data.data;const{misc:s}=L(e.customAttr);let r=0,d=0;!((l=s.wordCloudAxisValueRange)!=null&&l.auto)&&((n=s.wordCloudAxisValueRange)==null?void 0:n.fieldId)===e.yAxis[0].id&&(r=s.wordCloudAxisValueRange.min,d=s.wordCloudAxisValueRange.max),De(a??[],"value",d,r,(g,y)=>{d=g,r=y}),a=mo(a??[],d,r);const m={data:a,wordField:"field",weightField:"value",colorField:"field",wordStyle:{fontFamily:e.fontFamily?e.fontFamily:"Verdana",fontSize:s.wordSizeRange??qt.wordSizeRange,rotation:[0,0],padding:s.wordSpacing??qt.wordSpacing},random:()=>.5,appendPadding:nt(e),legend:!1,interactions:[]},c=this.setupOptions(e,m),{WordCloud:p}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(g=>g.ag),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),h=new p(o,c);return h.on("click",()=>{this.setDataRange(i,d,r)}),h.on("afterrender",()=>{this.setDataRange(i,d,r)}),h.on("point:click",g=>{i({x:g.x,y:g.y,data:{data:g.data.data.datum}})}),h}}configTooltip(t,e){var s;const i=L(t.customAttr).tooltip,l=t.yAxis;if(!i.show)return{...e,tooltip:!1};const n=(s=i.seriesTooltipFormatter)==null?void 0:s.filter(r=>r.show).reduce((r,d)=>(r[d.id]=d,r),{});return{...e,tooltip:{showTitle:!0,title:()=>{},customItems(r){var p,h;let d=r;(p=i.seriesTooltipFormatter)!=null&&p.length&&(d=r.filter(g=>n[g.data.datum.quotaList[0].id]));const m=[],c=r[0];return d.forEach(g=>{const y=n[g.data.datum.quotaList[0].id]??l[0],x=D(g.value,y.formatterCfg),b=W(y.chartShowName)?y.name:y.chartShowName;m.push({...g,name:b,value:x})}),(h=c.data.datum.dynamicTooltipValue)==null||h.forEach(g=>{const y=n[g.fieldId];if(y){const x=D(parseFloat(g.value),y.formatterCfg),b=W(y.chartShowName)?y.name:y.chartShowName;m.push({color:"grey",name:b,value:x})}}),m}}}}setupOptions(t,e){return U(this.configTheme,this.configTooltip)(t,e)}}const ca=Object.freeze(Object.defineProperty({__proto__:null,WordCloud:ra},Symbol.toStringTag,{value:"Module"})),{t:Ne}=Y(),qi=["background-overall-component","border-style","basic-style-selector","title-selector","legend-selector","label-selector","tooltip-selector","jump-set","linkage"],lo={"background-overall-component":["all"],"border-style":["all"],"label-selector":["fontSize","color","rPosition","showDimension","showQuota","showProportion"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"basic-style-selector":["colors","alpha","radius","seriesColor"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"]},ji=["xAxis","yAxis","drill","filter","extLabel","extTooltip"],Gi={xAxis:{name:`${Ne("chart.drag_block_pie_label")} / ${Ne("chart.dimension")}`,type:"d"},yAxis:{name:`${Ne("chart.drag_block_pie_angle")} / ${Ne("chart.quota")}`,type:"q",limit:1}},{t:ua}=Y(),da=[];class Ui extends Q{constructor(t="pie"){super(t,da);v(this,"axis",ji);v(this,"properties",qi);v(this,"propertyInner",{...lo,"basic-style-selector":["colors","alpha","radius","topN","seriesColor"]});v(this,"axisConfig",Gi)}async drawChart(t){var c,p,h;const{chart:e,container:o,action:i}=t;if(this.configEmptyDataStyle((c=e.data)==null?void 0:c.data,o,null,ua("chart.no_data_or_not_positive")),!((h=(p=e.data)==null?void 0:p.data)!=null&&h.length))return;const l=e.data.data,n=L(e.customAttr),a=n.basicStyle.colors.map(g=>P(g,n.basicStyle.alpha)),s={data:l,angleField:"value",colorField:"field",appendPadding:nt(e),color:a,animation:!1,pieStyle:{lineWidth:0},statistic:{title:!1,content:{style:{whiteSpace:"pre-wrap",overflow:"hidden",textOverflow:"ellipsis"},content:""}},interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}},{type:"active-region",cfg:{start:[{trigger:"interval:mousemove",action:"active-region:show"}],end:[{trigger:"interval:mouseleave",action:"active-region:hide"}]}}],meta:{field:{type:"cat"}}},r=this.setupOptions(e,s),{Pie:d}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(g=>g.a3),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),m=new d(o,r);return m.on("interval:click",i),ft(e,m),m}configLabel(t,e){const{label:o}=L(t.customAttr);if(!(o!=null&&o.show))return{...e,label:!1};const i=[];let l;o.position==="inner"?(l="center",o.fullDisplay?i.push({type:"limit-in-plot"}):(i.push({type:"limit-in-canvas"}),i.push({type:"hide-overlap"}))):o.fullDisplay||i.push({type:"limit-in-plot"});let n=o.position==="outer"?"spider":o.position;i.length===0&&(n="no");const a={type:n,textAlign:l,layout:i,autoRotate:!1,style:{fill:o.color,fontSize:o.fontSize},formatter:s=>{let r=s.value;const d=[];if(o.showDimension&&d.push(s.field),o.showQuota&&d.push(D(s.value,o.quotaLabelFormatter)),o.showProportion){const m=`${(Math.round(s.percent*1e4)/100).toFixed(o.reserveDecimalCount)}%`;o.showDimension&&o.showQuota?d.push(`(${m})`):d.push(m)}return r=d.join(" "),r}};return{...e,label:a}}configTooltip(t,e){var m,c;const{tooltip:o,label:i}=L(t.customAttr),{yAxis:l}=t;if(!o.show)return{...e,tooltip:!1};const n=i.reserveDecimalCount,a=Ke(e.data),s=(m=e.data)==null?void 0:m.reduce((p,h)=>Ye(p,h.value??0),0),r=(c=o.seriesTooltipFormatter)==null?void 0:c.filter(p=>p.show).reduce((p,h)=>(p[h.id]=h,p),{}),d={showTitle:!0,title:()=>{},customItems(p){var x,b;let h=p;(x=o.seriesTooltipFormatter)!=null&&x.length&&(h=p.filter(S=>r[S.data.quotaList[0].id]));const g=[],y=p[0];return h.forEach(S=>{const A=r[S.data.quotaList[0].id]??l[0],C=parseFloat(S.value),w=D(C,A.formatterCfg),T=(Math.round(C/s*1e4)/100).toFixed(n),z=W(A.chartShowName)?A.name:A.chartShowName;g.push({...S,name:z,value:`${w??""} (${T}%)`})}),(b=y.data.dynamicTooltipValue)==null||b.forEach(S=>{const A=r[S.fieldId];if(A){const C=a[S.fieldId],w=(Math.round(S.value/C*1e4)/100).toFixed(n),T=D(parseFloat(S.value),A.formatterCfg),z=W(A.chartShowName)?A.name:A.chartShowName;g.push({color:"grey",name:z,value:`${T??""} (${w}%)`})}}),g},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:d}}configBasicStyle(t,e){const o=L(t.customAttr),{basicStyle:i}=o,{data:l}=e;if(l!=null&&l.length&&i.calcTopN&&l.length>i.topN){l.sort((r,d)=>d.value-r.value);const n=l.splice(i.topN),a={...l[0],dynamicTooltipValue:[],field:i.topNLabel,name:i.topNLabel,value:0},s={};n.reduce((r,d)=>{var m;return r.value+=d.value??0,(m=d.dynamicTooltipValue)==null||m.forEach(c=>{s[c.fieldId]=(s[c.fieldId]||0)+c.value}),r},a);for(const r in s)a.dynamicTooltipValue.push({fieldId:r,value:s[r]});l.push(a)}return{...e,radius:i.radius/100}}setupDefaultOptions(t){const{customAttr:e,customStyle:o}=t,{label:i}=e;["inner","outer"].includes(i.position)||(i.position="outer"),e.label={...i,show:!0,showDimension:!0,showProportion:!0,reserveDecimalCount:2};const{legend:l}=o;return l.show=!1,t}setupSeriesColor(t,e){e=G(e);const{calcTopN:o,topN:i,topNLabel:l}=t.customAttr.basicStyle;return e!=null&&e.length&&o&&e.length>i&&(e.sort((n,a)=>a.value-n.value),e.splice(i),e.push({field:l,value:0})),be(t,e)}setupOptions(t,e){return U(this.configTheme,this.configBasicStyle,this.configSingleDimensionColor,this.configLabel,this.configTooltip,this.configLegend)(t,e,{},this)}}class fa extends Ui{constructor(){super("pie-donut");v(this,"propertyInner",{...lo,"basic-style-selector":["colors","alpha","radius","innerRadius","topN","seriesColor"]})}configBasicStyle(t,e){const o=super.configBasicStyle(t,e),{basicStyle:i}=L(t.customAttr);return{...o,radius:i.radius/100,innerRadius:i.innerRadius/100}}}const ma=Object.freeze(Object.defineProperty({__proto__:null,Pie:Ui,PieDonut:fa},Symbol.toStringTag,{value:"Module"})),{t:co}=Y();class Xi extends Q{constructor(t="pie-rose"){super(t,[]);v(this,"axis",ji);v(this,"properties",qi);v(this,"propertyInner",lo);v(this,"axisConfig",{...Gi,yAxis:{name:`${co("chart.drag_block_pie_radius")} / ${co("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var d,m,c;const{chart:e,container:o,action:i}=t;if(this.configEmptyDataStyle((d=e.data)==null?void 0:d.data,o,null,co("chart.no_data_or_not_positive")),!((c=(m=e==null?void 0:e.data)==null?void 0:m.data)!=null&&c.length))return;const n={data:e.data.data,xField:"field",yField:"value",seriesField:"field",appendPadding:nt(e),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}}],meta:{field:{type:"cat"}}},a=this.setupOptions(e,n),{Rose:s}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(p=>p.ac),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("interval:click",i),ft(e,r),r}configBasicStyle(t,e){const{basicStyle:o}=L(t.customAttr);return{...e,radius:o.radius/100}}configLabel(t,e){var a;const{label:o}=L(t.customAttr);if(!o.show)return{...e,label:!1};const i=(a=e.data)==null?void 0:a.reduce((s,r)=>Ye(s,r.value??0),0),l=[];if(!o.fullDisplay){const s=super.configLabel(t,e);l.push(...s.label.layout)}const n={autoRotate:!0,layout:l,style:{fill:o.color,fontSize:o.fontSize},formatter:s=>{let r=s.value;const d=[];if(o.showDimension&&d.push(s.field),o.showQuota&&d.push(D(s.value,o.quotaLabelFormatter)),o.showProportion){const m=`${(Math.round(s.value/i*1e4)/100).toFixed(o.reserveDecimalCount)}%`;o.showDimension&&o.showQuota?d.push(`(${m})`):d.push(m)}return r=d.join(`
`),r}};return o.position==="inner"&&(n.offset=-10),{...e,label:n}}configTooltip(t,e){var m,c;const{tooltip:o,label:i}=L(t.customAttr),{yAxis:l}=t;if(!o.show)return{...e,tooltip:!1};const n=i.reserveDecimalCount,a=Ke(e.data),s=(m=e.data)==null?void 0:m.reduce((p,h)=>Ye(p,h.value??0),0),r=(c=o.seriesTooltipFormatter)==null?void 0:c.filter(p=>p.show).reduce((p,h)=>(p[h.id]=h,p),{}),d={showTitle:!0,title:()=>{},customItems(p){var x,b;let h=p;(x=o.seriesTooltipFormatter)!=null&&x.length&&(h=p.filter(S=>r[S.data.quotaList[0].id]));const g=[],y=p[0];return h.forEach(S=>{const A=r[S.data.quotaList[0].id]??l[0],C=parseFloat(S.value),w=D(C,A.formatterCfg),T=(Math.round(C/s*1e4)/100).toFixed(n),z=W(A.chartShowName)?A.name:A.chartShowName;g.push({...S,name:z,value:`${w??""} (${T}%)`})}),(b=y.data.dynamicTooltipValue)==null||b.forEach(S=>{const A=r[S.fieldId];if(A){const C=a[S.fieldId],w=(Math.round(S.value/C*1e4)/100).toFixed(n),T=D(parseFloat(S.value),A.formatterCfg),z=W(A.chartShowName)?A.name:A.chartShowName;g.push({color:"grey",name:z,value:`${T??""} (${w}%)`})}}),g},container:at(`tooltip-${t.id}`),itemTpl:rt,enterable:!0};return{...e,tooltip:d}}setupDefaultOptions(t){const{customAttr:e,customStyle:o}=t,{label:i}=e;["inner","outer"].includes(i.position)||(i.position="outer"),e.label={...i,show:!0,showDimension:!0,showProportion:!0,reserveDecimalCount:2};const{legend:l}=o;return l.show=!1,t}setupSeriesColor(t,e){return be(t,e)}setupOptions(t,e){return U(this.configBasicStyle,this.configSingleDimensionColor,this.configTheme,this.configLabel,this.configLegend,this.configTooltip)(t,e)}}class pa extends Xi{constructor(){super("pie-donut-rose");v(this,"propertyInner",{...lo,"basic-style-selector":["colors","alpha","radius","innerRadius","seriesColor"]})}configBasicStyle(t,e){const o=L(t.customAttr);return{...e,radius:o.basicStyle.radius/100,innerRadius:o.basicStyle.innerRadius/100}}}const ha=Object.freeze(Object.defineProperty({__proto__:null,Rose:Xi,RoseDonut:pa},Symbol.toStringTag,{value:"Module"})),{t:ee}=Y(),ga=[];class ya extends Q{constructor(){super("t-heatmap",ga);v(this,"properties",["basic-style-selector","background-overall-component","label-selector","legend-selector","x-axis-selector","y-axis-selector","title-selector","tooltip-selector","jump-set","linkage","border-style"]);v(this,"propertyInner",{"background-overall-component":["all"],"basic-style-selector":["colors"],"label-selector":["fontSize","color"],"x-axis-selector":["name","color","fontSize","position","axisLabel","axisLine"],"y-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","showLengthLimit"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["orient","color","fontSize","hPosition","vPosition"],"tooltip-selector":["show","color","fontSize","backgroundColor"],"border-style":["all"]});v(this,"axis",["xAxis","xAxisExt","extColor","filter"]);v(this,"axisConfig",{xAxis:{name:`${ee("chart.x_axis")} / ${ee("chart.dimension")}`,type:"d",limit:1},xAxisExt:{name:`${ee("chart.y_axis")} / ${ee("chart.dimension")}`,type:"d",limit:1},extColor:{name:`${ee("chart.color")} / ${ee("chart.dimension_or_quota")}`,limit:1}});v(this,"getDefaultLength",(t,e)=>{const o=document.getElementById(t.container),i=(o==null?void 0:o.clientHeight)||100,l=(o==null?void 0:o.clientWidth)||100;let n=i-i*.5;return e.orient!=="vertical"&&(n=l-l*.5),n});v(this,"sortData",(t,e)=>{const{deType:o,sort:i,customSort:l}=t;return i==="desc"?o===0?e.sort().reverse():e.sort((n,a)=>a-n):i==="asc"?o===0?e.sort():e.sort((n,a)=>n-a):l&&l.length>0?l:e})}async drawChart(t){const{chart:e,container:o,action:i}=t,l=J(e.xAxis),n=J(e.xAxisExt),a=J(e.extColor);if(!(l!=null&&l.length)||!(n!=null&&n.length)||!(a!=null&&a.length))return;const s=l[0].dataeaseName,r=n[0].dataeaseName,d=a[0].dataeaseName,m=G(e.data.tableRow);m.forEach(y=>{Object.keys(y).forEach(x=>{x==="*"&&(y["@"]=y[x])})});const c={data:m,xField:s,yField:r,colorField:d==="*"?"@":d,appendPadding:nt(e),meta:{[s]:{type:"cat",values:this.sortData(l[0],[...new Set(m.map(y=>y[[s]]))])},[r]:{type:"cat",values:this.sortData(n[0],[...new Set(m.map(y=>y[[r]]))]).reverse()}},legend:{layout:"vertical",position:"right",slidable:!0,label:{align:"left",spacing:10}}};e.container=o;const p=this.setupOptions(e,c),{Heatmap:h}=await Z(()=>import("./@antv-0.0.0-dataease.js").then(y=>y.a9),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),g=new h(o,p);return g.on("plot:click",y=>{var S;if(!((S=y.data)!=null&&S.data))return;const x=y.data.data,b=[];e.data.fields.forEach(A=>{Object.keys(x).forEach(C=>{C.startsWith("f_")&&A.dataeaseName===C&&b.push({id:A.id,dataeaseName:A.dataeaseName,value:x[C]})})}),i({x:y.data.x,y:y.data.y,data:{data:{...y.data.data,value:b[1].value,name:b[1].id,dimensionList:b,quotaList:[b[1]]}}})}),g.on("afterrender",y=>{var b;const x=JSON.parse(JSON.stringify(L(e.customStyle).legend));if(x.show){const S=(b=y.view.getController("legend").option[a[0].dataeaseName])==null?void 0:b.rail;S&&(S.defaultLength=this.getDefaultLength(e,x))}}),Xt(e,g),g}configBasicStyle(t,e){var l;const o=L(t.customAttr).basicStyle,i=(l=o.colors)==null?void 0:l.map(n=>P(n,o.alpha));return{...e,color:i}}configTooltip(t,e){let o,i;if(t.customAttr&&(i=L(t.customAttr),i.tooltip)){const l=J(t.extColor),a=[J(t.xAxisExt),l];JSON.parse(JSON.stringify(i.tooltip)).show?o={showTitle:!0,customItems(r){const d=[],m=(c,p,h)=>{const g=c!=null&&c.chartShowName?c==null?void 0:c.chartShowName:c==null?void 0:c.name;let y=h[0].data[c.dataeaseName];isNaN(Number(y))||(y=D(y,c==null?void 0:c.formatterCfg)),p.push({...h[0],name:g,value:y})};return a.forEach(c=>{m(c[0],d,r)}),d}}:o=!1}return{...e,tooltip:o}}configXAxis(t,e){const o=xi(t);return{...e,xAxis:o?{...o,grid:null}:!1}}configYAxis(t,e){const o=Qe(t);return{...e,yAxis:o?{...o,grid:null}:!1}}configLegend(t,e){const o=super.configLegend(t,e);if(o.legend){const i=JSON.parse(JSON.stringify(L(t.customStyle).legend));o.legend.slidable=!0,o.legend.minHeight=10,o.legend.minWidth=10,o.legend.maxHeight=600,o.legend.maxWidth=600;const l=document.getElementById(t.container),n=(l==null?void 0:l.clientHeight)||100,a=(l==null?void 0:l.clientWidth)||100;let s=n-n*.5;i.orient==="vertical"?o.legend.offsetY=-5:s=a-a*.5,o.legend.rail={defaultLength:s},o.legend.label={spacing:10,style:{fill:i.color,fontSize:i.fontSize}}}return o}setupDefaultOptions(t){return t.customStyle.legend.orient="vertical",t.customStyle.legend.vPosition="center",t.customStyle.legend.hPosition="right",t.customStyle.legend.rail={defaultLength:100},t}configLabel(t,e){const o=super.configLabel(t,e);if(o.label){const i=J(t.extColor),l=[];o.label.fullDisplay||l.push(...o.label.layout);const n={...o.label,position:"middle",layout:l,formatter:a=>{var r,d;const s=a[(r=i[0])==null?void 0:r.dataeaseName];return isNaN(Number(s))?s:D(s,(d=i[0])==null?void 0:d.formatterCfg)}};return{...o,label:n}}return o}setupOptions(t,e){return U(this.configTheme,this.configXAxis,this.configYAxis,this.configBasicStyle,this.configLegend,this.configTooltip,this.configLabel)(t,e)}}const xa=Object.freeze(Object.defineProperty({__proto__:null,TableHeatmap:ya},Symbol.toStringTag,{value:"Module"})),{t:Rt}=Y();function ba(f){const u=P(K.tableHeaderBgColor,ot.alpha),t=K.tableHeaderAlign,e=P(Tt.tableItemBgColor,ot.alpha),o=Tt.tableItemAlign,i=P(ot.tableBorderColor,ot.alpha),l=ot.tableScrollBarColor,n=Wo(l,3),a=f.fontFamily&&f.fontFamily!=="inherit"?f.fontFamily:fi,s={background:{color:"#00000000"},splitLine:{horizontalBorderColor:i,horizontalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderColor:i,verticalBorderColorOpacity:1,verticalBorderWidth:1,showShadow:!1},cornerCell:{cell:{backgroundColor:u,horizontalBorderColor:i,verticalBorderColor:i},text:{fill:K.tableHeaderFontColor,fontSize:K.tableTitleFontSize,textAlign:t,fontFamily:a},bolderText:{fill:K.tableHeaderFontColor,fontSize:K.tableTitleFontSize,textAlign:t,fontFamily:a},measureText:{fill:K.tableHeaderFontColor,fontSize:K.tableTitleFontSize,textAlign:t,fontFamily:a}},rowCell:{cell:{backgroundColor:u,horizontalBorderColor:i,verticalBorderColor:i},text:{fill:K.tableHeaderFontColor,fontSize:K.tableTitleFontSize,textAlign:t,textBaseline:"middle",fontFamily:a},bolderText:{fill:K.tableHeaderFontColor,fontSize:K.tableTitleFontSize,textAlign:t,fontFamily:a},measureText:{fill:K.tableHeaderFontColor,fontSize:K.tableTitleFontSize,textAlign:t,fontFamily:a},seriesText:{fill:Tt.tableItemBgColor,fontSize:Tt.tableItemFontSize,textAlign:o,fontFamily:a}},colCell:{cell:{backgroundColor:u,horizontalBorderColor:i,verticalBorderColor:i},text:{fill:K.tableHeaderFontColor,fontSize:K.tableTitleFontSize,textAlign:t,fontFamily:a},bolderText:{fill:K.tableHeaderFontColor,fontSize:K.tableTitleFontSize,textAlign:t,fontFamily:a},measureText:{fill:K.tableHeaderFontColor,fontSize:K.tableTitleFontSize,textAlign:t,fontFamily:a}},dataCell:{cell:{backgroundColor:e,horizontalBorderColor:i,verticalBorderColor:i},text:{fill:Tt.tableFontColor,fontSize:Tt.tableItemFontSize,textAlign:o,fontFamily:a},bolderText:{fill:Tt.tableFontColor,fontSize:Tt.tableItemFontSize,textAlign:o,fontFamily:a},measureText:{fill:Tt.tableFontColor,fontSize:Tt.tableItemFontSize,textAlign:t,fontFamily:a}},scrollBar:{thumbColor:l,thumbHoverColor:n,size:8,hoverSize:12}};let r;if(f.customAttr){r=L(f.customAttr);const{basicStyle:d,tableHeader:m,tableCell:c}=r;if(d){const p=d.tableBorderColor,h=d.tableScrollBarColor,g={splitLine:{horizontalBorderColor:p,verticalBorderColor:p},cornerCell:{cell:{horizontalBorderColor:p,verticalBorderColor:p}},colCell:{cell:{horizontalBorderColor:p,verticalBorderColor:p}},dataCell:{cell:{horizontalBorderColor:p,verticalBorderColor:p,interactionState:{hoverFocus:{borderOpacity:d.showHoverStyle===!1?0:1}}}},scrollBar:{thumbColor:h,thumbHoverColor:Wo(h,1.5)}};xt(s,g)}if(m){const p=P(m.tableHeaderFontColor,d.alpha);let h=m.tableHeaderBgColor;_t(h)||(h=P(h,d.alpha));const g=m.isItalic?"italic":"normal",y=m.isBolder===!1?"normal":"bold",{tableHeaderAlign:x,tableTitleFontSize:b}=m;xt(s,{cornerCell:{cell:{backgroundColor:h},bolderText:{fill:p,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a},text:{fill:p,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a},measureText:{fill:p,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a}},colCell:{cell:{backgroundColor:h},bolderText:{fill:p,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a},text:{fill:p,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a},measureText:{fill:p,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a}}}),m.showHorizonBorder===!1&&m.showTableHeader!==!1&&xt(s,{splitLine:{horizontalBorderColor:h,horizontalBorderWidth:0,horizontalBorderColorOpacity:0},colCell:{cell:{horizontalBorderColor:h,horizontalBorderWidth:0}}}),m.showVerticalBorder===!1&&m.showTableHeader!==!1&&xt(s,{splitLine:{verticalBorderColor:h,verticalBorderWidth:0,verticalBorderColorOpacity:0},colCell:{cell:{verticalBorderColor:h,verticalBorderWidth:0}},cornerCell:{cell:{verticalBorderColor:h,verticalBorderWidth:0}}})}if(c){const p=P(c.tableFontColor,d.alpha);let h=c.tableItemBgColor;_t(h)||(h=P(h,d.alpha));let g=c.tableItemSubBgColor;_t(g)||(g=P(g,d.alpha));const y=c.isItalic?"italic":"normal",x=c.isBolder===!1?"normal":"bold",{tableItemAlign:b,tableItemFontSize:S,enableTableCrossBG:A}=c;xt(s,{rowCell:{cell:{backgroundColor:h,horizontalBorderColor:h,verticalBorderColor:h},bolderText:{fill:p,textAlign:b,fontSize:S,fontFamily:a},text:{fill:p,textAlign:b,fontSize:S,fontFamily:a},measureText:{fill:p,textAlign:b,fontSize:S,fontFamily:a},seriesText:{fill:p,textAlign:b,fontSize:S,fontFamily:a}},dataCell:{cell:{crossBackgroundColor:A?g:h,backgroundColor:h},bolderText:{fill:p,textAlign:b,fontSize:S,fontStyle:y,fontWeight:x,fontFamily:a},text:{fill:p,textAlign:b,fontSize:S,fontStyle:y,fontWeight:x,fontFamily:a},measureText:{fill:p,textAlign:b,fontSize:S,fontStyle:y,fontWeight:x,fontFamily:a},seriesText:{fill:p,textAlign:b,fontSize:S,fontStyle:y,fontWeight:x,fontFamily:a}}}),c.showHorizonBorder===!1&&xt(s,{dataCell:{cell:{horizontalBorderColor:h,horizontalBorderWidth:0}}}),c.showVerticalBorder===!1&&xt(s,{splitLine:{verticalBorderWidth:0,verticalBorderColorOpacity:0},dataCell:{cell:{verticalBorderColor:h,verticalBorderWidth:0}}})}}return s}function Sa(f,u){var o,i,l;const t={};let e;if(f.customAttr){e=L(f.customAttr);const{basicStyle:n,tableHeader:a,tableCell:s}=e;switch(t.colCfg={height:a.tableTitleHeight},t.cellCfg={height:s.tableItemHeight},n.tableColumnMode){case"adapt":{t.layoutWidthType="compact";break}case"field":{delete t.layoutWidthType;const r=((o=n.tableFieldWidth)==null?void 0:o.reduce((p,h)=>(p[h.fieldId]=h,p),{}))||{};if(f.drill){const{xAxis:p}=L(f),h=f.drillFields[f.drillFilters.length],g=p.findIndex(x=>x.id===f.drillFilters[0].fieldId),y=p[g];r[h.dataeaseName]={width:(i=r[y.dataeaseName])==null?void 0:i.width}}const d=(l=u.meta)==null?void 0:l.reduce((p,h)=>{var g;return p+(((g=r[h.field])==null?void 0:g.width)??10)},0),m=parseInt(d.toFixed(0))===100,c=[];t.colCfg.width=p=>{var b;const h=p.spreadsheet.container.cfg.el.getBoundingClientRect().width;if(!((b=n.tableFieldWidth)!=null&&b.length)){const S=f.data.fields.length,A=a.showIndex?S+1:S;return h/A}const g=h/100,y=r[p.field]?r[p.field].width*g:g*10,x=parseInt(y.toFixed(0));if(m)if(c.length===u.meta.length-1){const S=c.reduce((C,w)=>C+w,0),A=h-S;if(c.splice(0),A<x)return A}else c.push(x);return x};break}case"custom":{t.colCfg.width=n.tableColumnWidth;break}default:delete t.layoutWidthType,t.colCfg.width=r=>{const d=r.spreadsheet.container.cfg.el.offsetWidth,m=r.spreadsheet.dataCfg.meta.length;if(!m)return 0;const c=a.showIndex?m+1:m,p=d/c;return Math.max(p,n.tableColumnWidth)}}}return t}function Aa(f){const{threshold:u}=L(f.senior);if(!u.enable)return;const t={text:[],background:[]},e=u.tableThreshold??[],o=[...f.xAxis,...f.xAxisExt].map(i=>i.dataeaseName);if((e==null?void 0:e.length)>0){const{tableCell:i,basicStyle:l,tableHeader:n}=L(f.customAttr),a=f.type==="table-info"?i.enableTableCrossBG&&!i.mergeCells:i.enableTableCrossBG,s=_t(i.tableFontColor)?i.tableFontColor:P(i.tableFontColor,l.alpha),r=a?null:_t(i.tableItemBgColor)?i.tableItemBgColor:P(i.tableItemBgColor,l.alpha),d=n.tableHeaderFontColor,m=_t(n.tableHeaderBgColor)?n.tableHeaderBgColor:P(n.tableHeaderBgColor,l.alpha),c=Ca(f);for(let p=0;p<e.length;p++){const h=e[p];let g=s,y=r;f.type==="table-pivot"&&o.includes(h.field.dataeaseName)&&(g=d,y=m),t.text.push({field:h.field.dataeaseName,mapping(x,b){return b!=null&&b.isTotals||b!=null&&b.id&&(b==null?void 0:b.field)===b.id?null:{fill:Qo(x,g,h,"color",c,b)}}}),t.background.push({field:h.field.dataeaseName,mapping(x,b){if(b!=null&&b.isTotals||b!=null&&b.id&&(b==null?void 0:b.field)===b.id)return null;const S=Qo(x,y,h,"backgroundColor",c,b);return _l(S)?null:{fill:S}}})}}return t}function Qo(f,u,t,e,o,i){let l=null;for(let n=0;n<t.conditions.length;n++){let a=!1;const s=t.conditions[n];let r,d,m;if(s.type==="dynamic"?s.term==="between"?(d=parseFloat(uo(s.dynamicMaxField,o,i)),m=parseFloat(uo(s.dynamicMinField,o,i))):r=uo(s.dynamicField,o,i):s.term==="between"?(m=parseFloat(s.min),d=parseFloat(s.max)):r=s.value,t.field.deType===2||t.field.deType===3||t.field.deType===4){if(r=parseFloat(r),s.term==="eq"?f===r&&(l=s[e],a=!0):s.term==="not_eq"?f!==r&&(l=s[e],a=!0):s.term==="lt"?f<r&&(l=s[e],a=!0):s.term==="gt"?f>r&&(l=s[e],a=!0):s.term==="le"?f<=r&&(l=s[e],a=!0):s.term==="ge"?f>=r&&(l=s[e],a=!0):s.term==="between"?m<=f&&f<=d&&(l=s[e],a=!0):s.term==="default"&&(l=s[e],a=!0),a)break;n===t.conditions.length-1&&(l=u)}else if(t.field.deType===0||t.field.deType===5){if(s.term==="eq"?f===r&&(l=s[e],a=!0):s.term==="not_eq"?f!==r&&(l=s[e],a=!0):s.term==="like"?f.includes(r)&&(l=s[e],a=!0):s.term==="not like"?f.includes(r)||(l=s[e],a=!0):s.term==="null"?(f==null||f==="")&&(l=s[e],a=!0):s.term==="not_null"?f!=null&&f!==""&&(l=s[e],a=!0):s.term==="default"&&(l=s[e],a=!0),a)break;n===t.conditions.length-1&&(l=u)}else{const c=t.conditions[n];r=new Date(r.replace(/-/g,"/")+" GMT+8").getTime();const p=new Date(f.replace(/-/g,"/")+" GMT+8").getTime();if(c.term==="eq"?p===r&&(l=c[e],a=!0):c.term==="not_eq"?p!==r&&(l=c[e],a=!0):c.term==="lt"?p<r&&(l=c[e],a=!0):c.term==="gt"?p>r&&(l=c[e],a=!0):c.term==="le"?p<=r&&(l=c[e],a=!0):c.term==="ge"?p>=r&&(l=c[e],a=!0):c.term==="default"&&(l=c[e],a=!0),a)break;n===t.conditions.length-1&&(l=u)}}return l}function Ca(f){const u={};return f.data&&f.data.dynamicAssistLines&&f.data.dynamicAssistLines.length>0&&f.data.dynamicAssistLines.forEach(t=>{u[t.summary+"-"+t.fieldId]=t.value}),u}function uo(f,u,t){var e;return f.summary==="value"?t?t[(e=f.field)==null?void 0:e.dataeaseName]:void 0:u[f.summary+"-"+f.fieldId]}function wa(f){var l,n,a;let u=((l=f.data)==null?void 0:l.tableRow)||[],t=[];const e=L(f.senior);let o=(n=e==null?void 0:e.functionCfg)==null?void 0:n.emptyDataStrategy;o||(o="breakLine");const i=(a=e==null?void 0:e.functionCfg)==null?void 0:a.emptyDataFieldCtrl;if(o!=="breakLine"&&(i!=null&&i.length)&&(u!=null&&u.length)){const s=Xe(u[0]);t=Nl(s,i)}if(t.length){u=G(u);for(let s=u.length-1;s>=0;s--)for(let r=0,d=t.length;r<d;r++){const m=t[r];if(u[s][m]===null&&(o==="setZero"&&(u[s][m]=0),o==="ignoreData")){u=$e(u,(c,p)=>p!==s);break}}}return u}class Ji extends jl{show(u){const{iconName:t}=u;if(t){this.showSortTooltip(u);return}super.show(u)}showSortTooltip(u){var p,h;const{position:t,options:e,meta:o,event:i}=u,{enterable:l}=Gl(e),{autoAdjustBoundary:n,adjustPosition:a}=this.spreadsheet.options.tooltip||{};this.visible=!0,this.options=u;const s=this.getContainer(),r=ns(rs,{table:this.spreadsheet,meta:o});this.spreadsheet.tooltip.container.innerHTML="";const d=document.createElement("div");this.spreadsheet.tooltip.container.appendChild(d),as(r,d);const{x:m,y:c}=Ul({spreadsheet:this.spreadsheet,position:t,tooltipContainer:s,autoAdjustBoundary:n});this.position=(a==null?void 0:a({position:{x:m,y:c},event:i}))??{x:m,y:c},mi(s,{style:{left:`${(p=this.position)==null?void 0:p.x}px`,top:`${(h=this.position)==null?void 0:h.y}px`,pointerEvents:l?"all":"none",zIndex:9999,position:"absolute",color:"black",background:"white",fontSize:"16px"},visible:!0})}}const va='<svg t="1711681787276" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4355" width="200" height="200"><path d="M922.345786 372.183628l-39.393195 38.687114L676.138314 211.079416l0 683.909301-54.713113 0L621.425202 129.010259l53.320393 0L922.345786 372.183628zM349.254406 894.989741 101.654214 651.815349l39.393195-38.687114 206.814276 199.792349L347.861686 129.010259l54.713113 0 0 765.978459L349.254406 894.988718z" fill="{fill}" p-id="4356"></path></svg>',_a='<svg t="1711682928245" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11756" width="200" height="200"><path d="M960 704L512 256 64 704z" fill="{fill}" p-id="11757"></path></svg>',La='<svg t="1711681879346" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4655" width="200" height="200"><path d="M64 320l448 448 448-448z" fill="{fill}" p-id="4656"></path></svg>';function fo(f){return`data:image/svg+xml;charset=utf-8;base64,${btoa(f)}`}function Ta(f,u){const{tableHeaderFontColor:t,tableHeaderSort:e}=L(f.customAttr).tableHeader;if(!e)return;const o=t??"#666",i=fo(va.replace("{fill}",o)),l=fo(_a.replace("{fill}",o)),n=fo(La.replace("{fill}",o)),a=Math.random(),s={asc:`customSortUp${a}`,desc:`customSortDown${a}`};u.customSVGIcons=[{name:`customSortDefault${a}`,svg:i},{name:`customSortUp${a}`,svg:l},{name:`customSortDown${a}`,svg:n}],u.headerActionIcons=[{iconNames:[`customSortDefault${a}`,`customSortUp${a}`,`customSortDown${a}`],belongsCell:"colCell",displayCondition:(r,d)=>{if(r.field===hi||r.colIndex===-1)return!1;const m=r.spreadsheet.store.get("sortMethodMap"),c=m==null?void 0:m[r.field];return c?d===s[c]:d===`customSortDefault${a}`},onClick:r=>{var p;const{meta:d,event:m}=r;d.spreadsheet.showTooltip({position:{x:m.clientX,y:m.clientY},event:m,...r});const c=document.getElementById(f.container);if((p=c==null?void 0:c.childNodes)!=null&&p.length){const h=Array.from(c.childNodes).filter(g=>g.nodeType===Node.ELEMENT_NODE).find(g=>g.classList.contains("antv-s2-tooltip-container"));if(h&&h.offsetLeft+h.clientWidth>c.offsetWidth){const y=c.offsetWidth-h.clientWidth-10;h.style.left=`${y}px`}}}}]}function Ea(f,u){const{tooltip:t}=L(f.customAttr),e=f.fontFamily?f.fontFamily:fi;u.tooltip={...u.tooltip,style:{background:t.backgroundColor,fontSize:t.fontSize+"px",fontFamily:e,color:t.color,boxShadow:"rgba(0, 0, 0, 0.1) 0px 4px 8px 0px",borderRadius:"3px",padding:"4px 12px",opacity:.95,position:"absolute"},adjustPosition:({event:o})=>Fa(o)}}function Io(f,u,t){u.preventDefault();const e=f.getCell(u.target),o=e.getMeta().valueField,i=e.getMeta(),l=f.interaction.getState();let n="";if(l.stateName===Xl.SELECTED){const{cells:a}=l;if(!(a!=null&&a.length))return;if(a.length===1){const c=a[0];e.getMeta().id===c.id&&no(i.value+"",!0),f.interaction.clearState();return}const r=f.interaction.interactions.get(Jl.BRUSH_SELECTION).getScrollBrushRangeCells(a);r.sort((c,p)=>{const h=c.getMeta(),g=p.getMeta();return h.rowIndex!==g.rowIndex?h.rowIndex-g.rowIndex:h.colIndex-g.colIndex});let d=!1;const m=r.reduce((c,p)=>{p.getMeta().colIndex===i.colIndex&&p.getMeta().rowIndex===i.rowIndex&&(d=!0);const h=c[p.getMeta().rowIndex];return h?h.push(p):c[p.getMeta().rowIndex]=[p],c},{});d&&(Xe(m).forEach(c=>{const p=m[c];p.forEach((h,g)=>{var A;const y=h.getMeta(),x=(A=y.data)==null?void 0:A[y.valueField],b=ye(t,C=>C.field===y.valueField);let S=x==null?void 0:x.toString();b&&(S=b.formatter(x)),S==null&&(S=""),g!==p.length-1&&(S+="	"),n+=S}),n=n+`
`}),n&&no(n,!0)),f.interaction.clearState();return}if(i!=null&&i.data){const a=i.data[o],s=ye(t,r=>r.field===o);n=a==null?void 0:a.toString(),s&&(n=s.formatter(a))}else{const a=t==null?void 0:t.reduce((s,r)=>(s[r.field]=r.name,s),{});n=i.value,a!=null&&a[n]&&(n=a[n])}n&&no(n,!0)}function Fa(f){const u=f.s2Instance,{x:t,y:e}=f,o={x:t+15,y:e};if(!u)return o;const{height:i,width:l}=u.getCanvasElement().getBoundingClientRect(),{offsetHeight:n,offsetWidth:a}=u.tooltip.getContainer();return a>l&&(o.x=0),n>i&&(o.y=0),(o.x||o.y)&&(o.x&&o.x+a>l&&(o.x-=o.x+a-l),o.y&&(o.y>n?o.y-n>=15?o.y-=n+15:o.y=0:o.y+=15)),o}async function za(f,u){var z,N,O,_,k;const{layoutResult:t}=f.facet,{meta:e,fields:o}=f.dataCfg,i=((z=o==null?void 0:o.rows)==null?void 0:z.length)||0,l=((N=o==null?void 0:o.columns)==null?void 0:N.length)||0;if(t.colLeafNodes.length+i+1>16384){Je.warning(Rt("chart.pivot_export_invalid_col_exceed"));return}const a=new qe.Workbook,s=a.addWorksheet(Rt("chart.chart_data")),r=e==null?void 0:e.reduce((E,I)=>(I.field&&(E[I.field]=I),E),{});(O=o.columns)==null||O.forEach((E,I)=>{var F;const B=s.getCell(I+1,1);B.value=((F=r[E])==null?void 0:F.name)??E,B.alignment={vertical:"middle",horizontal:"center"},i>=2&&s.mergeCells(I+1,1,I+1,i),B.border={right:{style:"thick",color:{argb:"00000000"}}}}),(_=o==null?void 0:o.rows)==null||_.forEach((E,I)=>{var F;const B=s.getCell(l+1,I+1);B.value=((F=r[E])==null?void 0:F.name)??E,B.alignment={vertical:"middle",horizontal:"center"},B.border={bottom:{style:"thick",color:{argb:"00000000"}}},I===o.rows.length-1&&(B.border.right={style:"thick",color:{argb:"00000000"}})});const{rowLeafNodes:d,rowsHierarchy:m,rowNodes:c}=t,p=m.maxLevel+1,h={};d.forEach(E=>{let I=E.parent;for(;I;){const R=h[I.id]??0;h[I.id]=R+1,I=I.parent}const{rowIndex:B}=E,F=B+1+l+1,M=E.level+1,$=s.getCell(F,M);$.value=E.label,$.alignment={vertical:"middle",horizontal:"center"},M<p&&s.mergeCells(F,M,F,p),$.border={right:{style:"thick",color:{argb:"00000000"}}}});const g=E=>{var I;return(I=E.children)!=null&&I.length?g(E.children[0]):E.rowIndex+1};c==null||c.forEach(E=>{if(E.isLeaf)return;const I=g(E),B=h[E.id],F=I+l+1,M=E.children[0].level-E.level,$=E.label,R=s.getCell(F,E.level+1);R.value=$,R.alignment={vertical:"middle",horizontal:"center"},(M>1||B>1)&&s.mergeCells(F,E.level+1,F+B-1,E.level+M)});const{colLeafNodes:y,colNodes:x,colsHierarchy:b}=t,S=b.maxLevel+1,A={};y.forEach(E=>{var V;let I=E.parent;for(;I;){const X=A[I.id]??0;A[I.id]=X+1,I=I.parent}const{colIndex:B}=E,F=E.level+1,M=B+1+i,$=s.getCell(F,M);let R=E.label;E.field==="$$extra$$"&&((V=r[R])!=null&&V.name)&&(R=r[R].name),$.value=R,$.alignment={vertical:"middle",horizontal:"center"},F<S&&s.mergeCells(F,M,S,M),$.border={bottom:{style:"thick",color:{argb:"00000000"}}}});const C=E=>{var I;return(I=E.children)!=null&&I.length?C(E.children[0]):E.colIndex+1};x.forEach(E=>{if(E.isLeaf)return;const I=C(E),B=A[E.id],F=E.level+1,M=E.children[0].level-E.level,$=E.label,R=I+i,V=s.getCell(F,R);V.value=$,V.alignment={vertical:"middle",horizontal:"center"},(M>1||B>1)&&s.mergeCells(F,R,F+M-1,R+B-1)});for(let E=0;E<d.length;E++)for(let I=0;I<y.length;I++){const B=t.getCellMeta(E,I),{fieldValue:F}=B;if(F===0||F){const M=r[B.valueField],$=s.getCell(E+S+1,i+I+1),R=((k=M==null?void 0:M.formatter)==null?void 0:k.call(M,F))||F.toString();$.alignment={vertical:"middle",horizontal:"center"},$.value=R}}const w=await a.xlsx.writeBuffer(),T=new Blob([w],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});je.saveAs(T,`${u.title??"透视表"}.xlsx`)}async function ka(f,u){var b,S,A,C;const t=f.facet.layoutResult;if(t.colLeafNodes.length+2>16384){Je.warning(Rt("chart.pivot_export_invalid_col_exceed"));return}const{meta:e,fields:o}=f.dataCfg,i=((b=o==null?void 0:o.columns)==null?void 0:b.length)||0,l=new qe.Workbook,n=l.addWorksheet(Rt("chart.chart_data")),a=e==null?void 0:e.reduce((w,T)=>(T.field&&(w[T.field]=T),w),{});(S=o.columns)==null||S.forEach((w,T)=>{var N;const z=n.getCell(T+1,1);z.value=((N=a[w])==null?void 0:N.name)??w,z.alignment={vertical:"middle",horizontal:"center"},z.border={right:{style:"thick",color:{argb:"00000000"}}}});const s=t.colsHierarchy.maxLevel+1,r=(A=o==null?void 0:o.rows)==null?void 0:A.map(w=>{var T;return((T=a[w])==null?void 0:T.name)??w}).join("/"),d=n.getCell(i+1,1);d.value=r,d.alignment={vertical:"middle",horizontal:"center"},d.border={right:{style:"thick",color:{argb:"00000000"}},bottom:{style:"thick",color:{argb:"00000000"}}};const{rowLeafNodes:m}=t;m.forEach((w,T)=>{const z=n.getCell(s+T+1,1);z.value=Il("  ",w.level)+w.label,z.alignment={vertical:"middle",horizontal:"left"},z.border={right:{style:"thick",color:{argb:"00000000"}}}});const c={},{colLeafNodes:p}=t;p.forEach(w=>{var E;let T=w.parent;for(;T;){const I=c[T.id]??0;c[T.id]=I+1,T=T.parent}const{colIndex:z}=w,N=w.level+1,O=z+1+1,_=n.getCell(N,O);let k=w.label;w.field==="$$extra$$"&&((E=a[k])!=null&&E.name)&&(k=a[k].name),_.value=k,_.alignment={vertical:"middle",horizontal:"center"},N<s&&n.mergeCells(N,O,s,O),_.border={bottom:{style:"thick",color:{argb:"00000000"}}}});const h=t.colNodes,g=w=>{var T;return(T=w.children)!=null&&T.length?g(w.children[0]):w.colIndex+1};h.forEach(w=>{if(w.isLeaf)return;const T=g(w),z=c[w.id],N=w.level+1,O=w.children[0].level-w.level,_=T+1,k=n.getCell(N,_);k.value=w.label,k.alignment={vertical:"middle",horizontal:"center"},(O>1||z>1)&&n.mergeCells(N,_,N+O-1,_+z-1)});for(let w=0;w<m.length;w++)for(let T=0;T<p.length;T++){const z=t.getCellMeta(w,T),{fieldValue:N}=z;if(N===0||N){const O=a[z.valueField],_=n.getCell(w+s+1,T+1+1),k=((C=O==null?void 0:O.formatter)==null?void 0:C.call(O,N))||N.toString();_.alignment={vertical:"middle",horizontal:"center"},_.value=k}}const y=await l.xlsx.writeBuffer(),x=new Blob([y],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});je.saveAs(x,`${u.title??"透视表"}.xlsx`)}async function Ar(f,u){var i,l;const{fields:t}=f.dataCfg,e=((i=t==null?void 0:t.rows)==null?void 0:i.length)||0,o=((l=t==null?void 0:t.values)==null?void 0:l.length)||0;if(!(e&&o)){Je.warning(Rt("chart.pivot_export_invalid_field"));return}u.customAttr.basicStyle.tableLayoutMode!=="tree"?za(f,u):ka(f,u)}async function Cr(f,u=100){const t=JSON.parse(JSON.stringify(f));console.log("v: ",t),t.chartExtRequest=t.chartExtRequest||{},t.chartExtRequest.pageNo=1,t.chartExtRequest.pageSize=u;const e=await qo(t),o=e.totalItems||e.total||0;console.log("total: ",o);const i=Math.ceil(o/u);let l=(e.tableRow||[]).slice();const n=[];for(let r=2;r<=i;r++){const d=JSON.parse(JSON.stringify(f));d.chartExtRequest=d.chartExtRequest||{},d.chartExtRequest.pageNo=r,d.chartExtRequest.pageSize=u,n.push(qo(d))}return(await Promise.all(n)).forEach(r=>{const d=r.tableRow||[];l=l.concat(d)}),{...e,tableRow:l}}async function wr(f,u,t="明细表"){var c,p;const o=(p=(c=(f.value||f._value||f).customAttr)==null?void 0:c.tableHeader)==null?void 0:p.headerGroupConfig,i=o==null?void 0:o.columns,l=(o==null?void 0:o.meta)||[],n=u.fields||u.sourceFields||[],a={};if(n.forEach(h=>{a[h.dataeaseName||h.key]=h.name}),l&&Array.isArray(l)&&l.length>0&&i&&i.length>0){let h=function(O){!O.children||O.children.length===0?S.push(O):O.children.forEach(h)},g=function(O,_){return O.slice().sort((k,E)=>{for(let I of _){if(k[I]<E[I])return-1;if(k[I]>E[I])return 1}return 0})};const y=Ki(i),x=new qe.Workbook,b=x.addWorksheet(t);Zi(b,i,l,a,1,1,y);const S=[];i.forEach(h);const A=S.map(O=>O.key).slice(0,2),C=u.tableRow||[],w=A.length>0?g(C,A):C,T={};A.forEach(O=>{T[O]=[];let _=0;for(let k=1;k<=w.length;k++)(k===w.length||w[k][O]!==w[_][O])&&(k-_>1&&T[O].push({start:_,end:k-1}),_=k)});for(let O=0;O<w.length;O++){const _=[];S.forEach(k=>{A.includes(k.key)&&T[k.key].some(E=>O>E.start&&O<=E.end)?_.push(""):_.push(w[O][k.key])}),b.addRow(_)}const z=y+1;console.log("mergeFieldKeys: ",A),console.log("leafNodes: ",S),console.log("mergeRanges: ",T),A.forEach(O=>{const _=S.findIndex(k=>k.key===O);_!==-1&&(!T[O]||T[O].length===0||T[O].forEach(k=>{b.mergeCells(k.start+z,_+1,k.end+z,_+1)}))});const N=await x.xlsx.writeBuffer();je.saveAs(new Blob([N]),`${t}.xlsx`);return}if(!n||n.length===0){Je.error("明细表字段定义为空，无法导出");return}const s=new qe.Workbook,r=s.addWorksheet(t);r.addRow(n.map(h=>h.name)),(u.tableRow||[]).forEach(h=>{r.addRow(n.map(g=>h[g.dataeaseName||g.key]))});const m=await s.xlsx.writeBuffer();je.saveAs(new Blob([m]),`${t}.xlsx`)}function Zi(f,u,t,e,o=1,i=1,l=1){let n=i;u.forEach(a=>{const s=f.getRow(o),r=t.find(h=>h.field===a.key);let d=r?r.name:e[a.key]||a.name||a.title||a.key;const m=s.getCell(n);m.value=d,m.alignment={vertical:"middle",horizontal:"center"},m.font={bold:!0};let c=1,p=1;a.children&&a.children.length>0?(c=Qi(a),f.mergeCells(o,n,o,n+c-1),Zi(f,a.children,t,e,o+1,n,l)):(p=l-o+1,p>1&&f.mergeCells(o,n,o+p-1,n)),n+=c})}function Qi(f){return!f.children||f.children.length===0?1:f.children.reduce((u,t)=>u+Qi(t),0)}function Ki(f,u=1){let t=u;return f.forEach(e=>{if(e.children&&e.children.length>0){const o=Ki(e.children,u+1);o>t&&(t=o)}}),t}function Oa(f,u,t){var i;const{mergeCells:e}=L(f.customAttr).tableCell,{showIndex:o}=L(f.customAttr).tableHeader;if(e){u.frozenColCount=0,u.frozenRowCount=0;const n=(f.data.fields||[]).reduce((c,p)=>(c[p.dataeaseName]=p,c),{})||{},a=t.meta.findIndex(c=>{var p;return((p=n[c.field])==null?void 0:p.groupType)==="q"}),s=(i=f.data)==null?void 0:i.tableRow;if(a===0||!(s!=null&&s.length))return;const r=[[[0,s.length-1]]],d=[];t.meta.filter((c,p)=>p<a||a===-1).forEach((c,p)=>{const h=r[p],g=[];r.push(g),h.forEach(y=>{const[x,b]=y;let S=s[x][c.field],A=x;for(let C=x;C<=b;C++){const w=s[C][c.field];if(w!==S||C===b){const T=C-A;if(T>1||C===b&&T===1&&S===w){const z=[],N=T%2===1?(T-1)/2:T/2-1;for(let O=0;O<T;O++)z.push({colIndex:o?p+1:p,rowIndex:A+O,showText:O===N});C===b&&S===w&&z.push({colIndex:o?p+1:p,rowIndex:C,showText:!1}),d.push(z),g.push([A,C===b&&S===w?C:C-1])}S=w,A=C}}})}),o&&d.filter(p=>p[0].colIndex===1).forEach(p=>{const h=G(p);h.forEach(g=>{g.colIndex=0}),d.unshift(h)}),u.mergedCellsInfo=d,u.mergedCell=(c,p,h)=>(o&&h.colIndex===0&&(h.fieldValue=tl(d,h)),new Ia(c,p,h))}}function tl(f,u){if(!(f!=null&&f.length))return u.rowIndex+1;let t=u.rowIndex;const e=f.reduce((o,i)=>{if(i[0].colIndex!==0)return o;const l=i[0].rowIndex,n=i[i.length-1].rowIndex,a=n-l;return u.rowIndex>=l&&u.rowIndex<=n&&(t=l),u.rowIndex>n?o+a:o},0);return t-e+1}class Ia extends gi{drawBackgroundShape(){const u=Kl(this.cells),{backgroundColor:t,backgroundColorOpacity:e}=this.getBackgroundColor(),o=this.theme.dataCell.cell;this.backgroundShape=ts(this,{points:u,stroke:o.horizontalBorderColor,fill:t,lineHeight:o.horizontalBorderWidth})}}class _e extends pi{hideInteractionShape(){this.stateShapes.forEach(u=>{de(u,fe.backgroundOpacity,0),de(u,fe.backgroundColor,"transparent"),de(u,fe.borderOpacity,0),de(u,fe.borderWidth,0),de(u,fe.borderColor,"transparent")})}drawTextShape(){this.meta.autoWrap?el(this,!1):super.drawTextShape()}}class Na extends Eo{drawTextShape(){this.meta.autoWrap?el(this,!0):super.drawTextShape()}}const el=(f,u)=>{const t=`
`,e="...",o=f.meta.maxLines??1,{options:{placeholder:i}}=f.spreadsheet,l=Zl(void 0,i),{formattedValue:n}=f.getFormattedFieldValue(),a=f.getTextStyle();let s=go(n?n==null?void 0:n.toString():l,a,f.meta.width,f.spreadsheet);const r=s.split(t);let d=a.fontSize;if(u){const c=s.split(t);if(r.length>o){const p=c.slice(0,o),h=c[0].length;p[p.length-1]=p[p.length-1].slice(0,h-1)+e,s=p.join(t)}}else{const c=yo(s.replaceAll(t,""),a,f.spreadsheet,o),p=Math.floor(f.meta.height/c),h=r.slice(0,p);s=p<1?e:h.join(t)||e;const g=s.split(t);if(!s.endsWith(e)&&(r.length>o||r.length>p)){const y=g[0].length,x=g.slice(0,Math.min(o,p));x[x.length-1]=x[x.length-1].slice(0,y-1)+e,s=x.join(t)}s===e&&(d=12)}f.actualText=s,f.actualTextWidth=f.spreadsheet.measureTextWidth(s,a);const m=f.getTextPosition();f.textShape=Ql(f,[f.textShape],m.x,m.y,s,a,{fontSize:d}),f.textShapes.push(f.textShape)},Ko=(f,u,t,e,o)=>{if(t.showTableHeader===!1)return;const i=o||u.facet.layoutResult,l=e.maxLines??1,n={...u.theme.cornerCell.text},a=f.info.meta.value;let s=yo(go(a,n,f.info.resizedWidth,i.spreadsheet),n,i.spreadsheet,l);const r=i.colLeafNodes.filter(d=>d.colIndex!==f.info.meta.colIndex).reduce((d,m)=>{const c=yo(go(m.value,n,m.width,m.spreadsheet),n,m.spreadsheet,l);return c>d.height?{height:c,colIndex:m.colIndex}:d},{height:0});s=Math.max(s,r.height)+n.fontSize+10.5,o&&(e.tableColumnMode==="adapt"&&(s-=n.fontSize-2),i.colLeafNodes.forEach(d=>d.height=s),i.colsHierarchy.height=s),u.store.set("autoCalcHeight",s)},go=(f,u,t,e)=>{if(!f&&f!==0)return"";f=f.toString().trim();const o=a=>e.measureTextWidthRoughly(a,u);let i="",l="",n=0;for(let a=0;a<f.length;a++){const s=f[a],r=o(s);n+=r,l+=s;const d=s.charCodeAt(0)>=128?12:8;n>=t-u.fontSize-d&&(i+=l+(a!==f.length-1?`
`:""),l="",n=0)}return i+=l,i},yo=(f,u,t,e)=>{let o=0;for(const l of f){const n=u.fontSize/(l.charCodeAt(0)>=128?5:2.5);o=Math.max(o,t.measureTextHeight(l,u)+n)}const i=f.split(`
`).length;return Math.min(i,e)*o},ol=(f,u,t,e,o,i)=>{if(!i||!t.length)return;const l={};l[t.length]=e.tableTitleHeight,u.style.rowCfg={heightByField:l},u.frozenTrailingRowCount=1;const n=f.yAxis,a=f.xAxis,s=t.reduce((r,d)=>(f.type==="table-info"?a.filter(m=>[2,3,4].includes(m.deType)).forEach(m=>{r[m.dataeaseName]=(parseFloat(d[m.dataeaseName])||0)+(parseFloat(r[m.dataeaseName])||0)}):n.forEach(m=>{r[m.dataeaseName]=(parseFloat(d[m.dataeaseName])||0)+(parseFloat(r[m.dataeaseName])||0)}),r),{SUMMARY:!0});t.push(s),u.dataCell=r=>(r.autoWrap=o.autoWrap,r.maxLines=o.maxLines,r.rowIndex!==t.length-1?new _e(r,r.spreadsheet):(r.colIndex===0&&(e.showIndex||a.length)&&(r.fieldValue=o.summaryLabel??Rt("chart.total_show")),new Ba(r,r.spreadsheet)))},il=(f,u,t,e,o)=>{!o||!u.length||f.on(j.LAYOUT_BEFORE_RENDER,()=>{const l=e.showTableHeader===!0?2:1,n=e.tableTitleHeight*l+t.tableItemHeight*(u.length-1);n<f.options.height&&(f.options.height=n<f.options.height-6?n+6:n)})};class Ba extends _e{getTextStyle(){const u=G(this.theme.colCell.bolderText);return u.textAlign=this.theme.dataCell.text.textAlign,u}getBackgroundColor(){const{backgroundColor:u,backgroundColorOpacity:t}=this.theme.colCell.cell;return{backgroundColor:u,backgroundColorOpacity:t}}}const ll=(f,u,t,e)=>{const o=()=>{const i=document.getElementById(e+"_empty");i&&i.parentElement.removeChild(i)};o(),!t.length&&f.on(j.LAYOUT_AFTER_HEADER_LAYOUT,i=>{if(o(),!t.length){const l=document.createElement("div"),n=Math.min(f.options.width,i.colsHierarchy.width)/2-32;l.id=e+"_empty",l.textContent=Rt("data_set.no_data"),l.setAttribute("style",`position: absolute;
        left: ${n}px;
        top: 50%;`);const a=document.getElementById(e);a.insertBefore(l,a.firstChild)}})},Da=f=>{const u=[],t=e=>{var o,i;if(!((o=e.children)!=null&&o.length)){u.push(e);return}for(let l=0;l<((i=e.children)==null?void 0:i.length);l++)t(e.children[l])};return f.forEach(e=>t(e)),u},sl=(f,u)=>{var e;const t=[];for(let o=0;o<u.length;o++)f.includes(u[o].key)&&t.push(u[o]),(e=u[o].children)!=null&&e.length&&t.push(...sl(f,u[o].children));return t};class No extends eo{constructor(u,t){super(Pt.S2,u,t)}configTheme(u){return ba(u)}configStyle(u,t){return Sa(u,t)}configEmptyDataStrategy(u){return wa(u)}configTooltip(u,t){Ea(u,t)}configHeaderInteraction(u,t){Ta(u,t)}configConditions(u){return Aa(u)}configMergeCells(u,t,e){Oa(u,t,e)}showTooltip(u,t,e){var s;const o=u.getCell(t.target),i=o.getMeta();let l="",n;switch(o.cellType){case"dataCell":case"mergedCell":if(i.valueField===hi){l=i.fieldValue.toString();break}n=ye(e,r=>r.field===i.valueField),i.fieldValue===0&&(l="0"),i.fieldValue&&(l=(s=n==null?void 0:n.formatter)==null?void 0:s.call(n,i.fieldValue));break;case"rowCell":case"colCell":l=i.label,n=ye(e,r=>r.field===l),n&&(l=n.name);break}if(!l)return;t.s2Instance=u;const a=u.options.tooltip.style;mi(u.tooltip.container,{style:a}),u.showTooltip({position:{x:t.clientX,y:t.clientY},content:l,meta:i,event:t})}configTouchEvent(u,t,e){const{touchAction:o}=t;u.once(j.LAYOUT_AFTER_RENDER,()=>{if(u.store.get("touchActionInit"))return;u.store.set("touchActionInit",!0);const l=u.getCanvasElement();let n=Date.now();l.addEventListener("touchstart",()=>{n=Date.now()}),l.addEventListener("touchend",a=>{var h;if(Date.now()-n>300)return;const r=l.getBoundingClientRect(),d=[a.changedTouches[0].pageX,a.changedTouches[0].pageY],m=[d[0]-r.x,d[1]-r.y],c=u.container.getShape(m[0],m[1]);if(((h=c.cfg)==null?void 0:h.type)==="image")return;o(()=>{if(a.preventDefault(),a.stopPropagation(),c){const g={target:c,x:m[0],y:m[1],clientX:d[0],clientY:d[1],originEvent:a};this.showTooltip(u,g,e)}})})})}}const nl=["background-overall-component","border-style","basic-style-selector","table-header-selector","table-cell-selector","title-selector","tooltip-selector","function-cfg","threshold","scroll-cfg","jump-set","linkage"],Bt={"border-style":["all"],"background-overall-component":["all"],"basic-style-selector":["tableColumnMode","tableBorderColor","tableScrollBarColor","alpha"],"table-header-selector":["tableHeaderBgColor","tableTitleFontSize","tableHeaderFontColor","tableTitleHeight","tableHeaderAlign","showIndex","indexLabel","showColTooltip","showHorizonBorder","showVerticalBorder"],"table-cell-selector":["tableItemBgColor","tableItemFontSize","tableFontColor","tableItemAlign","tableItemHeight","enableTableCrossBG","tableItemSubBgColor","showTooltip","showHorizonBorder","showVerticalBorder"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"tooltip-selector":["fontSize","color","backgroundColor","show"],"function-cfg":["emptyDataStrategy"],threshold:["tableThreshold"]},{t:ti}=Y();class Ma extends _e{drawTextShape(){const u=new Image,{x:t,y:e,width:o,height:i,fieldValue:l}=this.meta;u.src=l,u.setAttribute("crossOrigin","anonymous"),u.onload=()=>{!this.cfg.children&&(this.cfg.children=[]);const{width:n,height:a}=u,s=Math.max(n/o,a/i),r=n/s*.8,d=a/s*.8;this.textShape=this.addShape("image",{attrs:{x:t+(r<o?(o-r)/2:0),y:e+(d<i?(i-d)/2:0),width:r,height:d,img:u}})}}}class Ra extends No{constructor(){super("table-info",[]);v(this,"properties",nl);v(this,"propertyInner",{...Bt,"table-header-selector":[...Bt["table-header-selector"],"tableHeaderSort","showTableHeader","headerGroup"],"basic-style-selector":["tableColumnMode","tableBorderColor","tableScrollBarColor","alpha","tablePageMode","showHoverStyle","autoWrap","showSummary","summaryLabel"],"table-cell-selector":[...Bt["table-cell-selector"],"tableFreeze","tableColumnFreezeHead","tableRowFreezeHead","mergeCells"]});v(this,"axis",["xAxis","filter","drill"]);v(this,"axisConfig",{xAxis:{name:`${ti("chart.drag_block_table_data_column")} / ${ti("chart.dimension_or_quota")}`}})}drawChart(t){var N,O;const{container:e,chart:o,pageInfo:i,action:l,resizeAction:n}=t,a=document.getElementById(e);let s=((N=o.data)==null?void 0:N.fields)??[];const r=[],d=[],m=o.xAxis.reduce((_,k)=>(_[k.dataeaseName]=k,_),{}),c={};if(o.drill){const _=o.drillFilters.map(F=>F.fieldId),k=o.drillFields[0].id,E=o.xAxis.findIndex(F=>F.id===k),I=o.drillFields[_.length].id,B=s.find(F=>F.id===I);_.push(I),s=s.filter(F=>!_.includes(F.id)),c[B.dataeaseName]=o.drillFields[0].dataeaseName,s.splice(E,0,B)}s.forEach(_=>{const k=m[_.dataeaseName];(k==null?void 0:k.hide)!==!0&&(r.push(_.dataeaseName),d.push({field:_.dataeaseName,name:_.chartShowName??_.name,formatter:function(E){if(!k||E==null||![2,3,4].includes(k.deType)||!He(E))return E;let I=k.formatterCfg;return I||(I=Ue),D(E,I)}}))});const{basicStyle:p,tableCell:h,tableHeader:g,tooltip:y}=L(o.customAttr),{headerGroup:x,showTableHeader:b}=g;if(x&&b!==!1){const{headerGroupConfig:_}=g;if((O=_==null?void 0:_.columns)!=null&&O.length){const k=r.map(B=>c[B]||B),I=Da(_.columns).map(B=>B.key);if(Bl(I,k)){if(Object.keys(c).length){const B=Object.values(c)[0],F=Object.keys(c)[0],[M]=sl([B],_.columns);M.key=F}r.splice(0,r.length,..._.columns),d.push(..._.meta)}}}const S=this.configEmptyDataStrategy(o),A={fields:{columns:r},meta:d,data:S},C={width:a.getBoundingClientRect().width,height:a.offsetHeight,showSeriesNumber:g.showIndex,conditions:this.configConditions(o),tooltip:{getContainer:()=>a,renderTooltip:_=>new Ji(_)},interaction:{hoverHighlight:p.showHoverStyle!==!1,scrollbarPosition:S.length?We.CONTENT:We.CANVAS}};if(C.style=this.configStyle(o,A),p.tableColumnMode==="adapt"){const _=s.filter(k=>{var E;return k.deType===7&&!((E=m[k.dataeaseName])!=null&&E.hide)});C.style.colCfg.widthByFieldValue=_==null?void 0:_.reduce((k,E)=>(k[E.chartShowName??E.name]=120,k),{})}if(h.tableFreeze&&!h.mergeCells&&(C.frozenColCount=h.tableColumnFreezeHead??0,C.frozenRowCount=h.tableRowFreezeHead??0),C.showSeriesNumber){let _=g.indexLabel;_||(_=""),C.layoutCoordinate=(k,E,I)=>{I.colIndex===0&&I.rowIndex===0&&(I.label=_,I.value=_)}}C.dataCell=_=>{var E;const k=(E=s.filter(I=>I.dataeaseName===_.valueField))==null?void 0:E[0];return(k==null?void 0:k.deType)===7&&o.showPosition!=="dialog"?new Ma(_,_==null?void 0:_.spreadsheet):(_.colIndex===0&&C.showSeriesNumber&&(h.mergeCells?_.fieldValue=tl(C.mergedCellsInfo,_):_.fieldValue=i.pageSize*(i.currentPage-1)+_.rowIndex+1),_.autoWrap=h.mergeCells?!1:p.autoWrap,_.maxLines=p.maxLines,new _e(_,_==null?void 0:_.spreadsheet))},this.configTooltip(o,C),this.configMergeCells(o,C,A),g.showTableHeader===!1?(C.style.colCfg.height=1,h.showHorizonBorder===!1&&(C.style.colCfg.height=0),C.interaction.resize={colCellVertical:!1},C.colCell=(_,k,E)=>(_.label=" ",new Eo(_,k,E))):(o.container=e,this.configHeaderInteraction(o,C),C.colCell=(_,k,E)=>(_.autoWrap=h.mergeCells?!1:p.autoWrap,_.maxLines=p.maxLines,new Na(_,k,E))),ol(o,C,S,g,p,p.showSummary);const w=new yi(a,A,C);il(w,S,h,g,p.showSummary),p.autoWrap&&!h.mergeCells&&(w.on(j.LAYOUT_RESIZE_COL_WIDTH,_=>{Ko(_,w,g,p,null)}),w.on(j.LAYOUT_AFTER_HEADER_LAYOUT,_=>{var E;const k=w.store.get("autoCalcHeight");if(k)_.colLeafNodes.forEach(I=>I.height=k),_.colsHierarchy.height=k,w.store.set("autoCalcHeight",void 0);else if((E=_.colLeafNodes)!=null&&E.length){const{value:I,width:B}=_.colLeafNodes[0];Ko({info:{meta:{value:I},resizedWidth:B}},w,g,p,_)}})),p.tableColumnMode==="adapt"&&(w.on(j.LAYOUT_RESIZE_COL_WIDTH,()=>{w.store.set("lastLayoutResult",w.facet.layoutResult)}),w.on(j.LAYOUT_AFTER_HEADER_LAYOUT,_=>{var V,X;const k=w.store.get("lastLayoutResult");if(k){const H=(X=(V=w.options.style)==null?void 0:V.colCfg)==null?void 0:X.widthByFieldValue,q=(k==null?void 0:k.colLeafNodes.reduce((et,yt)=>(et[yt.value]=(H==null?void 0:H[yt.value])??yt.width,et),{}))||{},At=_.colLeafNodes.reduce((et,yt)=>(yt.width=q[yt.value]||yt.width,yt.x=et,et+yt.width),0);_.colNodes.forEach(et=>{et.colIndex===-1&&(et.width=xo(et),et.x=bo(et))}),_.colsHierarchy.width=At,w.store.set("lastLayoutResult",void 0);return}const E=s.filter(H=>{var q;return H.deType===7&&!((q=m[H.dataeaseName])!=null&&q.hide)}).map(H=>H.dataeaseName),I=_.colLeafNodes.reduce((H,q)=>H+(E.includes(q.field)?120:q.width),0),B=a.getBoundingClientRect().width;if(B<=I){_.colLeafNodes.reduce((H,q)=>(q.width=Math.round(q.width),q.x=H,H+q.width),0);return}const F=_.colLeafNodes.reduce((H,q)=>H+(E.includes(q.field)?0:q.width),0),$=(B-E.length*120)/F,R=_.colLeafNodes.reduce((H,q)=>(q.width=E.includes(q.field)?120:Math.round(q.width*$),q.x=H,H+q.width),0);_.colNodes.forEach(H=>{H.colIndex===-1&&(H.width=xo(H),H.x=bo(H))}),R>B&&(_.colLeafNodes[_.colLeafNodes.length-1].width-=R-B),_.colsHierarchy.width=B})),ll(w,p,S,e),w.on(j.DATA_CELL_CLICK,_=>{const E=w.getCell(_.target).getMeta(),I=s.reduce(($,R)=>($[R.dataeaseName]=R.id,$),{}),B=w.dataSet.getRowData(E),F=[];for(const $ in B)I[$]&&F.push({id:I[$],value:B[$]});const M={x:_.x,y:_.y,data:{dimensionList:F,name:I[E.valueField],sourceType:"table-info",quotaList:[]}};l(M)}),w.on(j.MERGED_CELLS_CLICK,_=>w.emit(j.DATA_CELL_CLICK,_));const{show:T}=y;T&&(w.on(j.COL_CELL_HOVER,_=>this.showTooltip(w,_,d)),w.on(j.DATA_CELL_HOVER,_=>this.showTooltip(w,_,d)),w.on(j.MERGED_CELLS_HOVER,_=>this.showTooltip(w,_,d))),w.on(j.LAYOUT_RESIZE_COL_WIDTH,_=>n(_)),w.on(j.GLOBAL_CONTEXT_MENU,_=>Io(w,_,d)),this.configTouchEvent(w,t,d);const z=this.configTheme(o);return w.setThemeCfg({theme:z}),w}configTheme(t){const e=super.configTheme(t),{basicStyle:o,tableCell:i}=L(t.customAttr);if(i.mergeCells){const l=P(i.tableFontColor,o.alpha);let n=i.tableItemBgColor;_t(n)||(n=P(n,o.alpha));const{tableBorderColor:a}=o,{tableItemAlign:s,tableItemFontSize:r}=i,d=i.isItalic?"italic":"normal",m=i.isBolder===!1?"normal":"bold",c={dataCell:{cell:{crossBackgroundColor:n}},mergedCell:{cell:{backgroundColor:n,crossBackgroundColor:n,horizontalBorderColor:a,verticalBorderColor:a,horizontalBorderWidth:i.showHorizonBorder?1:0,verticalBorderWidth:i.showVerticalBorder?1:0},bolderText:{fill:l,textAlign:s,fontSize:r,fontStyle:d,fontWeight:m},text:{fill:l,textAlign:s,fontSize:r,fontStyle:d,fontWeight:m},measureText:{fill:l,textAlign:s,fontSize:r,fontStyle:d,fontWeight:m},seriesText:{fill:l,textAlign:s,fontSize:r,fontStyle:d,fontWeight:m}}};xt(e,c)}return e}}function xo(f){var u;return(u=f.children)!=null&&u.length?f.children.reduce((t,e)=>t+xo(e),0):f.width}function bo(f){var u;return(u=f.children)!=null&&u.length?bo(f.children[0]):f.x}const Pa=Object.freeze(Object.defineProperty({__proto__:null,TableInfo:Ra},Symbol.toStringTag,{value:"Module"})),{t:Be}=Y();class $a extends No{constructor(){super("table-normal",[]);v(this,"properties",nl);v(this,"propertyInner",{...Bt,"table-header-selector":[...Bt["table-header-selector"],"tableHeaderSort","showTableHeader"],"basic-style-selector":[...Bt["basic-style-selector"],"showSummary","summaryLabel","showHoverStyle"],"table-cell-selector":[...Bt["table-cell-selector"],"tableFreeze","tableColumnFreezeHead","tableRowFreezeHead"]});v(this,"axis",["xAxis","yAxis","drill","filter"]);v(this,"axisConfig",{xAxis:{name:`${Be("chart.drag_block_table_data_column")} / ${Be("chart.dimension")}`,type:"d"},yAxis:{name:`${Be("chart.drag_block_table_data_column")} / ${Be("chart.quota")}`,type:"q"}})}setupDefaultOptions(t){return t.xAxis=[],t}drawChart(t){const{container:e,chart:o,action:i,resizeAction:l}=t,n=document.getElementById(e);if(!n)return;let a=o.data.fields;const s=[],r=[];if(o.drill){const C=o.drillFilters.map(O=>O.fieldId),w=o.drillFields[0].id,T=o.xAxis.findIndex(O=>O.id===w),z=o.drillFields[C.length].id,N=a.filter(O=>O.id===z);C.push(z),a=a.filter(O=>!C.includes(O.id)),a.splice(T,0,...N)}const d=[...o.xAxis,...o.yAxis].reduce((C,w)=>(C[w.dataeaseName]=w,C),{});a.forEach(C=>{const w=d[C.dataeaseName];(w==null?void 0:w.hide)!==!0&&(s.push(C.dataeaseName),r.push({field:C.dataeaseName,name:C.chartShowName??C.name,formatter:function(T){if(!w||T==null||![2,3,4].includes(w.deType)||!He(T))return T;let z=w.formatterCfg;return z||(z=Ue),D(T,z)}}))});const m=this.configEmptyDataStrategy(o),c={fields:{columns:s},meta:r,data:m},{basicStyle:p,tableCell:h,tableHeader:g,tooltip:y}=L(o.customAttr),x={width:n.getBoundingClientRect().width,height:n.offsetHeight,showSeriesNumber:g.showIndex,conditions:this.configConditions(o),tooltip:{getContainer:()=>n,renderTooltip:C=>new Ji(C)},interaction:{hoverHighlight:p.showHoverStyle!==!1,scrollbarPosition:m.length?We.CONTENT:We.CANVAS}};if(x.style=this.configStyle(o,c),h.tableFreeze&&(x.frozenColCount=h.tableColumnFreezeHead??0,x.frozenRowCount=h.tableRowFreezeHead??0),x.showSeriesNumber){let C=g.indexLabel;C||(C=""),x.layoutCoordinate=(w,T,z)=>{z.colIndex===0&&z.rowIndex===0&&(z.label=C,z.value=C)},x.dataCell=w=>new pi(w,w.spreadsheet)}this.configTooltip(o,x),g.showTableHeader===!1?(x.style.colCfg.height=1,h.showHorizonBorder===!1&&(x.style.colCfg.height=0),x.interaction.resize={colCellVertical:!1},x.colCell=(C,w,T)=>(C.label=" ",new Eo(C,w,T))):(o.container=e,this.configHeaderInteraction(o,x)),ol(o,x,m,g,p,p.showSummary);const b=new yi(n,c,x);il(b,m,h,g,p.showSummary),p.tableColumnMode==="adapt"&&(b.on(j.LAYOUT_RESIZE_COL_WIDTH,()=>{b.store.set("lastLayoutResult",b.facet.layoutResult)}),b.on(j.LAYOUT_AFTER_HEADER_LAYOUT,C=>{var O,_;const w=b.store.get("lastLayoutResult");if(w){const k=(_=(O=b.options.style)==null?void 0:O.colCfg)==null?void 0:_.widthByFieldValue,E=(w==null?void 0:w.colLeafNodes.reduce((B,F)=>(B[F.value]=(k==null?void 0:k[F.value])??F.width,B),{}))||{},I=C.colLeafNodes.reduce((B,F)=>(F.width=E[F.value]||F.width,F.x=B,B+F.width),0);C.colsHierarchy.width=I,b.store.set("lastLayoutResult",void 0);return}const T=n.getBoundingClientRect().width,z=T/C.colsHierarchy.width;if(z<=1){C.colLeafNodes.reduce((k,E)=>(E.width=Math.round(E.width),E.x=k,k+E.width),0);return}const N=C.colLeafNodes.reduce((k,E)=>(E.width=Math.round(E.width*z),E.x=k,k+E.width),0);N>T&&(C.colLeafNodes[C.colLeafNodes.length-1].width-=N-T),C.colsHierarchy.width=T})),ll(b,p,m,e),b.on(j.DATA_CELL_CLICK,C=>{const T=b.getCell(C.target).getMeta(),z=a.reduce((k,E)=>(k[E.dataeaseName]=E.id,k),{}),N=b.dataSet.getRowData(T),O=[];for(const k in N)z[k]&&O.push({id:z[k],value:N[k]});const _={x:C.x,y:C.y,data:{dimensionList:O,name:z[T.valueField],sourceType:"table-normal",quotaList:[]}};i(_)});const{show:S}=y;S&&(b.on(j.COL_CELL_HOVER,C=>this.showTooltip(b,C,r)),b.on(j.DATA_CELL_HOVER,C=>this.showTooltip(b,C,r))),b.on(j.LAYOUT_RESIZE_COL_WIDTH,C=>l(C)),b.on(j.GLOBAL_CONTEXT_MENU,C=>Io(b,C,r)),this.configTouchEvent(b,t,r);const A=this.configTheme(o);return b.setThemeCfg({theme:A}),b}}const Ha=Object.freeze(Object.defineProperty({__proto__:null,TableNormal:$a},Symbol.toStringTag,{value:"Module"})),{t:Wt}=Y();class Wa extends os{getTotalValue(u,t){const{options:e}=this.spreadsheet,i=Rl(t)?t:this.getTotalStatus(u),{aggregation:l,calcFunc:n}=Ua(i,e==null?void 0:e.totals)||{},a=W(e==null?void 0:e.totals)&&!this.spreadsheet.isHierarchyTreeType()?ge.SUM:"",s=Xa[l||a];if(s||n){const r=this.getMultiData(u,{queryType:is.DetailOnly});let d;return n?d=n(u,r,this.spreadsheet,i):s&&(d=s(r,Yo)),{...u,[Yo]:d,[u[dt]]:d}}}}class Va extends No{constructor(){super("table-pivot",[]);v(this,"properties",["border-style","background-overall-component","basic-style-selector","table-header-selector","table-cell-selector","table-total-selector","title-selector","tooltip-selector","function-cfg","threshold","linkage","jump-set"]);v(this,"propertyInner",{...Bt,"table-header-selector":["tableHeaderBgColor","tableTitleFontSize","tableHeaderFontColor","tableTitleHeight","tableHeaderAlign","showColTooltip","showRowTooltip","showHorizonBorder","showVerticalBorder"],"table-total-selector":["row","col"],"basic-style-selector":["tableColumnMode","tableBorderColor","tableScrollBarColor","alpha","tableLayoutMode","showHoverStyle"]});v(this,"axis",["xAxis","xAxisExt","yAxis","filter"]);v(this,"axisConfig",{xAxis:{name:`${Wt("chart.table_pivot_row")} / ${Wt("chart.dimension")}`,type:"d"},xAxisExt:{name:`${Wt("chart.drag_block_table_data_column")} / ${Wt("chart.dimension")}`,type:"d",allowEmpty:!0},yAxis:{name:`${Wt("chart.drag_block_table_data_column")} / ${Wt("chart.quota")}`,type:"q"}})}drawChart(t){var I,B;const{container:e,chart:o,chartObj:i,action:l}=t,n=document.getElementById(e),{xAxisExt:a,xAxis:s,yAxis:r}=o,[d,m,c]=[a,s,r].map(F=>F.map(M=>M.dataeaseName)),{fields:p,customCalc:h}=o.data;if(!p||p.length===0){i&&i.destroy();return}const g=[],y=[],x=[...o.xAxis,...o.xAxisExt,...o.yAxis].reduce((F,M)=>(F[M.dataeaseName]=M,F),{});p.forEach(F=>{const M=x[F.dataeaseName];g.push(F.dataeaseName),y.push({field:F.dataeaseName,name:F.chartShowName??F.name,formatter:$=>!M||$==null||![2,3,4].includes(M.deType)||!He($)?$:M.formatterCfg?D($,M.formatterCfg):D($,Ue)})});const{basicStyle:b,tooltip:S,tableTotal:A}=L(o.customAttr);(!A.row.subTotalsDimensionsNew||A.row.subTotalsDimensions==null)&&(A.row.subTotalsDimensions=m),A.col.subTotalsDimensions=d;const C=[];if(A.row.totalSort&&A.row.totalSort!=="none"&&d.length>0&&A.row.showGrandTotals&&c.indexOf(A.row.totalSortField)>-1&&d.forEach(F=>{const M={sortFieldId:F,sortMethod:A.row.totalSort.toUpperCase(),sortByMeasure:ao,query:{[dt]:A.row.totalSortField}};C.push(M)}),A.col.totalSort&&A.col.totalSort!=="none"&&m.length>0&&A.col.showGrandTotals&&c.indexOf(A.col.totalSortField)>-1&&m.forEach(F=>{const M={sortFieldId:F,sortMethod:A.col.totalSort.toUpperCase(),sortByMeasure:ao,query:{[dt]:A.col.totalSortField}};C.push(M)}),!(a!=null&&a.length)){const F=r==null?void 0:r.find(M=>!["none","custom_sort"].includes(M.sort));if(F){const M={sortFieldId:m[0],sortMethod:F.sort.toUpperCase(),sortByMeasure:ao,query:{[dt]:F.dataeaseName}};C.push(M)}}const w=[A.row.calcTotals,A.row.calcSubTotals,A.col.calcTotals,A.col.calcSubTotals],T={row:o.xAxis,col:o.xAxisExt,quota:o.yAxis};(I=o.xAxisExt)!=null&&I.length||(b.tableLayoutMode==="tree"?(A.col.calcTotals=A.row.calcSubTotals,(B=A.col.calcTotals.cfg)!=null&&B.length||(A.col.calcTotals.cfg=o.yAxis.map(F=>({dataeaseName:F.dataeaseName,aggregation:"SUM"})))):A.col.calcTotals.calcFunc=()=>"-"),w.forEach(F=>{var M;if((M=F.cfg)!=null&&M.length){delete F.aggregation;const $=F.cfg.reduce((R,V)=>(R[V.dataeaseName]=V,R),{});F.calcFunc=(R,V,X,H)=>Ya(R,V,H,o,$,T,h)}});const z=this.configEmptyDataStrategy(o),N={fields:{rows:m,columns:d,values:c},meta:y,data:z,sortParams:C},O={width:n.offsetWidth,height:n.offsetHeight,totals:A,conditions:this.configConditions(o),tooltip:{getContainer:()=>n},hierarchyType:b.tableLayoutMode??"grid",dataSet:F=>new Wa(F),interaction:{hoverHighlight:b.showHoverStyle!==!1},dataCell:F=>new _e(F,F.spreadsheet)};if(O.style=this.configStyle(o,N),b.tableLayoutMode==="tree"){const{defaultExpandLevel:F}=b;He(F)&&(F>=o.xAxis.length?O.style.rowExpandDepth=F:O.style.rowExpandDepth=F-2),F==="all"&&(O.style.rowExpandDepth=o.xAxis.length),F||(O.style.hierarchyCollapse=!0)}this.configTooltip(o,O);const _=new es(n,N,O);b.tableColumnMode==="adapt"&&(_.on(j.LAYOUT_RESIZE_COL_WIDTH,()=>{_.store.set("lastLayoutResult",_.facet.layoutResult)}),_.on(j.LAYOUT_RESIZE_ROW_WIDTH,()=>{_.store.set("lastLayoutResult",_.facet.layoutResult)}),_.on(j.LAYOUT_RESIZE_TREE_WIDTH,()=>{_.store.set("lastLayoutResult",_.facet.layoutResult)}),_.on(j.LAYOUT_AFTER_HEADER_LAYOUT,F=>{var q,At,et,yt,Do;const M=_.store.get("lastLayoutResult");if(M){const lt=(At=(q=_.options.style)==null?void 0:q.colCfg)==null?void 0:At.widthByFieldValue,pt=(yt=(et=_.options.style)==null?void 0:et.rowCfg)==null?void 0:yt.widthByField,Mo=((Do=_.options.style)==null?void 0:Do.treeRowsWidth)||M.rowsHierarchy.width,fl=M.colLeafNodes.reduce((ut,Ct)=>(ut[Ct.id]=(lt==null?void 0:lt[Ct.value])??Ct.width,ut),{})||{},Ro=F.colLeafNodes.reduce((ut,Ct)=>(Ct.width=fl[Ct.id]||Ct.width,Ct.x=ut,ut+Ct.width),0);if(F.colNodes.forEach(ut=>{ut.isLeaf||(ut.width=this.getColWidth(ut),ut.x=this.getLeftChild(ut).x)}),b.tableLayoutMode==="tree")F.rowNodes.forEach(ut=>{ut.width=Mo}),F.rowsHierarchy.width=Mo,F.colsHierarchy.width=Ro;else{const ut=M.rowNodes.reduce((ct,ht)=>(ct[ht.id]=(pt==null?void 0:pt[ht.field])??ht.width,ct),{})||{};F.rowNodes.forEach(ct=>{ct.x=0,ct.width=ut[ct.id]||ct.width;let ht=ct;for(;ht.parent.id!=="root";)ct.x+=ht.parent.width,ht=ht.parent});const Ct=F.rowsHierarchy.sampleNodesForAllLevels.reduce((ct,ht)=>ct+ht.width,0),Po=F.rowsHierarchy.maxLevel;F.rowNodes.forEach(ct=>{if(ct.isTotalRoot||ct.isSubTotals&&ct.level<Po){let ht=0;for(let so=ct.level;so<=Po;so++)ht+=F.rowsHierarchy.sampleNodesForAllLevels[so].width;ct.width=ht}}),F.rowsHierarchy.width=Ct,F.colsHierarchy.width=Ro}_.store.set("lastLayoutResult",void 0);return}const $=n.getBoundingClientRect().width,R=$/(F.colsHierarchy.width+F.rowsHierarchy.width);if(R<=1)return;const V=Math.round(F.rowsHierarchy.width*R);F.rowNodes.forEach(lt=>{lt.width=Math.round(lt.width*R)}),b.tableLayoutMode!=="tree"&&F.rowNodes.forEach(lt=>{lt.x=0;let pt=lt;for(;pt.parent.id!=="root";)lt.x+=pt.parent.width,pt=pt.parent});let X=F.colLeafNodes.reduce((lt,pt)=>(pt.width=Math.round(pt.width*R),pt.x=lt,lt+pt.width),0);F.colNodes.forEach(lt=>{lt.isLeaf||(lt.width=this.getColWidth(lt),lt.x=this.getLeftChild(lt).x)});const H=X+V;H>$&&(F.colLeafNodes[F.colLeafNodes.length-1].width-=H-$,X=X-(H-$)),F.colsHierarchy.width=X,F.rowsHierarchy.width=V}));const{show:k}=S;k&&(_.on(j.COL_CELL_HOVER,F=>this.showTooltip(_,F,y)),_.on(j.ROW_CELL_HOVER,F=>this.showTooltip(_,F,y)),_.on(j.DATA_CELL_HOVER,F=>this.showTooltip(_,F,y))),Za(_,z),_.on(j.DATA_CELL_CLICK,F=>this.dataCellClickAction(o,F,_,l)),_.on(j.ROW_CELL_CLICK,F=>this.headerCellClickAction(o,F,_,l)),_.on(j.COL_CELL_CLICK,F=>this.headerCellClickAction(o,F,_,l)),_.on(j.GLOBAL_CONTEXT_MENU,F=>Io(_,F,y)),this.configTouchEvent(_,t,y);const E=this.configTheme(o);return _.setThemeCfg({theme:E}),_}getColWidth(t){var o;let e=0;return(o=t.children)!=null&&o.length?t.children.forEach(i=>{e+=this.getColWidth(i)}):e=t.width,e}getLeftChild(t){var e;return(e=t.children)!=null&&e.length?this.getLeftChild(t.children[0]):t}dataCellClickAction(t,e,o,i){const n=o.getCell(e.target).getMeta(),a=t.data.fields.reduce((m,c)=>(m[c.dataeaseName]=c.id,m),{}),s={...n.rowQuery,...n.colQuery};s[n.valueField]=n.fieldValue;const r=[];for(const m in s)a[m]&&r.push({id:a[m],value:s[m]});const d={x:e.x,y:e.y,data:{dimensionList:r,name:a[n.valueField],sourceType:"table-pivot",quotaList:[]}};i(d)}headerCellClickAction(t,e,o,i){const n=o.getCell(e.target).getMeta(),a=n.query,s=t.data.fields.reduce((m,c)=>(m[c.dataeaseName]=c.id,m),{}),r=[];for(const m in a)s[m]&&r.push({id:s[m],value:a[m]});const d={x:e.x,y:e.y,data:{dimensionList:r,name:s[n.valueField],sourceType:"table-pivot",quotaList:[]}};i(d)}configTheme(t){const e=super.configTheme(t),{basicStyle:o,tableHeader:i}=L(t.customAttr);let l=i.tableHeaderBgColor;_t(l)||(l=P(l,o.alpha));let n=i.tableHeaderCornerBgColor??K.tableHeaderCornerBgColor;_t(n)||(n=P(n,o.alpha));let a=i.tableHeaderColBgColor??K.tableHeaderColBgColor;_t(a)||(a=P(a,o.alpha));let s=o.tableBorderColor;_t(s)||(s=P(s,o.alpha));const r=P(i.tableHeaderColFontColor,o.alpha),d=P(i.tableHeaderCornerFontColor,o.alpha),m=i.isColItalic?"italic":"normal",c=i.isCornerItalic?"italic":"normal",p=i.isColBolder===!1?"normal":"bold",h=i.isCornerBolder===!1?"normal":"bold",g={rowCell:{cell:{backgroundColor:a,horizontalBorderColor:s,verticalBorderColor:s},text:{fill:r,fontSize:i.tableTitleColFontSize,textAlign:i.tableHeaderColAlign,textBaseline:"top",fontStyle:m,fontWeight:p},bolderText:{fill:r,fontSize:i.tableTitleColFontSize,textAlign:i.tableHeaderColAlign,fontStyle:m,fontWeight:p},measureText:{fill:r,fontSize:i.tableTitleColFontSize,textAlign:i.tableHeaderColAlign,fontStyle:m,fontWeight:p},seriesText:{fill:r,fontSize:i.tableTitleColFontSize,textAlign:i.tableHeaderColAlign,fontStyle:m,fontWeight:p}},cornerCell:{cell:{backgroundColor:n},text:{fill:d,fontSize:i.tableTitleCornerFontSize,textAlign:i.tableHeaderCornerAlign,fontStyle:c,fontWeight:h},bolderText:{fill:d,fontSize:i.tableTitleCornerFontSize,textAlign:i.tableHeaderCornerAlign,fontStyle:c,fontWeight:h},measureText:{fill:d,fontSize:i.tableTitleCornerFontSize,textAlign:i.tableHeaderCornerAlign,fontStyle:c,fontWeight:h}}};return xt(e,g),i.showHorizonBorder===!1&&xt(e,{cornerCell:{cell:{horizontalBorderColor:l,horizontalBorderWidth:0}},rowCell:{cell:{horizontalBorderColor:l,horizontalBorderWidth:0}}}),i.showVerticalBorder===!1&&xt(e,{cornerCell:{cell:{verticalBorderColor:l,verticalBorderWidth:0}},rowCell:{cell:{verticalBorderColor:l,verticalBorderWidth:0}}}),e}setupDefaultOptions(t){const{customAttr:e}=t;return e.basicStyle.tableColumnMode==="field"&&(e.basicStyle.tableColumnMode="custom"),t}}function Ya(f,u,t,e,o,i,l){var a;if(!(u!=null&&u.length)||!f[dt])return"-";switch(((a=o[f[dt]])==null?void 0:a.aggregation)||"SUM"){case"SUM":return u.reduce((s,r)=>s+parseFloat(r[f[dt]]??0),0);case"AVG":return u.reduce((r,d)=>r+parseFloat(d[f[dt]]??0),0)/u.length;case"MIN":{const s=Ml(u,r=>parseFloat(r[f[dt]]));return s==null?void 0:s[f[dt]]}case"MAX":{const s=Dl(u,r=>parseFloat(r[f[dt]]));return s==null?void 0:s[f[dt]]}case"NONE":return"-";case"CUSTOM":{const s=Ga(f,i,e,t,l||{});return s===""||s===void 0?"-":parseFloat(s)}default:return u.reduce((s,r)=>s+parseFloat(r[f[dt]]??0),0)}}function qa(f,u,t,e){var n,a,s,r,d,m,c,p,h;const o=f[dt],{row:i,col:l}=u;if(t.isRowTotal&&t.isColTotal)return(a=(n=e.rowColTotal)==null?void 0:n.data)==null?void 0:a[o];if(t.isColTotal&&!t.isRowSubTotal){const{colTotal:g,rowSubInColTotal:y}=e,x=it(f,i);let b;if(x.length){const S=gt(f,i);if(S+1===i.length&&g&&(x.push(o),b=st(g.data,x)),S+1<i.length&&y){const A=(s=y==null?void 0:y[S])==null?void 0:s.data;x.push(o),b=st(A,x)}}return b}if(t.isColSubTotal&&!t.isRowTotal&&!t.isRowSubTotal){const{colSubTotal:g}=e,y=gt(f,l),x=it(f,i),b=it(f,l),S=[...x,...b],A=(r=g==null?void 0:g[y])==null?void 0:r.data;let C;return S.length&&A&&(S.push(o),C=st(A,S)),C}if(t.isRowTotal&&!t.isColSubTotal){const{rowTotal:g}=e,y=it(f,l);let x;return g&&(y.length&&(y.push(o),x=st(g.data,y)),!l.length&&i.length&&(x=st(g.data,o))),x}if(t.isRowSubTotal&&(!t.isColTotal&&!t.isColSubTotal||!l.length&&t.isColTotal&&t.isRowSubTotal)){const{rowSubTotal:g}=e,y=gt(f,i),x=it(f,l),b=it(f,i),S=[...x,...b],A=(d=g==null?void 0:g[y])==null?void 0:d.data;let C;return S.length&&g&&(S.push(o),C=st(A,S)),C}if(t.isRowTotal&&t.isColSubTotal){const{colSubInRowTotal:g}=e,y=gt(f,l),x=(m=g==null?void 0:g[y])==null?void 0:m.data,b=it(f,l);let S;return b.length&&g&&(b.push(o),S=st(x,b)),S}if(t.isColTotal&&t.isRowSubTotal){const{rowSubInColTotal:g}=e,y=gt(f,i),x=(c=g==null?void 0:g[y])==null?void 0:c.data,b=it(f,i);let S;return b.length&&g&&(b.push(o),S=st(x,b)),S}if(t.isColSubTotal&&t.isRowSubTotal){const{rowSubInColSub:g}=e,y=gt(f,i),x=gt(f,l),b=(h=(p=g==null?void 0:g[y])==null?void 0:p[x])==null?void 0:h.data,S=it(f,i),A=it(f,l),C=[...S,...A];let w;return C.length&&g&&(C.push(o),w=st(b,C)),w}return"-"}function ja(f,u,t,e){var n,a,s,r,d,m,c,p;const o=f[dt],{row:i,col:l}=u;if(t.isRowTotal&&t.isColTotal)return(a=(n=e.rowColTotal)==null?void 0:n.data)==null?void 0:a[o];if(t.isColTotal&&!t.isRowSubTotal){const{colTotal:h}=e,g=it(f,i);let y;return g.length&&h&&(g.push(o),y=st(h.data,g)),y}if(t.isColSubTotal&&!t.isRowTotal&&!t.isRowSubTotal){const{colSubTotal:h}=e,g=gt(f,l),y=it(f,i),x=it(f,l),b=[...y,...x],S=(s=h==null?void 0:h[g])==null?void 0:s.data;let A;return b.length&&S&&(b.push(o),A=st(S,b)),A}if(t.isRowTotal&&!t.isColSubTotal){const{rowTotal:h}=e,g=it(f,l);let y;return h&&(g.length&&(g.push(o),y=st(h.data,g)),!l.length&&i.length&&(y=st(h.data,o))),y}if(t.isRowSubTotal&&!t.isColTotal&&!t.isColSubTotal){const{rowSubTotal:h}=e,g=gt(f,i),y=it(f,l),x=it(f,i),b=[...y,...x],S=(r=h==null?void 0:h[g])==null?void 0:r.data;let A;return b.length&&h&&(b.push(o),A=st(S,b)),A}if(t.isRowTotal&&t.isColSubTotal){const{colSubInRowTotal:h}=e,g=gt(f,l),y=(d=h==null?void 0:h[g])==null?void 0:d.data,x=it(f,l);let b;return x.length&&h&&(x.push(o),b=st(y,x)),b}if(t.isColTotal&&t.isRowSubTotal){const{rowSubInColTotal:h}=e,g=gt(f,i),y=(m=h==null?void 0:h[g])==null?void 0:m.data,x=it(f,i);let b;return x.length&&h&&(x.push(o),b=st(y,x)),b}if(t.isColSubTotal&&t.isRowSubTotal){const{rowSubInColSub:h}=e,g=gt(f,i),y=gt(f,l),x=(p=(c=h==null?void 0:h[g])==null?void 0:c[y])==null?void 0:p.data,b=it(f,i),S=it(f,l),A=[...b,...S];let C;return A.length&&h&&(A.push(o),C=st(x,A)),C}}function Ga(f,u,t,e,o){const{tableLayoutMode:i}=t.customAttr.basicStyle;return i==="tree"?qa(f,u,e,o):ja(f,u,e,o)}function gt(f,u){const t=u.map(i=>i.dataeaseName);let e=-1;const o=Xe(f);for(let i=t.length-1;i>=0;i--){const l=t[i];o.findIndex(a=>a===l)!==-1&&e++}return e}function it(f,u){const t=[],e=Xe(f);return u.forEach(o=>{e.findIndex(l=>l===o.dataeaseName)!==-1&&t.push(f[o.dataeaseName])}),t}function Ua(f,u){const{isRowTotal:t,isRowSubTotal:e,isColTotal:o,isColSubTotal:i}=f,{row:l,col:n}=u||{},{calcTotals:a={},calcSubTotals:s={}}=l||{},{calcTotals:r={},calcSubTotals:d={}}=n||{},m=(c,p)=>{if((c.aggregation||c.calcFunc)&&p)return{aggregation:c.aggregation,calcFunc:c.calcFunc}};return m(r,o)||m(d,i)||m(a,t)||m(s,e)}const al=f=>typeof f=="number"?Number.isNaN(f):f&&typeof f=="string"?Number.isNaN(Number(f)):!0,Bo=(f,u,t=!1)=>f!=null&&f.length?f.reduce((e,o)=>{const i=st(o,u),l=al(i);if(t&&l)return e;const n=l?0:i;return e.push(new Ze(n)),e},[]):[],rl=(f,u)=>{const t=Bo(f,u);return t.length?Ze.sum(...t).toNumber():0},So=(f,u,t)=>{const e=Bo(u,t,!0);if(e!=null&&e.length)return Ze[f](...e).toNumber()},cl=(f,u)=>{const t=Bo(f,u);return t!=null&&t.length?Ze.sum(...t).dividedBy(t.length).toNumber():0},Xa={[ge.SUM]:rl,[ge.MIN]:(f,u)=>So("min",f,u),[ge.MAX]:(f,u)=>So("max",f,u),[ge.AVG]:cl};class Ja extends gi{drawTextShape(){this.meta.fieldValue=" ",super.drawTextShape();const{rowHeader:u,columnHeader:t}=this.spreadsheet.facet,e=t.getConfig().viewportWidth/2,o=u.getConfig().viewportHeight/2,l={attrs:{...this.getTextStyle(),x:e,y:o,text:Wt("data_set.no_data"),opacity:1,textAlign:"center",textBaseline:"middle"}};this.addShape("text",l)}drawBackgroundShape(){const u=this.theme.dataCell.cell;u.backgroundColor=ul(u.backgroundColor,1),super.drawBackgroundShape()}}function ul(f,u){if(f.indexOf("rgba")!==-1){const t=f.split(",");return t[3]=`${u})`,t.join(",")}if(f.indexOf("rgb")!==-1)return`${f.replace("rgb","rgba").replace(")",`,${u})`)}`;if(f.indexOf("#")!==-1){if(f.length===7)return`${f}${Math.round(u*255).toString(16)}`;if(f.length===9)return f.slice(0,7)+Math.round(u*255).toString(16)}return f}function Za(f,u){u!=null&&u.length||f.on(j.LAYOUT_AFTER_RENDER,()=>{var i;const{colLeafNodes:t,rowLeafNodes:e}=((i=f.facet)==null?void 0:i.layoutResult)||{};if(!(t!=null&&t.length)||!(e!=null&&e.length))return;const o=[];t.forEach((l,n)=>{e.forEach((a,s)=>{o.push({rowIndex:s,colIndex:n})})}),f.options.mergedCell=(l,n,a)=>new Ja(l,n,a),f.interaction.mergeCells(o)})}const Qa=Object.freeze(Object.defineProperty({__proto__:null,TablePivot:Va,getDataAvgByField:cl,getDataExtremumByField:So,getDataSumByField:rl,isNotNumber:al,setColorOpacity:ul},Symbol.toStringTag,{value:"Module"})),Vt=class Vt{registerChartView(u,t,e){Vt.CHART_VIEW_MAP.has(u)?Vt.CHART_VIEW_MAP.get(u).set(t,e):Vt.CHART_VIEW_MAP.set(u,new Map([[t,e]]))}getChartView(u,t){var e;return(e=Vt.CHART_VIEW_MAP.get(u))==null?void 0:e.get(t)}};v(Vt,"CHART_VIEW_MAP",new Map);let Ao=Vt;const dl=new Ao,ei=Object.assign({"./charts/bar/bar.ts":qs,"./charts/bar/bidirectional-bar.ts":Gs,"./charts/bar/horizontal-bar.ts":Js,"./charts/bar/progress-bar.ts":Qs,"./charts/bar/range-bar.ts":en,"./charts/bar/waterfall.ts":ln,"./charts/line/area.ts":an,"./charts/line/line.ts":un,"./charts/line/stock-line.ts":mn,"./charts/liquid/liquid.ts":gn,"./charts/map/bubble-map.ts":bn,"./charts/map/flow-map.ts":An,"./charts/map/heat-map.ts":wn,"./charts/map/map.ts":_n,"./charts/map/symbolic-map.ts":Tn,"./charts/map/tooltip-carousel.ts":yn,"./charts/others/chart-mix-common.ts":En,"./charts/others/chart-mix.ts":In,"./charts/others/circle-packing.ts":Dn,"./charts/others/funnel.ts":Rn,"./charts/others/gauge.ts":Hn,"./charts/others/indicator.ts":Yn,"./charts/others/picture-group.ts":jn,"./charts/others/quadrant.ts":Un,"./charts/others/radar.ts":Jn,"./charts/others/rich-text.ts":Qn,"./charts/others/sankey-common.ts":Kn,"./charts/others/sankey.ts":oa,"./charts/others/scatter.ts":la,"./charts/others/treemap.ts":na,"./charts/others/word-cloud.ts":ca,"./charts/pie/pie.ts":ma,"./charts/pie/rose.ts":ha,"./charts/table/t-heatmap.ts":xa,"./charts/table/table-info.ts":Pa,"./charts/table/table-normal.ts":Ha,"./charts/table/table-pivot.ts":Qa});for(const f in ei){const u=ei[f];Object.getOwnPropertyNames(u).forEach(t=>{if(Ll(u[t],Ce)){const e=new u[t];dl.registerChartView(e.render,e.name,e)}})}const vr=dl;export{Pt as C,wr as a,ve as b,vr as c,Re as d,Ar as e,Cr as f,Da as g,Is as h,ba as i,sl as j,Qo as m,br as n,Ms as s};

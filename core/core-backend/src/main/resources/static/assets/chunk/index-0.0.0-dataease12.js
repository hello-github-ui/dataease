var hl=Object.defineProperty;var gl=(m,u,t)=>u in m?hl(m,u,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[u]=t;var w=(m,u,t)=>(gl(m,typeof u!="symbol"?u+"":u,t),t);import{_ as lt}from"./jspdf-0.0.0-dataease.js";import{p as L,m as yl,h as P,a as qe,b as xl,g as bl,c as Sl,d as Al,e as Cl,s as wl,f as Q,i as Bo,j as ci,k as ui,l as di,n as fi,o as fe,u as vl,q as We,r as So,t as _l,v as Uo,w as Ll,x as Jo,y as _e,z as Xo,A as Ft,B as po,C as Tl,D as El}from"./util-0.0.0-dataease2.js";import{p as mi,q as Ro,r as Fl,s as zt,t as Qt,b as ct,u as Gt,v as qt,w as zl,x as kl,y as at,z as kt}from"./chart-0.0.0-dataease.js";import{v as D,f as eo}from"./formatter-0.0.0-dataease.js";import{o as Y,q as he,e as Z,v as Ol,w as Nl,x as _t,y as Do,z as we,A as Nt,B as je,u as Il,n as vt,g as dt,C as oo,D as Bl,E as Rl,F as Ue,b as Dl,G as Ml,H as $l,I as Pl}from"./lodash-es-0.0.0-dataease.js";import{_ as Xt}from"./lodash-0.0.0-dataease.js";import{s as Mo,c as ve,C as pi,L as hi,I as gi,Z as Hl,a as Wl,P as Vl,G as Kt,b as yi,d as Yl,D as Go,T as xi,S as $o,e as Po,f as ql,g as ae,H as jl,h as Ul,F as bi,B as Jl,i as Xl,j as Gl,k as Si,l as Zl,m as Ql,n as Ao,u as ye,o as Je,p as Kl,r as ts,q as V,t as Ai,M as Ci,v as es,w as os,x as xe,y as re,z as Co,A as Ce,E as ho,J as gt,K as is,N as ls,Q as ss,V as Zo}from"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import{e as Xe}from"./@turf-0.0.0-dataease.js";import{j as U,i as ns,A as it}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{a as Ge}from"./mathjs-0.0.0-dataease.js";import{q as as}from"./sysParameter-0.0.0-dataease.js";import{a0 as rs,ax as cs}from"./@vue-0.0.0-dataease.js";import us from"./TableTooltip-0.0.0-dataease.js";import{E as Ze}from"./exceljs-0.0.0-dataease.js";import{a as Qe}from"./file-saver-0.0.0-dataease.js";import{p as io}from"./element-plus-secondary-0.0.0-dataease.js";import{g as Qo}from"./chart-0.0.0-dataease2.js";import{D as lo}from"./decimal.js-0.0.0-dataease.js";const{t:ds}=U();function ft(m){return m.drill?[0,10,22,10]:[0,10,10,10]}function fs(m){const u=[];let t,e,o,i,l,n,a,s,r;if(m.customAttr){if(r=L(m.customAttr),r.basicStyle){const c=JSON.parse(JSON.stringify(r.basicStyle));c.colors.forEach(f=>{u.push(P(f,c.alpha))})}if(r.label){const c=JSON.parse(JSON.stringify(r.label));e=c.fontSize,o=c.color}if(r.tooltip){const c=JSON.parse(JSON.stringify(r.tooltip));i=c.color,l=c.fontSize,n=c.backgroundColor}}let d;if(m.customStyle&&(d=L(m.customStyle),d.background&&(t=P(d.background.color,d.background.alpha)),d.legend)){const c=d.legend;a=c.color,s=c.fontSize}const p={styleSheet:{brandColor:u[0],paletteQualitative10:u,paletteQualitative20:u,backgroundColor:t},labels:{offset:4,style:{fill:o,fontSize:e}},innerLabels:{offset:4,style:{fill:o,fontSize:e}},pieLabels:{offset:4,style:{fill:o,fontSize:e}},components:{tooltip:{domStyles:{"g2-tooltip":{color:i,fontSize:l+"px",background:n,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.1)","z-index":2e3,position:"fixed"},"g2-tooltip-list-item":{display:"flex","align-items":"flex-start","line-height":l+"px"},"g2-tooltip-name":{display:"inline-block","line-height":l+"px",flex:1},"g2-tooltip-value":{display:"inline-block","line-height":l+"px"},"g2-tooltip-marker":{"margin-top":(l-8)/2+"px","min-width":"8px","min-height":"8px"}}},legend:{common:{itemName:{style:{fill:a,fontSize:s}}}}}};return m.fontFamily&&(p.styleSheet.fontFamily=m.fontFamily),p}function Le(m){let u,t;if(m.customAttr&&(t=L(m.customAttr),t.label)){const e=t.label;if(e.show){const o=[];e.fullDisplay||(m.type==="bar-stack"?o.push({type:"interval-hide-overlap"}):m.type.indexOf("-horizontal")>-1||["bidirectional-bar","progress-bar","pie-donut","radar","waterfall","t-heatmap","bar"].includes(m.type)?(o.push({type:"limit-in-canvas"}),o.push({type:"hide-overlap"})):m.type.includes("chart-mix")?(o.push({type:"limit-in-canvas"}),o.push({type:"limit-in-plot"}),o.push({type:"hide-overlap"})):(o.push({type:"limit-in-plot"}),o.push({type:"hide-overlap"}))),u={position:e.position,layout:o,style:{fill:e.color,fontSize:e.fontSize,fontFamily:m.fontFamily},formatter:function(i){return D(i.value,e.labelFormatter)}}}else u=!1}return u}function ms(m){let u,t;if(m.customAttr&&(t=L(m.customAttr),t.tooltip)){const e=JSON.parse(JSON.stringify(t.tooltip));e.show?u={formatter:function(o){const i=D(o.value,e.tooltipFormatter);return{name:o.field,value:i}},container:mt(`tooltip-${m.id}`),itemTpl:pt,enterable:!0}:u=!1}return u}function ps(m){var i;const t=L(m.customAttr).tooltip;if(!t.show)return!1;const e=(i=t.seriesTooltipFormatter)==null?void 0:i.filter(l=>l.show).reduce((l,n)=>(l[n.id]=n,l),{});return{showTitle:!0,customItems(l){var s,r;if(!((s=t.seriesTooltipFormatter)!=null&&s.length))return l;const n=l[0];if(!n.data.quotaList)return l;const a=[];return l.filter(d=>e[d.data.quotaList[0].id]).forEach(d=>{const p=e[d.data.quotaList[0].id],c=D(parseFloat(d.value),p.formatterCfg),f=Y(p.chartShowName)?p.name:p.chartShowName,h=Ho(d);a.push({...d,name:f,value:c,...h?{color:h}:{}})}),(r=n.data.dynamicTooltipValue)==null||r.forEach(d=>{const p=e[d.fieldId];if(p){const c=D(parseFloat(d.value),p.formatterCfg),f=Y(p.chartShowName)?p.name:p.chartShowName;a.push({color:"grey",name:f,value:c})}}),a},container:mt(`tooltip-${m.id}`),itemTpl:pt,enterable:!0}}function hs(m){let u={},t;if(m.customStyle&&(t=L(m.customStyle),t.legend)){const e=he(JSON.parse(JSON.stringify(t.legend)),zt);if(e.show){let o,i,l;const n=e.orient,a=e.icon;e.hPosition==="center"?l=e.vPosition==="center"?"top":e.vPosition:e.vPosition==="center"?l=e.hPosition==="center"?"left":e.hPosition:n==="horizontal"?l=e.vPosition+"-"+e.hPosition:l=e.hPosition+"-"+e.vPosition,n==="horizontal"?(e.hPosition==="left"?o=16:e.hPosition==="right"?o=-16:o=0,e.vPosition==="top"?i=0:e.vPosition==="bottom"?m.drill&&(i=-12):i=0):(e.hPosition==="left"?o=10:e.hPosition==="right"?o=-10:o=0,e.vPosition==="top"?i=0:e.vPosition==="bottom"?m.drill?i=-18:i=-10:i=0),u={layout:n,position:l,offsetX:o,offsetY:i,marker:{symbol:a,style:{r:e.size}},itemName:{style:{fill:e.color,fontSize:e.fontSize}},itemHeight:(e.fontSize>e.size*2?e.fontSize:e.size*2)+4,radio:!1,pageNavigator:{marker:{style:{fill:"rgba(0,0,0,0.65)",stroke:"rgba(192,192,192,0.52)",size:e.size*2}},text:{style:{fill:e.color,fontSize:e.fontSize}}}}}else u=!1}return u}function wi(m){let u={},t;if(m.customStyle&&(t=L(m.customStyle),t.xAxis)){const e=JSON.parse(JSON.stringify(t.xAxis));if(e.show){const o=e.nameShow&&e.name&&e.name!==""?{text:e.name,style:{fill:e.color,fontSize:e.fontSize},spacing:8}:null,i=e.splitLine.show?{line:{style:{stroke:e.splitLine.lineStyle.color,lineWidth:e.splitLine.lineStyle.width,lineDash:Ht(e.splitLine.lineStyle.style)}}}:null,l=e.axisLine?e.axisLine:mi.axisLine,n=l.show?{style:{stroke:l.lineStyle.color,lineWidth:l.lineStyle.width,lineDash:Ht(l.lineStyle.style)}}:null,a=l.show?{style:{stroke:l.lineStyle.color,lineWidth:l.lineStyle.width}}:null;let s="center";const r=e.axisLabel.rotate;e.position==="top"&&(s=r>20?"end":r<-20?"start":"center"),e.position==="bottom"&&(s=r>20?"start":r<-20?"end":"center");const d=e.axisLabel.show?{rotate:r*Math.PI/180,style:{fill:e.axisLabel.color,fontSize:e.axisLabel.fontSize,textAlign:s},formatter:p=>m.type==="bidirectional-bar"&&p.length>e.axisLabel.lengthLimit?p.substring(0,e.axisLabel.lengthLimit)+"...":p}:null;u={position:e.position,title:o,grid:i,label:d,line:n,tickLine:a}}else u=!1}return u}function so(m){let u={};const t=L(m.customStyle).yAxis;if(!t.show)return!1;const e=t.nameShow&&t.name&&t.name!==""?{text:t.name,style:{fill:t.color,fontSize:t.fontSize},spacing:8}:null,o=t.splitLine.show?{line:{style:{stroke:t.splitLine.lineStyle.color,lineWidth:t.splitLine.lineStyle.width,lineDash:Ht(t.splitLine.lineStyle.style)}}}:null,i=t.axisLine?t.axisLine:Ro.axisLine,l=i.show?{style:{stroke:i.lineStyle.color,lineWidth:i.lineStyle.width,lineDash:Ht(i.lineStyle.style)}}:null,n=i.show?{style:{stroke:i.lineStyle.color,lineWidth:i.lineStyle.width}}:null,a=t.axisLabel.rotate;let s="end",r="middle";t.position==="right"&&(s="start",Math.abs(a)>75&&(s="center"),a>75&&(r="bottom"),a<-75&&(r="top")),t.position==="left"&&(Math.abs(a)>75&&(s="center"),a>75&&(r="top"),a<-75&&(r="bottom"));const d=t.axisLabel.show?{rotate:a*Math.PI/180,style:{fill:t.axisLabel.color,fontSize:t.axisLabel.fontSize,textBaseline:r,textAlign:s},formatter:p=>p.length>t.axisLabel.lengthLimit?p.substring(0,t.axisLabel.lengthLimit)+"...":p}:null;return u={position:t.position,title:e,grid:o,label:d,line:l,tickLine:n,nice:!0},u}function vi(m){let u={};const t=L(m.customStyle).yAxisExt;if(!t.show)return!1;const e=t.nameShow&&t.name&&t.name!==""?{text:t.name,style:{fill:t.color,fontSize:t.fontSize},spacing:8}:null,o=t.splitLine.show?{line:{style:{stroke:t.splitLine.lineStyle.color,lineWidth:t.splitLine.lineStyle.width,lineDash:Ht(t.splitLine.lineStyle.style)}}}:null,i=t.axisLine?t.axisLine:Ro.axisLine,l=i.show?{style:{stroke:i.lineStyle.color,lineWidth:i.lineStyle.width,lineDash:Ht(i.lineStyle.style)}}:null,n=i.show?{style:{stroke:i.lineStyle.color,lineWidth:i.lineStyle.width}}:null,a=t.axisLabel.rotate;let s="end",r="middle";t.position==="right"&&(s="start",Math.abs(a)>75&&(s="center"),a>75&&(r="bottom"),a<-75&&(r="top")),t.position==="left"&&(Math.abs(a)>75&&(s="center"),a>75&&(r="top"),a<-75&&(r="bottom"));const d=t.axisLabel.show?{rotate:a*Math.PI/180,style:{fill:t.axisLabel.color,fontSize:t.axisLabel.fontSize,textBaseline:r,textAlign:s}}:null;return u={position:t.position,title:e,grid:o,label:d,line:l,tickLine:n,nice:!0},u}function gs(m){let u;const t=L(m.senior);return t.functionCfg&&t.functionCfg.sliderShow&&(u={start:t.functionCfg.sliderRange[0]/100,end:t.functionCfg.sliderRange[1]/100},t.functionCfg.sliderBg&&(u.backgroundStyle={fill:t.functionCfg.sliderBg,stroke:t.functionCfg.sliderBg,lineWidth:1,strokeOpacity:.5}),t.functionCfg.sliderFillBg&&(u.foregroundStyle={fill:t.functionCfg.sliderFillBg,fillOpacity:.5}),t.functionCfg.sliderTextColor&&(u.textStyle={fill:t.functionCfg.sliderTextColor,fontFamily:m.fontFamily},u.handlerStyle={fill:t.functionCfg.sliderTextColor,fillOpacity:.5,highLightFill:t.functionCfg.sliderTextColor})),u}function _i(m){var o,i;const u=[],t=L(m.senior);if(!((o=t.assistLineCfg)!=null&&o.enable))return u;const e=t.assistLineCfg.assistLine;if((e==null?void 0:e.length)>0){const l=L(m.customStyle);let n,a,s,r;if(l.yAxis){const y=JSON.parse(JSON.stringify(l.yAxis));n=y.position,a=y.axisLabelFormatter?y.axisLabelFormatter:Ro.axisLabelFormatter}if(l.yAxisExt){const y=JSON.parse(JSON.stringify(l.yAxisExt));s=y.position,r=y.axisLabelFormatter?y.axisLabelFormatter:Fl.axisLabelFormatter}const d=e.filter(y=>y.field==="0"),p=e.filter(y=>y.field==="1").map(y=>y.fieldId),c=Xt.filter(m.yAxis,y=>y.summary!==""&&y.id!=="-1"),f=Xt.filter(m.yAxisExt,y=>y.summary!==""&&y.id!=="-1"),h=(i=m.data.dynamicAssistLines)==null?void 0:i.filter(y=>(p==null?void 0:p.includes(y.fieldId))&&(!!Xt.find(c,x=>x.id===y.fieldId)||!!Xt.find(f,x=>x.id===y.fieldId)&&m.type.includes("chart-mix")));d.concat(h||[]).forEach(y=>{const x=parseFloat(y.value),b=y.name+" : "+D(x,y.yAxisType==="left"?a:r);u.push({type:"line",yAxisType:y.yAxisType,start:["start",x],end:["end",x],style:{stroke:y.color,lineDash:Ht(y.lineType)}}),u.push({type:"text",yAxisType:y.yAxisType,position:[(y.yAxisType==="left"?n:s)==="left"?"start":"end",x],content:b,offsetY:-2,offsetX:(y.yAxisType==="left"?n:s)==="left"?2:-10*(b.length-2),style:{textBaseline:"bottom",fill:y.color,fontSize:y.fontSize?y.fontSize:10}})})}return u}function ys(m){var o,i;const u=[],t=L(m.senior);if(!((o=t.assistLineCfg)!=null&&o.enable))return u;const e=t.assistLineCfg.assistLine;if((e==null?void 0:e.length)>0){const l=L(m.customStyle);let n;if(l.xAxis){const c=JSON.parse(JSON.stringify(l.xAxis));xs(c.position),n=c.axisLabelFormatter?c.axisLabelFormatter:mi.axisLabelFormatter}const a=e.filter(c=>c.field==="0"),s=e.filter(c=>c.field==="1").map(c=>c.fieldId),r=Xt.filter(m.yAxis,c=>c.summary!==""&&c.id!=="-1"),d=(i=m.data.dynamicAssistLines)==null?void 0:i.filter(c=>(s==null?void 0:s.includes(c.fieldId))&&!!Xt.find(r,f=>f.id===c.fieldId));a.concat(d||[]).forEach(c=>{const f=parseFloat(c.value),h=c.name+" : "+D(f,n);u.push({type:"line",start:["start",f],end:["end",f],style:{stroke:c.color,lineDash:Ht(c.lineType)}}),u.push({type:"text",position:["start",f],content:h,offsetY:5,offsetX:2,rotate:Math.PI/2,style:{textBaseline:"bottom",fill:c.color,fontSize:c.fontSize?c.fontSize:10}})})}return u}function Ht(m){switch(m){case"solid":return[0,0];case"dashed":return[10,8];case"dotted":return[2,2];default:return[0,0]}}function rt(m,u=!1,t=0,e=0){const o=m.split(","),l=parseFloat(o[3].replace(")",""))*.3;o.splice(3,1,`${l})`);let n;return e==0?n=`l(${t}) 0:${o.join(",")} 1:${m}`:e>0?n=`l(${t}) 0:rgba(255,255,255,0) ${e}:${o.join(",")} 1:${m}`:n=`l(${t}) 0:rgba(255,255,255,0) 0.1:${o.join(",")} 1:${m}`,u?n:m}function xs(m){switch(m){case"top":return"left";case"bottom":return"right";case"left":return"bottom";case"right":return"top";default:return m}}function Li(m){const t=L(m.customAttr).label,e={fill:t.color,fontSize:t.fontSize,textAllowOverlap:!0,fontWeight:"bold"};return t.fullDisplay||(e.textAllowOverlap=!1,e.padding=[2,2]),m.fontFamily&&(e.fontFamily=m.fontFamily),{visible:t.show,style:e}}function bs(m){return{stroke:L(m.customAttr).basicStyle.areaBorderColor}}function Ti(m){var i;const t=L(m.customAttr).tooltip,e=(i=t.seriesTooltipFormatter)==null?void 0:i.filter(l=>l.show).reduce((l,n)=>(l[n.id]=n,l),{}),o=document.getElementById(m.container);return o&&o.addEventListener("mousemove",l=>{const n=o.getBoundingClientRect(),a=l.clientX-n.left,s=l.clientY-n.top,r=o.getElementsByClassName("l7plot-tooltip-container");for(let d=0;d<(r==null?void 0:r.length);d++){const p=r[d],c=o.clientWidth-a<=p.clientWidth,f=o.clientHeight-s<=p.clientHeight;let h="";c&&(h+="translateX(-120%) "),f&&(h+="translateY(-100%) "),h&&(p.style.transform=h.trim())}}),{customTitle(l){return l.name},customItems(l){var r,d,p;const n=[];if(Y(e))return n;const a=l.properties,s=e[(d=(r=a.quotaList)==null?void 0:r[0])==null?void 0:d.id];if(!Y(s)){const c=parseFloat(a.value),f=D(c,s.formatterCfg),h=Y(s.chartShowName)?s.name:s.chartShowName;n.push({...a,name:h,value:`${f??""}`})}return(p=a.dynamicTooltipValue)==null||p.forEach(c=>{const f=e[c.fieldId];if(f){const h=D(parseFloat(c.value),f.formatterCfg),g=Y(f.chartShowName)?f.name:f.chartShowName;n.push({color:"grey",name:g,value:`${h??""}`})}}),n},showComponent:t.show,domStyles:{"l7plot-tooltip":{"background-color":t.backgroundColor,"font-size":`${t.fontSize}px`,"line-height":1.6,"font-family":m.fontFamily?m.fontFamily:void 0},"l7plot-tooltip__name":{color:t.color},"l7plot-tooltip__value":{color:t.color},"l7plot-tooltip__title":{color:t.color}}}}function Ei(m,u){m.features.forEach(t=>{if(!t.properties.centroid)if(t.properties.center)t.properties.centroid=t.properties.center;else{const o=Xe(t.geometry);t.properties.centroid=o.geometry.coordinates}let e=t.properties.name;u!=null&&u[e]&&(e=u[e],t.properties.name=e)})}function no(m){const u={};return m==null||m.forEach(t=>{var e;(e=t.dynamicTooltipValue)==null||e.forEach(o=>{u[o.fieldId]||(u[o.fieldId]=0),o.value&&(u[o.fieldId]=Ge(u[o.fieldId],o.value))})}),u}const Ss={circle:{borderRadius:"50%"},square:{},triangle:{borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottom:"10px solid var(--bgColor)",background:"unset"},diamond:{transform:"rotate(45deg)"}};function As(m){const{basicStyle:u}=L(m.customAttr);if(u.suspension===!1&&u.showZoom===void 0)return!1;const{legend:t}=L(m.customStyle);return t.show?{position:"bottomleft",customContent:(e,o)=>{const i=(o==null?void 0:o.length)>30?o.slice(0,30):o;if(i!=null&&i.length){const n=ve(pi).getElementsByClassName(hi)[0];return i.forEach(a=>{let s="-";if(a.value!=="")if(Array.isArray(a.value))a.value.forEach((c,f)=>{a.value[f]=Number.isNaN(c)||c==="NaN"?"NaN":parseFloat(c).toFixed(0)}),s=a.value.join("-");else{const c=a.value;s=Number.isNaN(c)||c==="NaN"?"NaN":parseFloat(c).toFixed(0)}const r={...a,value:s},d=Mo(gi,r),p=ve(d);p.style.setProperty("--bgColor",a.color),n.appendChild(p)}),n}return""},domStyles:{"l7plot-legend__category-value":{fontSize:t.fontSize+"px",color:t.color},"l7plot-legend__category-marker":{...Ss[t.icon]}}}:!1}const Cs='<svg t="1717484429999" fill="${fill}" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9332" width="14px" height="14px"><path d="M47.653 439.326c-24.501 0-44.368 19.881-44.368 44.4v56.548c0 24.492 19.862 44.4 44.368 44.4h928.694c24.501 0 44.368-19.881 44.368-44.4v-56.548c0-24.497-19.862-44.4-44.368-44.4H47.653z" p-id="9333"></path><path d="M586.326 47.653c0-24.501-19.881-44.368-44.4-44.368h-56.548c-24.492 0-44.4 19.862-44.4 44.368v928.694c0 24.501 19.881 44.368 44.4 44.368h56.548c24.497 0 44.4-19.862 44.4-44.368V47.653z" p-id="9334"></path></svg>',ws='<svg t="1717487786436" fill="${fill}" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="18361" width="14px" height="14px"><path d="M127.594667 503.274667a383.573333 383.573333 0 0 1 112.426666-263.04 380.864 380.864 0 0 1 122.24-82.474667 382.421333 382.421333 0 0 1 149.632-30.165333c51.946667 0 102.250667 10.176 149.504 30.165333a381.610667 381.610667 0 0 1 122.133334 82.474667 385.152 385.152 0 0 1 31.082666 35.093333l-67.285333 52.501333a8.96 8.96 0 0 0 3.349333 15.765334l196.352 48.042666a8.96 8.96 0 0 0 11.050667-8.597333l0.896-202.154667c0-7.466667-8.597333-11.733333-14.421333-7.04l-63.018667 49.28C795.605333 113.173333 661.973333 42.666667 511.786667 42.666667 255.786667 42.666667 47.488 247.829333 42.666667 502.826667a8.96 8.96 0 0 0 8.96 9.173333h67.029333c4.906667 0 8.832-3.925333 8.96-8.725333z m844.8 8.725333h-67.050667a8.917333 8.917333 0 0 0-8.96 8.704 381.76 381.76 0 0 1-30.037333 140.8 382.336 382.336 0 0 1-82.346667 122.24 382.656 382.656 0 0 1-271.893333 112.64 382.421333 382.421333 0 0 1-271.765334-112.64 385.152 385.152 0 0 1-31.061333-35.072l67.264-52.522667a8.96 8.96 0 0 0-3.349333-15.765333l-196.330667-48.042667a8.96 8.96 0 0 0-11.050667 8.597334l-0.789333 202.261333c0 7.488 8.597333 11.733333 14.421333 7.04l63.018667-49.28C228.394667 910.826667 362.026667 981.333333 512.213333 981.333333 768.341333 981.333333 976.512 776.042667 981.333333 521.173333a8.96 8.96 0 0 0-8.96-9.173333z" p-id="18362"></path></svg>',vs='<svg t="1717486240292" fill="${fill}" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="13641" width="14px" height="14px"><path d="M935 423.3H89C40.2 423.3 0.3 463.2 0.3 512c0 48.8 39.9 88.7 88.7 88.7h846c48.8 0 88.7-39.9 88.7-88.7 0-48.8-39.9-88.7-88.7-88.7z" p-id="13642"></path></svg>';class wo extends Hl{resetButtonGroup(u){Wl(u),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",u,this.zoomIn),this.zoomResetButton=this.createButton(this.controlOption.resetText,"Reset","l7-button-control",u,()=>{this.controlOption.bounds?this.mapsService.fitBounds(this.controlOption.bounds,{animate:!0}):this.mapsService.setZoomAndCenter(this.controlOption.initZoom,this.controlOption.center)}),this.controlOption.showZoom&&(this.zoomNumDiv=this.createButton("0","","l7-button-control l7-control-zoom__number",u)),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",u,this.zoomOut);const{buttonBackground:t}=this.controlOption,e=[this.zoomResetButton,this.zoomInButton,this.zoomOutButton];t&&Ko(e,"background",t),Ko(e,"border-bottom","none"),this.updateDisabled()}getDefault(u){const{buttonColor:t}=u;let e=Cs,o=vs,i=ws;return t&&(e=e.replace("${fill}",t),o=o.replace("${fill}",t),i=i.replace("${fill}",t)),{...u,position:Vl.BOTTOMRIGHT,name:"zoom",zoomInText:e,zoomInTitle:"Zoom in",zoomOutText:o,zoomOutTitle:"Zoom out",resetText:i,showZoom:!1}}}function _s(m,u){var o,i,l,n,a,s;const{basicStyle:t}=L(m.customAttr),e=u==null?void 0:u.getControlByName("zoom");if(e&&u.removeControl(e),!Fi(t)&&!(u!=null&&u.getControlByName("zoom")))if(!u.map)u.once("loaded",()=>{u.map.on("complete",()=>{const r=t.autoFit===!1?t.zoomLevel:u.getZoom(),d=t.autoFit===!1?[t.mapCenter.longitude,t.mapCenter.latitude]:[u.map.getCenter().lng,u.map.getCenter().lat],p={initZoom:r,center:d,buttonColor:t.zoomButtonColor,buttonBackground:t.zoomBackground};u.addControl(new wo(p))})});else{const r={buttonColor:t.zoomButtonColor,buttonBackground:t.zoomBackground};if(t.autoFit===!1)r.initZoom=t.zoomLevel,r.center=[t.mapCenter.longitude,t.mapCenter.latitude];else{const d=[];if(m.type==="flow-map"){const p=m.xAxis,c=m.xAxisExt;(p==null?void 0:p.length)===2&&((i=(o=m.data)==null?void 0:o.tableRow)==null||i.forEach(f=>{d.push([f[p[0].dataeaseName],f[p[1].dataeaseName]])})),(c==null?void 0:c.length)===2&&((n=(l=m.data)==null?void 0:l.tableRow)==null||n.forEach(f=>{d.push([f[c[0].dataeaseName],f[c[1].dataeaseName]])}))}else{const p=m.xAxis;(p==null?void 0:p.length)===2&&((s=(a=m.data)==null?void 0:a.tableRow)==null||s.forEach(c=>{d.push([c[p[0].dataeaseName],c[p[1].dataeaseName]])}))}r.bounds=Ls(d)}u.addControl(new wo(r))}}function Ls(m){if(!m||m.length===0)return{northEast:[180,90],southWest:[-180,-90]};let u=-180,t=180,e=-90,o=90;return m.forEach(([i,l])=>{u=Math.max(u,i),t=Math.min(t,i),e=Math.max(e,l),o=Math.min(o,l)}),[[u,e],[t,o]]}function Ts(m,u){const{basicStyle:t}=L(m.customAttr);Fi(t)||u.once("loaded",()=>{const e={initZoom:u.scene.getZoom(),center:u.scene.getCenter(),buttonColor:t.zoomButtonColor,buttonBackground:t.zoomBackground};u.scene.addControl(new wo(e))})}function Ko(m,u,t){m.forEach(e=>{e.style[u]=t})}function Te(m){typeof m=="string"&&(m=document.getElementById(m)),m.classList.add("de-map-rendering")}function pe(m){typeof m=="string"&&(m=document.getElementById(m)),m.classList.add("de-map-rendered")}function Fi(m){return m.suspension===!1&&m.showZoom===void 0||m.showZoom===!1}const Ke="g2-tooltip-wrapper";function mt(m){let u=document.getElementById(Ke);u||(u=document.createElement("div"),u.style.position="absolute",u.style.zIndex="9999",u.id=Ke,document.body.appendChild(u));const t=document.getElementById(m);t&&t.remove();const e=document.createElement("div");e.setAttribute("id",m),e.classList.add("g2-tooltip"),e.style.maxHeight="50%",ns()?e.style.maxWidth="50%":e.style.maxWidth="25%",e.style.overflowY="auto",e.style.display="none",e.style.position="fixed",e.style.left="0px",e.style.top="0px";const o=document.createElement("div");o.classList.add("g2-tooltip-title"),e.appendChild(o);const i=document.createElement("ul");i.classList.add("g2-tooltip-list"),e.appendChild(i);const l=document.getElementsByClassName("fullscreen");return l.length?l.item(0).appendChild(e):u.appendChild(e),e}function yt(m,u){const{tooltip:t}=L(m.customAttr);t.show&&(u.options.tooltip.container.addEventListener("mouseenter",e=>{e.target.style.visibility="visible",e.target.style.display="block"}),u.options.tooltip.container.addEventListener("mouseleave",e=>{e.target.style.visibility="hidden",e.target.style.display="none"}),u.on("tooltip:show",()=>{var i,l;const e=u.chart.getController("tooltip");if(!e)return;const o=(l=(i=u.chart.interactions.tooltip)==null?void 0:i.context)==null?void 0:l.event;if(e.tooltip){const n=e.tooltip.cfg.container;if(n.style.display="block",!document.getElementById(n.id)){const s=document.getElementsByClassName("fullscreen");s.length?s.item(0).appendChild(n):document.getElementById(Ke).appendChild(n)}}u.chart.getOptions().tooltip.follow=!1,e.title=Math.random().toString(),u.chart.getTheme().components.tooltip.x=o.clientX,u.chart.getTheme().components.tooltip.y=o.clientY}),u.on("plot:leave",()=>{var i,l;const e=u.chart.getController("tooltip");if(!e)return;u.chart.getOptions().tooltip.follow=!0;const o=(l=(i=e.tooltip)==null?void 0:i.cfg)==null?void 0:l.container;o&&(o.style.display="none"),e.hideTooltip()}),u.on("plot:touchstart",()=>{var o;const e=document.getElementById(Ke);if(e){const i=u.chart.getController("tooltip");if(!i)return;const l=(o=i.tooltip)==null?void 0:o.cfg.container;for(const n of e.children)(!l||l.id!==n.id)&&(n.style.display="none")}}),u.on("tooltip:hidden",()=>{var i;const e=u.chart.getController("tooltip");if(!e)return;const o=(i=e.tooltip)==null?void 0:i.cfg.container;o&&(o.style.display="none")}))}const pt='<li class="g2-tooltip-list-item" data-index={index}><span class="g2-tooltip-marker" style="background:{color}"></span><span class="g2-tooltip-name">{name}</span>:<span class="g2-tooltip-value">{value}</span></li>';function Es(m){const{threshold:u}=L(m.senior),t=[];if(!u.enable||m.type==="area-stack"||m.type==="symbolic-map")return t;const e=u.lineThreshold??[],o=m.yAxis.map(i=>i.id);for(const i of e)if(o.includes(i.fieldId))for(const l of i.conditions){const n={type:"regionFilter",start:["start","median"],end:["end","min"],color:l.color},a={type:"line",start:["start",l.value],end:["end",l.value],style:{stroke:l.color,lineDash:[2,2]}};l.term==="between"?(n.start=["start",parseFloat(l.min)],n.end=["end",parseFloat(l.max)],a.start=["start",parseFloat(l.min)],a.end=["end",parseFloat(l.min)],t.push(JSON.parse(JSON.stringify(a))),a.start=["start",parseFloat(l.max)],a.end=["end",parseFloat(l.max)],t.push(a)):["lt","le"].includes(l.term)?(n.start=["start",l.value],n.end=["end","min"],t.push(a)):["gt","ge"].includes(l.term)&&(n.start=["start",l.value],n.end=["end","max"],t.push(a)),t.push(n)}return t}const Oe={transition:"left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s",backgroundColor:"rgb(255, 255, 255)",boxShadow:"rgb(174, 174, 174) 0px 0px 10px",borderRadius:"3px",padding:"8px 12px",opacity:"0.95",position:"absolute",visibility:"visible"},Fs='<div class="g2-axis-label-tooltip"><div class="g2-tooltip-title">{title}</div></div>';function te(m,u,t){const e=t||"axis-label",o=e==="axis-title",{customStyle:i,customAttr:l}=L(m),{lengthLimit:n,fontSize:a,color:s,show:r}=i.yAxis.axisLabel,{tooltip:d}=l;!o&&(!n||!r||!i.yAxis.show||m.type==="bidirectional-bar")||(u.on(e+":mouseenter",p=>{var R;const c=p.target.cfg.delegateObject.component.cfg.field,f=p.target.cfg.delegateObject.component.cfg.position;if(c!=="field"&&c!=="title"&&!(f==="left"||f==="right"))return;const g=p.target.attrs.text;if(!o&&(g.length<n||g.slice(-3)!=="..."))return;const{x:y,y:x}=p,b=p.event.target.parentNode;let S=b.getElementsByClassName("g2-axis-label-tooltip")[0];const A=((R=p.target.cfg.delegateObject.item)==null?void 0:R.name)||p.target.cfg.delegateObject.axis.cfg.title.originalText;if(S)S.getElementsByClassName("g2-tooltip-title")[0].innerHTML=A,S.style.visibility="visible";else{const _=Mo(Fs,{title:A});S=ve(_),Oe.backgroundColor=d.backgroundColor,Oe.boxShadow=`${d.backgroundColor} 0px 0px 5px`,Oe.maxWidth="200px",Xt.assign(S.style,Oe),b.appendChild(S)}const{height:v,width:C}=b.getBoundingClientRect(),{offsetHeight:T,offsetWidth:k}=S;if(T>v||k>C){S.style.left=S.style.top="0px";return}const O={left:y+10,top:x+15};O.left+k>C&&(O.left=C-k-10),O.top+T>v&&(O.top-=T+15),S.style.left=`${O.left}px`,S.style.top=`${O.top}px`,S.style.color=s,S.style.fontSize=`${a}px`}),u.on(e+":mouseleave",p=>{const c=p.target.cfg.delegateObject.component.cfg.field,f=p.target.cfg.delegateObject.component.cfg.position;if(c!=="field"&&c!=="title"&&!(f==="left"||f==="right"))return;const g=p.target.attrs.text;if(!o&&(g.length<n||g.slice(-3)!=="..."))return;const x=p.event.target.parentNode.getElementsByClassName("g2-axis-label-tooltip")[0];x&&(x.style.visibility="hidden")}))}function zs(m,u){u.on("beforerender",t=>{const{yAxis:e}=L(m.customStyle),o=.8*(t.view.canvas.cfg.height-(t.view.canvas.cfg.height<120?60:30)),i=yl(m,e.name,{fontSize:e.fontSize,fontFamily:m.fontFamily},"height");let l="";for(let n=0;n<e.name.length&&(n+1)*i<=o;n++)l+=e.name[n];e.name.length>l.length&&(l=l.length>2?l.slice(0,l.length-2)+"...":l+"..."),t.view.options.axes.yAxisExt.title.originalText=e.name,t.view.options.axes.yAxisExt.title.text=l})}const ks=(m,u)=>{const{threshold:t}=L(m.senior);return t.enable&&u.data.forEach(e=>{var i;e.conditionColor=[];const o=m.type==="bar-horizontal"?u.xField:u.yField;m.type==="bidirectional-bar"?o.forEach(l=>{var s;const n=l==="value"?m.yAxis:m.yAxisExt,a=vo([(s=n[0])==null?void 0:s.id],e[l],m);a&&(e[e[u.xField]+"-"+l]=a)}):(i=e.quotaList)!=null&&i.length&&(e.quotaList.map(n=>n.id)??[]).forEach((n,a)=>{let s=e[o];m.type==="progress-bar"&&(s=e.originalValue);const r=vo([n],s,m);r?e.conditionColor.push(r):e.conditionColor=void 0})}),u},vo=(m,u,t)=>{var n,a;const{threshold:e}=L(t.senior),{basicStyle:o}=L(t.customAttr),i=Array.isArray(u)?u[1]-u[0]:u;if(!i)return;const l=new Map;for(const s of e.lineThreshold??[])l.set(s.fieldId,s);for(const s of l.values())if(!(t.type==="progress-bar"&&((a=(n=t.yAxisExt)==null?void 0:n[0])==null?void 0:a.id)!==m[0])&&!(!m.includes(s.fieldId)&&t.type!=="waterfall")){for(const r of s.conditions)if(r.term==="between"&&i>=r.min&&i<=r.max||r.term==="lt"&&i<r.value||r.term==="le"&&i<=r.value||r.term==="gt"&&i>r.value||r.term==="ge"&&i>=r.value){let d=qe(r.color,o.alpha);if(o.gradient){let p=["bar-horizontal","progress-bar"].includes(t.type)?0:270;if(t.type==="bidirectional-bar"){const c=t.yAxis.find(f=>f.id===s.fieldId);p=ki(o,c?0:1)}d=rt(d,!0,p)}return d}}};function Os(m,u){const{threshold:t}=L(m.senior);if(!t.enable)return u;const{basicStyle:e}=L(m.customAttr),o="conditionColor",i=u.rawFields||[];i.push(o);const l=s=>{var r;return{...u.columnStyle,...u.barStyle,...(r=s[o])!=null&&r[0]?{fill:s[o][0]}:{}}};let n;return m.type==="bidirectional-bar"?(i.push(u.xField),n=Is(m,e,u)):m.type==="waterfall"&&(n=Ns(e,m)),{...u,rawFields:i,columnStyle:l,barStyle:l,tooltip:{...u.tooltip,...u.tooltip.customItems?{}:{customItems:s=>(s.forEach(r=>{var d;(d=r.data)!=null&&d[o]&&(r.color=r.data[o][0])}),s)}},...n?{color:n}:{}}}const Ns=(m,u)=>{const t=zi(u,m,270);return e=>{if(e.$$isTotal$$)return t[2];const o=e.$$yField$$;return vo([],o,u)??(o[1]>o[0]?t[0]:t[1])}},Is=(m,u,t)=>{const e=zi(m,u,270);return o=>{const i=t.data.find(l=>l[o[t.xField]+"-"+o["series-field-key"]]);return i?i[o[t.xField]+"-"+o["series-field-key"]]:o["series-field-key"]==="value"?e[0]:e[1]}},zi=(m,u,t)=>{var o;const e=[];return(o=u.colors)==null||o.forEach((i,l)=>{m.type==="bidirectional-bar"?e.push(rt(qe(i,u.alpha),!0,ki(u,l))):e.push(rt(qe(i,u.alpha),!0,t))}),u.gradient?e:u.colors},ki=(m,u)=>{let t=180-u*180;return m.layout==="vertical"&&(t=u===0?280:90),t},Ho=m=>{var t;let u=m.color;return(t=m.data)!=null&&t.conditionColor&&(u=m.data.conditionColor[0]),u},Bs=(m,u,t,e)=>{if((()=>{const i=document.getElementById(u+"_empty");i&&i.parentElement.removeChild(i)})(),!(m.length>0)&&!m.length){const i=document.createElement("div");i.id=u+"_empty",i.textContent=e||ds("data_set.no_data"),i.setAttribute("style",`position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        color: darkgray;
        textAlign: center;`);const l=document.getElementById(u);l.insertBefore(i,l.firstChild),t==null||t.destroy()}},Sr=m=>{if(m<=0||m>99||!Number.isInteger(m))throw new Error("请输入1-99之间的整数");const u=["","一","二","三","四","五","六","七","八","九"];if(m<10)return u[m];const t=Math.floor(m/10),e=m%10;return e===0?t===1?"十":u[t]+"十":t===1?"十"+u[e]:u[t]+"十"+u[e]},{t:Tt}=U();var ao=(m=>(m.ANT_V="antv",m.ECHARTS="echarts",m.CUSTOM="custom",m))(ao||{}),Vt=(m=>(m.G2_PLOT="g2plot",m.L7_PLOT="l7plot",m.L7="l7",m.ECHARTS="echarts",m.S2="s2",m.RICH_TEXT="rich-text",m.PICTURE_GROUP="picture-group",m.INDICATOR="indicator",m))(Vt||{});class Rs{constructor(){w(this,"chartInstance")}}class Ee{constructor(u,t,e,o){w(this,"render");w(this,"library");w(this,"name");w(this,"title");w(this,"defaultData");this.render=u,this.library=t,this.name=e,this.defaultData=o}setupDefaultOptions(u){return u}}class ro extends Ee{constructor(t,e,o){super("antv",t,e,o);w(this,"axisConfig",{xAxis:{name:`${Tt("chart.drag_block_type_axis")} / ${Tt("chart.dimension")}`,type:"d",allowEmpty:!0},xAxisExt:{name:`${Tt("chart.chart_group")} / ${Tt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},extStack:{name:`${Tt("chart.stack_item")} / ${Tt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},yAxis:{name:`${Tt("chart.drag_block_value_axis")} / ${Tt("chart.quota")}`,type:"q",limit:1,allowEmpty:!0}});w(this,"selectorSpec",{"misc-style-selector":{title:`${Tt("chart.size")}`},"dual-y-axis-selector":{title:`${Tt("chart.yAxis")}`},"x-axis-selector":{title:`${Tt("chart.xAxis")}`}})}}class st extends ro{configTheme(u,t){const e=fs(u);return{...t,theme:e}}configLabel(u,t){const e=Le(u);return{...t,label:e}}configMultiSeriesTooltip(u,t){const e=ps(u);return{...t,tooltip:e}}configTooltip(u,t){const e=ms(u);return{...t,tooltip:e}}configLegend(u,t){const e=hs(u);return{...t,legend:e}}configXAxis(u,t){const e=wi(u);return{...t,xAxis:e}}configYAxis(u,t){const e=so(u);return{...t,yAxis:e}}configSlider(u,t){const e=gs(u);return{...t,slider:e}}configAnalyse(u,t){const e=_i(u);return{...t,annotations:[...e,...t.annotations||[]]}}configAnalyseHorizontal(u,t){const e=ys(u);return{...t,annotations:e}}configEmptyDataStrategy(u,t){return xl(u,t)}configColor(u,t){const e=bl(u);return{...t,color:e}}configGroupColor(u,t){const e=Sl(u,t);return{...t,color:e}}configStackColor(u,t){const e=Al(u,t);return{...t,color:e}}configSingleDimensionColor(u,t){const e=Cl(u,t);return{...t,color:e}}setupSeriesColor(u,t){return wl(u)}setupSubSeriesColor(u,t){}configConditions(u,t){const e=Es(u);return{...t,annotations:[...e,...t.annotations||[]]}}configBarConditions(u,t){return Os(u,t)}addConditionsStyleColorToData(u,t){return ks(u,t)}configEmptyDataStyle(u,t,e,o){Bs(u,t,e,o)}constructor(u,t){super(Vt.G2_PLOT,u,t)}}const Fe=["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","x-axis-selector","y-axis-selector","title-selector","legend-selector","function-cfg","assist-line","jump-set","linkage","threshold"],Ds=["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","x-axis-selector","y-axis-selector","title-selector","legend-selector","function-cfg","jump-set","linkage","threshold"],Lt={"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","radiusColumnBar","columnWidthRatio"],"label-selector":["fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","tooltipFormatter","show"],"x-axis-selector":["name","color","fontSize","axisLine","splitLine","axisForm","axisLabel","position"],"y-axis-selector":["name","color","fontSize","axisValue","axisLine","splitLine","axisForm","axisLabel","position"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["slider","emptyDataStrategy"],threshold:["lineThreshold"]},ge=["xAxis","yAxis","filter","drill","extLabel","extTooltip"],ze=m=>{var t;const u=document.getElementById(Ot(m));u&&(u.remove(),(t=u.parentNode)==null||t.removeChild(u))},Ms=(m,u=128)=>{const t=Oi(m);return Y(t)?!1:t.r*.299+t.g*.587+t.b*.114>=u},Oi=m=>{const u=/rgba\((\d+),\s*(\d+),\s*(\d+),\s*([\d.]+)\)/g;let t,e=null;for(;(t=u.exec(m))!==null;){const o=parseInt(t[1]),i=parseInt(t[2]),l=parseInt(t[3]),n=parseFloat(t[4]);e={r:o,g:i,b:l,a:n}}return e};function ti(m,u,t,e){var i;if(!u&&u!=0)return;const o=document.getElementById(Ot(e));if(o){const l=document.getElementById(m);l&&(l.remove(),(i=l.parentNode)==null||i.removeChild(l));const n=document.createElement("div");n.id=m,n.className="child",n.setAttribute("style",`width: auto;
        height: auto;
        border-radius: 2px;
        position: relative;
        padding: 4px 5px 4px 5px;
        display:none;
        transform: translateX(-50%);
        opacity: 1;
        transition: opacity 0.2s ease-in-out;
        white-space:nowrap;
        overflow:auto;`),n.textContent=D(u,t);const a=document.createElement("span");a.setAttribute("style",`width: 0px;
        height: 0px;
        border: 4px solid transparent;
        border-top-color: red;
        position: absolute;
        left: calc(50% - 4px);
        margin-top:4px;`),n.appendChild(a),o.appendChild(n)}}const Ni=m=>["area","bar"].includes(m.type),$s=m=>["line","area","bar","bar-group"].includes(m.type),Ve=m=>m.container+"_",Ot=m=>m.container+"_point_"+m.id+"_";function Ps(m,u){const t=document.getElementById(m);if(!t){console.error("Parent div not found");return}const e=t.getElementsByTagName("div");for(let o=e.length-1;o>=0;o--){const i=e[o];i.id&&i.id.startsWith(u)&&i.parentNode.removeChild(i)}}const Wo=(m,u,t,e)=>{if(u.container=e,ze(u),!$s(u))return;const{label:o}=L(u.customAttr),{yAxis:i}=L(u);m.once("beforerender",l=>{l.view.on("beforepaint",()=>{var n;(n=m.chart.geometries[0])==null||n.beforeMappingData.forEach(a=>{var p;a.forEach(c=>{delete c._origin.EXTREME});const{minItem:s,maxItem:r}=Hs(a.filter(c=>{var f,h;return((f=c==null?void 0:c._origin)==null?void 0:f.value)!==null&&((h=c==null?void 0:c._origin)==null?void 0:h.value)!==void 0}));if(!s||!r)return;let d=!1;if(Ni(u)||i.length>1){const c=o.seriesLabelFormatter.find(f=>(f.chartShowName?f.chartShowName:f.name===s._origin.category)||(f.chartShowName?f.chartShowName:f.name===r._origin.category));d=c==null?void 0:c.showExtremum}else["bar-group"].includes(u.type)?d=o.showExtremum:d=(p=o.seriesLabelFormatter[0])==null?void 0:p.showExtremum;d&&(s._origin.EXTREME=!0,r._origin.EXTREME=!0)})}),m.chart.geometries[0].on("afteranimate",()=>{Ws(u,l)})}),m.on("legend-item:click",l=>{const n=l.view.getController("legend").components[0].component.cfg.items.filter(a=>a.unchecked);n.length>0&&n.forEach(a=>{const s=Ve(u)+Ot(u)+a.id;Ps(Ot(u),s)})})},Hs=m=>m.reduce(({minItem:u,maxItem:t},e)=>((u===void 0||e._origin.value<u._origin.value)&&(u=e),(t===void 0||e._origin.value>t._origin.value)&&(t=e),u==null||delete u._origin.EXTREME,t==null||delete t._origin.EXTREME,{minItem:u,maxItem:t}),{minItem:void 0,maxItem:void 0}),Ws=(m,u)=>{const{label:t,basicStyle:e}=L(m.customAttr),o=e.lineSymbolSize,{yAxis:i}=L(m);if(ze(m),!document.getElementById(Ot(m))){const r=document.createElement("div");r.id=Ot(m),r.style.position="fixed",r.style.zIndex="1",r.style.opacity="0",r.style.transition="opacity 0.2s ease-in-out",r.style.overflow="visible";const d=document.getElementById(m.container);d.insertBefore(r,d.firstChild);let p=0;const c=()=>{if(p+=.19,p>=1){cancelAnimationFrame(f);return}r.style.opacity=p+"",f=requestAnimationFrame(c)};let f=requestAnimationFrame(c)}let n=[];const a=u.view.getGeometries().find(r=>r.type==="interval");a&&(n=a.dataArray);const s=u.view.getGeometries().find(r=>r.type==="point");s&&(n=s.dataArray),Vs(n,r=>{var d;if(r&&r.length>0){const p=r[0],[c,f]=r.filter(S=>S._origin.EXTREME);let h,g=!1;if(Ni(m)||i.length>1){const S=t.seriesLabelFormatter.find(A=>A.chartShowName?A.chartShowName===p._origin.category:A.name===p._origin.category);g=S==null?void 0:S.showExtremum,h=S}else["bar-group"].includes(m.type)?g=t.showExtremum:(g=(d=t.seriesLabelFormatter[0])==null?void 0:d.showExtremum,h=t.seriesLabelFormatter[0]);const y=h?h.fontSize:t.fontSize;if(!c)return;const x=Ve(m)+Ot(m)+p._origin.category+"_"+(f?f._origin.value:c._origin.value),b=Ve(m)+Ot(m)+p._origin.category+"_"+c._origin.value;g&&t.show?(f&&ti(x,f._origin.value,h?h.formatterCfg:t.labelFormatter,m),ti(b,c._origin.value,h?h.formatterCfg:t.labelFormatter,m),r.forEach(S=>{const A=document.getElementById(Ve(m)+Ot(m)+S._origin.category+"_"+S._origin.value);if(A&&S._origin.EXTREME){A.style.position="absolute";const v=(S.y[1]?S.y[1]:S.y)-(y+(o||0)+12);A.style.top=v+"px",A.style.left=S.x+"px",A.style.zIndex="10",A.style.fontSize=y+"px",A.style.lineHeight=y+"px";const C=S.color.startsWith("#")?qe(S.color,e.alpha/100):Oi(S.color),{r:T,b:k,g:O,a:R}=C;A.style.backgroundColor="rgba("+T+","+O+","+k+","+R+")",A.style.color=Ms(S.color)?"#000":"#fff",A.children[0].style.borderTopColor="rgba("+T+","+O+","+k+","+R+")",A.style.display="table";const _=A.childNodes[1],B=Math.ceil(S.y+Math.abs(Math.floor(v))+6);v<0&&Math.abs(v)/S.y*100>=50?(A.style.transform=`translateX(-50%) translateY(${B}px)`,_.style.marginTop="-12px",_.style.transform="rotate(180deg)"):_.style.display="block"}})):(ei(x),ei(b))}})};function ei(m){var t;const u=document.getElementById(m);u&&(u.remove(),(t=u.parentNode)==null||t.removeChild(u))}function Vs(m,u){if(typeof m=="number"&&(m={length:m}),m.length===0)return;let t=0;function e(){t>=m.length||requestIdleCallback(o=>{for(;o.timeRemaining()>0&&t<m.length;)u(m[t],t),t++;e()})}e()}const{t:ce}=U(),Ys=[];class Ii extends st{constructor(t="bar",e=Ys){super(t,e);w(this,"properties",Fe);w(this,"propertyInner",{...Lt,"basic-style-selector":[...Lt["basic-style-selector"],"seriesColor"],"label-selector":["vPosition","seriesLabelFormatter","showExtremum"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"y-axis-selector":[...Lt["y-axis-selector"],"axisLabelFormatter"]});w(this,"baseOptions",{xField:"field",yField:"value",seriesField:"category",isGroup:!0,data:[]});w(this,"axis",[...ge]);w(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${ce("chart.drag_block_type_axis")} / ${ce("chart.dimension")}`,type:"d"},yAxis:{name:`${ce("chart.drag_block_value_axis")} / ${ce("chart.quota")}`,type:"q"}})}async drawChart(t){var d,p,c;const{chart:e,container:o,action:i}=t;if(!((p=(d=e==null?void 0:e.data)==null?void 0:d.data)!=null&&p.length)){e.container=o,ze(e);return}const l=Z((c=t.chart.data)==null?void 0:c.data),n={...this.baseOptions,appendPadding:ft(e),data:l},a=this.setupOptions(e,n);let s=null;const{Column:r}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(f=>f.$),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url);return s=new r(o,a),s.on("interval:click",i),Wo(s,e,a,o),yt(e,s),s}configLabel(t,e){var a;const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const{label:i}=L(t.customAttr),l=(a=i.seriesLabelFormatter)==null?void 0:a.reduce((s,r)=>(s[r.id]=r,s),{});o.label.style.fill=Qt.color;const n={fields:[],...o.label,formatter:(s,r)=>{var f;if(s.EXTREME)return"";if(!((f=i.seriesLabelFormatter)!=null&&f.length))return s.value;const d=l==null?void 0:l[s.quotaList[0].id];if(!d)return s.value;if(!d.show)return;const p=D(s.value,d.formatterCfg),c=new Kt({});return c.addShape({type:"text",attrs:{x:0,y:0,text:p,textAlign:"start",textBaseline:"top",fontSize:d.fontSize,fontFamily:t.fontFamily,fill:d.color}}),c},position:s=>{var r,d,p;if(s.value<0){if(((r=o.label)==null?void 0:r.position)==="top")return"bottom";if(((d=o.label)==null?void 0:d.position)==="bottom")return"top"}return(p=o.label)==null?void 0:p.position}};return{...o,label:n}}configTooltip(t,e){return super.configMultiSeriesTooltip(t,e)}configBasicStyle(t,e){const o=L(t.customAttr).basicStyle;if(o.gradient){let n=o.colors;n=n.map(a=>{const s=P(a,o.alpha);return rt(s,!0,270)}),e={...e,color:n}}if(o.radiusColumnBar==="roundAngle"){const n={radius:[o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius]};e={...e,columnStyle:n}}let i;const l=o.columnWidthRatio??ct.columnWidthRatio;return l>=1&&l<=100?i=l/100:l<1?i=1/100:l>100&&(i=1),i&&(e.columnWidthRatio=i),e}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const i=L(t.customStyle).yAxis,l=i.axisValue;if(o.yAxis.label&&(o.yAxis.label.formatter=n=>D(n,i.axisLabelFormatter)),!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}},{data:a}=e,s=a.filter(r=>r.value>=l.min);return{...o,data:s,...n}}return o}setupOptions(t,e){return Q(this.addConditionsStyleColorToData,this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configBarConditions)(t,e,{},this)}setupDefaultOptions(t){return t.senior.functionCfg.emptyDataStrategy="ignoreData",t}}class Vo extends Ii{constructor(t="bar-stack"){super(t);w(this,"properties",Fe.filter(t=>t!=="threshold"));w(this,"propertyInner",{...this.propertyInner,"label-selector":[...Lt["label-selector"],"vPosition","showTotal","totalColor","totalFontSize","totalFormatter","showStackQuota"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show"]});this.baseOptions={...this.baseOptions,isStack:!0,isGroup:!1,meta:{category:{type:"cat"}}},this.axis=[...this.axis,"extStack"]}configLabel(t,e){let o=Le(t);if(!o)return e;e={...e,label:o};const{label:i}=L(t.customAttr);if(i.showStackQuota||i.showStackQuota===void 0?(o.style.fill=i.color,o={...o,formatter:function(l){return D(l.value,i.labelFormatter)}}):o=!1,i.showTotal){const l=i.labelFormatter??eo;Ol(Nl(e.data,"field"),(n,a)=>{const s=n.reduce((d,p)=>d+p.value,0),r=D(s,l);e.annotations||(e={...e,annotations:[]}),e.annotations.push({type:"text",position:[a,s],content:`${r}`,style:{textAlign:"center",fontSize:i.fontSize,fill:i.color},offsetY:-(parseInt(i.fontSize)/2)})})}return{...e,label:o}}configTooltip(t,e){const o=L(t.customAttr).tooltip;if(!o.show)return{...e,tooltip:!1};const i={formatter:l=>{const a={name:Y(l.category)?l.field:l.category,value:l.value},s=D(l.value,o.tooltipFormatter);return a.value=s??"",a},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:i}}configColor(t,e){return this.configStackColor(t,e)}configData(t,e){const{xAxis:o,extStack:i,yAxis:l}=t,n=o.some(c=>c.sort!=="none"),a=i.some(c=>c.sort!=="none");if(n||a||!((l==null?void 0:l[0].sort)!=="none")||!i.length||!l.length)return e;const{data:r}=e,d=r.reduce((c,f)=>(c[f.field]=c[f.field]?c[f.field]+f.value:f.value||0,c),{}),p=l[0].sort;return r.sort((c,f)=>p==="asc"?d[c.field]-d[f.field]:d[f.field]-d[c.field]),e}setupSeriesColor(t,e){return Bo(t,e)}setupOptions(t,e){return Q(this.configTheme,this.configEmptyDataStrategy,this.configData,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse)(t,e,{},this)}}class qs extends Vo{constructor(t="bar-group"){super(t);w(this,"properties",Fe);w(this,"propertyInner",{...this.propertyInner,"label-selector":[...Lt["label-selector"],"vPosition","showExtremum"]});w(this,"axisConfig",{...this.axisConfig,yAxis:{name:`${ce("chart.drag_block_value_axis")} / ${ce("chart.quota")}`,type:"q",limit:1}});this.baseOptions={...this.baseOptions,isGroup:!0,isStack:!1,meta:{category:{type:"cat"}}},this.axis=[...ge,"xAxisExt"]}configLabel(t,e){const o=Le(t);if(!o)return e;const i={...e,label:o},{label:l}=L(t.customAttr);i.label.style.fill=l.color;const n={...i.label,formatter:function(a,s){if(a.EXTREME)return"";const r=D(a.value,l.labelFormatter);return l.childrenShow?r:null}};return{...i,label:n}}configColor(t,e){return this.configGroupColor(t,e)}setupSeriesColor(t,e){return ci(t,e)}setupOptions(t,e){return Q(this.addConditionsStyleColorToData,this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configBarConditions)(t,e,{},this)}}class Bi extends Vo{constructor(t="bar-group-stack"){super(t);w(this,"propertyInner",{...this.propertyInner,"label-selector":[...Lt["label-selector"],"vPosition"]});this.baseOptions={...this.baseOptions,isGroup:!0,groupField:"group"},this.axis=[...this.axis,"xAxisExt","extStack"]}configTheme(t,e){const l={...super.configTheme(t,e).theme,innerLabels:{offset:0}};return{...e,theme:l}}configLabel(t,e){const o=Le(t);if(!o)return e;const i={...e,label:o},{label:l}=L(t.customAttr);i.label.style.fill=l.color;const n={...i.label,formatter:function(a){return D(a.value,l.labelFormatter)}};return{...i,label:n}}configTooltip(t,e){const o=L(t.customAttr).tooltip;if(!o.show)return{...e,tooltip:!1};const i={fields:[],formatter:l=>{const n={name:`${l.category} - ${l.group}`,value:l.value};return n.value=D(l.value,o.tooltipFormatter),n},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:i}}setupOptions(t,e){return Q(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse)(t,e,{},this)}}class js extends Bi{constructor(){super("percentage-bar-stack");w(this,"propertyInner",{...this.propertyInner,"label-selector":["color","fontSize","vPosition","reserveDecimalCount"],"tooltip-selector":["color","fontSize","backgroundColor","show"]});this.baseOptions={...this.baseOptions,isStack:!0,isPercent:!0,isGroup:!1,groupField:void 0,meta:{category:{type:"cat"}}},this.axis=[...ge,"extStack"]}configLabel(t,e){const o=super.configLabel(t,e);if(!o.label)return o;const{customAttr:i}=t,l=L(i).label,n={...o.label,formatter:function(a){return a.value?(Math.round(a.value*1e4)/100).toFixed(l.reserveDecimalCount)+"%":"0%"}};return{...o,label:n}}configTooltip(t,e){if(!L(t.customAttr).tooltip.show)return{...e,tooltip:{showContent:!1}};const{customAttr:i}=t,l=L(i).label,n={formatter:a=>{const s={name:a.category,value:a.value};return s.value=(Math.round(a.value*1e4)/100).toFixed(l.reserveDecimalCount)+"%",s},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:n}}setupOptions(t,e){return Q(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse)(t,e,{},this)}}const Us=Object.freeze(Object.defineProperty({__proto__:null,Bar:Ii,GroupBar:qs,GroupStackBar:Bi,PercentageStackBar:js,StackBar:Vo},Symbol.toStringTag,{value:"Module"})),{t:Rt}=U();class Js extends st{constructor(){super("bidirectional-bar",[]);w(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${Rt("chart.drag_block_type_axis")} / ${Rt("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Rt("chart.drag_block_value_axis")} / ${Rt("chart.quota")}`,type:"q",limit:1},yAxisExt:{name:`${Rt("chart.drag_block_value_axis_ext")} / ${Rt("chart.quota")}`,type:"q",limit:1}});w(this,"axis",["xAxis","yAxis","yAxisExt","filter","drill","extLabel","extTooltip"]);w(this,"properties",["background-overall-component","border-style","basic-style-selector","x-axis-selector","dual-y-axis-selector","title-selector","legend-selector","label-selector","tooltip-selector","function-cfg","jump-set","linkage","threshold"]);w(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","layout","radiusColumnBar"],"x-axis-selector":["position","axisLabel","axisLine","splitLine"],"dual-y-axis-selector":["name","position","color","fontSize","axisLabel","axisLine","splitLine","axisValue","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["emptyDataStrategy"],"label-selector":["hPosition","vPosition","seriesLabelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],threshold:["lineThreshold"]});w(this,"selectorSpec",{...this.selectorSpec,"dual-y-axis-selector":{title:`${Rt("chart.xAxis")}`},"x-axis-selector":{title:`${Rt("chart.yAxis")}`}})}async drawChart(t){var h,g,y,x;const{chart:e,container:o,action:i}=t;if(!((g=(h=e.data)==null?void 0:h.data)!=null&&g.length))return;const l=Z(e.data.data),n=_t((y=l[0])==null?void 0:y.data,[]),a=Do(_t((x=l[1])==null?void 0:x.data,[]),b=>{var S;return{...b,category:b.field,value:(S=n.find(A=>A.field===b.field))==null?void 0:S.value,valueExt:b.value}}),s={xField:"field",data:a,xAxis:{label:{style:{}},position:"bottom"},yField:["value","valueExt"],appendPadding:ft(e),meta:{field:{type:"cat"}}},d={...this.setupOptions(e,s)},p=e.xAxis;if((p==null?void 0:p.length)===1&&p[0].deType===1){const b=a.map(S=>S.field);d.meta={field:{type:"cat",values:b.reverse()}}}const{BidirectionalBar:c}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(b=>b.a6),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),f=new c(o,d);return f.on("interval:click",i),f.on("element:click",b=>{const S=f.options.data.filter(A=>A.field===b.data.data.field&&A[b.data.data["series-field-key"]]===b.data.data[b.data.data["series-field-key"]]);b.data.data={...b.data.data,...S[0]}}),yt(e,f),te(e,f),f}configBasicStyle(t,e){var i;const o=L(t.customAttr).basicStyle;if(o.gradient){const l=(i=o.colors)==null?void 0:i.map((n,a)=>{const s=P(n,o.alpha);let r=180-a*180;return o.layout==="vertical"&&(a===0&&(r=280),a===1&&(r=90)),rt(s,!0,r)});e={...e,color:l}}if(e={...e,layout:o.layout},o.radiusColumnBar==="roundAngle"){const l={radius:[o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius]};e={...e,barStyle:l}}return e}configXAxis(t,e){const o=super.configXAxis(t,e);return o.xAxis&&o.xAxis.label&&delete o.xAxis.label.style.textAlign,o}configTooltip(t,e){var p;const i=L(t.customAttr).tooltip;if(!i.show)return{...e,tooltip:!1};const l=Z(t.yAxis),n=Z(t.yAxisExt),a=(p=i.seriesTooltipFormatter)==null?void 0:p.filter(c=>c.show).reduce((c,f)=>(c[f.seriesId]=f,c),{}),s=Z(e.data),r=c=>{const f=c.data;let h=l[0],g="yAxis";return f["series-field-key"]==="valueExt"&&(h=n[0],g="yAxisExt"),{id:h.id,name:h.name,axisType:g,value:f[f["series-field-key"]]}},d={shared:!0,showTitle:!0,customItems(c){var g,y;if(!((g=i.seriesTooltipFormatter)!=null&&g.length))return c;const f=[];c.filter(x=>{const b=r(x);return a[b.id+"-"+b.axisType]}).forEach(x=>{const b=r(x),S=a[b.id+"-"+b.axisType],A=D(parseFloat(x.value),S.formatterCfg),v=Y(S.chartShowName)?S.name:S.chartShowName,C=Ho(x);f.push({...x,name:v,value:A,color:C})});const h=(y=s.find(x=>x.field===c[0].title))==null?void 0:y.dynamicTooltipValue;return h.length>0&&h.forEach(x=>{const b=i.seriesTooltipFormatter.filter(S=>S.id===x.fieldId);if(b&&b.length>0){const S=D(parseFloat(x.value),b[0].formatterCfg),A=Y(b[0].chartShowName)?b[0].name:b[0].chartShowName;f.push({color:"grey",name:A,value:S})}}),f},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:d}}configLegend(t,e){const o=super.configLegend(t,e);return o.legend&&(o.legend.itemName.formatter=(i,l,n)=>{const a=t.yAxis[0],s=t.yAxisExt[0];return n===0?a.chartShowName?a.chartShowName:a.name:s.chartShowName?s.chartShowName:s.name}),o}configYAxis(t,e){const o=so(t);let i=vi(t);const l={...e};o?l.yAxis={value:void 0,valueExt:void 0}:(i=!1,l.yAxis={value:!1,valueExt:!1});const n=e.layout==="horizontal";o&&o.title&&n&&(o.title.autoRotate=!1);const a=L(t.customStyle).yAxis;o.label&&(o.label.formatter=p=>D(p,a.axisLabelFormatter));const s=a.axisValue;s!=null&&s.auto?l.yAxis.value=o:l.yAxis.value={...o,min:s.min,max:s.max,minLimit:s.min,maxLimit:s.max,tickCount:s.splitCount};const r=L(t.customStyle).yAxisExt;i.label&&(i.label.formatter=p=>D(p,r.axisLabelFormatter));const d=r.axisValue;return d!=null&&d.auto?l.yAxis.valueExt=i:l.yAxis.valueExt={...i,min:d.min,max:d.max,minLimit:d.min,maxLimit:d.max,tickCount:d.splitCount},l}setupDefaultOptions(t){return t.customStyle.yAxis={...t.customStyle.yAxis,position:"left"},t.customStyle.yAxisExt={...t.customStyle.yAxisExt,position:"left",splitLine:t.customStyle.yAxis.splitLine},t.customAttr.label={...t.customAttr.label,position:"right"},t.customAttr.basicStyle.layout="horizontal",t}configLabel(t,e){var d;let o;const i=t.yAxis,l=t.yAxisExt,n=L(t.customAttr).label,a=(d=n.seriesLabelFormatter)==null?void 0:d.reduce((p,c)=>(p[c.id]=c,p),{});let s;const r=e.layout==="horizontal";if(t.customAttr&&(s=L(t.customAttr),s.label)){const p=s.label;if(p.show){const c=[];if(!n.fullDisplay){const f=super.configLabel(t,e);c.push(...f.label.layout)}o={position:p.position,layout:c,style:{fill:p.color,fontSize:p.fontSize,fontFamily:t.fontFamily},formatter:f=>{let h=i[0],g=f.value;f["series-field-key"]==="valueExt"&&(h=l[0]);const y=f[f["series-field-key"]],x=a==null?void 0:a[h.id];if(h.formatterCfg&&(g=D(y,h.formatterCfg)),!x)return g;if(!x.show)return;x?g=D(y,x.formatterCfg):g=D(y,p.labelFormatter);const b=new Kt({}),S=f["series-field-key"]==="value",A=S&&r?"end":"start",v=o.position==="middle";return b.addShape({type:"text",attrs:{x:S&&r&&!v?-6:!S&&r&&!v?6:0,y:S&&!r&&!v?-8:!S&&!r&&!v?8:0,text:g,textAlign:o.position==="middle"?"start":A,textBaseline:"top",fontSize:x.fontSize,fontFamily:t.fontFamily,fill:x.color}}),b}}}else o=!1}return r||(o.position==="left"&&(o.position="bottom"),o.position==="right"&&(o.position="top")),{...e,label:o}}configEmptyDataStrategy(t,e){const{data:o}=e;if(!(o!=null&&o.length))return e;const i=L(t.senior).functionCfg.emptyDataStrategy;if(i==="ignoreData"){const n=o.filter(a=>a.value===null||a.valueExt===null).map(a=>a.field);return{...e,data:o.filter(a=>!n.includes(a.field))}}return(i==="breakLine"||i==="setZero")&&((n,a)=>{a.forEach(s=>{s.value===null&&(s.value=n==="breakLine"?null:0),s.valueExt===null&&(s.valueExt=n==="breakLine"?null:0)})})(i,o),e}setupOptions(t,e){return Q(this.addConditionsStyleColorToData,this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configAnalyse,this.configSlider,this.configEmptyDataStrategy,this.configBarConditions)(t,e)}}const Xs=Object.freeze(Object.defineProperty({__proto__:null,BidirectionalHorizontalBar:Js},Symbol.toStringTag,{value:"Module"})),{t:ue}=U(),Gs=[];class Ri extends st{constructor(t="bar-horizontal"){super(t,Gs);w(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${ue("chart.drag_block_type_axis")} / ${ue("chart.dimension")}`,type:"d"},yAxis:{name:`${ue("chart.drag_block_value_axis")} / ${ue("chart.quota")}`,type:"q"}});w(this,"properties",Fe);w(this,"propertyInner",{...Lt,"basic-style-selector":[...Lt["basic-style-selector"],"seriesColor"],"label-selector":["hPosition","seriesLabelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"x-axis-selector":[...Lt["x-axis-selector"],"axisLabelFormatter","axisValue"],"y-axis-selector":["name","color","fontSize","axisLine","splitLine","axisForm","axisLabel","position","showLengthLimit"]});w(this,"axis",[...ge]);w(this,"baseOptions",{data:[],xField:"value",yField:"field",seriesField:"category",isGroup:!0})}async drawChart(t){var d,p;const{chart:e,container:o,action:i}=t;if(!((p=(d=e.data)==null?void 0:d.data)!=null&&p.length))return;const l=Z(e.data.data),n={...this.baseOptions,appendPadding:ft(e),data:l},a=this.setupOptions(e,n),{Bar:s}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(c=>c._),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("interval:click",i),yt(e,r),te(e,r),r}configXAxis(t,e){const o=super.configXAxis(t,e);if(!o.xAxis)return o;const i=L(t.customStyle).xAxis,l=i.axisValue;if(o.xAxis.label&&(o.xAxis.label.formatter=n=>D(n,i.axisLabelFormatter)),o.xAxis.position==="top"&&(o.xAxis.position="left"),o.xAxis.position==="bottom"&&(o.xAxis.position="right"),!(l!=null&&l.auto)){const n={xAxis:{...o.xAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}},{data:a}=e,s=a.filter(r=>r.value>=l.min);return{...o,data:s,...n}}return o}configTooltip(t,e){return super.configMultiSeriesTooltip(t,e)}configBasicStyle(t,e){const o=L(t.customAttr).basicStyle;if(o.gradient){let n=o.colors;n=n.map(a=>{const s=P(a,o.alpha);return rt(s,!0)}),e={...e,color:n}}if(o.radiusColumnBar==="roundAngle"){const n={radius:[o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius]};e={...e,barStyle:n}}let i;const l=o.columnWidthRatio??ct.columnWidthRatio;return l>=1&&l<=100?i=l/100:l<1?i=1/100:l>100&&(i=1),i&&(e.barWidthRatio=i),e}setupDefaultOptions(t){const{customAttr:e,senior:o}=t,{label:i}=e;return["left","middle","right"].includes(i.position)||(i.position="middle"),o.functionCfg.emptyDataStrategy="ignoreData",t}configLabel(t,e){var a;const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const i=L(t.customAttr).label,l=(a=i.seriesLabelFormatter)==null?void 0:a.reduce((s,r)=>(s[r.id]=r,s),{});o.label.style.fill=Qt.color;const n={fields:[],...o.label,formatter:s=>{var c;if(!((c=i.seriesLabelFormatter)!=null&&c.length))return s.value;const r=l==null?void 0:l[s.quotaList[0].id];if(!r)return s.value;if(!r.show)return;const d=D(s.value,r.formatterCfg),p=new Kt({});return p.addShape({type:"text",attrs:{x:0,y:0,text:d,textAlign:"start",textBaseline:"top",fontSize:r.fontSize,fontFamily:t.fontFamily,fill:r.color}}),p}};return{...o,label:n}}configYAxis(t,e){const o=super.configYAxis(t,e);return o.yAxis&&(o.yAxis.position==="left"&&(o.yAxis.position="bottom"),o.yAxis.position==="right"&&(o.yAxis.position="top")),o}setupOptions(t,e){return Q(this.addConditionsStyleColorToData,this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyseHorizontal,this.configBarConditions)(t,e,{},this)}}class Di extends Ri{constructor(t="bar-stack-horizontal"){super(t);w(this,"properties",Fe.filter(t=>t!=="threshold"));w(this,"axisConfig",{...this.axisConfig,extStack:{name:`${ue("chart.stack_item")} / ${ue("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}});w(this,"propertyInner",{...this.propertyInner,"label-selector":["color","fontSize","hPosition","labelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show"]});this.baseOptions={...this.baseOptions,isGroup:!1,isStack:!0,meta:{category:{type:"cat"}}},this.axis=[...this.axis,"extStack"]}configLabel(t,e){const o=super.configLabel(t,e);if(!o.label)return o;const{label:i}=L(t.customAttr);o.label.style.fill=i.color;const l={...o.label,formatter:function(n){return D(n.value,i.labelFormatter)}};return{...o,label:l}}configTooltip(t,e){const o=L(t.customAttr).tooltip;if(!o.show)return{...e,tooltip:!1};const i={formatter:l=>{const n={name:l.category,value:l.value},a=D(l.value,o.tooltipFormatter);return n.value=a??"",n},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:i}}configColor(t,e){return this.configStackColor(t,e)}setupSeriesColor(t,e){return Bo(t,e)}configData(t,e){var c;const{xAxis:o,extStack:i,yAxis:l}=t,n=o.some(f=>f.sort!=="none"),a=i.some(f=>f.sort!=="none");if(n||a||!(((c=l==null?void 0:l[0])==null?void 0:c.sort)!=="none")||!i.length||!l.length)return e;const{data:r}=e,d=r.reduce((f,h)=>(f[h.field]=f[h.field]?f[h.field]+h.value:h.value||0,f),{}),p=l[0].sort;return r.sort((f,h)=>p==="asc"?d[f.field]-d[h.field]:d[h.field]-d[f.field]),e}setupOptions(t,e){return Q(this.configTheme,this.configEmptyDataStrategy,this.configData,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyseHorizontal)(t,e,{},this)}}class Zs extends Di{constructor(){super("percentage-bar-stack-horizontal");w(this,"propertyInner",{...this.propertyInner,"label-selector":["color","fontSize","hPosition","reserveDecimalCount"],"tooltip-selector":["color","fontSize","backgroundColor","show"]});this.baseOptions={...this.baseOptions,isPercent:!0}}configLabel(t,e){const o=super.configLabel(t,e);if(!o.label)return o;const{customAttr:i}=t,l=L(i).label,n={...o.label,formatter:function(a){return a.value?(Math.round(a.value*1e4)/100).toFixed(l.reserveDecimalCount)+"%":"0%"}};return{...o,label:n}}configTooltip(t,e){if(!L(t.customAttr).tooltip.show)return{...e,tooltip:{showContent:!1}};const{customAttr:i}=t,l=L(i).label,n={formatter:a=>{const s={name:a.category,value:a.value};return s.value=(Math.round(a.value*1e4)/100).toFixed(l.reserveDecimalCount)+"%",s},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:n}}setupOptions(t,e){return Q(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyseHorizontal)(t,e,{},this)}}const Qs=Object.freeze(Object.defineProperty({__proto__:null,HorizontalBar:Ri,HorizontalPercentageStackBar:Zs,HorizontalStackBar:Di},Symbol.toStringTag,{value:"Module"})),{t:ee}=U();class Ks extends st{constructor(){super("progress-bar",[]);w(this,"axisConfig",{xAxis:{name:`${ee("chart.form_type")} / ${ee("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${ee("chart.progress_target")} / ${ee("chart.quota")}`,type:"q",limit:1},yAxisExt:{name:`${ee("chart.progress_current")} / ${ee("chart.quota")}`,type:"q",limit:1}});w(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","y-axis-selector","title-selector","function-cfg","jump-set","linkage","threshold"]);w(this,"propertyInner",{...Lt,"legend-selector":null,"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","radiusColumnBar","columnWidthRatio"],"label-selector":["hPosition","color","fontSize","showQuota","showProportion"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show"],"y-axis-selector":["name","color","fontSize","axisForm","axisLabel","showLengthLimit"],"function-cfg":["emptyDataStrategy"],threshold:["lineThreshold"]});w(this,"axis",[...ge,"yAxisExt"]);w(this,"baseOptions",{data:[],xField:"progress",yField:"title",seriesField:"type",isGroup:!1,isPercent:!0,isStack:!0,xAxis:!1,appendPadding:[0,0,10,0]})}async drawChart(t){var g,y,x,b;const{chart:e,container:o,action:i}=t;if(!((y=(g=e.data)==null?void 0:g.data)!=null&&y.length))return;const l=(S,A)=>{if(S===0)return 100;if(S>0&&A<0)return 0;if(S<0&&A>0||S<0&&A===0)return(2-A/S)*100;if(S>0&&A>0)return A/S*100;if(S<0&&A<0){const v=(2-A/S)*100;return Number(Math.max(v,0).toFixed(2))}return 0},n=Z(e.data.data),a=_t((x=n[0])==null?void 0:x.data,[]),r=_t((b=n[1])==null?void 0:b.data,[]).map(S=>{var v;const A=l((v=a.find(C=>C.field===S.field))==null?void 0:v.value,S.value);return{...S,type:"current",title:S.field,id:S.quotaList[0].id,originalValue:S.value,originalProgress:A,progress:A>=100?100:A}}),d=a.map(S=>{var v;const A=100-((v=r.find(C=>C.title===S.field))==null?void 0:v.progress);return{...S,type:"target",title:S.field,id:S.quotaList[0].id,originalValue:S.value,progress:A}}),p={...this.baseOptions,data:r.concat(d).flat()},c=this.setupOptions(e,p),{Bar:f}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(S=>S._),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),h=new f(o,c);return h.on("interval:click",i),yt(e,h),te(e,h),h}configBasicStyle(t,e){var a;const o=L(t.customAttr).basicStyle;let i=(a=o.colors)==null?void 0:a.map((s,r)=>r===1?P(s,o.alpha>10?10:o.alpha):P(s,o.alpha));if(o.gradient&&(i=i.map((s,r)=>rt(s,!0,0))),e={...e,color:s=>s.type==="target"?"rgba(0, 0, 0, 0)":i[0],barBackground:{style:{fill:i[1]}}},o.radiusColumnBar==="roundAngle"){const s={radius:[o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius,o.columnBarRightAngleRadius]};e={...e,barStyle:s}}let l;const n=o.columnWidthRatio??ct.columnWidthRatio;return n>=1&&n<=100?l=n/100:n<1?l=1/100:n>100&&(l=1),l&&(e.barWidthRatio=l),e}configTooltip(t,e){const o=L(t.customAttr).tooltip;if(!o.show)return{...e,tooltip:{showContent:!1}};const i=Z(t.yAxis)[0],l=Z(t.yAxisExt)[0];return{...e,tooltip:{showContent:!0,domStyles:{"g2-tooltip-marker":null},customItems(n){const a=[];return n.forEach(s=>{if(s.data){const r=D(s.data.value,o.tooltipFormatter);s.data.id===i.id&&a.push({...s,marker:!1,name:i.chartShowName?i.chartShowName:i.name,value:r}),s.data.id===l.id&&a.push({...s,marker:!1,name:l.chartShowName?l.chartShowName:l.name,value:r})}}),a.length==0?n:a},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0}}}configLabel(t,e){var n;const o=super.configLabel(t,e);if(!o.label)return o;(n=o.label.layout)!=null&&n[0]||(o.label.layout=[{type:"limit-in-canvas"}]);const{label:i}=L(t.customAttr);o.label.style.fill=i.color;const l={...o.label,content:a=>{if(a.type==="target")return"";let s="";if(i.showQuota&&(s+=D(a.value,i.quotaLabelFormatter)),i.showProportion){let r=a.originalProgress.toFixed(i.reserveDecimalCount)+"%";i.showQuota&&(r=` (${r}) `),s+=r}return s}};return l.position==="top"&&(l.position="right"),{...o,label:l}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;o.yAxis.position="bottom";const i=L(t.customStyle).yAxis;if(i.axisLabel.show){const l=i.axisLabel.rotate;let n="end",a="middle";Math.abs(l)>75&&(n="center"),l>75&&(a="top"),l<-75&&(a="bottom"),o.yAxis.label.style.textBaseline=a,o.yAxis.label.style.textAlign=n}return o}setupDefaultOptions(t){return t.customStyle.yAxis={...t.customStyle.yAxis,position:"left",axisLine:{show:!1,lineStyle:t.customStyle.yAxis.axisLine.lineStyle},splitLine:{show:!1,lineStyle:t.customStyle.yAxis.axisLine.lineStyle}},t.customStyle.legend.show=!1,t.customAttr.label.show=!0,t.customAttr.label.position="right",t.customAttr.label.showQuota=!1,t.customAttr.label.showProportion=!0,t}configLegend(t,e){return{...super.configLegend(t,e),legend:!1}}configEmptyDataStrategy(t,e){const{data:o}=e;if(!(o!=null&&o.length))return e;const i=L(t.senior).functionCfg.emptyDataStrategy;if(i==="ignoreData"){const l=o.filter(n=>n.value===null).map(n=>n.field);return{...e,data:o.filter(n=>!l.includes(n.field))}}return i==="breakLine"&&o.forEach(l=>{l.value===null&&(l.value=null)}),i==="setZero"&&o.forEach(l=>{l.value===null&&(l.value=0)}),e}setupOptions(t,e){return Q(this.addConditionsStyleColorToData,this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configYAxis,this.configEmptyDataStrategy,this.configBarConditions)(t,e)}}const tn=Object.freeze(Object.defineProperty({__proto__:null,ProgressBar:Ks},Symbol.toStringTag,{value:"Module"})),{t:oe}=U(),en=[];class on extends st{constructor(t="bar-range"){super(t,en);w(this,"axisConfig",{xAxis:{name:`${oe("chart.drag_block_type_axis")} / ${oe("chart.dimension")}`,type:"d"},yAxis:{name:`${oe("chart.drag_block_value_start")} / ${oe("chart.time_dimension_or_quota")}`,limit:1,type:"q"},yAxisExt:{name:`${oe("chart.drag_block_value_end")} / ${oe("chart.time_dimension_or_quota")}`,limit:1,type:"q"}});w(this,"properties",Ds.filter(t=>t!=="threshold"));w(this,"propertyInner",{...Lt,"label-selector":["hPosition","color","fontSize","labelFormatter","showGap"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","showGap","show"],"x-axis-selector":[...Lt["x-axis-selector"],"axisLabelFormatter"],"y-axis-selector":["name","color","fontSize","axisLine","splitLine","axisForm","axisLabel","position","showLengthLimit"]});w(this,"axis",[...ge,"yAxisExt"]);w(this,"baseOptions",{data:[],xField:"values",yField:"field",colorField:"category",isGroup:!0})}async drawChart(t){var S,A,v,C;const{chart:e,container:o,action:i}=t;if(!((A=(S=e.data)==null?void 0:S.data)!=null&&A.length))return;const l=Z(e.data.data);l.forEach(T=>{T.tempId=(Math.random()*1e7).toString()});const n=!!e.aggregate,a=!!e.data.isDate,s=e.yAxis??e.yAxisExt??[];let r;const d=((v=s[0])==null?void 0:v.datePattern)==="date_split"?"/":"-";switch((C=s[0])==null?void 0:C.dateStyle){case"y":r="YYYY";break;case"y_M":r="YYYY"+d+"MM";break;case"y_M_d":r="YYYY"+d+"MM"+d+"DD";break;case"y_M_d_H":r="YYYY"+d+"MM"+d+"DD HH";break;case"y_M_d_H_m":r="YYYY"+d+"MM"+d+"DD HH:mm";break;case"y_M_d_H_m_s":r="YYYY"+d+"MM"+d+"DD HH:mm:ss";break;default:r="YYYY-MM-dd HH:mm:ss"}const p=e.data.minTime,c=e.data.maxTime,f=e.data.min,h=e.data.max,g={...this.baseOptions,appendPadding:ft(e),data:l,seriesField:a?n?"category":void 0:"category",isGroup:a?!n:!1,isStack:a?!n:!1,meta:a?{values:{type:"time",min:p,max:c,mask:r},tempId:{key:!0}}:{values:{min:f,max:h,mask:r},tempId:{key:!0}}},y=this.setupOptions(e,g),{Bar:x}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(T=>T._),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),b=new x(o,y);return b.on("interval:click",i),yt(e,b),te(e,b),b}configXAxis(t,e){const o=super.configXAxis(t,e);if(!o.xAxis)return o;const i=L(t.customStyle).xAxis,l=i.axisValue,n=!!t.data.isDate;if(o.xAxis.label&&(o.xAxis.label.formatter=a=>n?a:D(a,i.axisLabelFormatter)),o.xAxis.position==="top"&&(o.xAxis.position="left"),o.xAxis.position==="bottom"&&(o.xAxis.position="right"),!(l!=null&&l.auto)){const a={xAxis:{...o.xAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...a}}return o}configTooltip(t,e){const o=!!t.data.isDate;let i,l;if(t.customAttr&&(l=L(t.customAttr),l.tooltip)){const n=JSON.parse(JSON.stringify(l.tooltip));n.show?i={fields:["values","field","gap"],formatter:function(a){let s;return o?(s=a.values[0]+" ~ "+a.values[1],n.showGap&&(s=s+" ("+a.gap+")")):(s=D(a.values[0],n.tooltipFormatter)+" ~ "+D(a.values[1],n.tooltipFormatter),n.showGap&&(s=s+" ("+D(a.gap,n.tooltipFormatter)+")")),{value:s,values:a.values,name:a.field}},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0}:i=!1}return{...e,tooltip:i}}configBasicStyle(t,e){const o=!!t.data.isDate,i=!!t.aggregate,l=L(t.customAttr).basicStyle;if(o&&!i){const s=[],r=[];for(let p=0;p<t.data.data.length;p++){const c=t.data.data[p].field;r.indexOf(c)<0&&r.push(c)}for(let p=0;p<r.length;p++){const c=r[p];s.push({name:c,color:l.colors[p%l.colors.length],isCustom:!1})}e={...e,color:p=>{const c=we(s,h=>h.name===p.field);if(c===void 0)return;const f=P(c.color,l.alpha);return l.gradient?rt(f,!0):f}}}else if(l.gradient){let s=l.colors;s=s.map(r=>{const d=P(r,l.alpha);return rt(d,!0)}),e={...e,color:s}}if(l.radiusColumnBar==="roundAngle"){const s={radius:[l.columnBarRightAngleRadius,l.columnBarRightAngleRadius,l.columnBarRightAngleRadius,l.columnBarRightAngleRadius]};e={...e,barStyle:s}}let n;const a=l.columnWidthRatio??ct.columnWidthRatio;return a>=1&&a<=100?n=a/100:a<1?n=1/100:a>100&&(n=1),n&&(e.barWidthRatio=n),e}setupDefaultOptions(t){const{customAttr:e,senior:o}=t,{label:i}=e;return["left","middle","right"].includes(i.position)||(i.position="middle"),o.functionCfg.emptyDataStrategy="ignoreData",t}configLabel(t,e){const o=!!t.data.isDate,i=!!t.aggregate,l=super.configLabel(t,e);if(!l.label)return{...l,label:!1};const n=L(t.customAttr).label;o&&!i&&(l.label.layout||(l.label.layout=[]),l.label.layout.push({type:"interval-hide-overlap"}),l.label.layout.push({type:"limit-in-plot",cfg:{action:"hide"}}));const a={fields:[],...l.label,formatter:s=>{let r;return o?n.showGap?r=s.gap:r=s.values[0]+" ~ "+s.values[1]:n.showGap?r=D(s.gap,n.labelFormatter):r=D(s.values[0],n.labelFormatter)+" ~ "+D(s.values[1],n.labelFormatter),r}};return{...l,label:a}}configYAxis(t,e){const o=super.configYAxis(t,e);return o.yAxis&&(o.yAxis.position==="left"&&(o.yAxis.position="bottom"),o.yAxis.position==="right"&&(o.yAxis.position="top")),o}setupOptions(t,e){return Q(this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configEmptyDataStrategy)(t,e)}}const ln=Object.freeze(Object.defineProperty({__proto__:null,RangeBar:on},Symbol.toStringTag,{value:"Module"})),{t:Dt}=U();class sn extends st{constructor(){super("waterfall",[]);w(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","legend-selector","x-axis-selector","y-axis-selector","threshold"]);w(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","columnWidthRatio"],"label-selector":["fontSize","color","vPosition","labelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"x-axis-selector":["position","name","color","fontSize","axisLine","splitLine","axisForm","axisLabel"],"y-axis-selector":["position","name","color","fontSize","axisValue","splitLine","axisForm","axisLabel","axisLabelFormatter","showLengthLimit","axisLine"],threshold:["lineThreshold"]});w(this,"axis",["xAxis","yAxis","filter","drill","extLabel","extTooltip"]);w(this,"axisConfig",{xAxis:{name:`${Dt("chart.drag_block_type_axis")} / ${Dt("chart.dimension")}`,type:"d"},yAxis:{name:`${Dt("chart.drag_block_value_axis")} / ${Dt("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var d;const{chart:e,container:o,action:i}=t;if(!((d=e.data)!=null&&d.data))return;const n={data:e.data.data,xField:"field",yField:"value",seriesField:"category",appendPadding:ft(e)},a=this.setupOptions(e,n),{Waterfall:s}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(p=>p.af),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("interval:click",i),yt(e,r),te(e,r),r}configMeta(t,e){const o=t.yAxis,i={field:{type:"cat"}};if(!(o!=null&&o.length))return{...e,meta:i};const l=o[0],n=L(t.customStyle).yAxis;return i.value={alias:l.name,formatter:a=>D(a,n.axisLabelFormatter)},{...e,meta:i}}configBasicStyle(t,e){const o=L(t.customAttr),{colors:i,gradient:l,alpha:n}=o.basicStyle,[a,s,r]=i;let d;const p=o.basicStyle.columnWidthRatio??ct.columnWidthRatio;return p>=1&&p<=100?d=p/100:p<1?d=1/100:p>100&&(d=1),d&&(e.columnWidthRatio=d),{...e,total:{label:Dt("chart.waterfall_total"),style:{fill:rt(P(r,n),l,270)}},risingFill:rt(P(a,n),l,270),fallingFill:rt(P(s,n),l,270)}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const l=L(t.customStyle).yAxis.axisValue;if(!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configTooltip(t,e){var r;const i=L(t.customAttr).tooltip,l=t.yAxis;if(!i.show)return{...e,tooltip:!1};const n=(r=i.seriesTooltipFormatter)==null?void 0:r.filter(d=>d.show).reduce((d,p)=>(d[p.id]=p,d),{}),a=no(e.data),s={showTitle:!0,customItems(d){var f,h;if(!((f=i.seriesTooltipFormatter)!=null&&f.length))return d;const p=[],c=d[0];return c.data.quotaList?(d.filter(g=>n[g.data.quotaList[0].id]).forEach(g=>{const y=n[g.data.quotaList[0].id],x=(g.value+"").replace(/,/g,"");y.formatterCfg.type="value";const b=D(parseFloat(x),y.formatterCfg),S=Y(y.chartShowName)?y.name:y.chartShowName;p.push({...g,name:S,value:b})}),(h=c.data.dynamicTooltipValue)==null||h.forEach(g=>{const y=n[g.fieldId];if(y){const x=(g.value+"").replace(/,/g,""),b=D(parseFloat(x),y.formatterCfg),S=Y(y.chartShowName)?y.name:y.chartShowName;p.push({color:"grey",name:S,value:b})}}),p.forEach(g=>{const y=Ho(g);g.color=y}),p):(Object.keys(n).forEach(g=>{const y=n[g];let x=a[g],b="grey";g===l[0].id&&(x=c.data.value,b=c.color);const S=D(x,y.formatterCfg),A=Y(y.chartShowName)?y.name:y.chartShowName;if(g===l[0].id){p.unshift({color:b,name:A,value:S});return}p.push({color:b,name:A,value:S})}),p)},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:s}}configLegend(t,e){const o=super.configLegend(t,e);if(!o.legend)return o;const i=L(t.customAttr),{colors:l,gradient:n,alpha:a}=i.basicStyle,[s,r,d]=l;return{...o,legend:{...o.legend,items:[{name:Dt("chart.increase"),value:"",marker:{style:{fill:rt(P(s,a),n,270)}}},{name:Dt("chart.decrease"),value:"",marker:{style:{fill:rt(P(r,a),n,270)}}},{name:Dt("chart.waterfall_total"),value:"",marker:{style:{fill:rt(P(d,a),n,270)}}}]}}}setupOptions(t,e){return Q(this.addConditionsStyleColorToData,this.configTheme,this.configLegend,this.configBasicStyle,this.configLabel,this.configTooltip,this.configXAxis,this.configYAxis,this.configMeta,this.configBarConditions)(t,e)}}const nn=Object.freeze(Object.defineProperty({__proto__:null,Waterfall:sn},Symbol.toStringTag,{value:"Module"})),Mi=["background-overall-component","border-style","basic-style-selector","x-axis-selector","y-axis-selector","title-selector","legend-selector","label-selector","tooltip-selector","assist-line","function-cfg","jump-set","linkage","threshold"],Zt={"background-overall-component":["all"],"border-style":["all"],"label-selector":["fontSize","color"],"tooltip-selector":["fontSize","color","backgroundColor","show"],"basic-style-selector":["colors","alpha","lineWidth","lineSymbol","lineSymbolSize","lineSmooth"],"x-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine"],"y-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine","axisValue","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["slider","emptyDataStrategy"],threshold:["lineThreshold"]},$i=["xAxis","yAxis","drill","filter","extLabel","extTooltip"],{t:de}=U(),an=[];class Pi extends st{constructor(t="area"){super(t,an);w(this,"properties",Mi);w(this,"propertyInner",{...Zt,"basic-style-selector":[...Zt["basic-style-selector"],"gradient","seriesColor"],"label-selector":["seriesLabelVPosition","seriesLabelFormatter","showExtremum"],"tooltip-selector":[...Zt["tooltip-selector"],"seriesTooltipFormatter"]});w(this,"axis",[...$i]);w(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${de("chart.drag_block_type_axis")} / ${de("chart.dimension")}`,type:"d"},yAxis:{name:`${de("chart.drag_block_value_axis")} / ${de("chart.quota")}`,type:"q"}});w(this,"baseOptions",{data:[],xField:"field",yField:"value",seriesField:"category",isStack:!1,interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region",cfg:{start:[{trigger:"element:mousemove",action:"active-region:show"}],end:[{trigger:"element:mouseleave",action:"active-region:hide"}]}}]})}async drawChart(t){var d,p;const{chart:e,container:o,action:i}=t;if(!((p=(d=e.data)==null?void 0:d.data)!=null&&p.length)){e.container=o,ze(e);return}const l=Z(e.data.data),n={...this.baseOptions,data:l,appendPadding:ft(e)},a=this.setupOptions(e,n),{Area:s}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(c=>c.Y),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("point:click",i),Wo(r,e,a,o),yt(e,r),r}configLabel(t,e){var r;const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const{label:i,basicStyle:l}=L(t.customAttr),n=ui(t),a=(r=i.seriesLabelFormatter)==null?void 0:r.reduce((d,p)=>(d[p.id]=p,d),{});o.label.style.fill=Qt.color;const s={fields:[],...o.label,layout:i.fullDisplay?[{type:"limit-in-plot"}]:o.label.layout,formatter:(d,p)=>{var x;if(d.EXTREME)return"";if(!((x=i.seriesLabelFormatter)!=null&&x.length))return d.value;const c=a==null?void 0:a[d.quotaList[0].id];if(!c)return d.value;if(!c.show)return;const f=c.position==="top"?-2-l.lineSymbolSize:10+l.lineSymbolSize,h=D(d.value,c.formatterCfg),g=di(n,d.value,d.quotaList[0].id)||c.color,y=new Kt({});return y.addShape({type:"text",attrs:{x:0,y:f,text:h,textAlign:"start",textBaseline:"top",fontSize:c.fontSize,fontFamily:t.fontFamily,fill:g}}),y}};return{...o,label:s}}configBasicStyle(t,e){const o=L(t.customAttr),i=JSON.parse(JSON.stringify(o.basicStyle)),l=i.lineSmooth,n={size:i.lineSymbolSize,shape:i.lineSymbol},a={style:{lineWidth:i.lineWidth}},{colors:s,alpha:r}=o.basicStyle,d=[...s,...s];let p;if(o.basicStyle.gradient){const c=new Map,h=L(t.customStyle).yAxis.axisValue,g=!(h!=null&&h.auto)&&h.min&&h.max?h.min/h.max:0;p=y=>{let x;const b=`${y.field}-${y.category}`;return c.has(b)?x=c.get(b):(x=d.shift(),c.set(b,x)),x?{fill:rt(P(x,r),!0,270,g)}:{fill:"rgba(255,255,255,0)"}}}return{...e,smooth:l,line:a,point:n,areaStyle:p}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const i=L(t.customStyle).yAxis;o.yAxis.label&&(o.yAxis.label.formatter=n=>D(n,i.axisLabelFormatter));const l=i.axisValue;if(!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configTooltip(t,e){return super.configMultiSeriesTooltip(t,e)}setupOptions(t,e){return Q(this.configTheme,this.configEmptyDataStrategy,this.configColor,this.configLabel,this.configTooltip,this.configBasicStyle,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configConditions)(t,e,{},this)}}class rn extends Pi{constructor(){super("area-stack");w(this,"propertyInner",{...this.propertyInner,"label-selector":["vPosition","fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","tooltipFormatter","show"]});w(this,"axisConfig",{...this.axisConfig,extStack:{name:`${de("chart.stack_item")} / ${de("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}});this.baseOptions={...this.baseOptions,isStack:!0},delete this.propertyInner.threshold,this.properties=this.properties.filter(t=>t!=="threshold"),this.axis.push("extStack")}configLabel(t,e){const{label:o,basicStyle:i}=L(t.customAttr);if(!(o!=null&&o.show))return{...e,label:!1};const l=[];if(o.fullDisplay)l.push({type:"limit-in-plot"});else{const s=super.configLabel(t,e);l.push(...s.label.layout)}const n=o.position==="top"?-2-i.lineSymbolSize:8+i.lineSymbolSize,a={position:o.position,offsetY:n,layout:l,style:{fill:o.color,fontSize:o.fontSize},formatter:function(s){return D(s.value,o.labelFormatter)}};return{...e,label:a}}setupDefaultOptions(t){return t.senior.functionCfg.emptyDataStrategy="ignoreData",t}configColor(t,e){return this.configStackColor(t,e)}setupSeriesColor(t,e){return Bo(t,e)}configTooltip(t,e){const i=L(t.customAttr).tooltip;if(!i.show)return{...e,tooltip:!1};const l={formatter:function(n){return{name:n.category,value:D(n.value,i.tooltipFormatter)}},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:l}}}const cn=Object.freeze(Object.defineProperty({__proto__:null,Area:Pi,StackArea:rn},Symbol.toStringTag,{value:"Module"})),{t:ie}=U(),un=[];class dn extends st{constructor(t="line"){super(t,un);w(this,"properties",Mi);w(this,"propertyInner",{...Zt,"basic-style-selector":[...Zt["basic-style-selector"],"seriesColor"],"label-selector":["seriesLabelVPosition","seriesLabelFormatter","showExtremum"],"tooltip-selector":[...Zt["tooltip-selector"],"seriesTooltipFormatter"]});w(this,"axis",[...$i,"xAxisExt"]);w(this,"axisConfig",{...this.axisConfig,xAxis:{name:`${ie("chart.drag_block_type_axis")} / ${ie("chart.dimension")}`,type:"d"},xAxisExt:{name:`${ie("chart.chart_group")} / ${ie("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},yAxis:{name:`${ie("chart.drag_block_value_axis")} / ${ie("chart.quota")}`,type:"q"}})}async drawChart(t){var c,f;const{chart:e,action:o,container:i}=t;if(!((f=(c=e.data)==null?void 0:c.data)!=null&&f.length)){e.container=i,ze(e);return}const l=Z(e.data.data),a=L(e.customAttr).basicStyle.colors,s={data:l,xField:"field",yField:"value",seriesField:"category",appendPadding:ft(e),color:a,interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region",cfg:{start:[{trigger:"element:mousemove",action:"active-region:show"}],end:[{trigger:"element:mouseleave",action:"active-region:hide"}]}}]},r=this.setupOptions(e,s),{Line:d}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(h=>h.a2),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),p=new d(i,r);return p.on("point:click",o),Wo(p,e,r,i),yt(e,p),p}configLabel(t,e){var r;const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const{label:i,basicStyle:l}=L(t.customAttr),n=ui(t),a=(r=i.seriesLabelFormatter)==null?void 0:r.reduce((d,p)=>(d[p.id]=p,d),{});o.label.style.fill=Qt.color;const s={fields:[],...o.label,layout:i.fullDisplay?[{type:"limit-in-plot"}]:o.label.layout,formatter:(d,p)=>{var x;if(d.EXTREME)return"";if(!((x=i.seriesLabelFormatter)!=null&&x.length))return d.value;const c=a==null?void 0:a[d.quotaList[0].id];if(!c)return d.value;if(!c.show)return;const f=c.position==="top"?-2-l.lineSymbolSize:10+l.lineSymbolSize,h=D(d.value,c.formatterCfg),g=di(n,d.value,d.quotaList[0].id)||c.color,y=new Kt({});return y.addShape({type:"text",attrs:{x:0,y:f,text:h,textAlign:"start",textBaseline:"top",fontSize:c.fontSize,fontFamily:t.fontFamily,fill:g}}),y}};return{...o,label:s}}configBasicStyle(t,e){const o=L(t.customAttr),i=JSON.parse(JSON.stringify(o.basicStyle)),l=i.lineSmooth,n={size:i.lineSymbolSize,shape:i.lineSymbol},a={lineWidth:i.lineWidth};return{...e,smooth:l,point:n,lineStyle:a}}configCustomColors(t,e){const o=L(t.customAttr).basicStyle,i=o.colors.map(l=>P(l,o.alpha));return{...e,color:i}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const i=L(t.customStyle).yAxis;o.yAxis.label&&(o.yAxis.label.formatter=n=>D(n,i.axisLabelFormatter));const l=i.axisValue;if(!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configTooltip(t,e){var s;const i=L(t.customAttr).tooltip;if(!i.show)return{...e,tooltip:!1};const l=t.xAxisExt,n=(s=i.seriesTooltipFormatter)==null?void 0:s.filter(r=>r.show).reduce((r,d)=>(r[d.id]=d,r),{}),a={showTitle:!0,customItems(r){var c,f;if(!((c=i.seriesTooltipFormatter)!=null&&c.length))return r;const d=r[0];if(!d.data.quotaList)return r;const p=[];return r.filter(h=>n[h.data.quotaList[0].id]).forEach(h=>{const g=n[h.data.quotaList[0].id],y=D(parseFloat(h.value),g.formatterCfg);let x=Y(g.chartShowName)?g.name:g.chartShowName;(l==null?void 0:l.length)>0&&(x=h.data.category),p.push({...h,name:x,value:y})}),(f=d.data.dynamicTooltipValue)==null||f.forEach(h=>{const g=n[h.fieldId];if(g){const y=D(parseFloat(h.value),g.formatterCfg),x=Y(g.chartShowName)?g.name:g.chartShowName;p.push({color:"grey",name:x,value:y})}}),p},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:a}}setupSeriesColor(t,e){return ci(t,e)}configLegend(t,e){var a;const o=super.configLegend(t,e);if(!o.legend)return o;const i=t.xAxisExt[0];if(((a=i==null?void 0:i.customSort)==null?void 0:a.length)>0){const s=i.customSort??[];if(s!=null&&s.length){const r=o.data;r==null||r.forEach(d=>{const p=d.category;p&&!s.includes(p)&&s.push(p)}),o.meta={...o.meta,category:{type:"cat",values:s}}}}const l=L(t.customStyle);let n;return l&&l.legend?n=he(JSON.parse(JSON.stringify(l.legend)),zt).size:n=zt.size,o.legend.marker.style=s=>({r:n,fill:s.stroke}),o}setupOptions(t,e){return Q(this.configTheme,this.configEmptyDataStrategy,this.configGroupColor,this.configLabel,this.configTooltip,this.configBasicStyle,this.configCustomColors,this.configLegend,this.configXAxis,this.configYAxis,this.configSlider,this.configAnalyse,this.configConditions)(t,e)}}const fn=Object.freeze(Object.defineProperty({__proto__:null,Line:dn},Symbol.toStringTag,{value:"Module"})),{t:Ne}=U(),mn=[];class pn extends st{constructor(t="stock-line"){super(t,mn);w(this,"properties",["background-overall-component","border-style","basic-style-selector","legend-selector","x-axis-selector","y-axis-selector","title-selector","tooltip-selector","function-cfg","jump-set","linkage"]);w(this,"propertyInner",{...Zt,"function-cfg":["emptyDataStrategy"],"y-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine","axisLabelFormatter"],"legend-selector":["fontSize","color","show"]});w(this,"axis",["xAxis","yAxis","filter","extLabel","extTooltip"]);w(this,"axisConfig",{xAxis:{name:`${Ne("common.component.date")} / ${Ne("chart.dimension")}`,limit:1,type:"d"},yAxis:{name:`${Ne("chart.k_line_yaxis_tip")} / ${Ne("chart.quota")}`,limit:4,type:"q"}});w(this,"calculateMovingAverage",(t,e,o)=>{const i=o.xAxis,l=o.yAxis,n=i[0].dataeaseName,a=l[1].dataeaseName,s=[];for(let r=0;r<t.length;r++)if(r<e)s.push({[n]:t[r][n],value:null});else{const d=t.slice(r-e+1,r+1).reduce((p,c)=>p+c[a],0);s.push({[n]:t[r][n],value:parseFloat((d/e).toFixed(3))})}return s});w(this,"calculateMinMax",t=>t.reduce((e,o)=>{const l=Object.values(o).filter(n=>typeof n=="number");if(l.length>0){const n=Math.max(...l),a=Math.min(...l);e.maxValue=Math.max(e.maxValue,n),e.minValue=Math.min(e.minValue,a)}return e},{maxValue:Number.NEGATIVE_INFINITY,minValue:Number.POSITIVE_INFINITY}));w(this,"registerEvent",(t,e,o)=>{let i=!0;e.on("legend-item:click",l=>{const{value:n}=l.target.get("delegateObject").item;if(n==="k")i=!i,e.chart.geometries.forEach(a=>{a.type==="schema"&&a.changeVisible(i)});else{const a=e.chart.geometries.filter(d=>d.type==="line"),s=e.chart.geometries.filter(d=>d.type==="point");let r=0;for(const d of o.keys())r++,d===n&&(a[r-1].changeVisible(!a[r-1].visible),s[r-1].changeVisible(!s[r-1].visible))}}),e.on("afterrender",l=>{var a,s;let n=!1;if(e.chart.options.slider.start===.5&&e.chart.options.slider.end===1&&(n=!0),(s=(a=l.view)==null?void 0:a.options)!=null&&s.scales){const r=Math.floor(.5*t.length),d=Math.ceil(1*t.length),p=t.slice(r,d),{maxValue:c,minValue:f}=this.calculateMinMax(n?p:l.view.filteredData),h=l.view.options.scales;Object.keys(h).forEach(g=>{h[g].max&&(h[g].max=c),h[g].min&&(h[g].min=f)})}}),e.on("legend-item-group:click",l=>{var n,a;if((a=(n=l.view)==null?void 0:n.options)!=null&&a.scales){const{maxValue:s,minValue:r}=this.calculateMinMax(l.view.filteredData),d=l.view.options.scales;Object.keys(d).forEach(p=>{d[p].max&&(d[p].max=s),d[p].min&&(d[p].min=r)})}}),e.on("slider:valuechanged",l=>{const n=l.gEvent.currentTarget.cfg.component.cfg.start,a=l.gEvent.currentTarget.cfg.component.cfg.end;e.chart.options.slider.start=n,e.chart.options.slider.end=a;const s=Math.floor(n*t.length),r=Math.ceil(a*t.length),d=t.slice(s,r),{maxValue:p,minValue:c}=this.calculateMinMax(d),f=l.view.options.scales;Object.keys(f).forEach(h=>{f[h].max&&(f[h].max=p),f[h].min&&(f[h].min=c)})})})}async drawChart(t){var z,N,F,I,$;const{chart:e,action:o,container:i}=t;if(!((N=(z=e.data)==null?void 0:z.data)!=null&&N.length))return;const l=e.xAxis,n=e.yAxis;if(n.length!=4)return;const a=L(e.customAttr).basicStyle,s=[],r=a.alpha;a.colors.forEach(M=>{s.push(P(M,r))});const d=L((F=e.data)==null?void 0:F.tableRow),p=l[0].dataeaseName,c=[5,10,20,60,120,180],f=[{name:"日K",value:"k",marker:{symbol:(M,H,J)=>{const W=J*1,j=J;return[["M",M-W-1/2,H-j/2],["L",M+W+1/2,H-j/2],["L",M+W+1/2,H+j/2],["L",M-W-1/2,H+j/2],["Z"],["M",M,H+10/2],["L",M,H-10/2]]},style:{fill:"red",stroke:"red",lineWidth:2}}}],h=new Map;c.forEach(M=>{h.set("ma"+M,this.calculateMovingAverage(d,M,e))}),d.forEach(M=>{var J;const H=M[p];for(const[W,j]of h)M[W]=(J=j.find(tt=>tt[p]===H))==null?void 0:J.value});const g=[];let y=0;const x=.5,b=1,S=Math.floor(x*d.length),A=Math.ceil(b*d.length),v=d.slice(S,A),{maxValue:C,minValue:T}=this.calculateMinMax(v);for(const M of h.keys())y++,g.push({type:"line",top:!0,options:{smooth:!1,xField:p,yField:M,color:s[y-1],xAxis:null,yAxis:{label:!1,min:T,max:C,grid:null,line:null},lineStyle:{lineWidth:2}}}),f.push({name:M.toUpperCase(),value:M,marker:{symbol:"hyphen",style:{stroke:s[y-1],lineWidth:2}}});const k=e.xAxis??[];let O;const R=((I=k[0])==null?void 0:I.datePattern)==="date_split"?"/":"-";switch(($=k[0])==null?void 0:$.dateStyle){case"y":O="YYYY";break;case"y_M":O="YYYY"+R+"MM";break;case"y_M_d":O="YYYY"+R+"MM"+R+"DD";break;case"y_M_d_H":O="YYYY"+R+"MM"+R+"DD HH";break;case"y_M_d_H_m":O="YYYY"+R+"MM"+R+"DD HH:mm";break;case"y_M_d_H_m_s":O="YYYY"+R+"MM"+R+"DD HH:mm:ss";break;default:O="YYYY-MM-dd HH:mm:ss"}const _=this.setupOptions(e,{data:d,slider:{start:.5,end:1,textStyle:{fontFamily:e.fontFamily}},plots:[{type:"stock",top:!0,options:{meta:{[p]:{mask:O}},stockStyle:{stroke:"black",lineWidth:.5},yAxis:{label:{},position:"left",min:T,max:C},xField:p,yField:[n[0].dataeaseName,n[1].dataeaseName,n[2].dataeaseName,n[3].dataeaseName],legend:{position:"top",custom:!0,items:f}}},...g]}),{Mix:B}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(M=>M.a5),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),E=new B(i,_);return this.registerEvent(d,E,h),E.on("schema:click",M=>{var tt;const H=M.data.data[p],W=L((tt=e.data)==null?void 0:tt.data).filter(q=>q.field===H),j=[];if(W.forEach(q=>{j.push({...q.quotaList[0],value:q.value})}),W.length){const q={x:M.x,y:M.y,data:{data:{...M.data.data,value:j[0].value,name:H,dimensionList:W[0].dimensionList,quotaList:j}}};o(q)}}),E}configBasicStyle(t,e){const o=L(t.customAttr),i=JSON.parse(JSON.stringify(o.basicStyle)),l=i.lineSmooth,n={size:i.lineSymbolSize,shape:i.lineSymbol},a={lineWidth:i.lineWidth},s=[];return e.plots.forEach(r=>{r.type==="stock"&&s.push({...r}),r.type==="line"&&s.push({...r,options:{...r.options,smooth:l,point:n,lineStyle:a}})}),{...e,plots:s}}configTooltip(t,e){const o=L(t.customAttr).tooltip;t.xAxis;const i=[];e.plots.filter(c=>c.type==="line").forEach(c=>{i.push(c)});const n=e.plots.filter(c=>c.type==="stock")[0];if(!o.show){const c={...n.options,tooltip:{showContent:!1}};return i.push({...n,options:c}),{...e,plots:i}}const a=t.data.fields,s=c=>{var y;const f=c.map(x=>{const b=a.find(C=>C.dataeaseName===x.name),S=(b==null?void 0:b.chartShowName)||(b==null?void 0:b.name)||x.name,A=S.startsWith("ma")?S.toUpperCase():S;o.tooltipFormatter.decimalCount=3;const v=D(x.value,o.tooltipFormatter);return{...x,name:A,value:v,color:x.color}}),h=f.some(x=>!x.name.startsWith("MA")),g=f.filter(x=>!x.name.startsWith("MA"));return h?[{name:"日K",value:"",marker:!0,color:(y=g[0])==null?void 0:y.color},...g,...f.filter(x=>x.name.startsWith("MA"))]:f},r=c=>{const f=c.name.startsWith("MA")||!c.value?10:5,h=c.name.startsWith("MA")||!c.value?5:9,g=c.name.startsWith("MA")||!c.value?0:2;return`
        <li style="display: flex; align-items: center; margin-bottom: 10px;">
          <div>
            <span
              style="
                background-color: ${c.color};
                width: ${f}px;
                height: ${f}px;
                border-radius: 50%;
                display: inline-block;
                margin-right: ${h}px;
                margin-left: ${g}px;
              "></span>
          </div>
          <div style="display: flex; justify-content: space-between; width: 100%;">
            <span style="margin-right: 15px;">${c.name}</span>
            <span>${c.name.startsWith("MA")&&c.value==="0"?"-":c.value}</span>
          </div>
        </li>
      `},d=(c,f)=>`
        <div style="padding: 10px 0;">
          <div style="margin-bottom: 10px;">${c}</div>
          <ul style="list-style: none; padding: 0;">
            ${f.map(r).join("")}
          </ul>
        </div>
      `,p={...n.options,tooltip:{showMarkers:!0,showCrosshairs:!0,showNil:!0,crosshairs:{follow:!0,text:(c,f,h)=>c==="y"?{content:f&&f.toFixed(0)}:{content:h[0].title,position:"end"}},showContent:!0,customItems:s,customContent:d}};return i.push({...n,options:p}),{...e,plots:i}}configXAxis(t,e){const o=super.configXAxis(t,e);if(!o)return e;const i=[],l=e.plots.filter(s=>s.type==="line"),n=e.plots.filter(s=>s.type==="stock")[0],a={...n,options:{...n.options,xAxis:o.xAxis?{...n.options.xAxis,...o.xAxis}:{label:!1,line:null}}};return i.push(a),l.forEach(s=>{i.push(s)}),{...e,plots:i}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o)return e;const i=L(t.customStyle).yAxis,l=[],n=e.plots.filter(d=>d.type==="line"),a=e.plots.filter(d=>d.type==="stock")[0];let s=!1;o.yAxis.label&&(s={...o.yAxis.label,formatter:d=>D(d,i.axisLabelFormatter)});const r={...a,options:{...a.options,yAxis:s?{...a.options.yAxis,...o.yAxis,label:s}:{...o.yAxis,label:s,grid:null,line:null}}};return l.push(r),n.forEach(d=>{l.push(d)}),{...e,plots:l}}customConfigEmptyDataStrategy(t,e){const{data:o}=e;if(!(o!=null&&o.length))return e;const i=L(t.senior).functionCfg.emptyDataStrategy;if(i==="ignoreData")for(let n=o.length-1;n>=0;n--){const a=o[n];Object.keys(a).forEach(s=>{s.startsWith("f_")&&a[s]===null&&o.splice(n,1)})}return(i==="breakLine"||i==="setZero")&&((n,a)=>{a.forEach(s=>{Object.keys(s).forEach(r=>{r.startsWith("f_")&&s[r]===null&&(s[r]=n==="breakLine"?null:0)})})})(i,o),e}configLegend(t,e){let o={},i;const l=e.plots.filter(r=>r.type==="stock")[0];if(t.customStyle&&(i=L(t.customStyle),i.legend)){const r=JSON.parse(JSON.stringify(i.legend));r.show?o={...l.options.legend,itemName:{style:{fill:r.color,fontSize:r.fontSize}}}:o=!1}const n=[],a={...l.options,legend:o};return e.plots.filter(r=>r.type==="line").forEach(r=>{n.push(r)}),n.push({...l,options:a}),{...e,plots:n}}setupOptions(t,e){return Q(this.configTheme,this.configBasicStyle,this.configXAxis,this.configYAxis,this.configTooltip,this.configLegend,this.customConfigEmptyDataStrategy)(t,e)}}const hn=Object.freeze(Object.defineProperty({__proto__:null,StockLine:pn},Symbol.toStringTag,{value:"Module"})),{t:oi}=U(),gn=[];class yn extends st{constructor(){super("liquid",gn);w(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","misc-selector","title-selector","threshold"]);w(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha"],"label-selector":["fontSize","color","labelFormatter"],"misc-selector":["liquidShape","liquidSize","liquidMaxType","liquidMaxField"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],threshold:["liquidThreshold"]});w(this,"axis",["yAxis","filter"]);w(this,"axisConfig",{yAxis:{name:`${oi("chart.drag_block_progress")} / ${oi("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var d,p;const{chart:e,container:o,action:i}=t;if(!((d=e.data)!=null&&d.series)||!e.yAxis.length)return;const l={percent:0},n=this.setupOptions(e,l),{Liquid:a}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(c=>c.aa),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),s=new a(o,n);s.on("afterrender",()=>{var c,f;i({from:"liquid",data:{type:"liquid",max:(f=(c=e.data)==null?void 0:c.series[0])==null?void 0:f.data[0]}})});const r=(p=e.data)==null?void 0:p.series.some(c=>{var f;return!((f=c.data)!=null&&f[0])});if(this.configEmptyDataStyle(r?[]:[1],o,s),!r)return s}configTheme(t,e){const o=L(t.customAttr),i=[];if(o.basicStyle){const s=o.basicStyle;s.colors.forEach(r=>{i.push(P(r,s.alpha))})}const l=L(t.customStyle);let n;l.background&&(n=P(l.background.color,l.background.alpha));const a={styleSheet:{brandColor:i[0],paletteQualitative10:i,paletteQualitative20:i,backgroundColor:n}};return{...e,theme:a}}configMisc(t,e){var r,d,p;const o=L(t.customAttr);let i=0;t.data.series.length>0&&(i=t.data.series[0].data[0]);let l,n,a;if(o.misc){const c=o.misc,f=(p=(d=t.data)==null?void 0:d.series[((r=t.data)==null?void 0:r.series.length)-1])==null?void 0:p.data[0];c.liquidMaxType==="dynamic"?l=f:l=c.liquidMax?c.liquidMax:f,n=(c.liquidSize?c.liquidSize:Gt.liquidSize)/100,a=c.liquidShape??Gt.liquidShape}const s={percent:i/l,radius:n,shape:a};return{...e,...s}}configLabel(t,e){var a;const o=L(t.customAttr),i=e.percent;if(i>1&&(e={...e,percent:1}),!((a=o.label)!=null&&a.show))return{...e,statistic:{content:!1}};const l=o.label,n=l.labelFormatter;return{...e,statistic:{content:{style:{fontSize:l.fontSize.toString()+"px",color:l.color},formatter:()=>D(i,n)}}}}configThreshold(t,e){var i;const o=L(t.senior);if((i=o==null?void 0:o.threshold)!=null&&i.enable){const{liquidThreshold:l}=o==null?void 0:o.threshold;if(l){const{paletteQualitative10:n}=e.theme.styleSheet;return{...e,liquidStyle:()=>{const s=l.split(",");let r=0;return s.forEach((d,p)=>{e.percent>parseFloat(d)/100&&(r=p+1)}),{fill:n[r%n.length],stroke:n[r%n.length]}}}}}return e}setupDefaultOptions(t){return t.customAttr.label={...t.customAttr.label,fontSize:12,show:!0,labelFormatter:{type:"percent",thousandSeparator:!0,decimalCount:2}},t}setupOptions(t,e){return Q(this.configTheme,this.configMisc,this.configLabel,this.configThreshold)(t,e)}}const xn=Object.freeze(Object.defineProperty({__proto__:null,Liquid:yn},Symbol.toStringTag,{value:"Module"}));class Hi extends ro{configLabel(u,t){const e=Li(u);return Nt(t.label,e),t}configStyle(u,t){const e=bs(u);return Nt(t.style,e),t}configTooltip(u,t){const e=Ti(u);return Nt(t.tooltip,e),t}configLegend(u,t){const e=As(u);return Nt(t,{legend:e}),t}configEmptyDataStrategy(u,t){var l,n;const{functionCfg:e}=L(u.senior),o=e.emptyDataStrategy;if(!o||o==="breakLine")return t;const i=Z(t.source.data);if(o==="setZero"&&i.forEach(a=>{var s;a.value===null&&(a.value=0),((s=a.dynamicTooltipValue)==null?void 0:s.length)>0&&a.dynamicTooltipValue.forEach(r=>{r.value===null&&(r.value=0)})}),o==="ignoreData")for(let a=i.length-1;a>=0;a--){i[a].value===null&&i.splice(a,1);for(let s=((n=(l=i[a])==null?void 0:l.dynamicTooltipValue)==null?void 0:n.length)-1;s>=0;s--)i[a].dynamicTooltipValue[s].value===null&&i[a].dynamicTooltipValue.splice(s,1)}return t.source.data=i,t}configZoomButton(u,t){Ts(u,t)}constructor(u,t){super(Vt.L7_PLOT,u),this.defaultData=t}}const Wi=["background-overall-component","border-style","basic-style-selector","title-selector","label-selector","tooltip-selector","function-cfg","map-mapping","jump-set","linkage"],Pt={"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","areaBorderColor","zoom"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"label-selector":["color","fontSize","labelBgColor","labelShadow","labelShadowColor","showDimension","showQuota"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"],"function-cfg":["emptyDataStrategy"],"map-mapping":[""]},Vi=["xAxis","yAxis","area","drill","filter","extLabel","extTooltip"],co=(m,u,t,e,o,i)=>{var l;["bubble-map","map"].includes(m.type)&&(t=(l=u.source.data.dataArray)==null?void 0:l.filter(n=>{var a;return((a=n.dimensionList)==null?void 0:a.length)>0}).reduce((n,a)=>(n.find(r=>{var d;return(d=i==null?void 0:i.areaId)!=null&&d.startsWith("custom_")?r.areaName===a.areaName:r.name===a.name||r.adcode&&r.adcode===a.adcode})||n.push(a),n),[])),me[m.container]?me[m.container].update(e,m,u,t,o,i):new Yi(e,m,u,t,o,i)},me={};class Yi{constructor(u,t,e,o,i,l){w(this,"popupTimeoutId",null);w(this,"popupIntervalId",null);w(this,"isPaused",!1);w(this,"currentIndex",0);w(this,"scene");w(this,"chart");w(this,"view");w(this,"data");w(this,"stayTime");w(this,"intervalTime");w(this,"popup");w(this,"customSubArea");w(this,"drawOption");w(this,"onMouseEnterHandler");w(this,"onMouseLeaveHandler");w(this,"onVisibilityChangeHandler");w(this,"handleVisibilityChange",()=>{document.hidden?this.clearPreviousInstance(this.chart.container):this.startCarouselPopups()});w(this,"pauseCarouselPopups",()=>{var u;this.popup&&((u=this.popup)==null||u.remove()),this.removeStyle(),this.isPaused=!0,this.clearExistingTimers()});w(this,"resumeCarouselPopups",()=>{this.isPaused&&(this.isPaused=!1,this.startCarouselPopups())});w(this,"clearExistingTimers",()=>{this.popupTimeoutId!==null&&(clearTimeout(this.popupTimeoutId),this.popupTimeoutId=0),this.popupIntervalId!==null&&(clearInterval(this.popupIntervalId),this.popupIntervalId=0)});this.onMouseEnterHandler=this.pauseCarouselPopups.bind(this),this.onMouseLeaveHandler=this.resumeCarouselPopups.bind(this),this.onVisibilityChangeHandler=this.handleVisibilityChange.bind(this),this.clearExistingTimers=this.clearExistingTimers.bind(this),this.init(u,t,e,o,i,l)}update(u,t,e,o,i,l){this.init(u,t,e,o,i,l)}init(u,t,e,o,i,l){var n,a,s,r,d,p,c,f,h,g;if(this.view=e,this.chart=t,this.scene=u,this.data=o,this.popup=null,this.currentIndex=0,this.customSubArea=i,this.drawOption=l,this.clearPreviousInstance(this.chart.container),(a=(n=this.chart.customAttr)==null?void 0:n.tooltip)!=null&&a.show&&((d=(r=(s=this.chart.customAttr)==null?void 0:s.tooltip)==null?void 0:r.carousel)!=null&&d.enable)&&this.data.length>0){this.popup=new yi({closeButton:!1,maxWidth:600});const y=(c=(p=this.chart.customAttr)==null?void 0:p.tooltip)==null?void 0:c.carousel;this.stayTime=y.stayTime*1e3,this.intervalTime=y.intervalTime*1e3,this.startCarouselPopups();const x=document.getElementById(this.chart.container);x.addEventListener("mouseenter",this.pauseCarouselPopups),x.addEventListener("mouseleave",this.resumeCarouselPopups),this.chart.type==="symbolic-map"&&((h=(f=u==null?void 0:u.getLayers())==null?void 0:f[0])==null||h.addListener("touchend",()=>{this.pauseCarouselPopups()}),(g=u==null?void 0:u.getMapCanvasContainer())==null||g.addEventListener("touchend",()=>{this.resumeCarouselPopups()})),document.addEventListener("visibilitychange",this.handleVisibilityChange),me[this.chart.container]=this}}clearPreviousInstance(u){var t;if(me[u]){const e=me[u];this.clearExistingTimers(),(t=e.popup)==null||t.remove(),e.removeStyle()}}startCarouselPopups(){this.clearExistingTimers(),this.carouselPopups()}carouselPopups(){const u=t=>{this.removeStyle();const e=document.getElementById(this.chart.container);if(e){if(this.chart.type==="symbolic-map"){const o=e.getElementsByClassName("l7-popup-"+this.chart.container);for(const i of Array.from(o))i.classList.add("l7-popup-hide");this.createSymbolicMapPopup(t)}else{if(this.chart.type==="map"){const o=e.getElementsByClassName("l7plot-tooltip-container");for(const i of Array.from(o)){const l=i;l.style.display="none"}}this.createPopup(t)}this.clearExistingTimers(),this.popupTimeoutId=window.setTimeout(()=>{var o;this.currentIndex++,(o=this.popup)==null||o.remove(),this.cancelHighlightLayer(t),this.currentIndex>=this.data.length&&(this.currentIndex=0),this.popupIntervalId=window.setTimeout(()=>{u(this.currentIndex)},this.intervalTime)},this.stayTime)}else this.clearExistingTimers()};u(this.currentIndex)}removeStyle(){var t;const u=document.getElementById("style-"+this.chart.container);u&&(u.remove(),(t=u.parentNode)==null||t.removeChild(u))}createPopup(u){var n,a,s,r,d,p;const t=this.view.tooltip.options.domStyles,e=t["l7plot-tooltip"]["background-color"],o=t["l7plot-tooltip"]["font-size"],i=document.createElement("style");i.id="style-"+this.chart.container,i.innerHTML=`
            #${this.chart.container} .l7-popup-content {
                background-color: ${e} !important;
                font-size: ${o};
                padding: 10px 10px 6px;
                line-height: 1.6;
            }
            #${this.chart.container} .l7-popup-tip {
                border-top-color: ${e} !important;
            }
        `,document.head.appendChild(i);const l=this.getPopupData(u);if(l.data){let c="";this.getTooltipItems(l.data).forEach(h=>{c+=`
                    <li style="list-style-type: none; margin-bottom: 4px; white-space: nowrap; display: flex; justify-content: space-between;">
                        <span style="${this.objectToSemicolonSeparated(t["l7plot-tooltip__name"])}">${h.name}</span>
                        <span style="${this.objectToSemicolonSeparated(t["l7plot-tooltip__value"])}">${h.value}</span>
                    </li>`});const f=`
                <div>
                <div style="${this.objectToSemicolonSeparated(t["l7plot-tooltip__title"])}">${l.data.name}</div>
                    <ul style="${this.objectToSemicolonSeparated(t["l7plot-tooltip__list"])}">
                        ${c}
                    </ul>
                </div>
            `;if(this.popup.setLngLat({lng:l.centroid[0],lat:l.centroid[1]}),this.popup.setHTML(f),this.popup.closeButton=!1,this.view.addLayer(this.popup),(a=(n=this.view.scene.getLayers())==null?void 0:n.find(h=>h.name==="highlightLayer"))==null||a.setData(this.getActiveData(u)),this.chart.type==="bubble-map"){const{_id:h}=(r=(s=this.view.scene.getLayers())==null?void 0:s.find(g=>g.name==="bubbleLayer"))==null?void 0:r.layerSource.data.dataArray.find(g=>g.name===this.data[u].name);(p=(d=this.view.scene.getLayers())==null?void 0:d.find(g=>g.name==="bubbleLayer"&&g.coordCenter))==null||p.setActive(h,{color:"rgba(30,90,255,1)"})}}}getActiveData(u){var t,e,o;if((e=(t=this.drawOption)==null?void 0:t.areaId)!=null&&e.startsWith("custom_")){const i={type:"FeatureCollection",features:[]},l=this.customSubArea.find(a=>a.name===this.data[u].areaName),n=this.view.currentDistrictData.features.reduce((a,s)=>(a["156"+s.properties.adcode]=s,a),{});return(o=l==null?void 0:l.scopeArr)==null||o.forEach(a=>{n[a]&&i.features.push(n[a])}),i}return{type:"FeatureCollection",features:[this.view.currentDistrictData.features.find(i=>i.properties.name===this.data[u].name)]}}getPopupData(u){var t,e,o,i;if((e=(t=this.drawOption)==null?void 0:t.areaId)!=null&&e.startsWith("custom_")){const l=this.data[u],n=(o=this.customSubArea)==null?void 0:o.find(a=>a.name===l.areaName);return l.name=l.areaName,{data:l,centroid:n.centroid}}else return{data:this.data[u],centroid:(i=this.view.currentDistrictData.features.find(l=>l.properties.name===this.data[u].name))==null?void 0:i.properties.centroid}}objectToSemicolonSeparated(u){let t="";for(const e in u)u.hasOwnProperty(e)&&(t+=`${this.convertToSnakeCase(e)}:${u[e]};`);return t}cancelHighlightLayer(u){var t,e,o,i,l,n,a,s,r,d,p,c,f;if((o=(e=(t=this.view.scene)==null?void 0:t.getLayers())==null?void 0:e.find(h=>h.name==="highlightLayer"))==null||o.setData({type:"FeatureCollection",features:[]}),this.chart.type==="bubble-map"){const{_id:h}=(n=(l=(i=this.view.scene)==null?void 0:i.getLayers())==null?void 0:l.find(g=>g.name==="bubbleLayer"))==null?void 0:n.layerSource.data.dataArray.find(g=>g.name===this.data[u].name);(s=(a=this.view.scene.getLayers())==null?void 0:a.find(g=>g.name==="bubbleLayer"&&g.coordCenter))==null||s.setActive(h,{color:this.view.scene.getLayers().find(g=>g.name==="bubbleLayer").styleAttributeService.getLayerStyleAttribute("color").scale.field})}if(this.chart.type==="symbolic-map"){const h=this.chart.xAxis[0].dataeaseName,g=this.chart.xAxis[1].dataeaseName,{_id:y}=(p=(d=(r=this.scene)==null?void 0:r.getLayers())==null?void 0:d.find(x=>x.type==="PointLayer"))==null?void 0:p.layerSource.data.dataArray.find(x=>{const b=this.data[u][h],S=this.data[u][g];return x[h]===b&&x[g]===S});(f=(c=this.scene.getLayers())==null?void 0:c.find(x=>x.type==="PointLayer"&&x.coordCenter))==null||f.setActive(y,{color:this.scene.getLayers().find(x=>x.type==="PointLayer").styleAttributeService.getLayerStyleAttribute("color").scale.field})}}convertToSnakeCase(u){return u.replace(/([A-Z])/g,t=>"-"+t.toLowerCase())}getTooltipItems(u){var a,s,r,d;const t=[],i=(a=L(this.chart.customAttr).tooltip.seriesTooltipFormatter)==null?void 0:a.filter(p=>p.show).reduce((p,c)=>(p[c.id]=c,p),{});if(Y(i))return t;const l=u,n=i[(r=(s=l.quotaList)==null?void 0:s[0])==null?void 0:r.id];if(!Y(n)){const p=parseFloat(l.value),c=D(p,n.formatterCfg),f=Y(n.chartShowName)?n.name:n.chartShowName;t.push({...l,name:f,value:`${c??""}`})}return(d=l.dynamicTooltipValue)==null||d.forEach(p=>{const c=i[p.fieldId];if(c){const f=D(parseFloat(p.value),c.formatterCfg),h=Y(c.chartShowName)?c.name:c.chartShowName;t.push({color:"grey",name:h,value:`${f??""}`})}}),t}createSymbolicMapPopup(u){const t=()=>{var l,n,a,s,r,d;const i=this.chart.customAttr?L(this.chart.customAttr):null;if((l=i==null?void 0:i.tooltip)!=null&&l.show){if(!this.popup)return;const{tooltip:p}=it(i);let c=p.showFields||[];(!p.showFields||p.showFields.length===0)&&(c=[...this.chart.xAxisExt.map(S=>`${S.dataeaseName}@${S.name}`),...this.chart.xAxis.map(S=>`${S.dataeaseName}@${S.name}`)]);const f=document.createElement("style");f.id="style-"+this.chart.container,f.innerHTML=`
          #${this.chart.container} .l7-popup-content {
            background-color: ${p.backgroundColor} !important;
            padding: 6px 10px 6px;
            line-height: 1.6;
          }
          #${this.chart.container} .l7-popup-tip {
           border-top-color: ${p.backgroundColor} !important;
          }
        `,document.head.appendChild(f);const h=this.chart.xAxis[0].dataeaseName,g=this.chart.xAxis[1].dataeaseName,y=`<div style='font-size:${p.fontSize}px;color:${p.color};'>`,x="</div>",b=this.view.sourceOption.data[u];if(b&&((n=b.details)!=null&&n.length)){const S={...b,...Object.fromEntries(o(b.details))},A=e(p,S,c),v=`${y}${A}${x}`;this.popup.setLngLat({lng:b[h],lat:b[g]}),this.popup.setHTML(v),this.popup.closeButton=!1,this.scene.addPopup(this.popup),this.popup.addTo(this.scene);const{_id:C}=(s=(a=this.scene.getLayers())==null?void 0:a.find(T=>T.type==="PointLayer"))==null?void 0:s.layerSource.data.dataArray.find(T=>{const k=this.data[u][h],O=this.data[u][g];return T[h]===k&&T[g]===O});(d=(r=this.scene.getLayers())==null?void 0:r.find(T=>T.type==="PointLayer"&&T.coordCenter))==null||d.setActive(C,{color:"rgba(30,90,255,1)"})}}},e=(i,l,n)=>{let a="";return i.customContent?(a=i.customContent,n.forEach(s=>{a=a.replace(`\${${s.split("@")[1]}}`,l[s.split("@")[0]])})):n.forEach(s=>{a+=`<span style="margin-bottom: 4px">${s.split("@")[1]}: ${l[s.split("@")[0]]}</span><br>`}),a.replace(/\n/g,"<br>")},o=i=>{const l=new Map;return i.forEach(n=>{Object.entries(n).forEach(([a,s])=>{if(l.has(a)){const r=l.get(a);r!==s&&l.set(a,`${r}, ${s}`)}else l.set(a,s)})}),l};t()}}const bn=Object.freeze(Object.defineProperty({__proto__:null,CarouselManager:Yi,carouselManagerInstances:me,configCarouselTooltip:co},Symbol.toStringTag,{value:"Module"})),{t:Ie}=U();class Sn extends Hi{constructor(){super("bubble-map");w(this,"properties",[...Wi,"bubble-animate"]);w(this,"propertyInner",{...Pt,"tooltip-selector":[...Pt["tooltip-selector"],"carousel"],"basic-style-selector":[...Pt["basic-style-selector"],"areaBaseColor"]});w(this,"axis",Vi);w(this,"axisConfig",{xAxis:{name:`${Ie("chart.area")} / ${Ie("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Ie("chart.bubble_size")} / ${Ie("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var y;const{chart:e,level:o,areaId:i,container:l,action:n,scope:a}=t;if(!i)return;e.container=l;let s={},r=[],d=(y=e.data)==null?void 0:y.data;if(i.startsWith("custom_")){r=(await fi(i)).data||[],r.forEach(v=>{var C;return v.scopeArr=((C=v.scope)==null?void 0:C.split(","))||[]}),s=Z(await fe("156"));const x=s.features.reduce((v,C)=>(v["156"+C.properties.adcode]=C.properties.name,v),{}),{areaMapping:b}=L(e.senior),S=r.reduce((v,C)=>{var k,O;const T=(k=b==null?void 0:b[i])==null?void 0:k[C.name];return T&&(C.name=T),v[C.name]=C,C.scopeArr=((O=C.scope)==null?void 0:O.split(","))||[],v},{}),A=[];d==null||d.forEach(v=>{const C=S[v.name];C&&C.scopeArr.forEach(T=>{A.push({...v,name:x[T],field:x[T],scope:C.scopeArr,areaName:v.name})})}),d=A}else a?(s=Z(await fe("156")),s.features=s.features.filter(x=>a.includes("156"+x.properties.adcode))):s=Z(await fe(i));let p={preserveDrawingBuffer:!0,map:{type:"mapbox",style:"blank"},geoArea:{type:"geojson"},source:{data:d||[],joinBy:{sourceField:"name",geoField:"name",geoData:s}},viewLevel:{level:o,adcode:"all"},autoFit:!0,chinaBorder:!1,color:{field:"value"},style:{opacity:1,lineWidth:.6,lineOpacity:1},label:{field:"_DE_LABEL_",style:{textAnchor:"center"}},tooltip:{},legend:!1,customFetchGeoData:()=>null};const c={drawOption:t,geoJson:s,customSubArea:r};p=this.setupOptions(e,p,c);const f=it(p.tooltip);p={...p,tooltip:{...f,showComponent:!1}};const h=new Yl(l,p),g=this.getDotLayer(e,s,t,r);return i.startsWith("custom_")||(g.options={...g.options,tooltip:f}),this.configZoomButton(e,h),Te(l),h.once("loaded",()=>{h.scene.map._canvasContainer.lastElementChild.style.cursor="default";const{layers:x}=c;x&&x.forEach(b=>{h.addLayer(b)}),g.addToScene(h.scene),g.once("add",()=>{pe(l)}),h.scene.map.keyboard.disable(),g.on("dotLayer:click",b=>{var C;const S=b.feature.properties;let A,v;if(i.startsWith("custom_")){A="156";const T=r.find(k=>k.name===S.name);v=T==null?void 0:T.scopeArr}else A=(C=h.currentDistrictData.features.find(T=>T.properties.name===b.feature.properties.name))==null?void 0:C.properties.adcode;n({x:b.x,y:b.y,data:{data:S,extra:{adcode:A,scope:v}}})}),g.once("loaded",()=>{e.container=l,co(e,h,d||[],null,r,t)})}),h}getDotLayer(t,e,o,i){var f,h,g,y,x;const{areaId:l}=o,{basicStyle:n,tooltip:a}=L(t.customAttr),{bubbleCfg:s}=L(t.senior),{offsetHeight:r,offsetWidth:d}=document.getElementById(o.container),p=[],c={source:{data:p,parser:{type:"json",x:"x",y:"y"}},shape:"circle",size:{field:"size",value:[5,Math.min(r,d)/20]},visible:!0,zIndex:.05,color:P(n.colors[0],n.alpha),name:"bubbleLayer",style:{opacity:1},state:{active:{color:"rgba(30,90,255,1)"}},tooltip:{showComponent:a.show}};if(l.startsWith("custom_")){const b=e.features.reduce((v,C)=>(C.properties.adcode&&(v["156"+C.properties.adcode]=C),v),{}),{areaMapping:S}=L(t.senior),A=i.reduce((v,C)=>{var k;const T=(k=S==null?void 0:S[l])==null?void 0:k[C.name];return T&&(C.name=T),v[C.name]=C,v},{});if((h=(f=t.data)==null?void 0:f.data)==null||h.forEach(v=>{var T;const C=A[v.name];if(C){const k=[];if((T=C.scopeArr)==null||T.forEach(O=>{const R=b[O];R&&k.push(R)}),k.length){const R=Xe({type:"FeatureCollection",features:k});C.centroid=[R.geometry.coordinates[0],R.geometry.coordinates[1]],p.push({name:C.name,size:v.value,properties:v,x:R.geometry.coordinates[0],y:R.geometry.coordinates[1]})}}}),c.tooltip&&c.tooltip.showComponent){c.tooltip.items=["name","adcode","value"],c.tooltip.customTitle=({name:C})=>C;const v=(g=a.seriesTooltipFormatter)==null?void 0:g.filter(C=>C.show).reduce((C,T)=>(C[T.id]=T,C),{});c.tooltip.customItems=C=>{var R,_,B;const T=[];if(Y(v))return T;const k=C.properties,O=v[(_=(R=k.quotaList)==null?void 0:R[0])==null?void 0:_.id];if(!Y(O)){const E=parseFloat(k.value),z=D(E,O.formatterCfg),N=Y(O.chartShowName)?O.name:O.chartShowName;T.push({...k,name:N,value:`${z??""}`})}return(B=k.dynamicTooltipValue)==null||B.forEach(E=>{const z=v[E.fieldId];if(z){const N=D(parseFloat(E.value),z.formatterCfg),F=Y(z.chartShowName)?z.name:z.chartShowName;T.push({color:"grey",name:F,value:`${N??""}`})}}),T},c.tooltip.domStyles={"l7plot-tooltip":{"background-color":a.backgroundColor,"font-size":`${a.fontSize}px`,"line-height":1.6},"l7plot-tooltip__name":{color:a.color},"l7plot-tooltip__value":{color:a.color},"l7plot-tooltip__title":{color:a.color}}}}else{const b=(x=(y=t.data)==null?void 0:y.data)==null?void 0:x.reduce((S,A)=>(S[A.field]={value:A.value,data:A},S),{});e.features.forEach(S=>{var v;const A=S.properties.name;(v=b==null?void 0:b[A])!=null&&v.value&&p.push({x:S.properties.centroid[0],y:S.properties.centroid[1],size:b[A].value,properties:b[A].data,name:A})})}return s&&s.enable?new Go({...c,size:{field:"size",value:[10,Math.min(r,d)/10]},animate:{enable:!0,speed:s.speed,rings:s.rings}}):new Go(c)}configBasicStyle(t,e,o){var c,f,h,g;const{areaId:i}=o.drawOption,l=o.geoJson,{basicStyle:n,label:a}=L(t.customAttr),r=(c=L(t.senior).areaMapping)==null?void 0:c[i];if(Ei(l,r),e.color=n.areaBaseColor,!((h=(f=t.data)==null?void 0:f.data)!=null&&h.length)||!((g=l==null?void 0:l.features)!=null&&g.length))return e.label&&(e.label.field="name"),e;const p=t.data.data.reduce((y,x)=>(y[x.field]=x.value,y),{});return l.features.forEach(y=>{const x=y.properties.name;if(a.show){const b=[];a.showDimension&&b.push(x),a.showQuota&&(p[x]||p[x]===0)&&b.push(D(p[x],a.quotaLabelFormatter)),y.properties._DE_LABEL_=b.join(`

`)}}),e}configCustomArea(t,e,o){var p;const{drawOption:i,customSubArea:l,geoJson:n}=o;if(!i.areaId.startsWith("custom_"))return e;const a=L(t.customAttr),{label:s}=a,r=(p=t.data)==null?void 0:p.data,d=r==null?void 0:r.reduce((c,f)=>(c[f.field]=f,c),{});if(e.label={visible:!1},s.show){const c=n.features.reduce((y,x)=>(x.properties.adcode&&(y["156"+x.properties.adcode]=x),y),{}),{areaMapping:f}=L(t.senior),h=[];l.forEach(y=>{var b,S;const x=[];if((b=y.scopeArr)==null||b.forEach(A=>{const v=c[A];v&&x.push(v)}),x.length){const A={type:"FeatureCollection",features:x},v=[];if(s.showDimension){const T=(S=f==null?void 0:f[i.areaId])==null?void 0:S[y.name];T&&(y.name=T),v.push(y.name)}s.showQuota&&d[y.name]&&v.push(D(d[y.name].value,s.quotaLabelFormatter));const C=Xe(A);h.push({name:v.join(`

`),x:C.geometry.coordinates[0],y:C.geometry.coordinates[1]})}});const g=new xi({name:"areaLabelLayer",source:{data:h,parser:{type:"json",x:"x",y:"y"}},field:"name",zIndex:.06,style:{fill:s.color,fontSize:s.fontSize,opacity:1,fontWeight:"bold",textAnchor:"center",textAllowOverlap:s.fullDisplay,padding:s.fullDisplay?void 0:[2,2]}});o.layers=[g]}return e}setupOptions(t,e,o){return Q(this.configEmptyDataStrategy,this.configLabel,this.configStyle,this.configTooltip,this.configBasicStyle,this.configCustomArea)(t,e,o,this)}}const An=Object.freeze(Object.defineProperty({__proto__:null,BubbleMap:Sn},Symbol.toStringTag,{value:"Module"})),be=vl();class It extends Rs{constructor(t,e){super();w(this,"config");w(this,"scene",null);w(this,"destroy",()=>{var t;this.chartInstance&&((t=this.chartInstance)==null||t.destroy())});w(this,"render",()=>{var t;this.scene&&this.config&&(this.scene.loaded?Array.isArray(this.config)?(t=this.config)==null||t.forEach(e=>{this.handleConfig(e)}):this.handleConfig(this.config):this.scene.on("loaded",()=>{var e;Array.isArray(this.config)?(e=this.config)==null||e.forEach(o=>{this.handleConfig(o)}):this.handleConfig(this.config)}))});w(this,"handleConfig",t=>{var e;t&&(t.handleConfig?(e=t.handleConfig)==null||e.call(t,this.scene):this.scene.addLayer(t))});this.chartInstance=t,this.config=e,this.scene=t}getScene(){return this.scene}}class Yo extends ro{constructor(t,e){super(Vt.L7,t,e);w(this,"getMapKey",async()=>(be.mapKey.key||await as().then(t=>be.setKey(t.data)),be.mapKey.securityCode&&(window._AMapSecurityConfig={securityJsCode:be.mapKey.securityCode}),be.mapKey))}configEmptyDataStrategy(t,e){const{functionCfg:o}=L(t.senior),i=o.emptyDataStrategy;if(!i||i==="breakLine")return e;const l=Z(e.sourceOption.data);if(i==="setZero"&&l.forEach(n=>{n.value===null&&(n.value=0)}),i==="ignoreData")for(let n=l.length-1;n>=0;n--)l[n].value===null&&l.splice(n,1);return e.sourceOption.data=l,e}configZoomButton(t,e){_s(t,e)}configLabel(t,e){const o=Li(t);return Nt(e.label,o),e}configTooltip(t,e){const o=Ti(t);return Nt(e.tooltip,o),e}}const{t:Et}=U();class Cn extends Yo{constructor(){super("flow-map",[]);w(this,"properties",["background-overall-component","border-style","basic-style-selector","title-selector","flow-map-line-selector","flow-map-point-selector","bubble-animate"]);w(this,"propertyInner",{...Pt,"basic-style-selector":["mapBaseStyle","mapLineStyle","zoom","showLabel","autoFit","mapCenter","zoomLevel"]});w(this,"axis",["xAxis","xAxisExt","filter","flowMapStartName","flowMapEndName","yAxis"]);w(this,"axisConfig",{xAxis:{name:`${Et("chart.start_coordinates")} / ${Et("chart.dimension")}`,type:"d",limit:2},xAxisExt:{name:`${Et("chart.end_coordinates")} / ${Et("chart.dimension")}`,type:"d",limit:2},flowMapStartName:{name:`${Et("chart.start_name")} / ${Et("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},flowMapEndName:{name:`${Et("chart.end_name")} / ${Et("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},yAxis:{name:`${Et("chart.flow_map_line_width")} / ${Et("chart.quota")}`,type:"q",limit:1,tooltip:Et("chart.flow_map_line_width_tip"),allowEmpty:!0}});w(this,"lineConfig",(t,e,o,i,l)=>{var g;const n={type:l.flowMapConfig.lineConfig.mapLineType,size:l.flowMapConfig.lineConfig.mapLineType==="line"?l.flowMapConfig.lineConfig.mapLineWidth/2:l.flowMapConfig.lineConfig.mapLineWidth,animate:l.flowMapConfig.lineConfig.mapLineAnimate,animateDuration:l.flowMapConfig.lineConfig.mapLineAnimateDuration,gradient:l.flowMapConfig.lineConfig.mapLineGradient,sourceColor:l.flowMapConfig.lineConfig.mapLineSourceColor,targetColor:l.flowMapConfig.lineConfig.mapLineTargetColor,alpha:l.flowMapConfig.lineConfig.alpha},a=i.colors.map(y=>P(y,l.flowMapConfig.lineConfig.alpha));n.sourceColor=a[0],n.targetColor=a[1];let s=null;const r=it(t.yAxis);r.length>0&&(s=r[0].dataeaseName);let d=null;const p=it(t.yAxisExt);p.length>0&&(d=p[0].dataeaseName);const c="*",f=[];(g=t.data)==null||g.tableRow.forEach(y=>{const x="f_record",b=Object.keys(y).reduce((S,A)=>(A===c?S[x]=y[A]:S[A]=y[A],S),{});f.push(b)});const h=new ql({name:"line",blend:"normal",autoFit:i.autoFit!==!1}).source(f,{parser:{type:"json",x:e[0].dataeaseName,y:e[1].dataeaseName,x1:o[0].dataeaseName,y1:o[1].dataeaseName}}).size(n.size).shape(n.type).animate({enable:n.animate,duration:n.animateDuration,interval:1,trailLength:1});return s&&h.size(s===c?"f_record":s,[1,10]),d?(h.style({opacity:n.alpha/100}),h.color(d)):n.gradient?h.style({sourceColor:n.sourceColor,targetColor:n.targetColor,opacity:n.alpha/100}):h.style({opacity:n.alpha/100}).color(n.sourceColor),h});w(this,"startAndEndNameConfig",(t,e,o,i,l)=>{var p,c;const n=it(t.flowMapStartName),a=it(t.flowMapEndName),s=i.flowMapConfig.pointConfig.text.color,r=i.flowMapConfig.pointConfig.text.fontSize,d=new Map;if((n==null?void 0:n.length)>0){const f=new ae().source((p=t.data)==null?void 0:p.tableRow,{parser:{type:"json",x:e[0].dataeaseName,y:e[1].dataeaseName}}).shape(n[0].dataeaseName,h=>d.has("from-"+h)?"":(d.set("from-"+h,h),h)).size(r).color(s).style({textAnchor:"top",textOffset:[0,0],spacing:2,padding:[1,1],textAllowOverlap:!0,fontFamily:t.fontFamily?t.fontFamily:void 0});l.push(f)}if((a==null?void 0:a.length)>0){const f=new ae().source((c=t.data)==null?void 0:c.tableRow,{parser:{type:"json",x:o[0].dataeaseName,y:o[1].dataeaseName}}).shape(a[0].dataeaseName,h=>d.has("from-"+h)||d.has("to-"+h)?"":(d.set("to-"+h,h),h)).size(r).color(s).style({textAnchor:"top",textOffset:[0,0],spacing:2,padding:[1,1],textAllowOverlap:!0,fontFamily:t.fontFamily?t.fontFamily:void 0});l.push(f)}});w(this,"pointConfig",(t,e,o,i,l)=>{var p,c;const n=i.flowMapConfig.pointConfig.point.color,a=i.flowMapConfig.pointConfig.point.size,{bubbleCfg:s}=L(t.senior),r=new ae({zIndex:-1}).source((p=t.data)==null?void 0:p.tableRow,{parser:{type:"json",x:e[0].dataeaseName,y:e[1].dataeaseName}}).shape("circle").size(a).color(n).style({blur:.6}),d=new ae({zIndex:-1}).source((c=t.data)==null?void 0:c.tableRow,{parser:{type:"json",x:o[0].dataeaseName,y:o[1].dataeaseName}}).shape("circle").size(a).color(n).style({blur:.6});if(s&&s.enable){const f={enable:!0,speed:s.speed,rings:s.rings};r.size(a*2),r.animate(f),d.size(a*2),d.animate(f)}l.push(r),l.push(d)})}async drawChart(t){var y,x;const{chart:e,container:o}=t,i=document.getElementById(o),l=i==null?void 0:i.getBoundingClientRect();if((l==null?void 0:l.height)<=0)return new It((y=t.chartObj)==null?void 0:y.getScene(),[]);const n=it(e.xAxis),a=it(e.xAxisExt),{basicStyle:s,misc:r}=it(L(e.customAttr));let d=[ct.mapCenter.longitude,ct.mapCenter.latitude];s.autoFit===!1&&(d=[s.mapCenter.longitude,s.mapCenter.latitude]);let p=s.mapStyleUrl;s.mapStyle!=="custom"&&(p=`amap://styles/${s.mapStyle?s.mapStyle:"normal"}`);const c=await this.getMapKey(),f=t.chartObj;let h=f==null?void 0:f.getScene();if(h?((x=h.getLayers())!=null&&x.length&&(await h.removeAllLayer(),h.setPitch(r.mapPitch),h.setMapStyle(p),h.map.showLabel=s.showLabel!==!1),s.autoFit===!1&&h.setZoomAndCenter(s.zoomLevel,d)):h=new $o({id:o,logoVisible:!1,map:new Po({token:(c==null?void 0:c.key)??void 0,style:p,pitch:r.mapPitch,center:s.autoFit===!1?d:void 0,zoom:s.autoFit===!1?s.zoomLevel:void 0,showLabel:s.showLabel!==!1,WebGLParams:{preserveDrawingBuffer:!0}})}),Te(o),h.once("loaded",()=>{pe(o)}),this.configZoomButton(e,h),(n==null?void 0:n.length)<2||(a==null?void 0:a.length)<2)return new It(h,void 0);const g=[];return g.push(this.lineConfig(e,n,a,s,r)),this.startAndEndNameConfig(e,n,a,r,g),this.pointConfig(e,n,a,r,g),g[0].once("inited",()=>{pe(o)}),new It(h,g)}setupDefaultOptions(t){return t.customAttr.misc.flowMapConfig.lineConfig.mapLineAnimate=!0,t}}const wn=Object.freeze(Object.defineProperty({__proto__:null,FlowMap:Cn},Symbol.toStringTag,{value:"Module"})),{t:Be}=U();class vn extends Yo{constructor(){super("heat-map",[]);w(this,"properties",["background-overall-component","border-style","basic-style-selector","title-selector"]);w(this,"propertyInner",{...Pt,"basic-style-selector":["colors","heatMapStyle","zoom","showLabel","autoFit","mapCenter","zoomLevel"]});w(this,"axis",["xAxis","yAxis","filter"]);w(this,"axisConfig",{xAxis:{name:`${Be("chart.longitude_and_latitude")} / ${Be("chart.dimension")}`,type:"d",limit:2},yAxis:{name:`${Be("chart.chart_data")} / ${Be("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var y,x,b;const{chart:e,container:o}=t,i=document.getElementById(o),l=i==null?void 0:i.getBoundingClientRect();if((l==null?void 0:l.height)<=0)return new It((y=t.chartObj)==null?void 0:y.getScene(),[]);const n=it(e.xAxis),a=it(e.yAxis);let s,r;e.customAttr&&(s=L(e.customAttr).basicStyle,r=L(e.customAttr).misc);let d=[ct.mapCenter.longitude,ct.mapCenter.latitude];s.autoFit===!1&&(d=[s.mapCenter.longitude,s.mapCenter.latitude]);let p=s.mapStyleUrl;s.mapStyle!=="custom"&&(p=`amap://styles/${s.mapStyle?s.mapStyle:"normal"}`);const c=await this.getMapKey(),f=t.chartObj;let h=f==null?void 0:f.getScene();if(h?(x=h.getLayers())!=null&&x.length&&(await h.removeAllLayer(),h.setPitch(r.mapPitch),h.setMapStyle(p),h.map.showLabel=s.showLabel!==!1,s.autoFit===!1&&h.setZoomAndCenter(s.zoomLevel,d)):h=new $o({id:o,logoVisible:!1,map:new Po({token:(c==null?void 0:c.key)??void 0,style:p,pitch:r.mapPitch,center:d,zoom:s.autoFit===!1?s.zoomLevel:void 0,showLabel:s.showLabel!==!1,WebGLParams:{preserveDrawingBuffer:!0}})}),Te(o),h.once("loaded",()=>{pe(o)}),this.configZoomButton(e,h),(n==null?void 0:n.length)<2||(a==null?void 0:a.length)<1)return new It(h,void 0);const g=new jl({name:"line",blend:"normal",autoFit:s.autoFit!==!1}).source((b=e.data)==null?void 0:b.data,{parser:{type:"json",x:"x",y:"y"}}).size("value",[0,1]).shape(s.heatMapType??ct.heatMapType);return g.style({intensity:s.heatMapIntensity??ct.heatMapIntensity,radius:s.heatMapRadius??ct.heatMapRadius,rampColors:{colors:s.colors.reverse(),positions:[0,.11,.22,.33,.44,.55,.66,.77,.88,1]}}),new It(h,g)}setupOptions(t,e){return Q(this.configEmptyDataStrategy)(t,e)}}const _n=Object.freeze(Object.defineProperty({__proto__:null,HeatMap:vn},Symbol.toStringTag,{value:"Module"})),{t:Re}=U();let Ln=class extends Hi{constructor(){super("map",[]);w(this,"properties",[...Wi,"legend-selector"]);w(this,"propertyInner",{...Pt,"basic-style-selector":["colors","alpha","areaBorderColor","areaBaseColor","zoom","gradient-color"],"legend-selector":["icon","fontSize","color"],"tooltip-selector":[...Pt["tooltip-selector"],"carousel"]});w(this,"axis",Vi);w(this,"axisConfig",{xAxis:{name:`${Re("chart.area")} / ${Re("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Re("chart.chart_data")} / ${Re("chart.quota")}`,type:"q",limit:1}});w(this,"createLegendCustomContent",t=>{const o=ve(pi).getElementsByClassName(hi)[0];return t.forEach(i=>{let l="-";if(i.value!=="")if(Array.isArray(i.value))i.value.forEach((r,d)=>{i.value[d]=Number.isNaN(r)||r==="NaN"?"NaN":parseFloat(r).toFixed(0)}),l=i.value.join("-");else{const r=i.value;l=Number.isNaN(r)||r==="NaN"?"NaN":parseFloat(r).toFixed(0)}const n={...i,value:l},a=Mo(gi,n),s=ve(a);s.style.setProperty("--bgColor",i.color),o.appendChild(s)}),o})}async drawChart(t){var b;const{chart:e,level:o,container:i,action:l,scope:n}=t,{areaId:a}=t;if(!a)return;e.container=i;let s=JSON.parse(JSON.stringify(((b=e.data)==null?void 0:b.data)||[]));const{misc:r}=L(e.customAttr),{legend:d}=L(e.customStyle);let p={},c=[];if(a.startsWith("custom_")){c=(await fi(a)).data||[],p=Z(await fe("156"));const S=p.features.reduce((T,k)=>(T["156"+k.properties.adcode]=k.properties.name,T),{}),{areaMapping:A}=L(e.senior),v=c.reduce((T,k)=>{var R,_;const O=(R=A==null?void 0:A[a])==null?void 0:R[k.name];return O&&(k.name=O),T[k.name]=k,k.scopeArr=((_=k.scope)==null?void 0:_.split(","))||[],T},{}),C=[];s.forEach(T=>{const k=v[T.name];k&&k.scopeArr.forEach(O=>{C.push({...T,name:S[O],field:S[O],scope:k.scopeArr,areaName:T.name})})}),s=C}else n?(p=Z(await fe("156")),p.features=p.features.filter(S=>n.includes("156"+S.properties.adcode))):p=Z(await fe(a));let f=[];if(!r.mapAutoLegend&&d.show){let S=r.mapLegendMin,A=r.mapLegendMax,v=9;r.mapLegendRangeType==="custom"&&(A=0,S=0,v=r.mapLegendNumber),We(s,"value",A,S,(C,T)=>{A=C,S=T,l({from:"map",data:{max:A,min:S??Uo(s,"value"),legendNumber:v}})}),f=So(s,A,S)}else f=s;let h={preserveDrawingBuffer:!0,map:{type:"mapbox",style:"blank"},geoArea:{type:"geojson"},source:{data:f,joinBy:{sourceField:"name",geoField:"name",geoData:p}},viewLevel:{level:o,adcode:"all"},autoFit:!0,chinaBorder:!1,color:{field:"value"},style:{opacity:1,lineWidth:.6,lineOpacity:1},label:{field:"_DE_LABEL_",style:{textAnchor:"center"}},state:{active:{stroke:"green",lineWidth:1}},tooltip:{},customFetchGeoData:()=>null};const g={drawOption:t,geoJson:p,customSubArea:c};h=this.setupOptions(e,h,g);const{Choropleth:y}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(S=>S.X),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),x=new y(i,h);return this.configZoomButton(e,x),Te(i),x.once("loaded",()=>{pe(i);const{layers:S}=g;S&&S.forEach(A=>{x.addLayer(A)}),x.scene.map.keyboard.disable(),x.on("fillAreaLayer:click",A=>{const v=A.feature.properties;a.startsWith("custom_")&&(v.name=v.areaName,v.adcode="156"),l({x:A.x,y:A.y,data:{data:v,extra:{adcode:v.adcode,scope:v.scope}}})}),e.container=i,co(e,x,f,null,c,t)}),x}configBasicStyle(t,e,o){var A,v,C,T;const{areaId:i}=o.drawOption,l=o.geoJson,{basicStyle:n,label:a,misc:s}=L(t.customAttr),d=(A=L(t.senior).areaMapping)==null?void 0:A[i];if(Ei(l,d),e.color={field:"value",value:[n.colors[0]],scale:{type:"quantize",unknown:n.areaBaseColor}},!((C=(v=t.data)==null?void 0:v.data)!=null&&C.length)||!((T=l==null?void 0:l.features)!=null&&T.length))return e.label&&(e.label.field="name"),e;const p=e.source.data,c=n.colors.map(k=>P(k,n.alpha)),{legend:f}=L(t.customStyle);let h=p,g=[],y=s.mapLegendMin,x=s.mapLegendMax,b=s.mapLegendNumber;f.show?(We(p,"value",x,y,(k,O)=>{x=k,y=O,b=9}),s.mapAutoLegend?b=9:h=So(p,x,y),g=_l(y,x,b,c)):g=c;const S=h.reduce((k,O)=>(k[O.field]=O.value,k),{});return l.features.forEach(k=>{const O=k.properties.name;if(a.show){const R=[];a.showDimension&&R.push(O),a.showQuota&&(S[O]||S[O]===0)&&R.push(D(S[O],a.quotaLabelFormatter)),k.properties._DE_LABEL_=R.join(`

`)}}),g.length&&(e.color.value=g.map(k=>k.color?k.color:k),g[0].value&&!s.mapAutoLegend&&(e.color.scale.domain=[y??Uo(p,"value"),x])),e}customConfigLegend(t,e,o){const{basicStyle:i,misc:l}=L(t.customAttr),n=i.colors.map(d=>P(d,i.alpha));if(i.suspension===!1&&i.showZoom===void 0)return e;const{legend:a}=L(t.customStyle);if(!a.show)return e;const s={circle:{borderRadius:"50%"},square:{},triangle:{border:"unset",borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottom:"10px solid var(--bgColor)",background:"unset"},diamond:{transform:"rotate(45deg)"}},r={position:"bottomleft",domStyles:{"l7plot-legend__category-value":{fontSize:a.fontSize+"px",color:a.color,"font-family":t.fontFamily?t.fontFamily:void 0},"l7plot-legend__category-marker":{...s[a.icon],width:a.size+"px",height:a.size+"px",...a.icon==="triangle"?{...s[a.icon].triangle,borderLeft:`${a.size/2}px solid transparent`,borderRight:`${a.size/2}px solid transparent`,borderBottom:`${a.size}px solid var(--bgColor)`}:{border:"0.01px solid #f4f4f4"},...a.icon==="diamond"?{transform:"rotate(45deg)",marginBottom:`${a.size/4}px`}:{}}}};if(!l.mapAutoLegend&&l.mapLegendRangeType==="custom"&&!t.drill){const d=[],p=l.mapLegendCustomRange.slice(0,-1).map((c,f)=>[c,l.mapLegendCustomRange[f+1]]);p.forEach((c,f)=>{const h=[c[0],c[1]],g=f%n.length,y=c[0]<p[0][0]&&c[1]<p[0][0];let x=n[g];y&&(x=i.areaBaseColor),d.push({value:h,color:x})}),r.customContent=(c,f)=>d!=null&&d.length?this.createLegendCustomContent(d):"",e.color.value=({value:c})=>{const f=d.find(h=>c>=h.value[0]&&c<=h.value[1]);return f?f.color:i.areaBaseColor},e.color.scale.domain=[p[0][0],p[p.length-1][1]]}else r.customContent=(d,p)=>{const c=(p==null?void 0:p.length)>30?p.slice(0,30):p;return c!=null&&c.length?this.createLegendCustomContent(c):""};return t.drill&&We(e.source.data,"value",0,0,(d,p)=>{e.color.scale.domain=[p,d]}),Nt(e,{legend:r}),e}configCustomArea(t,e,o){var f;const{drawOption:i,customSubArea:l,geoJson:n}=o;if(!i.areaId.startsWith("custom_"))return e;const a=L(t.customAttr),{label:s}=a,r=t.data.data,d=r==null?void 0:r.reduce((h,g)=>(h[g.field]=g,h),{}),p=n.features.reduce((h,g)=>(g.properties.adcode&&(h["156"+g.properties.adcode]=g),h),{});if(l.forEach(h=>{var y;const g=[];if((y=h.scopeArr)==null||y.forEach(x=>{const b=p[x];b&&g.push(b)}),g.length){const b=Xe({type:"FeatureCollection",features:g});h.centroid=[b.geometry.coordinates[0],b.geometry.coordinates[1]]}}),e.label={visible:!1},s.show){const h=[];l.forEach(y=>{if(y.centroid){const x=[];s.showDimension&&x.push(y.name),s.showQuota&&(d[y.name]||d[y.name]===0)&&x.push(D(d[y.name].value,s.quotaLabelFormatter)),h.push({name:x.join(`

`),x:y.centroid[0],y:y.centroid[1]})}});const g=new xi({name:"areaLabelLayer",source:{data:h,parser:{type:"json",x:"x",y:"y"}},field:"name",style:{fill:s.color,fontSize:s.fontSize,opacity:1,fontWeight:"bold",textAnchor:"center",textAllowOverlap:s.fullDisplay,padding:s.fullDisplay?void 0:[2,2]}});o.layers=[g]}const c=l.reduce((h,g)=>(g.scopeArr.forEach(y=>{h[y]=g.name}),h),{});if(e.tooltip&&e.tooltip.showComponent){e.tooltip.items=["name","adcode","value"],e.tooltip.customTitle=({name:y,adcode:x})=>(x="156"+x,c[x]??y);const g=(f=a.tooltip.seriesTooltipFormatter)==null?void 0:f.filter(y=>y.show).reduce((y,x)=>(y[x.id]=x,y),{});e.tooltip.customItems=y=>{var T,k,O;const x=[];if(Y(g))return x;const b=y.properties,{adcode:S}=b,A=c["156"+S],v=d[A];if(!v)return x;const C=g[(k=(T=v.quotaList)==null?void 0:T[0])==null?void 0:k.id];if(!Y(C)){const R=parseFloat(v.value),_=D(R,C.formatterCfg),B=Y(C.chartShowName)?C.name:C.chartShowName;x.push({...v,name:B,value:`${_??""}`})}return(O=v.dynamicTooltipValue)==null||O.forEach(R=>{const _=g[R.fieldId];if(_){const B=D(parseFloat(R.value),_.formatterCfg),E=Y(_.chartShowName)?_.name:_.chartShowName;x.push({color:"grey",name:E,value:`${B??""}`})}}),x}}return e}setupDefaultOptions(t){return t.customAttr.basicStyle.areaBaseColor="#f4f4f4",t}setupOptions(t,e,o){return Q(this.configEmptyDataStrategy,this.configLabel,this.configStyle,this.configTooltip,this.configBasicStyle,this.customConfigLegend,this.configCustomArea)(t,e,o,this)}};const Tn=Object.freeze(Object.defineProperty({__proto__:null,Map:Ln},Symbol.toStringTag,{value:"Module"})),{t:jt}=U();class En extends Yo{constructor(){super("symbolic-map",[]);w(this,"properties",["background-overall-component","border-style","basic-style-selector","symbolic-style-selector","title-selector","label-selector","tooltip-selector","threshold"]);w(this,"propertyInner",{...Pt,"basic-style-selector":["colors","alpha","mapBaseStyle","zoom","showLabel","autoFit","mapCenter","zoomLevel"],"symbolic-style-selector":["symbolicMapStyle"],"label-selector":["color","fontSize","showFields","customContent"],"tooltip-selector":["color","fontSize","showFields","customContent","show","backgroundColor","carousel"],threshold:["lineThreshold"]});w(this,"axis",["xAxis","xAxisExt","extBubble","filter","extLabel","extTooltip"]);w(this,"axisConfig",{xAxis:{name:`${jt("chart.symbolic_map_coordinates")} / ${jt("chart.dimension")}`,type:"d",limit:2},xAxisExt:{name:`${jt("chart.color")} / ${jt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0},extBubble:{name:`${jt("chart.bubble_size")} / ${jt("chart.quota")}`,type:"q",limit:1,tooltip:jt("chart.symbolic_map_bubble_size_tip"),allowEmpty:!0}});w(this,"buildSymbolicLayer",async(t,e)=>{var R,_;const{basicStyle:o}=L(t.customAttr),i=it(t.xAxis),l=it(t.xAxisExt),n=it(t.extBubble),{mapSymbolOpacity:a,mapSymbolSize:s,mapSymbol:r,mapSymbolStrokeWidth:d,colors:p,alpha:c,mapSymbolSizeMin:f,mapSymbolSizeMax:h}=it(o),g=p.map(B=>P(B,c));let y=0;const x=new Map,b=n.length>0?n[0].dataeaseName:"",{threshold:S}=L(t.senior);let A=[];S.enable&&(A=S.lineThreshold??[]);const v=t.extBubble.map(B=>B.id);A=je(A,B=>v.includes(B.fieldId));const C=g[0],T=[],k=(R=t.data)!=null&&R.tableRow?t.data.tableRow.map((B,E)=>{var F;B._index="_index"+E;const z=B[(F=l[0])==null?void 0:F.dataeaseName];let N=x.get(z);if(N||(N=g[y++%g.length],x.set(z,N)),T[E]=N,A.length>0)for(let I=0;I<A.length;I++){const $=A[I],M=B[$.field.dataeaseName];for(const H of $.conditions){const J=H.value,W=Ll(H.color);if(H.term==="between"){const j=parseFloat(H.min),tt=parseFloat(H.max);j<=M&&M<=tt&&(N=P(W,c),T[E]=N)}else H.term==="lt"?M<J&&(N=P(W,c),T[E]=N):H.term==="le"?M<=J&&(N=P(W,c),T[E]=N):H.term==="gt"?M>J&&(N=P(W,c),T[E]=N):H.term==="ge"?M>=J&&(N=P(W,c),T[E]=N):H.term==="eq"?M===J&&(N=P(W,c),T[E]=N):H.term==="not_eq"&&M!==J&&(N=P(W,c),T[E]=N)}}return{...B,color:N,size:parseInt(B[b])??s,name:z}}):[],O=new ae({autoFit:o.autoFit!==!1}).source(k,{parser:{type:"json",x:i[0].dataeaseName,y:i[1].dataeaseName}}).active(!0);if((_=l[0])!=null&&_.dataeaseName)if(o.mapSymbol==="custom"&&o.customIcon)if(o.customIcon.startsWith("data"))e.removeImage("customIcon"),await e.addImage("customIcon",o.customIcon),O.shape("customIcon");else{const B=new DOMParser;for(let E=0;E<Math.min(T.length,y+1);E++){const z=T[E],N=/(fill="[^"]*")/g,F=o.customIcon.replace(N,""),$=B.parseFromString(F,"image/svg+xml").documentElement;$.setAttribute("fill",z),e.removeImage(`icon-${z}`),await e.addImage(`icon-${z}`,Jo($.outerHTML))}O.shape("color",E=>`icon-${E}`)}else O.shape(r).color("_index",T),O.style({stroke:{field:"color"},strokeWidth:d,opacity:a/10});else if(o.mapSymbol==="custom"&&o.customIcon)if(e.removeImage("customIcon"),o.customIcon.startsWith("data"))await e.addImage("customIcon",o.customIcon),O.shape("customIcon");else{const B=new DOMParser,E=C,z=/(fill="[^"]*")/g,N=o.customIcon.replace(z,""),I=B.parseFromString(N,"image/svg+xml").documentElement;I.setAttribute("fill",E),await e.addImage("customIcon",Jo(I.outerHTML)),O.shape("customIcon")}else O.shape(r).color("_index",T).style({stroke:{field:"color"},strokeWidth:d,opacity:a/10});return b?O.size("size",[f,h]):O.size(s),O});w(this,"mergeDetailsToMap",t=>{const e=new Map;return t.forEach(o=>{Object.entries(o).forEach(([i,l])=>{if(e.has(i)){const n=e.get(i);n!==l&&e.set(i,`${n}, ${l}`)}else e.set(i,l)})}),e});w(this,"clearPopup",t=>{const e=document.getElementById(t);e==null||e.querySelectorAll(".l7-popup").forEach(o=>o.remove())});w(this,"buildTooltip",(t,e,o,i)=>{var n,a;const l=t.customAttr?L(t.customAttr):null;if(this.clearPopup(e),(n=l==null?void 0:l.tooltip)!=null&&n.show){const{tooltip:s}=it(l);let r=s.showFields||[];(!s.showFields||s.showFields.length===0)&&(r=[...t.xAxisExt.map(y=>`${y.dataeaseName}@${y.name}`),...t.xAxis.map(y=>`${y.dataeaseName}@${y.name}`)]);const d="tooltip-"+e,p=document.getElementById(d);p&&(p.remove(),(a=p.parentNode)==null||a.removeChild(p));const c=document.createElement("style");c.id=d,c.innerHTML=`
          #${e} .l7-popup-content {
            background-color: ${s.backgroundColor} !important;
            padding: 6px 10px 6px;
            line-height: 1.6;
            border-top-left-radius: 3px;
          }
          #${e} .l7-popup-tip {
           border-top-color: ${s.backgroundColor} !important;
          }
        `,document.head.appendChild(c);const f=`<div style='font-size:${s.fontSize}px;color:${s.color};font-family: ${t.fontFamily}'>`,h="</div>",g=document.getElementById(e);return g&&g.addEventListener("mousemove",y=>{const x=g.getBoundingClientRect(),b=y.clientX-x.left,S=y.clientY-x.top,A=g.getElementsByClassName("l7-popup");for(let v=0;v<(A==null?void 0:A.length);v++){const C=A[v];C.firstElementChild.style.display="none",C.style.transform="translate(15px, 12px)";const T=g.clientWidth-b<=C.clientWidth+10,k=g.clientHeight-S<=C.clientHeight;let O="";T&&(O+="translateX(-120%) translateY(15%) "),k&&(O+="translateX(15%) translateY(-80%) "),O&&(C.style.transform=O.trim())}}),o.on("touchend",y=>{if(y.lngLat){const x={...y.feature,...Object.fromEntries(this.mergeDetailsToMap(y.feature.details??[]))},b=this.buildTooltipContent(s,x,r),S=new yi({lngLat:y.lngLat,title:"",closeButton:!1,closeOnClick:!0,html:`${f}${b}${h}`});i.addPopup(S)}}),new Ul({anchor:"top-left",className:"l7-popup-"+e,items:[{layer:o,customContent:y=>{const x={...y,...Object.fromEntries(this.mergeDetailsToMap(y.details))},b=this.buildTooltipContent(s,x,r);return`${f}${b}${h}`}}],trigger:"hover"})}});w(this,"buildTooltipContent",(t,e,o)=>{let i="";return t.customContent?(i=t.customContent,o.forEach(l=>{i=i.replace(`\${${l.split("@")[1]}}`,e[l.split("@")[0]])})):o.forEach(l=>{i+=`<span style="margin-bottom: 4px">${l.split("@")[1]}: ${e[l.split("@")[0]]}</span><br>`}),i.replace(/\n/g,"<br>")});w(this,"buildLabel",(t,e)=>{var l,n;const o=it(t.xAxis),i=t.customAttr?L(t.customAttr):null;if((l=i==null?void 0:i.label)!=null&&l.show){const{label:a}=i,s=((n=t.data)==null?void 0:n.tableRow)||[];let r=a.showFields||[];(!a.showFields||a.showFields.length===0)&&(r=[...t.xAxisExt.map(d=>`${d.dataeaseName}@${d.name}`),...t.xAxis.map(d=>`${d.dataeaseName}@${d.name}`)]),s.forEach(d=>{const p={...d,...Object.fromEntries(this.mergeDetailsToMap(d.details))};let c=a.customContent||"";c?r.forEach(f=>{const[h,g]=f.split("@");c=c.replace(`\${${g}}`,p[h])}):c=r.map(f=>p[f.split("@")[0]]).join(","),c=c.replace(/\n/g,""),d.textLayerContent=c}),e.push(new ae().source(s,{parser:{type:"json",x:o[0].dataeaseName,y:o[1].dataeaseName}}).shape("textLayerContent","text").color(a.color).size(a.fontSize).style({textAllowOverlap:a.fullDisplay,textAnchor:"center",textOffset:[0,0],fontFamily:t.fontFamily?t.fontFamily:void 0}))}})}async drawChart(t){var b,S,A,v,C,T,k,O,R;const{chart:e,container:o,action:i}=t,l=document.getElementById(o),n=l==null?void 0:l.getBoundingClientRect();if((n==null?void 0:n.height)<=0)return new It((b=t.chartObj)==null?void 0:b.getScene(),[]);const a=it(e.xAxis);let s,r;e.customAttr&&(s=L(e.customAttr).basicStyle,r=L(e.customAttr).misc);let d=s.mapStyleUrl;s.mapStyle!=="custom"&&(d=`amap://styles/${s.mapStyle?s.mapStyle:"normal"}`);const p=await this.getMapKey();let c=[ct.mapCenter.longitude,ct.mapCenter.latitude];if(s.autoFit===!1&&(c=[s.mapCenter.longitude,s.mapCenter.latitude]),(A=(S=e.chartExtRequest)==null?void 0:S.linkageFilters)!=null&&A.length&&(a==null?void 0:a.length)===2&&((v=e.data)!=null&&v.tableRow.length)){const _=(T=(C=e.data)==null?void 0:C.tableRow)==null?void 0:T[0][e.xAxis[0].dataeaseName],B=(O=(k=e.data)==null?void 0:k.tableRow)==null?void 0:O[0][e.xAxis[1].dataeaseName];c=[_,B]}const f=t.chartObj;let h=f==null?void 0:f.getScene();if(h?((R=h.getLayers())!=null&&R.length&&(await h.removeAllLayer(),h.setPitch(r.mapPitch),h.setMapStyle(d),h.map.showLabel=s.showLabel!==!1),s.autoFit===!1&&h.setZoomAndCenter(s.zoomLevel,c)):h=new $o({id:o,logoVisible:!1,map:new Po({token:(p==null?void 0:p.key)??void 0,style:d,pitch:r.mapPitch,center:c,zoom:s.autoFit===!1?s.zoomLevel:void 0,showLabel:s.showLabel!==!1,WebGLParams:{preserveDrawingBuffer:!0}})}),Te(o),h.once("loaded",()=>{pe(o)}),this.configZoomButton(e,h),(a==null?void 0:a.length)<2)return new It(h,void 0);const g=[],y=await this.buildSymbolicLayer(e,h);g.push(y);const x=this.buildTooltip(e,o,y,h);return x&&h.addPopup(x),this.buildLabel(e,g),y.on("inited",()=>{e.container=o,co(e,y,y.sourceOption.data,h)}),y.on("click",_=>{const B=_.feature,E=[],z=[];e.data.fields.forEach((N,F)=>{Object.keys(B).forEach(I=>{I.startsWith("f_")&&N.dataeaseName===I&&(F===0?E.push({id:N.id,dataeaseName:N.dataeaseName,value:B[I]}):z.push({id:N.id,dataeaseName:N.dataeaseName,value:B[I]}))})}),i({x:_.x,y:_.y,data:{data:{...B,value:z[0].value,name:E[0].id,dimensionList:E,quotaList:z}}})}),new It(h,g)}setupDefaultOptions(t){return t.customAttr.label={...t.customAttr.label,show:!1},t.customAttr.basicStyle={...t.customAttr.basicStyle,mapSymbolOpacity:5,mapStyle:"normal"},t}}const Fn=Object.freeze(Object.defineProperty({__proto__:null,SymbolicMap:En},Symbol.toStringTag,{value:"Module"})),qi=["background-overall-component","border-style","dual-basic-style-selector","x-axis-selector","dual-y-axis-selector","title-selector","legend-selector","label-selector","tooltip-selector","assist-line","function-cfg","jump-set","linkage"],Bt={"background-overall-component":["all"],"border-style":["all"],"label-selector":["fontSize","color"],"tooltip-selector":["fontSize","color","backgroundColor","show"],"dual-basic-style-selector":["colors","alpha","gradient","lineWidth","lineSymbol","lineSymbolSize","lineSmooth","radiusColumnBar","subSeriesColor","seriesColor","columnWidthRatio"],"x-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","splitLine"],"dual-y-axis-selector":["name","color","fontSize","axisLabel","axisLine","splitLine","axisValue","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"function-cfg":["emptyDataStrategy"]},ji=["xAxis","yAxis","drill","filter","extLabel","extTooltip"],Ye={...ct,subAlpha:100,subColorScheme:"fast",subSeriesColor:[],subColors:["#fae800","#00c039","#0482dc","#bb9581","#ff7701","#9c5ec3","#00ccdf","#00c039","#ff7701"],leftLineWidth:2,leftLineSymbol:"circle",leftLineSymbolSize:4,leftLineSmooth:!0},zn=Object.freeze(Object.defineProperty({__proto__:null,CHART_MIX_AXIS_TYPE:ji,CHART_MIX_DEFAULT_BASIC_STYLE:Ye,CHART_MIX_EDITOR_PROPERTY:qi,CHART_MIX_EDITOR_PROPERTY_INNER:Bt},Symbol.toStringTag,{value:"Module"})),{t:bt}=U(),kn=[];class uo extends st{constructor(t="chart-mix"){super(t,kn);w(this,"properties",qi);w(this,"propertyInner",{...Bt,"label-selector":["vPosition","seriesLabelFormatter"],"tooltip-selector":[...Bt["tooltip-selector"],"seriesTooltipFormatter"]});w(this,"axis",[...ji,"xAxisExtRight","yAxisExt"]);w(this,"axisConfig",{xAxis:{name:`${bt("chart.drag_block_type_axis")} / ${bt("chart.dimension")}`,type:"d"},yAxis:{name:`${bt("chart.drag_block_value_axis_left")} / ${bt("chart.column_quota")}`,limit:1,type:"q"},extBubble:{name:`${bt("chart.drag_block_type_axis_right")} / ${bt("chart.dimension")}`,limit:1,type:"d",allowEmpty:!0},yAxisExt:{name:`${bt("chart.drag_block_value_axis_right")} / ${bt("chart.line_quota")}`,limit:1,type:"q",allowEmpty:!0}})}getLeftType(){return"column"}getRightType(){return"line"}async drawChart(t){var S,A,v,C,T,k,O,R,_,B,E,z,N,F;const{chart:e,action:o,container:i}=t;if(!((v=(A=(S=e.data)==null?void 0:S.left)==null?void 0:A.data)!=null&&v.length)&&!((k=(T=(C=e.data)==null?void 0:C.right)==null?void 0:T.data)!=null&&k.length))return;const l=Z((R=(O=e.data)==null?void 0:O.left)==null?void 0:R.data),n=Z((B=(_=e.data)==null?void 0:_.right)==null?void 0:B.data),a=this.getLeftType(),s=this.getRightType(),r=this.name==="chart-mix-group"&&((E=e.xAxisExt)==null?void 0:E.length)>0,d=this.name==="chart-mix-stack"&&((z=e.extStack)==null?void 0:z.length)>0,p="category",c="category",f=_t((N=l[0])==null?void 0:N.data,[]),h=Do(_t((F=n[0])==null?void 0:F.data,[]),I=>({...I,valueExt:I.value})),g={data:[f,h],xField:"field",yField:["value","valueExt"],appendPadding:ft(e),geometryOptions:[{geometry:a,color:[],isGroup:r,isStack:d,seriesField:p},{geometry:s,color:[],seriesField:c}],interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region"}]},y=this.setupOptions(e,g),{DualAxes:x}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(I=>I.a8),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),b=new x(i,y);return b.on("point:click",o),b.on("interval:click",o),yt(e,b),b}configLabel(t,e){var s;const o=Le(t),i={...e};if(!o)return i.geometryOptions&&(i.geometryOptions[0].label=!1,i.geometryOptions[1].label=!1),i;const l=L(t.customAttr).label,n={};return(s=l.seriesLabelFormatter)==null||s.forEach(r=>{n[r.axisType]||(n[r.axisType]=[]),n[r.axisType].push(r)}),["yAxis","yAxisExt"].forEach(r=>{var c;const d=(c=n[r])==null?void 0:c.reduce((f,h)=>(f[h.id]=h,f),{});o.style.fill=Qt.color;const p={fields:[],...o,offsetY:-8,formatter:f=>{var x;if(!((x=l.seriesLabelFormatter)!=null&&x.length))return f.value;const h=d==null?void 0:d[f.quotaList[0].id];if(!h)return f.value;if(!h.show)return;const g=D(f.value,h.formatterCfg),y=new Kt({});return y.addShape({type:"text",attrs:{x:0,y:0,text:g,textAlign:"start",textBaseline:"top",fontSize:h.fontSize,fontFamily:t.fontFamily,fill:h.color}}),y}};i.geometryOptions&&(r==="yAxis"?i.geometryOptions[0].label=p:r==="yAxisExt"&&(i.geometryOptions[1].label=p))}),i}configBasicStyle(t,e){const o=L(t.customAttr),i=Nt(JSON.parse(JSON.stringify(o.basicStyle)),Ye),l=i.lineSmooth,n={size:i.lineSymbolSize,shape:i.lineSymbol,style:{stroke:P("#FFFFFF",i.subAlpha)}},a={lineWidth:i.lineWidth},s=i.leftLineSmooth,r={size:i.leftLineSymbolSize,shape:i.leftLineSymbol,style:{stroke:P("#FFFFFF",i.alpha)}},d={lineWidth:i.leftLineWidth},p={...e,smooth:l,point:n,lineStyle:a};if(p.geometryOptions&&(p.geometryOptions[0].smooth=s,p.geometryOptions[0].point=r,p.geometryOptions[0].lineStyle=d,p.geometryOptions[1].smooth=l,p.geometryOptions[1].point=n,p.geometryOptions[1].lineStyle=a,i.radiusColumnBar==="roundAngle")){const h={radius:[i.columnBarRightAngleRadius,i.columnBarRightAngleRadius,i.columnBarRightAngleRadius,i.columnBarRightAngleRadius]};p.geometryOptions[0].columnStyle=h,p.geometryOptions[1].columnStyle=h}let c;const f=i.columnWidthRatio??ct.columnWidthRatio;return f>=1&&f<=100?c=f/100:f<1?c=1/100:f>100&&(c=1),c&&(p.geometryOptions[0].columnWidthRatio=c),super.name!=="chart-mix-dual-line"&&(p.geometryOptions[0].appendPadding=ft(t)),p}setupDefaultOptions(t){const{customAttr:e,senior:o}=t;return(o.functionCfg.emptyDataStrategy==null||o.functionCfg.emptyDataStrategy==="ignoreData")&&(o.functionCfg.emptyDataStrategy="breakLine"),t}configCustomColors(t,e){const o={...e},i=L(t.customAttr).basicStyle,{seriesColor:l}=i;if(l!=null&&l.length){const a=l.reduce((r,d)=>(r[d.id]=d,r),{}),{yAxis:s}=t;s==null||s.forEach((r,d)=>{const p=a[r.id];p&&(d+1>i.colors.length?i.colors.push(p.color):i.colors[d]=p.color)})}const n=i.colors.map(a=>{const s=P(a,i.alpha);return i.gradient?rt(s,!0,270):s});return o.geometryOptions[0].color=n,o}configSubCustomColors(t,e){var a;const o={...e},i=Nt(L(t.customAttr).basicStyle,Z(Ye)),{subSeriesColor:l}=i;if(l!=null&&l.length){const{yAxisExt:s,extBubble:r}=t,d=l.reduce((c,f)=>(c[f.id]=f,c),{}),{data:p}=e;if(r!=null&&r.length){const c=new Set;(a=p[1])==null||a.forEach(h=>h.category!==null&&c.add(h.category)),[...c].forEach((h,g)=>{const y=d[h];y&&(g+1>i.subColors.length?i.subColors.push(y.color):i.subColors[g]=y.color)})}else s==null||s.forEach((c,f)=>{const h=d[c.id];h&&(f+1>i.subColors.length?i.subColors.push(h.color):i.subColors[f]=h.color)})}const n=i.subColors.map(s=>P(s,i.subAlpha));return o.geometryOptions[1].color=n,o}setupSubSeriesColor(t,e){const o=[],i=new Set,l=t.customAttr.basicStyle.subColors??Ye.subColors,{yAxisExt:n,extBubble:a}=t;return a!=null&&a.length?e==null||e.forEach(s=>{s.value===null||s.category===null||i.has(s.category)||(i.add(s.category),o.push({id:s.category,name:s.category,color:l[(i.size-1)%l.length]}))}):n==null||n.forEach(s=>{i.has(s.id)||(i.add(s.id),o.push({id:s.id,name:s.chartShowName??s.name,color:l[(i.size-1)%l.length]}))}),o}configYAxis(t,e){const o=so(t),i=vi(t),l={...e};if(l.yAxis={},!o)l.yAxis.value=!1;else{l.yAxis.value=void 0,o.position="left";const n=L(t.customStyle).yAxis;o.label&&(o.label.style.textAlign="end",o.label.formatter=s=>D(s,n.axisLabelFormatter));const a=n.axisValue;a!=null&&a.auto?l.yAxis.value=o:l.yAxis.value={...o,min:a.min,max:a.max,minLimit:a.min,maxLimit:a.max,tickCount:a.splitCount}}if(!i)l.yAxis.valueExt=!1;else{l.yAxis.valueExt=void 0,i.position="right";const n=L(t.customStyle).yAxisExt;i.label&&(i.label.style.textAlign="start",i.label.formatter=s=>D(s,n.axisLabelFormatter));const a=n.axisValue;a!=null&&a.auto?l.yAxis.valueExt=i:l.yAxis.valueExt={...i,min:a.min,max:a.max,minLimit:a.min,maxLimit:a.max,tickCount:a.splitCount}}return l}configTooltip(t,e){var a;const i=L(t.customAttr).tooltip;if(!i.show)return{...e,tooltip:!1};const l=(a=i.seriesTooltipFormatter)==null?void 0:a.filter(s=>s.show).reduce((s,r)=>(s[r.id]=r,s),{}),n={shared:!0,showTitle:!0,customItems(s){var p,c;if(!((p=i.seriesTooltipFormatter)!=null&&p.length))return s;const r=s[0];if(!r.data.quotaList)return s;const d=[];return s.filter(f=>l[f.data.quotaList[0].id]).forEach(f=>{const h=l[f.data.quotaList[0].id],g=D(parseFloat(f.value),h.formatterCfg),y=f.data.category;d.push({...f,name:y,value:g})}),(c=r.data.dynamicTooltipValue)==null||c.forEach(f=>{const h=l[f.fieldId];if(h){const g=D(parseFloat(f.value),h.formatterCfg),y=Y(h.chartShowName)?h.name:h.chartShowName;d.push({color:"grey",name:y,value:g})}}),d},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:n}}configLegend(t,e){var i,l,n,a;const o=super.configLegend(t,e);if(o.legend){const s=Z((l=(i=t.data)==null?void 0:i.left)==null?void 0:l.data),r=Z((a=(n=t.data)==null?void 0:n.right)==null?void 0:a.data);o.legend.itemName.formatter=(c,f,h)=>{var y,x;let g;return f.viewId==="left-axes-view"&&c==="value"?g=(y=s[0])==null?void 0:y.categories[0]:f.viewId==="right-axes-view"&&c==="valueExt"&&(g=(x=r[0])==null?void 0:x.categories[0]),f.id=f.id+"__"+h,g===void 0?c:g};const d=L(t.customStyle);let p;d&&d.legend?p=he(JSON.parse(JSON.stringify(d.legend)),zt).size:p=zt.size,o.legend.marker.style=c=>{const f=c.fill??c.stroke;return{r:p,fill:f}}}return o}configAnalyse(t,e){var l,n,a,s;t.data.dynamicAssistLines=Il(_t((n=(l=t.data)==null?void 0:l.left)==null?void 0:n.dynamicAssistLines,[]),_t((s=(a=t.data)==null?void 0:a.right)==null?void 0:s.dynamicAssistLines,[]));const o=_i(t),i={value:je(o,r=>r.yAxisType==="left"),valueExt:je(o,r=>r.yAxisType==="right")};return{...e,annotations:i}}setupOptions(t,e){return Q(this.configTheme,this.configLabel,this.configTooltip,this.configBasicStyle,this.configCustomColors,this.configSubCustomColors,this.configLegend,this.configXAxis,this.configYAxis,this.configAnalyse,this.configEmptyDataStrategy)(t,e)}}class On extends uo{constructor(t="chart-mix-group"){super(t);w(this,"axis",[...this.axis,"xAxisExt"]);w(this,"propertyInner",{...Bt,"label-selector":["vPosition","seriesLabelFormatter"],"tooltip-selector":[...Bt["tooltip-selector"],"seriesTooltipFormatter"]});w(this,"axisConfig",{...this.axisConfig,xAxisExt:{name:`${bt("chart.chart_group")} / ${bt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}})}configCustomColors(t,e){var a;const o={...e},i=L(t.customAttr).basicStyle,{seriesColor:l}=i;if(l!=null&&l.length){const s=l.reduce((c,f)=>(c[f.id]=f,c),{}),{yAxis:r,xAxisExt:d}=t,{data:p}=e;if(d!=null&&d.length){const c=new Set;(a=p[0])==null||a.forEach(h=>h.category!==null&&c.add(h.category)),[...c].forEach((h,g)=>{const y=s[h];y&&(g+1>i.colors.length?i.colors.push(y.color):i.colors[g]=y.color)})}else r==null||r.forEach((c,f)=>{const h=s[c.id];h&&(f+1>i.colors.length?i.colors.push(h.color):i.colors[f]=h.color)})}const n=i.colors.map(s=>{const r=P(s,i.alpha);return i.gradient?rt(r,!0,270):r});return o.geometryOptions[0].color=n,o}setupSeriesColor(t,e){const o=[],i=new Set,l=t.customAttr.basicStyle.colors,{yAxis:n,xAxisExt:a}=t;return a!=null&&a.length?e==null||e.forEach(s=>{s.value===null||s.category===null||i.has(s.category)||(i.add(s.category),o.push({id:s.category,name:s.category,color:l[(i.size-1)%l.length]}))}):n==null||n.forEach(s=>{i.has(s.id)||(i.add(s.id),o.push({id:s.id,name:s.chartShowName??s.name,color:l[(i.size-1)%l.length]}))}),o}}class Nn extends uo{constructor(t="chart-mix-stack"){super(t);w(this,"axis",[...this.axis,"extStack"]);w(this,"propertyInner",{...Bt,"label-selector":["vPosition","seriesLabelFormatter"],"tooltip-selector":[...Bt["tooltip-selector"],"seriesTooltipFormatter"]});w(this,"axisConfig",{...this.axisConfig,extStack:{name:`${bt("chart.stack_item")} / ${bt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}})}configCustomColors(t,e){var a;const o={...e},i=L(t.customAttr).basicStyle,{seriesColor:l}=i;if(l!=null&&l.length){const s=l.reduce((c,f)=>(c[f.id]=f,c),{}),{yAxis:r,extStack:d}=t,{data:p}=e;if(d!=null&&d.length){const c=new Set;(a=p[0])==null||a.forEach(h=>h.category!==null&&c.add(h.category)),[...c].forEach((h,g)=>{const y=s[h];y&&(g+1>i.colors.length?i.colors.push(y.color):i.colors[g]=y.color)})}else r==null||r.forEach((c,f)=>{const h=s[c.id];h&&(f+1>i.colors.length?i.colors.push(h.color):i.colors[f]=h.color)})}const n=i.colors.map(s=>{const r=P(s,i.alpha);return i.gradient?rt(r,!0,270):r});return o.geometryOptions[0].color=n,o}setupSeriesColor(t,e){const o=[],i=new Set,l=t.customAttr.basicStyle.colors,{yAxis:n,extStack:a}=t;return a!=null&&a.length?e==null||e.forEach(s=>{s.value===null||s.category===null||i.has(s.category)||(i.add(s.category),o.push({id:s.category,name:s.category,color:l[(i.size-1)%l.length]}))}):n==null||n.forEach(s=>{i.has(s.id)||(i.add(s.id),o.push({id:s.id,name:s.chartShowName??s.name,color:l[(i.size-1)%l.length]}))}),o}}class In extends uo{constructor(t="chart-mix-dual-line"){super(t);w(this,"axis",[...this.axis,"xAxisExt"]);w(this,"propertyInner",{...Bt,"label-selector":["seriesLabelFormatter"],"tooltip-selector":[...Bt["tooltip-selector"],"seriesTooltipFormatter"]});w(this,"axisConfig",{...this.axisConfig,xAxisExt:{name:`${bt("chart.drag_block_type_axis_left")} / ${bt("chart.dimension")}`,type:"d",limit:1,allowEmpty:!0}})}getLeftType(){return"line"}configCustomColors(t,e){var a;const o={...e},i=L(t.customAttr).basicStyle,{seriesColor:l}=i;if(l!=null&&l.length){const s=l.reduce((c,f)=>(c[f.id]=f,c),{}),{yAxis:r,xAxisExt:d}=t,{data:p}=e;if(d!=null&&d.length){const c=new Set;(a=p[0])==null||a.forEach(h=>h.category!==null&&c.add(h.category)),[...c].forEach((h,g)=>{const y=s[h];y&&(g+1>i.colors.length?i.colors.push(y.color):i.colors[g]=y.color)})}else r==null||r.forEach((c,f)=>{const h=s[c.id];h&&(f+1>i.colors.length?i.colors.push(h.color):i.colors[f]=h.color)})}const n=i.colors.map(s=>{const r=P(s,i.alpha);return i.gradient?rt(r,!0,270):r});return o.geometryOptions[0].color=n,o}setupSeriesColor(t,e){const o=[],i=new Set,l=t.customAttr.basicStyle.colors,{yAxis:n,xAxisExt:a}=t;return a!=null&&a.length?e==null||e.forEach(s=>{s.value===null||s.category===null||i.has(s.category)||(i.add(s.category),o.push({id:s.category,name:s.category,color:l[(i.size-1)%l.length]}))}):n==null||n.forEach(s=>{i.has(s.id)||(i.add(s.id),o.push({id:s.id,name:s.chartShowName??s.name,color:l[(i.size-1)%l.length]}))}),o}}const Bn=Object.freeze(Object.defineProperty({__proto__:null,ColumnLineMix:uo,DualLineMix:In,GroupColumnLineMix:On,StackColumnLineMix:Nn},Symbol.toStringTag,{value:"Module"})),{t:le}=U(),Rn=[];class Dn extends st{constructor(){super("circle-packing",Rn);w(this,"properties",["basic-style-selector","background-overall-component","border-style","label-selector","legend-selector","title-selector","tooltip-selector","jump-set","linkage"]);w(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","circleBorderStyle"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"function-cfg":["emptyDataStrategy"],"label-selector":["color","fontSize"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"tooltip-selector":["color","fontSize","backgroundColor","tooltipFormatter","show"]});w(this,"axis",["xAxis","yAxis","filter","drill"]);w(this,"axisConfig",{xAxis:{name:`${le("chart.circle_packing_name")} / ${le("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${le("chart.circle_packing_value")} / ${le("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var l,n,a;const{chart:e,container:o,action:i}=t;if((n=(l=e==null?void 0:e.data)==null?void 0:l.data)!=null&&n.length){const s=e.data.data,{xAxis:r,yAxis:d,drillFields:p}=e,c=((a=d[0])==null?void 0:a.sort)??"none",f={sort:(S,A)=>c==="asc"?S.value-A.value:c==="desc"?A.value-S.value:0},g={data:(()=>{const S=[{name:le("commons.all"),children:[]}],A=(v,C)=>{const T={...C,name:C.name,children:[]};v.push(T)};return s.forEach(v=>A(S[0].children,v)),S[0]})(),appendPadding:ft(e),hierarchyConfig:{...c==="none"?{}:f},interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}}]},y=this.setupOptions(e,g),{CirclePacking:x}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(S=>S.a7),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),b=new x(o,y);return b.on("element:click",S=>{var C;const A=(C=S==null?void 0:S.data)==null?void 0:C.data;if((A==null?void 0:A.name)===le("commons.all"))return;const v={x:S.x,y:S.y,data:{data:{...A}}};i(v)}),b}}configBasicStyle(t,e){const o=L(t.customAttr),i=JSON.parse(JSON.stringify(o.basicStyle)),l={stroke:i.circleBorderColor,lineWidth:i.circleBorderWidth??0},n=i.circlePadding;return{...e,hierarchyConfig:{...e.hierarchyConfig,padding:n/100},pointStyle:l}}configLabel(t,e){const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const{label:i}=L(t.customAttr),l={...o.label,textAlign:"center",offsetY:5,layout:i.fullDisplay?[{type:"limit-in-plot"}]:o.label.layout,formatter:(n,a)=>n.children.length===0?n.name:""};return{...o,label:l}}configTooltip(t,e){const o=super.configTooltip(t,e);if(!o.tooltip)return o;const i=L(t.customAttr).tooltip;return{...o,tooltip:{...o,fields:["name","value"],formatter:l=>{let n=l.value;return i.tooltipFormatter&&(n=D(n,i.tooltipFormatter)),{name:l.name,value:n}}}}}configEmptyDataStrategy(t,e){const{functionCfg:o}=L(t.senior),i=o.emptyDataStrategy,l=a=>{var s,r,d,p,c;if(i==="ignoreData")for(let f=a.length-1;f>=0;f--){let h=[];(s=a[f].children)!=null&&s.length&&(h=a[f].children.filter(g=>g.value!==null)),(r=a[f].children)!=null&&r.length&&h.length&&l(a[f].children),(d=a[f])!=null&&d.hasOwnProperty("value")&&a[f].value===null&&a.splice(f,1),!((p=a[f])!=null&&p.hasOwnProperty("value"))&&h.length===0&&a.splice(f,1)}else for(let f=a.length-1;f>=0;f--){let h=[];if((c=a[f].children)!=null&&c.length&&(h=a[f].children.filter(g=>g.value!==null),!h.length)){a[f].children=[];continue}l(a[f].children)}},n=Z(e.data.children);return l(n),e.data.children=n,e}setupDefaultOptions(t){const{customAttr:e,customStyle:o,senior:i}=t,{label:l,basicStyle:n}=e,{legend:a}=o;return i.functionCfg.emptyDataStrategy="ignoreData",e.label={...l,show:!0},a.show=!1,n.circleBorderWidth=0,n.circleBorderColor="#fff",n.circlePadding=0,t}setupOptions(t,e){return Q(this.configTheme,this.configEmptyDataStrategy,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend)(t,e)}}const Mn=Object.freeze(Object.defineProperty({__proto__:null,CirclePacking:Dn},Symbol.toStringTag,{value:"Module"})),{t:Se}=U();class $n extends st{constructor(){super("funnel",[]);w(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","legend-selector","jump-set","linkage"]);w(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","seriesColor"],"label-selector":["fontSize","color","hPosition","showQuota","conversionTag"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"],"title-selector":["show","title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"]});w(this,"axis",["xAxis","yAxis","filter","drill","extLabel","extTooltip"]);w(this,"axisConfig",{xAxis:{name:`${Se("chart.drag_block_funnel_split")} / ${Se("chart.dimension")}`,type:"d"},yAxis:{name:`${Se("chart.drag_block_funnel_width")} / ${Se("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var d;const{chart:e,container:o,action:i}=t;if(!((d=e.data)!=null&&d.data))return;const n={data:e.data.data,xField:"field",yField:"value",appendPadding:ft(e),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}}],meta:{field:{type:"cat"}}},a=this.setupOptions(e,n),{Funnel:s}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(p=>p.a0),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("interval:click",i),yt(e,r),r}configLabel(t,e){var n;let o,i,l;if(t.customAttr){l=L(t.customAttr);const a=l.label.showQuota,s=l.label;if((n=l.label)!=null&&n.show){if(a){const d=[];s.fullDisplay||d.push({type:"hide-overlap"},{type:"limit-in-plot"}),o={position:s.position,layout:d,style:{fill:s.color,fontSize:s.fontSize},formatter:function(c){return D(c.value,s.quotaLabelFormatter)}},o.position==="right"&&(o.offsetX=-40)}const r=L(t.customAttr).label.conversionTag;r&&r.show&&(i={style:{fill:s.color,fontSize:s.fontSize},formatter:d=>{if(!d.$$conversion$$[0])return`${r.text??""} -`;const p=(d.$$conversion$$[1]/d.$$conversion$$[0]*100).toFixed(r.precision);return`${r.text??""} ${p}%`}})}return{...e,label:o,conversionTag:i,maxSize:i?.8:1}}return e}setupSeriesColor(t,e){return _e(t,e)}setupOptions(t,e){return Q(this.configTheme,this.configSingleDimensionColor,this.configLabel,this.configMultiSeriesTooltip,this.configLegend)(t,e)}setupDefaultOptions(t){const{customAttr:e,customStyle:o}=t,{label:i}=e;["left","middle","right"].includes(i.position)||(i.position="middle"),e.label={...i,show:!0,showQuota:!0,conversionTag:{show:!1,precision:2,text:Se("chart.conversion_rate")}};const{legend:l}=o;return l.show=!1,t}}const Pn=Object.freeze(Object.defineProperty({__proto__:null,Funnel:$n},Symbol.toStringTag,{value:"Module"})),{t:go}=U(),Hn=[];class Wn extends st{constructor(){super("gauge",Hn);w(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","misc-selector","title-selector","threshold"]);w(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient","gaugeAxisLine","gaugePercentLabel"],"label-selector":["fontSize","color","labelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"misc-selector":["gaugeMinType","gaugeMinField","gaugeMin","gaugeMaxType","gaugeMaxField","gaugeMax","gaugeStartAngle","gaugeEndAngle"],threshold:["gaugeThreshold"]});w(this,"axis",["yAxis","filter"]);w(this,"axisConfig",{yAxis:{name:`${go("chart.drag_block_gauge_angel")} / ${go("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var p,c;const{chart:e,container:o,scale:i,action:l}=t;if(!((p=e.data)!=null&&p.series)||!e.yAxis.length)return;const n={percent:0,appendPadding:ft(e),axis:{tickInterval:.2,label:{style:{fontSize:qt(12,i)}},tickLine:{length:qt(12,i)*-1,style:{lineWidth:qt(1,i)}},subTickLine:{count:4,length:qt(6,i)*-1,style:{lineWidth:qt(1,i)}}}},a=this.setupOptions(e,n,{scale:i}),{Gauge:s}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(f=>f.a1),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);r.on("afterrender",()=>{var f,h;l({from:"gauge",data:{type:"gauge",max:(h=(f=e.data)==null?void 0:f.series[0])==null?void 0:h.data[0]}})});const d=(c=e.data)==null?void 0:c.series.some(f=>{var h;return!((h=f.data)!=null&&h[0])});if(this.configEmptyDataStyle(d?[]:[1],o,r),!d)return r}configMisc(t,e,o){var c,f,h,g,y,x,b,S,A,v,C,T,k,O,R;const i=L(t.customAttr),l=t.data.series[0].data[0];let n,a,s,r;if(i.misc){const _=i.misc;_.gaugeMinType==="dynamic"&&_.gaugeMaxType==="dynamic"?(n=(h=(f=t.data)==null?void 0:f.series[((c=t.data)==null?void 0:c.series.length)-2])==null?void 0:h.data[0],a=(x=(y=t.data)==null?void 0:y.series[((g=t.data)==null?void 0:g.series.length)-1])==null?void 0:x.data[0]):_.gaugeMinType!=="dynamic"&&_.gaugeMaxType==="dynamic"?(n=_.gaugeMin||_.gaugeMin===0?_.gaugeMin:Gt.gaugeMin,a=(A=(S=t.data)==null?void 0:S.series[((b=t.data)==null?void 0:b.series.length)-1])==null?void 0:A.data[0]):_.gaugeMinType==="dynamic"&&_.gaugeMaxType!=="dynamic"?(n=(T=(C=t.data)==null?void 0:C.series[((v=t.data)==null?void 0:v.series.length)-1])==null?void 0:T.data[0],a=_.gaugeMax?_.gaugeMax:Gt.gaugeMax):(n=_.gaugeMin||_.gaugeMin===0?_.gaugeMin:Gt.gaugeMin,a=_.gaugeMax?_.gaugeMax:(R=(O=t.data)==null?void 0:O.series[((k=t.data)==null?void 0:k.series.length)-1])==null?void 0:R.data[0]),s=_.gaugeStartAngle*Math.PI/180,r=_.gaugeEndAngle*Math.PI/180,o.min=n,o.max=a}const p={percent:(parseFloat(l)-parseFloat(n))/(parseFloat(a)-parseFloat(n)),startAngle:s,endAngle:r};return{...e,...p}}configRange(t,e,o){var c;const{scale:i}=o,l=[0];let n=0,a=!1,s=!1;const r=e.theme;if(t.senior){const h=L(t.senior).threshold??zl;if(h.enable&&h.gaugeThreshold){s=!0;const g=h.gaugeThreshold.split(",");for(let y=0;y<g.length;y++){const x=g[y],b=parseFloat(x)/100;l.push(b),!a&&e.percent<=b&&(a=!0,n=y)}a||(n=g.length)}}l.push(1);let d;if(s?d={range:{color:r.styleSheet.paletteQualitative10,ticks:l},indicator:{pointer:{style:{stroke:r.styleSheet.paletteQualitative10[n%r.styleSheet.paletteQualitative10.length]}},pin:{style:{stroke:r.styleSheet.paletteQualitative10[n%r.styleSheet.paletteQualitative10.length],r:qt(10,i)}}}}:d={indicator:{pin:{style:{r:qt(10,i)}}}},L(t.customAttr).basicStyle.gradient){const f=(((c=r.styleSheet)==null?void 0:c.paletteQualitative10)||[]).map(h=>rt(h,!0));d.range?d.range.color=f:d.range={color:f}}return{...e,...d}}configLabel(t,e,o){const i=L(t.customAttr),l=t.data.series[0].data[0];let n=!1,a=!1;const s=i.label,r=s.labelFormatter??Qt.labelFormatter;s.show&&s.childrenShow&&(n={style:{fontSize:`${s.fontSize}px`,color:s.color},formatter:function(){let y;return r.type==="percent"?y=e.percent:y=l,D(y,r)}});const{min:d,max:p}=o;if(s.show&&s.proportionSeriesFormatter.show){const y=s.proportionSeriesFormatter;a={offsetY:y.fontSize+s.fontSize,style:{fontSize:`${y.fontSize}px`,color:y.color},formatter:function(){const x=(parseFloat(l)-d)/(p-d)*100;return go("chart.proportion")+"： "+x.toFixed(y.formatterCfg.decimalCount)+"%"}}}const c={title:n,content:a},{gaugeAxisLine:f,gaugePercentLabel:h}=i.basicStyle;return e=vt(e,{axis:{label:{formatter:y=>{if(f===!1)return"";if(h===!1){const x=y==="0"?d:y==="1"?p:d+(p-d)*y;return r.type==="value"?D(x,r):x}return y==="0"?y:y*100+"%"}}}}),{...e,statistic:c}}setupDefaultOptions(t){return t.customAttr.label={...t.customAttr.label,show:!0,labelFormatter:{type:"value",thousandSeparator:!0,decimalCount:0,unit:1}},t}setupOptions(t,e,o){return Q(this.configTheme,this.configMisc,this.configLabel,this.configRange)(t,e,o)}}const Vn=Object.freeze(Object.defineProperty({__proto__:null,Gauge:Wn},Symbol.toStringTag,{value:"Module"})),{t:Yn}=U();class qn extends Ee{constructor(){super(ao.CUSTOM,Vt.INDICATOR,"indicator");w(this,"selectorSpec");w(this,"properties",["background-overall-component","border-style","title-selector","indicator-value-selector","indicator-name-selector","threshold","function-cfg"]);w(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"indicator-value-selector":["fontSize","color","hPosition","isItalic","isBolder","fontFamily","letterSpace","fontShadow"],"indicator-name-selector":["title","fontSize","color","hPosition","isItalic","isBolder","fontFamily","letterSpace","fontShadow"],"function-cfg":["emptyDataStrategy"]});w(this,"axis",["yAxis","filter"]);w(this,"axisConfig",{yAxis:{name:`${Yn("chart.quota")}`,limit:1}})}setupDefaultOptions(t){const e=kl[0].colors;return t.customAttr.basicStyle.colors=e,t.customAttr.indicator.color=e[0],t.customAttr.indicatorName.color=e[1],t}}const jn=Object.freeze(Object.defineProperty({__proto__:null,IndicatorChartView:qn},Symbol.toStringTag,{value:"Module"})),{t:ii}=U();class Un extends Ee{constructor(){super(ao.CUSTOM,Vt.PICTURE_GROUP,"picture-group");w(this,"properties",["background-overall-component","border-style","threshold"]);w(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],threshold:["tableThreshold"]});w(this,"axis",["xAxis","yAxis","filter"]);w(this,"axisConfig",{xAxis:{name:`${ii("chart.dimension")}`,type:"d"},yAxis:{name:`${ii("chart.quota")}`,type:"q"}})}}const Jn=Object.freeze(Object.defineProperty({__proto__:null,PictureGroupView:Un},Symbol.toStringTag,{value:"Module"})),{t:Mt}=U();class Xn extends st{constructor(){super("quadrant",[]);w(this,"properties",["background-overall-component","border-style","basic-style-selector","x-axis-selector","y-axis-selector","title-selector","label-selector","tooltip-selector","legend-selector","jump-set","linkage","quadrant-selector"]);w(this,"propertyInner",{"basic-style-selector":["colors","alpha","scatterSymbol","scatterSymbolSize","seriesColor"],"label-selector":["fontSize","color"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"x-axis-selector":["position","name","color","fontSize","axisLine","axisValue","splitLine","axisForm","axisLabel","axisLabelFormatter"],"y-axis-selector":["position","name","color","fontSize","axisValue","axisLine","splitLine","axisForm","axisLabel","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"],"quadrant-selector":["regionStyle","label","lineStyle"]});w(this,"axis",["xAxis","yAxis","yAxisExt","extBubble","filter","drill","extLabel","extTooltip"]);w(this,"axisConfig",{extBubble:{name:`${Mt("chart.bubble_size")} / ${Mt("chart.quota")}`,type:"q",limit:1,allowEmpty:!0},xAxis:{name:`${Mt("chart.form_type")} / ${Mt("chart.dimension")}`,type:"d",limit:1},yAxis:{name:`${Mt("chart.x_axis")} / ${Mt("chart.quota")}`,type:"q",limit:1},yAxisExt:{name:`${Mt("chart.y_axis")} / ${Mt("chart.quota")}`,type:"q",limit:1}})}getFieldObject(t){var n,a,s,r,d,p,c,f;const e={id:(n=t.xAxis[0])==null?void 0:n.id,name:(a=t.xAxis[0])==null?void 0:a.originName},o={id:(s=t.extBubble[0])==null?void 0:s.id,name:(r=t.extBubble[0])==null?void 0:r.originName},i={id:(d=t.yAxis[0])==null?void 0:d.id,name:(p=t.yAxis[0])==null?void 0:p.originName},l={id:(c=t.yAxisExt[0])==null?void 0:c.id,name:(f=t.yAxisExt[0])==null?void 0:f.originName};return{colorFieldObj:e,sizeFieldObj:o,xFieldObj:i,yFieldObj:l}}getUniqueObjects(t){return[...new Set(t.map(JSON.stringify))].map(JSON.parse)}async drawChart(t){var O,R,_,B;const{chart:e,container:o,action:i,quadrantDefaultBaseline:l}=t;if(!((O=e.data)!=null&&O.data))return;const n=Z(e.data.data),a=_t((R=n[0])==null?void 0:R.data,[]),s=_t((_=n[1])==null?void 0:_.data,[]),r=_t((B=n[2])==null?void 0:B.data,[]),d=a.map(E=>{var z;return{...E,id:(z=E.quotaList[0])==null?void 0:z.id,field:E.field,value:E.value}}),p=s.map(E=>{var z;return{...E,id:(z=E.quotaList[0])==null?void 0:z.id,field:E.field,value:E.value}}),c=r.map(E=>{var z;return{...E,id:(z=E.quotaList[0])==null?void 0:z.id,field:E.field,value:E.value}}),f=d.map(E=>E.value),h=((Math.max(...f)+Math.min(...f))/2).toFixed(),g=p.map(E=>E.value),y=((Math.max(...g)+Math.min(...g))/2).toFixed(),x={...e.customAttr.quadrant};x.xBaseline===void 0&&(x.xBaseline=h,x.yBaseline=y);const b=E=>{var F,I;const z=(F=c.find($=>$.field===E.field))==null?void 0:F.quotaList,N=(I=p.find($=>$.field===E.field))==null?void 0:I.quotaList;return JSON.stringify(z)===JSON.stringify(N)?N:[...z||[],...N||[]]},S=Do(_t(d,[]),E=>{var z,N;return{...E,yAxis:E.value,quotaList:b(E),yAxisExt:(z=p.find(F=>F.field===E.field))==null?void 0:z.value,extBubble:(N=c.find(F=>F.field===E.field))==null?void 0:N.value}}),A={colorField:"field",meta:{field:{type:"cat"}},quadrant:{...x},data:S,xField:"yAxis",yField:"yAxisExt",appendPadding:30,pointStyle:{fillOpacity:.8,stroke:"#bbb"}};e.container=o;const v=this.setupOptions(e,A),{Scatter:C}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(E=>E.a4),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),T=new C(o,v);T.on("point:click",i),T.on("click",()=>l(x)),T.on("afterrender",()=>l(x));const k=L(e.customStyle).yAxis;return k!=null&&k.name&&(zs(e,T),te(e,T,"axis-title")),yt(e,T),T}configBasicStyle(t,e){var l;const i=L(t.customAttr).basicStyle;return(l=t.extBubble)!=null&&l.length?{...e,size:[4,30],sizeField:"extBubble",shape:i.scatterSymbol}:{...e,size:i.scatterSymbolSize,shape:i.scatterSymbol}}configXAxis(t,e){const o=super.configXAxis(t,e);if(!o.xAxis)return o;const i=L(t.customStyle).xAxis;o.xAxis.label&&(o.xAxis.label.formatter=n=>D(n,i.axisLabelFormatter));const l=i.axisValue;if(!(l!=null&&l.auto)){const n={xAxis:{...o.xAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const i=L(t.customStyle).yAxis;o.yAxis.label&&(o.yAxis.label.formatter=n=>D(n,i.axisLabelFormatter));const l=i.axisValue;if(!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configLabel(t,e){let o,i;if(t.customAttr&&(i=L(t.customAttr),i.label)){const l=i.label;if(l.show){const n=[];l.fullDisplay||(n.push({type:"hide-overlap"}),n.push({type:"limit-in-shape"})),o={offset:0,style:{fill:l.color,fontSize:l.fontSize},content:a=>a.name,layout:n}}else o=!1}return{...e,label:o}}configTooltip(t,e){var p;const i=L(t.customAttr).tooltip,l=t.xAxis[0],n=t.yAxis[0],a=t.yAxisExt[0];if(!i.show||!l&&!n&&!a)return{...e,tooltip:!1};const s=(p=i.seriesTooltipFormatter)==null?void 0:p.filter(c=>c.show).reduce((c,f)=>(c[f.seriesId]=f,c),{}),r=Z(e.data),d={showTitle:!0,title:(c,f)=>f==null?void 0:f.name,customItems(c){var g,y;if(!((g=i.seriesTooltipFormatter)!=null&&g.length))return c;const f=[];c.forEach(x=>{Object.keys(s).forEach(b=>{if(b.endsWith(x.name)){const S=s[b];if(S){const A=S.groupType==="q"?D(parseFloat(x.value),S.formatterCfg):x.value,v=Y(S.chartShowName)?S.name:S.chartShowName;f.push({color:x.color,name:v,value:A})}}})});const h=(y=r.find(x=>x.field===c[0].title))==null?void 0:y.dynamicTooltipValue;return h.length>0&&h.forEach(x=>{const b=i.seriesTooltipFormatter.filter(S=>S.id===x.fieldId);if(b&&b.length>0){const S=D(parseFloat(x.value),b[0].formatterCfg),A=Y(b[0].chartShowName)?b[0].name:b[0].chartShowName;f.push({color:"grey",name:A,value:S})}}),f},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:d}}setupDefaultOptions(t){return t.customStyle.yAxis.splitLine={...t.customStyle.yAxis.splitLine,show:!1},t.customStyle.yAxisExt.splitLine={...t.customStyle.yAxisExt.splitLine,show:!1},t.customStyle.yAxis.axisLine={...t.customStyle.yAxis.axisLine,show:!0},t.customStyle.yAxisExt.axisLine={...t.customStyle.yAxisExt.axisLine,show:!0},t}configColor(t,e){const{xAxis:o,yAxis:i,yAxisExt:l}=t;return o!=null&&o.length&&(i!=null&&i.length)&&(l!=null&&l.length)?this.configSingleDimensionColor(t,e):e}setupSeriesColor(t,e){var a;const{xAxis:o,yAxis:i,yAxisExt:l}=t;if(!(o!=null&&o.length&&(i!=null&&i.length)&&(l!=null&&l.length)))return[];const n=(a=e==null?void 0:e[0])==null?void 0:a.data;return _e(t,n)}configLegend(t,e){const o=super.configLegend(t,e);if(!o.legend)return o;const i=L(t.customStyle);let l;return i&&i.legend?l=he(JSON.parse(JSON.stringify(i.legend)),zt).size:l=zt.size,o.legend.marker.style=n=>({r:l,fill:n.fill}),o}setupOptions(t,e){return Q(this.configTheme,this.configColor,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configAnalyse,this.configSlider,this.configBasicStyle)(t,e,{},this)}}const Gn=Object.freeze(Object.defineProperty({__proto__:null,Quadrant:Xn},Symbol.toStringTag,{value:"Module"})),{t:Ae}=U();class Zn extends st{constructor(){super("radar",[]);w(this,"properties",["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","legend-selector","misc-style-selector","jump-set","linkage"]);w(this,"propertyInner",{"basic-style-selector":["colors","alpha","radarShape","seriesColor","radarShowPoint","radarPointSize","radarAreaColor"],"label-selector":["seriesLabelFormatter"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"],"misc-style-selector":["showName","color","fontSize","axisColor","axisValue"],"title-selector":["show","title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"]});w(this,"selectorSpec",{...this.selectorSpec,"misc-style-selector":{title:`${Ae("chart.tooltip_axis")}`}});w(this,"axis",["xAxis","yAxis","drill","filter","extLabel","extTooltip"]);w(this,"axisConfig",{xAxis:{name:`${Ae("chart.drag_block_radar_label")} / ${Ae("chart.dimension")}`,type:"d"},yAxis:{name:`${Ae("chart.drag_block_radar_length")} / ${Ae("chart.quota")}`,type:"q"}})}async drawChart(t){var d;const{chart:e,container:o,action:i}=t;if(!((d=e.data)!=null&&d.data))return;const n={data:e.data.data,xField:"field",yField:"value",seriesField:"category",appendPadding:[10,10,10,10],interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"active-region",cfg:{start:[{trigger:"point:mousemove",action:"active-region:show"}],end:[{trigger:"point:mouseleave",action:"active-region:hide"}]}}]},a=this.setupOptions(e,n),{Radar:s}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(p=>p.ab),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("point:click",i),a.label&&r.on("label:click",p=>{i({x:p.x,y:p.y,data:{data:p.target.attrs.data}})}),yt(e,r),r}configBasicStyle(t,e){const{radarShowPoint:o,radarPointSize:i,radarAreaColor:l}=L(t.customAttr).basicStyle,n={};return o&&(n.point={shape:"circle",size:i,style:{fill:null}}),l&&(n.area={}),{...e,...n}}configLabel(t,e){var a;const o=super.configLabel(t,e);if(!o.label)return{...o,label:!1};const i=L(t.customAttr).label,l=(a=i.seriesLabelFormatter)==null?void 0:a.reduce((s,r)=>(s[r.id]=r,s),{});o.label.style.fill=Qt.color;const n={fields:[],...o.label,autoRotate:!1,autoHide:!0,formatter:s=>{var c;if(!((c=i.seriesLabelFormatter)!=null&&c.length))return s.value;const r=l==null?void 0:l[s.quotaList[0].id];if(!r)return s.value;if(!r.show)return;const d=D(s.value,r.formatterCfg),p=new Kt({});return p.addShape({type:"text",attrs:{data:s,x:0,y:0,text:d,textAlign:"start",textBaseline:"top",fontSize:r.fontSize,fill:r.color}}),p}};return{...o,label:n}}configAxis(t,e){const o=L(t.customAttr),i=L(t.customStyle),l=o.basicStyle,n=i.misc;let a={style:{fill:n.color,fontSize:n.fontSize}};n.showName||(a=!1);const s={line:null,tickLine:null,label:a,grid:{line:{style:{stroke:n.axisColor}}}},r={label:null,line:null,tickLine:null,grid:{line:{type:l.radarShape,style:{stroke:n.axisColor}}}},d=n.axisValue;if(!(d!=null&&d.auto)){const p={...r,min:d.min,max:d.max,minLimit:d.min,maxLimit:d.max,tickCount:d.splitCount};return{...e,xAxis:s,yAxis:p}}return{...e,xAxis:s,yAxis:r}}configLegend(t,e){const o=super.configLegend(t,e);if(!o.legend)return o;const i=L(t.customStyle);let l;return i&&i.legend?l=he(JSON.parse(JSON.stringify(i.legend)),zt).size:l=zt.size,o.legend.marker.style=n=>({r:l,fill:n.stroke}),o}setupOptions(t,e){return Q(this.configTheme,this.configColor,this.configLabel,this.configLegend,this.configMultiSeriesTooltip,this.configAxis,this.configBasicStyle)(t,e)}}const Qn=Object.freeze(Object.defineProperty({__proto__:null,Radar:Zn},Symbol.toStringTag,{value:"Module"})),{t:li}=U();class Kn extends Ee{constructor(){super(ao.CUSTOM,Vt.RICH_TEXT,"rich-text");w(this,"properties",["background-overall-component","border-style","threshold","function-cfg"]);w(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],threshold:["tableThreshold"],"function-cfg":["emptyDataStrategy"]});w(this,"axis",["xAxis","yAxis","filter"]);w(this,"axisConfig",{xAxis:{name:`${li("chart.dimension")}`,type:"d",allowEmpty:!0},yAxis:{name:`${li("chart.quota")}`,type:"q",allowEmpty:!0}})}}const ta=Object.freeze(Object.defineProperty({__proto__:null,RichTextChartView:Kn},Symbol.toStringTag,{value:"Module"})),Ui=["background-overall-component","border-style","basic-style-selector","label-selector","tooltip-selector","title-selector","jump-set","linkage"],Ji={"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","gradient"],"label-selector":["fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","tooltipFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"function-cfg":["slider","emptyDataStrategy"]},Xi=["xAxis","xAxisExt","yAxis","filter","extLabel","extTooltip"],ea=Object.freeze(Object.defineProperty({__proto__:null,SANKEY_AXIS_TYPE:Xi,SANKEY_EDITOR_PROPERTY:Ui,SANKEY_EDITOR_PROPERTY_INNER:Ji},Symbol.toStringTag,{value:"Module"})),{t:se}=U(),oa=[];class ia extends st{constructor(t="sankey"){super(t,oa);w(this,"axisConfig",{xAxis:{name:`${se("chart.drag_block_type_axis_start")} / ${se("chart.dimension")}`,limit:1,type:"d"},xAxisExt:{name:`${se("chart.drag_block_type_axis_end")} / ${se("chart.dimension")}`,limit:1,type:"d",allowEmpty:!0},yAxis:{name:`${se("chart.chart_data")} / ${se("chart.quota")}`,limit:1,type:"q"}});w(this,"properties",Ui);w(this,"propertyInner",{...Ji,"label-selector":["color","fontSize"],"tooltip-selector":["fontSize","color","backgroundColor","tooltipFormatter","show"]});w(this,"axis",[...Xi]);w(this,"baseOptions",{data:[],sourceField:"source",targetField:"target",weightField:"value",rawFields:["dimensionList","quotaList"],interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}},{type:"active-region",cfg:{start:[{trigger:"interval:mousemove",action:"active-region:show"}],end:[{trigger:"interval:mouseleave",action:"active-region:hide"}]}}]})}async drawChart(t){var d,p;const{chart:e,container:o,action:i}=t;if(!((p=(d=e.data)==null?void 0:d.data)!=null&&p.length))return;const l=Z(e.data.data);l.forEach(c=>{c.dimensionList&&(c.dimensionList[0]&&(c.source=c.dimensionList[0].value),c.dimensionList[1]&&(c.target=c.dimensionList[1].value))});const n={...this.baseOptions,appendPadding:ft(e),data:l,nodeSort:(c,f)=>{if(e.yAxis&&e.yAxis[0]){if(e.yAxis[0].sort==="asc")return c.value-f.value;if(e.yAxis[0].sort==="desc")return f.value-c.value}if(e.xAxis&&e.xAxis[0]&&c.sourceLinks.length>0){if(e.xAxis[0].sort==="custom_sort"&&e.xAxis[0].customSort)return e.xAxis[0].customSort.indexOf(c.name)-e.xAxis[0].customSort.indexOf(f.name);if(e.xAxis[0].sort==="asc")return c.name.localeCompare(f.name);if(e.xAxis[0].sort==="desc")return f.name.localeCompare(c.name)}if(e.xAxisExt&&e.xAxisExt[0]&&c.targetLinks.length>0){if(e.xAxisExt[0].sort==="custom_sort"&&e.xAxisExt[0].customSort)return e.xAxisExt[0].customSort.indexOf(c.name)-e.xAxisExt[0].customSort.indexOf(f.name);if(e.xAxisExt[0].sort==="asc")return c.name.localeCompare(f.name);if(e.xAxisExt[0].sort==="desc")return f.name.localeCompare(c.name)}return f.value-c.value}},a=this.setupOptions(e,n),{Sankey:s}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(c=>c.ad),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("edge:click",i),r}configTooltip(t,e){let o,i;if(t.customAttr&&(i=L(t.customAttr),i.tooltip)){const l=JSON.parse(JSON.stringify(i.tooltip));l.show?o={showTitle:!1,showMarkers:!1,shared:!1,showContent:n=>!dt(n,[0,"data","isNode"]),formatter:n=>{const{source:a,target:s,value:r}=n;return{name:a+" -> "+s,value:D(r,l.tooltipFormatter)}}}:o=!1}return{...e,tooltip:o}}configBasicStyle(t,e){const o=L(t.customAttr).basicStyle;let i=o.colors;return i=i.map(l=>{const n=P(l,o.alpha);return o.gradient?rt(n,!0):n}),e={...e,color:i},e}setupDefaultOptions(t){const{customAttr:e,senior:o}=t,{label:i}=e;return["left","middle","right"].includes(i.position)||(i.position="middle"),o.functionCfg.emptyDataStrategy="ignoreData",t}configLabel(t,e){const o=L(t.customAttr).label;if(o.show){const i=[];return o.fullDisplay||i.push({type:"hide-overlap"},{type:"limit-in-canvas"}),{...e,label:{formatter:({name:n})=>n,callback:n=>{const a=n[1]===1;return{style:{fill:o.color,fontSize:o.fontSize,textAlign:a?"end":"start",fontFamily:t.fontFamily},offsetX:a?-8:8}},layout:i}}}else return{...e,label:!1}}setupOptions(t,e){return Q(this.configTheme,this.configBasicStyle,this.configLabel,this.configTooltip,this.configLegend,this.configSlider,this.configAnalyseHorizontal,this.configEmptyDataStrategy)(t,e)}}const la=Object.freeze(Object.defineProperty({__proto__:null,SankeyBar:ia},Symbol.toStringTag,{value:"Module"})),{t:De}=U();class sa extends st{constructor(){super("scatter",[]);w(this,"properties",["background-overall-component","border-style","basic-style-selector","x-axis-selector","y-axis-selector","title-selector","label-selector","tooltip-selector","legend-selector","jump-set","linkage"]);w(this,"propertyInner",{"basic-style-selector":["colors","alpha","scatterSymbol","scatterSymbolSize","seriesColor"],"label-selector":["fontSize","color","labelFormatter"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"x-axis-selector":["position","name","color","fontSize","axisLine","splitLine","axisForm","axisLabel"],"y-axis-selector":["position","name","color","fontSize","axisValue","axisLine","splitLine","axisForm","axisLabel","axisLabelFormatter"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","color","fontSize","hPosition","vPosition"]});w(this,"axis",["xAxis","yAxis","extBubble","filter","drill","extLabel","extTooltip"]);w(this,"axisConfig",{xAxis:{name:`${De("chart.drag_block_type_axis")} / ${De("chart.dimension")}`,type:"d"},yAxis:{...this.axisConfig.yAxis,limit:void 0,allowEmpty:!1},extBubble:{name:`${De("chart.bubble_size")} / ${De("chart.quota")}`,type:"q",limit:1,allowEmpty:!0}})}async drawChart(t){var d;const{chart:e,container:o,action:i}=t;if(!((d=e.data)!=null&&d.data))return;const n={data:e.data.data,xField:"field",yField:"value",colorField:"category",meta:{field:{type:"cat"}},appendPadding:ft(e),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}}]},a=this.setupOptions(e,n),{Scatter:s}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(p=>p.a4),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("point:click",i),yt(e,r),r}configBasicStyle(t,e){var l;const i=L(t.customAttr).basicStyle;return(l=t.extBubble)!=null&&l.length?{...e,size:[5,30],sizeField:"popSize",shape:i.scatterSymbol}:{...e,size:i.scatterSymbolSize,shape:i.scatterSymbol}}configYAxis(t,e){const o=super.configYAxis(t,e);if(!o.yAxis)return o;const i=L(t.customStyle).yAxis;o.yAxis.label&&(o.yAxis.label.formatter=n=>D(n,i.axisLabelFormatter));const l=i.axisValue;if(!(l!=null&&l.auto)){const n={yAxis:{...o.yAxis,min:l.min,max:l.max,minLimit:l.min,maxLimit:l.max,tickCount:l.splitCount}};return{...o,...n}}return o}configTooltip(t,e){var s;const i=L(t.customAttr).tooltip;if(!i.show)return{...e,tooltip:!1};const l=(s=i.seriesTooltipFormatter)==null?void 0:s.filter(r=>r.show).reduce((r,d)=>(r[d.seriesId]=d,r),{}),n=["value","popSize"],a={showTitle:!0,customItems(r){var c,f;if(!((c=i.seriesTooltipFormatter)!=null&&c.length))return r;const d=r[0];if(!d.data.quotaList)return r;const p=[];return r.filter(h=>n.includes(h.name)).forEach(h=>{let g=l[`${h.data.quotaList[0].id}-yAxis`];if(h.name==="popSize"&&(g=l[`${h.data.quotaList[1].id}-extBubble`]),!g)return;const y=D(parseFloat(h.value),g.formatterCfg),x=Y(g.chartShowName)?g.name:g.chartShowName;p.push({...h,name:x,value:y})}),(f=d.data.dynamicTooltipValue)==null||f.forEach(h=>{const g=l[h.fieldId];if(g){const y=D(parseFloat(h.value),g.formatterCfg),x=Y(g.chartShowName)?g.name:g.chartShowName;p.push({color:"grey",name:x,value:y})}}),p},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:a}}configLegend(t,e){const o=super.configLegend(t,e);if(!o.legend)return o;const i=L(t.customStyle);let l;return i&&i.legend?l=he(JSON.parse(JSON.stringify(i.legend)),zt).size:l=zt.size,o.legend.marker.style=n=>({r:l,fill:n.fill}),o}setupOptions(t,e){return Q(this.configTheme,this.configColor,this.configLabel,this.configTooltip,this.configLegend,this.configXAxis,this.configYAxis,this.configAnalyse,this.configSlider,this.configBasicStyle)(t,e)}}const na=Object.freeze(Object.defineProperty({__proto__:null,Scatter:sa},Symbol.toStringTag,{value:"Module"})),{t:Me}=U();class aa extends st{constructor(){super("treemap",[]);w(this,"properties",["background-overall-component","border-style","basic-style-selector","title-selector","legend-selector","label-selector","tooltip-selector","jump-set","linkage"]);w(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha","seriesColor"],"label-selector":["fontSize","color","showDimension","showQuota","showProportion"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"]});w(this,"axis",["xAxis","yAxis","filter","drill","extLabel","extTooltip"]);w(this,"axisConfig",{xAxis:{name:`${Me("chart.drag_block_treemap_label")} / ${Me("chart.dimension")}`,type:"d"},yAxis:{name:`${Me("chart.drag_block_treemap_size")} / ${Me("chart.quota")}`,limit:1}})}async drawChart(t){var d,p;const{chart:e,container:o,action:i}=t;if(!((p=(d=e.data)==null?void 0:d.data)!=null&&p.length))return;const n={data:{name:"root",children:e.data.data},colorField:"name",appendPadding:ft(e),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"element:mousemove",action:"tooltip:show"}],end:[{trigger:"element:mouseleave",action:"tooltip:hide"}]}}]},a=this.setupOptions(e,n),{Treemap:s}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(c=>c.ae),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("polygon:click",i),r}configTooltip(t,e){var d;const{tooltip:o,label:i}=L(t.customAttr),{yAxis:l}=t;if(!o.show)return{...e,tooltip:!1};const n=i.reserveDecimalCount,a=no(e.data.children),s=(d=o.seriesTooltipFormatter)==null?void 0:d.filter(p=>p.show).reduce((p,c)=>(p[c.id]=c,p),{});return{...e,tooltip:{showTitle:!0,title:()=>{},customItems(p){var g,y;let c=p;(g=o.seriesTooltipFormatter)!=null&&g.length&&(c=p.filter(x=>s[x.data.quotaList[0].id]));const f=[],h=p[0];return c.forEach(x=>{const b=s[x.data.quotaList[0].id]??l[0],S=D(parseFloat(x.value),b.formatterCfg),A=(Math.round(x.data.value/x.data.path[1].value*1e4)/100).toFixed(n),v=Y(b.chartShowName)?b.name:b.chartShowName;f.push({...x,name:v,value:`${S??""} (${A}%)`})}),(y=h.data.dynamicTooltipValue)==null||y.forEach(x=>{const b=s[x.fieldId];if(b){const S=a[x.fieldId],A=(Math.round(x.value/S*1e4)/100).toFixed(n),v=D(parseFloat(x.value),b.formatterCfg),C=Y(b.chartShowName)?b.name:b.chartShowName;f.push({color:"grey",name:C,value:`${v??""} (${A}%)`})}}),f}}}}configLabel(t,e){const i=L(t.customAttr).label;if(!i.show)return{...e,label:!1};const l={style:{fill:i.color,fontSize:i.fontSize},formatter:function(n){let a=n.value;const s=[];if(i.showDimension&&s.push(n.field),i.showQuota&&s.push(D(n.value,i.quotaLabelFormatter)),i.showProportion){const r=`${(n.value/n.parent.value*1e4/100).toFixed(i.reserveDecimalCount)}%`;s.push(r)}return a=s.join(`
`),a}};return i.fullDisplay&&(l.layout=[{type:"limit-in-plot"}]),{...e,label:l}}setupDefaultOptions(t){const{customAttr:e,customStyle:o}=t,{label:i}=e;e.label={...i,show:!0,showDimension:!0,showProportion:!0,reserveDecimalCount:2};const{legend:l}=o;return l.show=!1,t}setupSeriesColor(t,e){return e==null||e.sort((o,i)=>i.value-o.value),_e(t,e)}configColor(t,e){const o=e.data.children;o.sort((l,n)=>n.value-l.value);const i=this.configSingleDimensionColor(t,{...e,data:o});return{...e,color:i.color}}setupOptions(t,e){return Q(this.configTheme,this.configColor,this.configLabel,this.configTooltip,this.configLegend)(t,e,{},this)}}const ra=Object.freeze(Object.defineProperty({__proto__:null,Treemap:aa},Symbol.toStringTag,{value:"Module"})),{t:$e}=U(),ca=[];class ua extends st{constructor(){super("word-cloud",ca);w(this,"properties",["basic-style-selector","background-overall-component","border-style","title-selector","tooltip-selector","misc-selector","jump-set","linkage"]);w(this,"propertyInner",{"background-overall-component":["all"],"border-style":["all"],"basic-style-selector":["colors","alpha"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"misc-selector":["wordSizeRange","wordSpacing","wordCloudAxisValueRange"],"tooltip-selector":["color","fontSize","backgroundColor","seriesTooltipFormatter","show"]});w(this,"axis",["xAxis","yAxis","filter"]);w(this,"axisConfig",{xAxis:{name:`${$e("chart.drag_block_word_cloud_label")} / ${$e("chart.dimension_or_quota")}`,type:"d",limit:1},yAxis:{name:`${$e("chart.drag_block_word_cloud_size")} / ${$e("chart.quota")}`,type:"q",limit:1}});w(this,"setDataRange",(t,e,o)=>{t({from:"word-cloud",data:{max:e,min:o}})})}async drawChart(t){var l,n;const{chart:e,container:o,action:i}=t;if(e!=null&&e.data){let a=e.data.data;const{misc:s}=L(e.customAttr);let r=0,d=0;!((l=s.wordCloudAxisValueRange)!=null&&l.auto)&&((n=s.wordCloudAxisValueRange)==null?void 0:n.fieldId)===e.yAxis[0].id&&(r=s.wordCloudAxisValueRange.min,d=s.wordCloudAxisValueRange.max),We(a??[],"value",d,r,(g,y)=>{d=g,r=y}),a=So(a??[],d,r);const p={data:a,wordField:"field",weightField:"value",colorField:"field",wordStyle:{fontFamily:e.fontFamily?e.fontFamily:"Verdana",fontSize:s.wordSizeRange??Gt.wordSizeRange,rotation:[0,0],padding:s.wordSpacing??Gt.wordSpacing},random:()=>.5,appendPadding:ft(e),legend:!1,interactions:[]},c=this.setupOptions(e,p),{WordCloud:f}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(g=>g.ag),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),h=new f(o,c);return h.on("click",()=>{this.setDataRange(i,d,r)}),h.on("afterrender",()=>{this.setDataRange(i,d,r)}),h.on("point:click",g=>{i({x:g.x,y:g.y,data:{data:g.data.data.datum}})}),h}}configTooltip(t,e){var s;const i=L(t.customAttr).tooltip,l=t.yAxis;if(!i.show)return{...e,tooltip:!1};const n=(s=i.seriesTooltipFormatter)==null?void 0:s.filter(r=>r.show).reduce((r,d)=>(r[d.id]=d,r),{});return{...e,tooltip:{showTitle:!0,title:()=>{},customItems(r){var f,h;let d=r;(f=i.seriesTooltipFormatter)!=null&&f.length&&(d=r.filter(g=>n[g.data.datum.quotaList[0].id]));const p=[],c=r[0];return d.forEach(g=>{const y=n[g.data.datum.quotaList[0].id]??l[0],x=D(g.value,y.formatterCfg),b=Y(y.chartShowName)?y.name:y.chartShowName;p.push({...g,name:b,value:x})}),(h=c.data.datum.dynamicTooltipValue)==null||h.forEach(g=>{const y=n[g.fieldId];if(y){const x=D(parseFloat(g.value),y.formatterCfg),b=Y(y.chartShowName)?y.name:y.chartShowName;p.push({color:"grey",name:b,value:x})}}),p}}}}setupOptions(t,e){return Q(this.configTheme,this.configTooltip)(t,e)}}const da=Object.freeze(Object.defineProperty({__proto__:null,WordCloud:ua},Symbol.toStringTag,{value:"Module"})),{t:Pe}=U(),Gi=["background-overall-component","border-style","basic-style-selector","title-selector","legend-selector","label-selector","tooltip-selector","jump-set","linkage"],fo={"background-overall-component":["all"],"border-style":["all"],"label-selector":["fontSize","color","rPosition","showDimension","showQuota","showProportion"],"tooltip-selector":["fontSize","color","backgroundColor","seriesTooltipFormatter","show"],"basic-style-selector":["colors","alpha","radius","seriesColor"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["icon","orient","fontSize","color","hPosition","vPosition"]},Zi=["xAxis","yAxis","drill","filter","extLabel","extTooltip"],Qi={xAxis:{name:`${Pe("chart.drag_block_pie_label")} / ${Pe("chart.dimension")}`,type:"d"},yAxis:{name:`${Pe("chart.drag_block_pie_angle")} / ${Pe("chart.quota")}`,type:"q",limit:1}},{t:fa}=U(),ma=[];class Ki extends st{constructor(t="pie"){super(t,ma);w(this,"axis",Zi);w(this,"properties",Gi);w(this,"propertyInner",{...fo,"basic-style-selector":["colors","alpha","radius","topN","seriesColor"]});w(this,"axisConfig",Qi)}async drawChart(t){var c,f,h;const{chart:e,container:o,action:i}=t;if(this.configEmptyDataStyle((c=e.data)==null?void 0:c.data,o,null,fa("chart.no_data_or_not_positive")),!((h=(f=e.data)==null?void 0:f.data)!=null&&h.length))return;const l=e.data.data,n=L(e.customAttr),a=n.basicStyle.colors.map(g=>P(g,n.basicStyle.alpha)),s={data:l,angleField:"value",colorField:"field",appendPadding:ft(e),color:a,animation:!1,pieStyle:{lineWidth:0},statistic:{title:!1,content:{style:{whiteSpace:"pre-wrap",overflow:"hidden",textOverflow:"ellipsis"},content:""}},interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}},{type:"active-region",cfg:{start:[{trigger:"interval:mousemove",action:"active-region:show"}],end:[{trigger:"interval:mouseleave",action:"active-region:hide"}]}}],meta:{field:{type:"cat"}}},r=this.setupOptions(e,s),{Pie:d}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(g=>g.a3),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),p=new d(o,r);return p.on("interval:click",i),yt(e,p),p}configLabel(t,e){const{label:o}=L(t.customAttr);if(!(o!=null&&o.show))return{...e,label:!1};const i=[];let l;o.position==="inner"?(l="center",o.fullDisplay?i.push({type:"limit-in-plot"}):(i.push({type:"limit-in-canvas"}),i.push({type:"hide-overlap"}))):o.fullDisplay||i.push({type:"limit-in-plot"});let n=o.position==="outer"?"spider":o.position;i.length===0&&(n="no");const a={type:n,textAlign:l,layout:i,autoRotate:!1,style:{fill:o.color,fontSize:o.fontSize},formatter:s=>{let r=s.value;const d=[];if(o.showDimension&&d.push(s.field),o.showQuota&&d.push(D(s.value,o.quotaLabelFormatter)),o.showProportion){const p=`${(Math.round(s.percent*1e4)/100).toFixed(o.reserveDecimalCount)}%`;o.showDimension&&o.showQuota?d.push(`(${p})`):d.push(p)}return r=d.join(" "),r}};return{...e,label:a}}configTooltip(t,e){var p,c;const{tooltip:o,label:i}=L(t.customAttr),{yAxis:l}=t;if(!o.show)return{...e,tooltip:!1};const n=i.reserveDecimalCount,a=no(e.data),s=(p=e.data)==null?void 0:p.reduce((f,h)=>Ge(f,h.value??0),0),r=(c=o.seriesTooltipFormatter)==null?void 0:c.filter(f=>f.show).reduce((f,h)=>(f[h.id]=h,f),{}),d={showTitle:!0,title:()=>{},customItems(f){var x,b;let h=f;(x=o.seriesTooltipFormatter)!=null&&x.length&&(h=f.filter(S=>r[S.data.quotaList[0].id]));const g=[],y=f[0];return h.forEach(S=>{const A=r[S.data.quotaList[0].id]??l[0],v=parseFloat(S.value),C=D(v,A.formatterCfg),T=(Math.round(v/s*1e4)/100).toFixed(n),k=Y(A.chartShowName)?A.name:A.chartShowName;g.push({...S,name:k,value:`${C??""} (${T}%)`})}),(b=y.data.dynamicTooltipValue)==null||b.forEach(S=>{const A=r[S.fieldId];if(A){const v=a[S.fieldId],C=(Math.round(S.value/v*1e4)/100).toFixed(n),T=D(parseFloat(S.value),A.formatterCfg),k=Y(A.chartShowName)?A.name:A.chartShowName;g.push({color:"grey",name:k,value:`${T??""} (${C}%)`})}}),g},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:d}}configBasicStyle(t,e){const o=L(t.customAttr),{basicStyle:i}=o,{data:l}=e;if(l!=null&&l.length&&i.calcTopN&&l.length>i.topN){l.sort((r,d)=>d.value-r.value);const n=l.splice(i.topN),a={...l[0],dynamicTooltipValue:[],field:i.topNLabel,name:i.topNLabel,value:0},s={};n.reduce((r,d)=>{var p;return r.value+=d.value??0,(p=d.dynamicTooltipValue)==null||p.forEach(c=>{s[c.fieldId]=(s[c.fieldId]||0)+c.value}),r},a);for(const r in s)a.dynamicTooltipValue.push({fieldId:r,value:s[r]});l.push(a)}return{...e,radius:i.radius/100}}setupDefaultOptions(t){const{customAttr:e,customStyle:o}=t,{label:i}=e;["inner","outer"].includes(i.position)||(i.position="outer"),e.label={...i,show:!0,showDimension:!0,showProportion:!0,reserveDecimalCount:2};const{legend:l}=o;return l.show=!1,t}setupSeriesColor(t,e){e=Z(e);const{calcTopN:o,topN:i,topNLabel:l}=t.customAttr.basicStyle;return e!=null&&e.length&&o&&e.length>i&&(e.sort((n,a)=>a.value-n.value),e.splice(i),e.push({field:l,value:0})),_e(t,e)}setupOptions(t,e){return Q(this.configTheme,this.configBasicStyle,this.configSingleDimensionColor,this.configLabel,this.configTooltip,this.configLegend)(t,e,{},this)}}class pa extends Ki{constructor(){super("pie-donut");w(this,"propertyInner",{...fo,"basic-style-selector":["colors","alpha","radius","innerRadius","topN","seriesColor"]})}configBasicStyle(t,e){const o=super.configBasicStyle(t,e),{basicStyle:i}=L(t.customAttr);return{...o,radius:i.radius/100,innerRadius:i.innerRadius/100}}}const ha=Object.freeze(Object.defineProperty({__proto__:null,Pie:Ki,PieDonut:pa},Symbol.toStringTag,{value:"Module"})),{t:yo}=U();class tl extends st{constructor(t="pie-rose"){super(t,[]);w(this,"axis",Zi);w(this,"properties",Gi);w(this,"propertyInner",fo);w(this,"axisConfig",{...Qi,yAxis:{name:`${yo("chart.drag_block_pie_radius")} / ${yo("chart.quota")}`,type:"q",limit:1}})}async drawChart(t){var d,p,c;const{chart:e,container:o,action:i}=t;if(this.configEmptyDataStyle((d=e.data)==null?void 0:d.data,o,null,yo("chart.no_data_or_not_positive")),!((c=(p=e==null?void 0:e.data)==null?void 0:p.data)!=null&&c.length))return;const n={data:e.data.data,xField:"field",yField:"value",seriesField:"field",appendPadding:ft(e),interactions:[{type:"legend-active",cfg:{start:[{trigger:"legend-item:mouseenter",action:["element-active:reset"]}],end:[{trigger:"legend-item:mouseleave",action:["element-active:reset"]}]}},{type:"legend-filter",cfg:{start:[{trigger:"legend-item:click",action:["list-unchecked:toggle","data-filter:filter","element-active:reset","element-highlight:reset"]}]}},{type:"tooltip",cfg:{start:[{trigger:"interval:mousemove",action:"tooltip:show"}],end:[{trigger:"interval:mouseleave",action:"tooltip:hide"}]}}],meta:{field:{type:"cat"}}},a=this.setupOptions(e,n),{Rose:s}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(f=>f.ac),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),r=new s(o,a);return r.on("interval:click",i),yt(e,r),r}configBasicStyle(t,e){const{basicStyle:o}=L(t.customAttr);return{...e,radius:o.radius/100}}configLabel(t,e){var a;const{label:o}=L(t.customAttr);if(!o.show)return{...e,label:!1};const i=(a=e.data)==null?void 0:a.reduce((s,r)=>Ge(s,r.value??0),0),l=[];if(!o.fullDisplay){const s=super.configLabel(t,e);l.push(...s.label.layout)}const n={autoRotate:!0,layout:l,style:{fill:o.color,fontSize:o.fontSize},formatter:s=>{let r=s.value;const d=[];if(o.showDimension&&d.push(s.field),o.showQuota&&d.push(D(s.value,o.quotaLabelFormatter)),o.showProportion){const p=`${(Math.round(s.value/i*1e4)/100).toFixed(o.reserveDecimalCount)}%`;o.showDimension&&o.showQuota?d.push(`(${p})`):d.push(p)}return r=d.join(`
`),r}};return o.position==="inner"&&(n.offset=-10),{...e,label:n}}configTooltip(t,e){var p,c;const{tooltip:o,label:i}=L(t.customAttr),{yAxis:l}=t;if(!o.show)return{...e,tooltip:!1};const n=i.reserveDecimalCount,a=no(e.data),s=(p=e.data)==null?void 0:p.reduce((f,h)=>Ge(f,h.value??0),0),r=(c=o.seriesTooltipFormatter)==null?void 0:c.filter(f=>f.show).reduce((f,h)=>(f[h.id]=h,f),{}),d={showTitle:!0,title:()=>{},customItems(f){var x,b;let h=f;(x=o.seriesTooltipFormatter)!=null&&x.length&&(h=f.filter(S=>r[S.data.quotaList[0].id]));const g=[],y=f[0];return h.forEach(S=>{const A=r[S.data.quotaList[0].id]??l[0],v=parseFloat(S.value),C=D(v,A.formatterCfg),T=(Math.round(v/s*1e4)/100).toFixed(n),k=Y(A.chartShowName)?A.name:A.chartShowName;g.push({...S,name:k,value:`${C??""} (${T}%)`})}),(b=y.data.dynamicTooltipValue)==null||b.forEach(S=>{const A=r[S.fieldId];if(A){const v=a[S.fieldId],C=(Math.round(S.value/v*1e4)/100).toFixed(n),T=D(parseFloat(S.value),A.formatterCfg),k=Y(A.chartShowName)?A.name:A.chartShowName;g.push({color:"grey",name:k,value:`${T??""} (${C}%)`})}}),g},container:mt(`tooltip-${t.id}`),itemTpl:pt,enterable:!0};return{...e,tooltip:d}}setupDefaultOptions(t){const{customAttr:e,customStyle:o}=t,{label:i}=e;["inner","outer"].includes(i.position)||(i.position="outer"),e.label={...i,show:!0,showDimension:!0,showProportion:!0,reserveDecimalCount:2};const{legend:l}=o;return l.show=!1,t}setupSeriesColor(t,e){return _e(t,e)}setupOptions(t,e){return Q(this.configBasicStyle,this.configSingleDimensionColor,this.configTheme,this.configLabel,this.configLegend,this.configTooltip)(t,e)}}class ga extends tl{constructor(){super("pie-donut-rose");w(this,"propertyInner",{...fo,"basic-style-selector":["colors","alpha","radius","innerRadius","seriesColor"]})}configBasicStyle(t,e){const o=L(t.customAttr);return{...e,radius:o.basicStyle.radius/100,innerRadius:o.basicStyle.innerRadius/100}}}const ya=Object.freeze(Object.defineProperty({__proto__:null,Rose:tl,RoseDonut:ga},Symbol.toStringTag,{value:"Module"})),{t:ne}=U(),xa=[];class ba extends st{constructor(){super("t-heatmap",xa);w(this,"properties",["basic-style-selector","background-overall-component","label-selector","legend-selector","x-axis-selector","y-axis-selector","title-selector","tooltip-selector","jump-set","linkage","border-style"]);w(this,"propertyInner",{"background-overall-component":["all"],"basic-style-selector":["colors"],"label-selector":["fontSize","color"],"x-axis-selector":["name","color","fontSize","position","axisLabel","axisLine"],"y-axis-selector":["name","color","fontSize","position","axisLabel","axisLine","showLengthLimit"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"legend-selector":["orient","color","fontSize","hPosition","vPosition"],"tooltip-selector":["show","color","fontSize","backgroundColor"],"border-style":["all"]});w(this,"axis",["xAxis","xAxisExt","extColor","filter"]);w(this,"axisConfig",{xAxis:{name:`${ne("chart.x_axis")} / ${ne("chart.dimension")}`,type:"d",limit:1},xAxisExt:{name:`${ne("chart.y_axis")} / ${ne("chart.dimension")}`,type:"d",limit:1},extColor:{name:`${ne("chart.color")} / ${ne("chart.dimension_or_quota")}`,limit:1}});w(this,"getDefaultLength",(t,e)=>{const o=document.getElementById(t.container),i=(o==null?void 0:o.clientHeight)||100,l=(o==null?void 0:o.clientWidth)||100;let n=i-i*.5;return e.orient!=="vertical"&&(n=l-l*.5),n});w(this,"sortData",(t,e)=>{const{deType:o,sort:i,customSort:l}=t;return i==="desc"?o===0?e.sort().reverse():e.sort((n,a)=>a-n):i==="asc"?o===0?e.sort():e.sort((n,a)=>n-a):l&&l.length>0?l:e})}async drawChart(t){const{chart:e,container:o,action:i}=t,l=it(e.xAxis),n=it(e.xAxisExt),a=it(e.extColor);if(!(l!=null&&l.length)||!(n!=null&&n.length)||!(a!=null&&a.length))return;const s=l[0].dataeaseName,r=n[0].dataeaseName,d=a[0].dataeaseName,p=Z(e.data.tableRow);p.forEach(y=>{Object.keys(y).forEach(x=>{x==="*"&&(y["@"]=y[x])})});const c={data:p,xField:s,yField:r,colorField:d==="*"?"@":d,appendPadding:ft(e),meta:{[s]:{type:"cat",values:this.sortData(l[0],[...new Set(p.map(y=>y[[s]]))])},[r]:{type:"cat",values:this.sortData(n[0],[...new Set(p.map(y=>y[[r]]))]).reverse()}},legend:{layout:"vertical",position:"right",slidable:!0,label:{align:"left",spacing:10}}};e.container=o;const f=this.setupOptions(e,c),{Heatmap:h}=await lt(()=>import("./@antv-0.0.0-dataease.js").then(y=>y.a9),["./@antv-0.0.0-dataease.js","./eventemitter3-0.0.0-dataease.js","./@amap-0.0.0-dataease.js","./lodash-0.0.0-dataease.js","./@mapbox-0.0.0-dataease.js","./pbf-0.0.0-dataease.js","./ieee754-0.0.0-dataease.js","./supercluster-0.0.0-dataease.js","./@babel-0.0.0-dataease.js","./gl-matrix-0.0.0-dataease.js","./tslib-0.0.0-dataease.js","./topojson-client-0.0.0-dataease.js","./viewport-mercator-project-0.0.0-dataease.js","./@turf-0.0.0-dataease.js","./polygon-clipping-0.0.0-dataease.js","./splaytree-0.0.0-dataease.js","./robust-predicates-0.0.0-dataease.js","./d3-scale-0.0.0-dataease.js","./d3-collection-0.0.0-dataease.js","./d3-format-0.0.0-dataease.js","./d3-time-format-0.0.0-dataease.js","./d3-time-0.0.0-dataease.js","./d3-color-0.0.0-dataease.js","./d3-array-0.0.0-dataease.js","./earcut-0.0.0-dataease.js","./regl-0.0.0-dataease.js","./lodash-es-0.0.0-dataease.js","./mapbox-gl-0.0.0-dataease.js","./d3-dsv-0.0.0-dataease.js","./geojson-vt-0.0.0-dataease.js","./hammerjs-0.0.0-dataease.js","./element-resize-detector-0.0.0-dataease.js","./batch-processor-0.0.0-dataease.js","./d3-hexbin-0.0.0-dataease.js","./detect-browser-0.0.0-dataease.js","./d3-ease-0.0.0-dataease.js","./d3-interpolate-0.0.0-dataease.js","./d3-timer-0.0.0-dataease.js","./fecha-0.0.0-dataease.js","./size-sensor-0.0.0-dataease.js","./d3-regression-0.0.0-dataease.js","./d3-hierarchy-0.0.0-dataease.js","./fmin-0.0.0-dataease.js","./pdfast-0.0.0-dataease.js","..\\css\\@antv-0.0.0-dataease.css"],import.meta.url),g=new h(o,f);return g.on("plot:click",y=>{var S;if(!((S=y.data)!=null&&S.data))return;const x=y.data.data,b=[];e.data.fields.forEach(A=>{Object.keys(x).forEach(v=>{v.startsWith("f_")&&A.dataeaseName===v&&b.push({id:A.id,dataeaseName:A.dataeaseName,value:x[v]})})}),i({x:y.data.x,y:y.data.y,data:{data:{...y.data.data,value:b[1].value,name:b[1].id,dimensionList:b,quotaList:[b[1]]}}})}),g.on("afterrender",y=>{var b;const x=JSON.parse(JSON.stringify(L(e.customStyle).legend));if(x.show){const S=(b=y.view.getController("legend").option[a[0].dataeaseName])==null?void 0:b.rail;S&&(S.defaultLength=this.getDefaultLength(e,x))}}),te(e,g),g}configBasicStyle(t,e){var l;const o=L(t.customAttr).basicStyle,i=(l=o.colors)==null?void 0:l.map(n=>P(n,o.alpha));return{...e,color:i}}configTooltip(t,e){let o,i;if(t.customAttr&&(i=L(t.customAttr),i.tooltip)){const l=it(t.extColor),a=[it(t.xAxisExt),l];JSON.parse(JSON.stringify(i.tooltip)).show?o={showTitle:!0,customItems(r){const d=[],p=(c,f,h)=>{const g=c!=null&&c.chartShowName?c==null?void 0:c.chartShowName:c==null?void 0:c.name;let y=h[0].data[c.dataeaseName];isNaN(Number(y))||(y=D(y,c==null?void 0:c.formatterCfg)),f.push({...h[0],name:g,value:y})};return a.forEach(c=>{p(c[0],d,r)}),d}}:o=!1}return{...e,tooltip:o}}configXAxis(t,e){const o=wi(t);return{...e,xAxis:o?{...o,grid:null}:!1}}configYAxis(t,e){const o=so(t);return{...e,yAxis:o?{...o,grid:null}:!1}}configLegend(t,e){const o=super.configLegend(t,e);if(o.legend){const i=JSON.parse(JSON.stringify(L(t.customStyle).legend));o.legend.slidable=!0,o.legend.minHeight=10,o.legend.minWidth=10,o.legend.maxHeight=600,o.legend.maxWidth=600;const l=document.getElementById(t.container),n=(l==null?void 0:l.clientHeight)||100,a=(l==null?void 0:l.clientWidth)||100;let s=n-n*.5;i.orient==="vertical"?o.legend.offsetY=-5:s=a-a*.5,o.legend.rail={defaultLength:s},o.legend.label={spacing:10,style:{fill:i.color,fontSize:i.fontSize}}}return o}setupDefaultOptions(t){return t.customStyle.legend.orient="vertical",t.customStyle.legend.vPosition="center",t.customStyle.legend.hPosition="right",t.customStyle.legend.rail={defaultLength:100},t}configLabel(t,e){const o=super.configLabel(t,e);if(o.label){const i=it(t.extColor),l=[];o.label.fullDisplay||l.push(...o.label.layout);const n={...o.label,position:"middle",layout:l,formatter:a=>{var r,d;const s=a[(r=i[0])==null?void 0:r.dataeaseName];return isNaN(Number(s))?s:D(s,(d=i[0])==null?void 0:d.formatterCfg)}};return{...o,label:n}}return o}setupOptions(t,e){return Q(this.configTheme,this.configXAxis,this.configYAxis,this.configBasicStyle,this.configLegend,this.configTooltip,this.configLabel)(t,e)}}const Sa=Object.freeze(Object.defineProperty({__proto__:null,TableHeatmap:ba},Symbol.toStringTag,{value:"Module"})),{t:Wt}=U();function Aa(m){const u=P(at.tableHeaderBgColor,ct.alpha),t=at.tableHeaderAlign,e=P(kt.tableItemBgColor,ct.alpha),o=kt.tableItemAlign,i=P(ct.tableBorderColor,ct.alpha),l=ct.tableScrollBarColor,n=Xo(l,3),a=m.fontFamily&&m.fontFamily!=="inherit"?m.fontFamily:bi,s={background:{color:"#00000000"},splitLine:{horizontalBorderColor:i,horizontalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderColor:i,verticalBorderColorOpacity:1,verticalBorderWidth:1,showShadow:!1},cornerCell:{cell:{backgroundColor:u,horizontalBorderColor:i,verticalBorderColor:i},text:{fill:at.tableHeaderFontColor,fontSize:at.tableTitleFontSize,textAlign:t,fontFamily:a},bolderText:{fill:at.tableHeaderFontColor,fontSize:at.tableTitleFontSize,textAlign:t,fontFamily:a},measureText:{fill:at.tableHeaderFontColor,fontSize:at.tableTitleFontSize,textAlign:t,fontFamily:a}},rowCell:{cell:{backgroundColor:u,horizontalBorderColor:i,verticalBorderColor:i},text:{fill:at.tableHeaderFontColor,fontSize:at.tableTitleFontSize,textAlign:t,textBaseline:"middle",fontFamily:a},bolderText:{fill:at.tableHeaderFontColor,fontSize:at.tableTitleFontSize,textAlign:t,fontFamily:a},measureText:{fill:at.tableHeaderFontColor,fontSize:at.tableTitleFontSize,textAlign:t,fontFamily:a},seriesText:{fill:kt.tableItemBgColor,fontSize:kt.tableItemFontSize,textAlign:o,fontFamily:a}},colCell:{cell:{backgroundColor:u,horizontalBorderColor:i,verticalBorderColor:i},text:{fill:at.tableHeaderFontColor,fontSize:at.tableTitleFontSize,textAlign:t,fontFamily:a},bolderText:{fill:at.tableHeaderFontColor,fontSize:at.tableTitleFontSize,textAlign:t,fontFamily:a},measureText:{fill:at.tableHeaderFontColor,fontSize:at.tableTitleFontSize,textAlign:t,fontFamily:a}},dataCell:{cell:{backgroundColor:e,horizontalBorderColor:i,verticalBorderColor:i},text:{fill:kt.tableFontColor,fontSize:kt.tableItemFontSize,textAlign:o,fontFamily:a},bolderText:{fill:kt.tableFontColor,fontSize:kt.tableItemFontSize,textAlign:o,fontFamily:a},measureText:{fill:kt.tableFontColor,fontSize:kt.tableItemFontSize,textAlign:t,fontFamily:a}},scrollBar:{thumbColor:l,thumbHoverColor:n,size:8,hoverSize:12}};let r;if(m.customAttr){r=L(m.customAttr);const{basicStyle:d,tableHeader:p,tableCell:c}=r;if(d){const f=d.tableBorderColor,h=d.tableScrollBarColor,g={splitLine:{horizontalBorderColor:f,verticalBorderColor:f},cornerCell:{cell:{horizontalBorderColor:f,verticalBorderColor:f}},colCell:{cell:{horizontalBorderColor:f,verticalBorderColor:f}},dataCell:{cell:{horizontalBorderColor:f,verticalBorderColor:f,interactionState:{hoverFocus:{borderOpacity:d.showHoverStyle===!1?0:1}}}},scrollBar:{thumbColor:h,thumbHoverColor:Xo(h,1.5)}};vt(s,g)}if(p){const f=P(p.tableHeaderFontColor,d.alpha);let h=p.tableHeaderBgColor;Ft(h)||(h=P(h,d.alpha));const g=p.isItalic?"italic":"normal",y=p.isBolder===!1?"normal":"bold",{tableHeaderAlign:x,tableTitleFontSize:b}=p;vt(s,{cornerCell:{cell:{backgroundColor:h},bolderText:{fill:f,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a},text:{fill:f,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a},measureText:{fill:f,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a}},colCell:{cell:{backgroundColor:h},bolderText:{fill:f,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a},text:{fill:f,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a},measureText:{fill:f,fontSize:b,textAlign:x,fontStyle:g,fontWeight:y,fontFamily:a}}}),p.showHorizonBorder===!1&&p.showTableHeader!==!1&&vt(s,{splitLine:{horizontalBorderColor:h,horizontalBorderWidth:0,horizontalBorderColorOpacity:0},colCell:{cell:{horizontalBorderColor:h,horizontalBorderWidth:0}}}),p.showVerticalBorder===!1&&p.showTableHeader!==!1&&vt(s,{splitLine:{verticalBorderColor:h,verticalBorderWidth:0,verticalBorderColorOpacity:0},colCell:{cell:{verticalBorderColor:h,verticalBorderWidth:0}},cornerCell:{cell:{verticalBorderColor:h,verticalBorderWidth:0}}})}if(c){const f=P(c.tableFontColor,d.alpha);let h=c.tableItemBgColor;Ft(h)||(h=P(h,d.alpha));let g=c.tableItemSubBgColor;Ft(g)||(g=P(g,d.alpha));const y=c.isItalic?"italic":"normal",x=c.isBolder===!1?"normal":"bold",{tableItemAlign:b,tableItemFontSize:S,enableTableCrossBG:A}=c;vt(s,{rowCell:{cell:{backgroundColor:h,horizontalBorderColor:h,verticalBorderColor:h},bolderText:{fill:f,textAlign:b,fontSize:S,fontFamily:a},text:{fill:f,textAlign:b,fontSize:S,fontFamily:a},measureText:{fill:f,textAlign:b,fontSize:S,fontFamily:a},seriesText:{fill:f,textAlign:b,fontSize:S,fontFamily:a}},dataCell:{cell:{crossBackgroundColor:A?g:h,backgroundColor:h},bolderText:{fill:f,textAlign:b,fontSize:S,fontStyle:y,fontWeight:x,fontFamily:a},text:{fill:f,textAlign:b,fontSize:S,fontStyle:y,fontWeight:x,fontFamily:a},measureText:{fill:f,textAlign:b,fontSize:S,fontStyle:y,fontWeight:x,fontFamily:a},seriesText:{fill:f,textAlign:b,fontSize:S,fontStyle:y,fontWeight:x,fontFamily:a}}}),c.showHorizonBorder===!1&&vt(s,{dataCell:{cell:{horizontalBorderColor:h,horizontalBorderWidth:0}}}),c.showVerticalBorder===!1&&vt(s,{splitLine:{verticalBorderWidth:0,verticalBorderColorOpacity:0},dataCell:{cell:{verticalBorderColor:h,verticalBorderWidth:0}}})}}return s}function Ca(m,u){var o,i,l;const t={};let e;if(m.customAttr){e=L(m.customAttr);const{basicStyle:n,tableHeader:a,tableCell:s}=e;switch(t.colCfg={height:a.tableTitleHeight},t.cellCfg={height:s.tableItemHeight},n.tableColumnMode){case"adapt":{t.layoutWidthType="compact";break}case"field":{delete t.layoutWidthType;const r=((o=n.tableFieldWidth)==null?void 0:o.reduce((f,h)=>(f[h.fieldId]=h,f),{}))||{};if(m.drill){const{xAxis:f}=L(m),h=m.drillFields[m.drillFilters.length],g=f.findIndex(x=>x.id===m.drillFilters[0].fieldId),y=f[g];r[h.dataeaseName]={width:(i=r[y.dataeaseName])==null?void 0:i.width}}const d=(l=u.meta)==null?void 0:l.reduce((f,h)=>{var g;return f+(((g=r[h.field])==null?void 0:g.width)??10)},0),p=parseInt(d.toFixed(0))===100,c=[];t.colCfg.width=f=>{var b;const h=f.spreadsheet.container.cfg.el.getBoundingClientRect().width;if(!((b=n.tableFieldWidth)!=null&&b.length)){const S=m.data.fields.length,A=a.showIndex?S+1:S;return h/A}const g=h/100,y=r[f.field]?r[f.field].width*g:g*10,x=parseInt(y.toFixed(0));if(p)if(c.length===u.meta.length-1){const S=c.reduce((v,C)=>v+C,0),A=h-S;if(c.splice(0),A<x)return A}else c.push(x);return x};break}case"custom":{t.colCfg.width=n.tableColumnWidth;break}default:delete t.layoutWidthType,t.colCfg.width=r=>{const d=r.spreadsheet.container.cfg.el.offsetWidth,p=r.spreadsheet.dataCfg.meta.length;if(!p)return 0;const c=a.showIndex?p+1:p,f=d/c;return Math.max(f,n.tableColumnWidth)}}}return t}function wa(m){const{threshold:u}=L(m.senior);if(!u.enable)return;const t={text:[],background:[]},e=u.tableThreshold??[],o=[...m.xAxis,...m.xAxisExt].map(i=>i.dataeaseName);if((e==null?void 0:e.length)>0){const{tableCell:i,basicStyle:l,tableHeader:n}=L(m.customAttr),a=m.type==="table-info"?i.enableTableCrossBG&&!i.mergeCells:i.enableTableCrossBG,s=Ft(i.tableFontColor)?i.tableFontColor:P(i.tableFontColor,l.alpha),r=a?null:Ft(i.tableItemBgColor)?i.tableItemBgColor:P(i.tableItemBgColor,l.alpha),d=n.tableHeaderFontColor,p=Ft(n.tableHeaderBgColor)?n.tableHeaderBgColor:P(n.tableHeaderBgColor,l.alpha),c=va(m);for(let f=0;f<e.length;f++){const h=e[f];let g=s,y=r;m.type==="table-pivot"&&o.includes(h.field.dataeaseName)&&(g=d,y=p),t.text.push({field:h.field.dataeaseName,mapping(x,b){return b!=null&&b.isTotals||b!=null&&b.id&&(b==null?void 0:b.field)===b.id?null:{fill:si(x,g,h,"color",c,b)}}}),t.background.push({field:h.field.dataeaseName,mapping(x,b){if(b!=null&&b.isTotals||b!=null&&b.id&&(b==null?void 0:b.field)===b.id)return null;const S=si(x,y,h,"backgroundColor",c,b);return Tl(S)?null:{fill:S}}})}}return t}function si(m,u,t,e,o,i){let l=null;for(let n=0;n<t.conditions.length;n++){let a=!1;const s=t.conditions[n];let r,d,p;if(s.type==="dynamic"?s.term==="between"?(d=parseFloat(xo(s.dynamicMaxField,o,i)),p=parseFloat(xo(s.dynamicMinField,o,i))):r=xo(s.dynamicField,o,i):s.term==="between"?(p=parseFloat(s.min),d=parseFloat(s.max)):r=s.value,t.field.deType===2||t.field.deType===3||t.field.deType===4){if(r=parseFloat(r),s.term==="eq"?m===r&&(l=s[e],a=!0):s.term==="not_eq"?m!==r&&(l=s[e],a=!0):s.term==="lt"?m<r&&(l=s[e],a=!0):s.term==="gt"?m>r&&(l=s[e],a=!0):s.term==="le"?m<=r&&(l=s[e],a=!0):s.term==="ge"?m>=r&&(l=s[e],a=!0):s.term==="between"?p<=m&&m<=d&&(l=s[e],a=!0):s.term==="default"&&(l=s[e],a=!0),a)break;n===t.conditions.length-1&&(l=u)}else if(t.field.deType===0||t.field.deType===5){if(s.term==="eq"?m===r&&(l=s[e],a=!0):s.term==="not_eq"?m!==r&&(l=s[e],a=!0):s.term==="like"?m.includes(r)&&(l=s[e],a=!0):s.term==="not like"?m.includes(r)||(l=s[e],a=!0):s.term==="null"?(m==null||m==="")&&(l=s[e],a=!0):s.term==="not_null"?m!=null&&m!==""&&(l=s[e],a=!0):s.term==="default"&&(l=s[e],a=!0),a)break;n===t.conditions.length-1&&(l=u)}else{const c=t.conditions[n];r=new Date(r.replace(/-/g,"/")+" GMT+8").getTime();const f=new Date(m.replace(/-/g,"/")+" GMT+8").getTime();if(c.term==="eq"?f===r&&(l=c[e],a=!0):c.term==="not_eq"?f!==r&&(l=c[e],a=!0):c.term==="lt"?f<r&&(l=c[e],a=!0):c.term==="gt"?f>r&&(l=c[e],a=!0):c.term==="le"?f<=r&&(l=c[e],a=!0):c.term==="ge"?f>=r&&(l=c[e],a=!0):c.term==="default"&&(l=c[e],a=!0),a)break;n===t.conditions.length-1&&(l=u)}}return l}function va(m){const u={};return m.data&&m.data.dynamicAssistLines&&m.data.dynamicAssistLines.length>0&&m.data.dynamicAssistLines.forEach(t=>{u[t.summary+"-"+t.fieldId]=t.value}),u}function xo(m,u,t){var e;return m.summary==="value"?t?t[(e=m.field)==null?void 0:e.dataeaseName]:void 0:u[m.summary+"-"+m.fieldId]}function _a(m){var l,n,a;let u=((l=m.data)==null?void 0:l.tableRow)||[],t=[];const e=L(m.senior);let o=(n=e==null?void 0:e.functionCfg)==null?void 0:n.emptyDataStrategy;o||(o="breakLine");const i=(a=e==null?void 0:e.functionCfg)==null?void 0:a.emptyDataFieldCtrl;if(o!=="breakLine"&&(i!=null&&i.length)&&(u!=null&&u.length)){const s=oo(u[0]);t=Rl(s,i)}if(t.length){u=Z(u);for(let s=u.length-1;s>=0;s--)for(let r=0,d=t.length;r<d;r++){const p=t[r];if(u[s][p]===null&&(o==="setZero"&&(u[s][p]=0),o==="ignoreData")){u=je(u,(c,f)=>f!==s);break}}}return u}class _o extends Jl{show(u){const{iconName:t}=u;if(t){this.showSortTooltip(u);return}super.show(u)}showSortTooltip(u){var f,h;const{position:t,options:e,meta:o,event:i}=u,{enterable:l}=Xl(e),{autoAdjustBoundary:n,adjustPosition:a}=this.spreadsheet.options.tooltip||{};this.visible=!0,this.options=u;const s=this.getContainer(),r=rs(us,{table:this.spreadsheet,meta:o});this.spreadsheet.tooltip.container.innerHTML="";const d=document.createElement("div");this.spreadsheet.tooltip.container.appendChild(d),cs(r,d);const{x:p,y:c}=Gl({spreadsheet:this.spreadsheet,position:t,tooltipContainer:s,autoAdjustBoundary:n});this.position=(a==null?void 0:a({position:{x:p,y:c},event:i}))??{x:p,y:c},Si(s,{style:{left:`${(f=this.position)==null?void 0:f.x}px`,top:`${(h=this.position)==null?void 0:h.y}px`,pointerEvents:l?"all":"none",zIndex:9999,position:"absolute",color:"black",background:"white",fontSize:"16px"},visible:!0})}}const La='<svg t="1711681787276" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4355" width="200" height="200"><path d="M922.345786 372.183628l-39.393195 38.687114L676.138314 211.079416l0 683.909301-54.713113 0L621.425202 129.010259l53.320393 0L922.345786 372.183628zM349.254406 894.989741 101.654214 651.815349l39.393195-38.687114 206.814276 199.792349L347.861686 129.010259l54.713113 0 0 765.978459L349.254406 894.988718z" fill="{fill}" p-id="4356"></path></svg>',Ta='<svg t="1711682928245" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11756" width="200" height="200"><path d="M960 704L512 256 64 704z" fill="{fill}" p-id="11757"></path></svg>',Ea='<svg t="1711681879346" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4655" width="200" height="200"><path d="M64 320l448 448 448-448z" fill="{fill}" p-id="4656"></path></svg>';function bo(m){return`data:image/svg+xml;charset=utf-8;base64,${btoa(m)}`}function Fa(m,u){const{tableHeaderFontColor:t,tableHeaderSort:e}=L(m.customAttr).tableHeader;if(!e)return;const o=t??"#666",i=bo(La.replace("{fill}",o)),l=bo(Ta.replace("{fill}",o)),n=bo(Ea.replace("{fill}",o)),a=Math.random(),s={asc:`customSortUp${a}`,desc:`customSortDown${a}`};u.customSVGIcons=[{name:`customSortDefault${a}`,svg:i},{name:`customSortUp${a}`,svg:l},{name:`customSortDown${a}`,svg:n}],u.headerActionIcons=[{iconNames:[`customSortDefault${a}`,`customSortUp${a}`,`customSortDown${a}`],belongsCell:"colCell",displayCondition:(r,d)=>{if(r.field===Ai||r.colIndex===-1)return!1;const p=r.spreadsheet.store.get("sortMethodMap"),c=p==null?void 0:p[r.field];return c?d===s[c]:d===`customSortDefault${a}`},onClick:r=>{var f;const{meta:d,event:p}=r;d.spreadsheet.showTooltip({position:{x:p.clientX,y:p.clientY},event:p,...r});const c=document.getElementById(m.container);if((f=c==null?void 0:c.childNodes)!=null&&f.length){const h=Array.from(c.childNodes).filter(g=>g.nodeType===Node.ELEMENT_NODE).find(g=>g.classList.contains("antv-s2-tooltip-container"));if(h&&h.offsetLeft+h.clientWidth>c.offsetWidth){const y=c.offsetWidth-h.clientWidth-10;h.style.left=`${y}px`}}}}]}function za(m,u){const{tooltip:t}=L(m.customAttr),e=m.fontFamily?m.fontFamily:bi;u.tooltip={...u.tooltip,style:{background:t.backgroundColor,fontSize:t.fontSize+"px",fontFamily:e,color:t.color,boxShadow:"rgba(0, 0, 0, 0.1) 0px 4px 8px 0px",borderRadius:"3px",padding:"4px 12px",opacity:.95,position:"absolute"},adjustPosition:({event:o})=>ka(o)}}function to(m,u,t){u.preventDefault();const e=m.getCell(u.target),o=e.getMeta().valueField,i=e.getMeta(),l=m.interaction.getState();let n="";if(l.stateName===Zl.SELECTED){const{cells:a}=l;if(!(a!=null&&a.length))return;if(a.length===1){const c=a[0];e.getMeta().id===c.id&&po(i.value+"",!0),m.interaction.clearState();return}const r=m.interaction.interactions.get(Ql.BRUSH_SELECTION).getScrollBrushRangeCells(a);r.sort((c,f)=>{const h=c.getMeta(),g=f.getMeta();return h.rowIndex!==g.rowIndex?h.rowIndex-g.rowIndex:h.colIndex-g.colIndex});let d=!1;const p=r.reduce((c,f)=>{f.getMeta().colIndex===i.colIndex&&f.getMeta().rowIndex===i.rowIndex&&(d=!0);const h=c[f.getMeta().rowIndex];return h?h.push(f):c[f.getMeta().rowIndex]=[f],c},{});d&&(oo(p).forEach(c=>{const f=p[c];f.forEach((h,g)=>{var A;const y=h.getMeta(),x=(A=y.data)==null?void 0:A[y.valueField],b=we(t,v=>v.field===y.valueField);let S=x==null?void 0:x.toString();b&&(S=b.formatter(x)),S==null&&(S=""),g!==f.length-1&&(S+="	"),n+=S}),n=n+`
`}),n&&po(n,!0)),m.interaction.clearState();return}if(i!=null&&i.data){const a=i.data[o],s=we(t,r=>r.field===o);n=a==null?void 0:a.toString(),s&&(n=s.formatter(a))}else{const a=t==null?void 0:t.reduce((s,r)=>(s[r.field]=r.name,s),{});n=i.value,a!=null&&a[n]&&(n=a[n])}n&&po(n,!0)}function ka(m){const u=m.s2Instance,{x:t,y:e}=m,o={x:t+15,y:e};if(!u)return o;const{height:i,width:l}=u.getCanvasElement().getBoundingClientRect(),{offsetHeight:n,offsetWidth:a}=u.tooltip.getContainer();return a>l&&(o.x=0),n>i&&(o.y=0),(o.x||o.y)&&(o.x&&o.x+a>l&&(o.x-=o.x+a-l),o.y&&(o.y>n?o.y-n>=15?o.y-=n+15:o.y=0:o.y+=15)),o}async function Oa(m,u){var k,O,R,_,B;const{layoutResult:t}=m.facet,{meta:e,fields:o}=m.dataCfg,i=((k=o==null?void 0:o.rows)==null?void 0:k.length)||0,l=((O=o==null?void 0:o.columns)==null?void 0:O.length)||0;if(t.colLeafNodes.length+i+1>16384){io.warning(Wt("chart.pivot_export_invalid_col_exceed"));return}const a=new Ze.Workbook,s=a.addWorksheet(Wt("chart.chart_data")),r=e==null?void 0:e.reduce((E,z)=>(z.field&&(E[z.field]=z),E),{});(R=o.columns)==null||R.forEach((E,z)=>{var F;const N=s.getCell(z+1,1);N.value=((F=r[E])==null?void 0:F.name)??E,N.alignment={vertical:"middle",horizontal:"center"},i>=2&&s.mergeCells(z+1,1,z+1,i),N.border={right:{style:"thick",color:{argb:"00000000"}}}}),(_=o==null?void 0:o.rows)==null||_.forEach((E,z)=>{var F;const N=s.getCell(l+1,z+1);N.value=((F=r[E])==null?void 0:F.name)??E,N.alignment={vertical:"middle",horizontal:"center"},N.border={bottom:{style:"thick",color:{argb:"00000000"}}},z===o.rows.length-1&&(N.border.right={style:"thick",color:{argb:"00000000"}})});const{rowLeafNodes:d,rowsHierarchy:p,rowNodes:c}=t,f=p.maxLevel+1,h={};d.forEach(E=>{let z=E.parent;for(;z;){const M=h[z.id]??0;h[z.id]=M+1,z=z.parent}const{rowIndex:N}=E,F=N+1+l+1,I=E.level+1,$=s.getCell(F,I);$.value=E.label,$.alignment={vertical:"middle",horizontal:"center"},I<f&&s.mergeCells(F,I,F,f),$.border={right:{style:"thick",color:{argb:"00000000"}}}});const g=E=>{var z;return(z=E.children)!=null&&z.length?g(E.children[0]):E.rowIndex+1};c==null||c.forEach(E=>{if(E.isLeaf)return;const z=g(E),N=h[E.id],F=z+l+1,I=E.children[0].level-E.level,$=E.label,M=s.getCell(F,E.level+1);M.value=$,M.alignment={vertical:"middle",horizontal:"center"},(I>1||N>1)&&s.mergeCells(F,E.level+1,F+N-1,E.level+I)});const{colLeafNodes:y,colNodes:x,colsHierarchy:b}=t,S=b.maxLevel+1,A={};y.forEach(E=>{var H;let z=E.parent;for(;z;){const J=A[z.id]??0;A[z.id]=J+1,z=z.parent}const{colIndex:N}=E,F=E.level+1,I=N+1+i,$=s.getCell(F,I);let M=E.label;E.field==="$$extra$$"&&((H=r[M])!=null&&H.name)&&(M=r[M].name),$.value=M,$.alignment={vertical:"middle",horizontal:"center"},F<S&&s.mergeCells(F,I,S,I),$.border={bottom:{style:"thick",color:{argb:"00000000"}}}});const v=E=>{var z;return(z=E.children)!=null&&z.length?v(E.children[0]):E.colIndex+1};x.forEach(E=>{if(E.isLeaf)return;const z=v(E),N=A[E.id],F=E.level+1,I=E.children[0].level-E.level,$=E.label,M=z+i,H=s.getCell(F,M);H.value=$,H.alignment={vertical:"middle",horizontal:"center"},(I>1||N>1)&&s.mergeCells(F,M,F+I-1,M+N-1)});for(let E=0;E<d.length;E++)for(let z=0;z<y.length;z++){const N=t.getCellMeta(E,z),{fieldValue:F}=N;if(F===0||F){const I=r[N.valueField],$=s.getCell(E+S+1,i+z+1),M=((B=I==null?void 0:I.formatter)==null?void 0:B.call(I,F))||F.toString();$.alignment={vertical:"middle",horizontal:"center"},$.value=M}}const C=await a.xlsx.writeBuffer(),T=new Blob([C],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});Qe.saveAs(T,`${u.title??"透视表"}.xlsx`)}async function Na(m,u){var b,S,A,v;const t=m.facet.layoutResult;if(t.colLeafNodes.length+2>16384){io.warning(Wt("chart.pivot_export_invalid_col_exceed"));return}const{meta:e,fields:o}=m.dataCfg,i=((b=o==null?void 0:o.columns)==null?void 0:b.length)||0,l=new Ze.Workbook,n=l.addWorksheet(Wt("chart.chart_data")),a=e==null?void 0:e.reduce((C,T)=>(T.field&&(C[T.field]=T),C),{});(S=o.columns)==null||S.forEach((C,T)=>{var O;const k=n.getCell(T+1,1);k.value=((O=a[C])==null?void 0:O.name)??C,k.alignment={vertical:"middle",horizontal:"center"},k.border={right:{style:"thick",color:{argb:"00000000"}}}});const s=t.colsHierarchy.maxLevel+1,r=(A=o==null?void 0:o.rows)==null?void 0:A.map(C=>{var T;return((T=a[C])==null?void 0:T.name)??C}).join("/"),d=n.getCell(i+1,1);d.value=r,d.alignment={vertical:"middle",horizontal:"center"},d.border={right:{style:"thick",color:{argb:"00000000"}},bottom:{style:"thick",color:{argb:"00000000"}}};const{rowLeafNodes:p}=t;p.forEach((C,T)=>{const k=n.getCell(s+T+1,1);k.value=Bl("  ",C.level)+C.label,k.alignment={vertical:"middle",horizontal:"left"},k.border={right:{style:"thick",color:{argb:"00000000"}}}});const c={},{colLeafNodes:f}=t;f.forEach(C=>{var E;let T=C.parent;for(;T;){const z=c[T.id]??0;c[T.id]=z+1,T=T.parent}const{colIndex:k}=C,O=C.level+1,R=k+1+1,_=n.getCell(O,R);let B=C.label;C.field==="$$extra$$"&&((E=a[B])!=null&&E.name)&&(B=a[B].name),_.value=B,_.alignment={vertical:"middle",horizontal:"center"},O<s&&n.mergeCells(O,R,s,R),_.border={bottom:{style:"thick",color:{argb:"00000000"}}}});const h=t.colNodes,g=C=>{var T;return(T=C.children)!=null&&T.length?g(C.children[0]):C.colIndex+1};h.forEach(C=>{if(C.isLeaf)return;const T=g(C),k=c[C.id],O=C.level+1,R=C.children[0].level-C.level,_=T+1,B=n.getCell(O,_);B.value=C.label,B.alignment={vertical:"middle",horizontal:"center"},(R>1||k>1)&&n.mergeCells(O,_,O+R-1,_+k-1)});for(let C=0;C<p.length;C++)for(let T=0;T<f.length;T++){const k=t.getCellMeta(C,T),{fieldValue:O}=k;if(O===0||O){const R=a[k.valueField],_=n.getCell(C+s+1,T+1+1),B=((v=R==null?void 0:R.formatter)==null?void 0:v.call(R,O))||O.toString();_.alignment={vertical:"middle",horizontal:"center"},_.value=B}}const y=await l.xlsx.writeBuffer(),x=new Blob([y],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});Qe.saveAs(x,`${u.title??"透视表"}.xlsx`)}async function Cr(m,u){var i,l;const{fields:t}=m.dataCfg,e=((i=t==null?void 0:t.rows)==null?void 0:i.length)||0,o=((l=t==null?void 0:t.values)==null?void 0:l.length)||0;if(!(e&&o)){io.warning(Wt("chart.pivot_export_invalid_field"));return}u.customAttr.basicStyle.tableLayoutMode!=="tree"?Oa(m,u):Na(m,u)}async function wr(m,u=100){var s,r,d;console.log("[fetchAllTableRows] Using standard pagination logic from the start."),console.log("[fetchAllTableRows] Initial view object for pagination:",JSON.parse(JSON.stringify(m)));let t=[];const e=JSON.parse(JSON.stringify(m));e.chartExtRequest=e.chartExtRequest||{},e.chartExtRequest.pageNo=1,e.chartExtRequest.pageSize=u,delete e.chartExtRequest.resultMode,delete e.chartExtRequest.resultCount,console.log("[fetchAllTableRows] Standard pagination - First page request object being sent:",JSON.parse(JSON.stringify(e)));const o=await Qo(e);console.log("[fetchAllTableRows] Standard pagination - First page response:",o),t=(((s=o.data)==null?void 0:s.tableRow)||[]).slice();const i=((r=o.data)==null?void 0:r.totalItems)||((d=o.data)==null?void 0:d.total)||t.length,l=Math.ceil(i/u),n=[];for(let p=2;p<=l;p++){const c=JSON.parse(JSON.stringify(m));c.chartExtRequest=c.chartExtRequest||{},c.chartExtRequest.pageNo=p,c.chartExtRequest.pageSize=u,delete c.chartExtRequest.resultMode,delete c.chartExtRequest.resultCount,n.push(Qo(c))}return(await Promise.all(n)).forEach(p=>{var f;const c=((f=p.data)==null?void 0:f.tableRow)||[];t=t.concat(c)}),{...o,data:{...o.data||{},tableRow:t,totalItems:i,total:i}}}async function vr(m,u,t="明细表",e=null,o=null,i={},l={}){var k,O,R,_,B,E;const n=m.value||m._value||m,a=(O=(k=n.customAttr)==null?void 0:k.tableHeader)==null?void 0:O.headerGroupConfig,s=a==null?void 0:a.columns,r=(a==null?void 0:a.meta)||[],d=u.fields||u.sourceFields||[],p={};if(d.forEach(z=>{p[z.dataeaseName||z.key]=z.name}),r&&Array.isArray(r)&&r.length>0&&s&&s.length>0){let z=function(tt,q,G,xt){return tt.slice().sort((X,K)=>{let ot,St;for(let wt of q){if(ot=X[wt],St=K[wt],ot<St)return-1;if(ot>St)return 1}if(G&&xt){const et=xt[ot];if(et){const nt=et.indexOf(X[G]),Yt=et.indexOf(K[G]);if(nt!==-1&&Yt!==-1){if(nt<Yt)return-1;if(nt>Yt)return 1}else{if(nt!==-1)return-1;if(Yt!==-1)return 1}}}if(G){if(X[G]<K[G])return-1;if(X[G]>K[G])return 1}return 0})};const N=il(s),F=new Ze.Workbook,I=F.addWorksheet(String(t));el(I,s,r,p,1,1,N);const $=e;if(!$||$.length===0)return;const M=u.tableRow||[];let H=M;if((o==null?void 0:o.length)>0){const tt=o[0],q=o.length>1?o[1]:null;tt&&q&&Object.keys(l).length>0?H=z(M,[tt],q,l):H=z(M,o,null,null)}console.log("sortedTableRow (after applying expected order if available): ",H);const J={};if((o==null?void 0:o.length)>0){let tt=function(q,G){if(q>=o.length||!G||G.length===0)return;const xt=o[q],X=[];G.forEach(K=>{var St,wt;if(K.start>K.end||K.start>=H.length)return;let ot=K.start;for(let et=K.start;et<=K.end;et++)if(et===K.end||((St=H[et+1])==null?void 0:St[xt])!==((wt=H[ot])==null?void 0:wt[xt])){const nt=et;nt>=ot&&nt-ot+1>1&&J[xt].push({start:ot,end:nt}),nt>=ot&&X.push({start:ot,end:nt}),ot=et+1}}),tt(q+1,X)};o.forEach(q=>{J[q]=[]}),tt(0,[{start:0,end:H.length-1}])}console.log("Final Accurate Recursive Merge Ranges:",J);for(let tt=0;tt<H.length;tt++){const q=[];e.forEach((G,xt)=>{var ot;let X=((ot=H[tt])==null?void 0:ot[G])??"",K=!1;for(const St in i)if(o.includes(St)&&i[St]===xt&&J[St]&&J[St].some(wt=>tt>wt.start&&tt<=wt.end)){K=!0;break}q.push(K?"":X)}),I.addRow(q)}const W=N+1;if((o==null?void 0:o.length)>0&&Object.keys(i).length>0){const tt=new Set;o.forEach(q=>{var xt;const G=i[q];G!==void 0&&G!==-1&&((xt=J[q])==null?void 0:xt.length)>0&&J[q].forEach(X=>{const K=`${X.start+W}:${G+1}`;if(!tt.has(K))try{I.mergeCells(X.start+W,G+1,X.end+W,G+1);for(let ot=X.start;ot<=X.end;ot++)tt.add(`${ot+W}:${G+1}`)}catch(ot){console.error(`Error merging cells for key ${q} at col ${G+1}, range ${X.start}-${X.end}:`,ot)}})})}const j=await F.xlsx.writeBuffer();Qe.saveAs(new Blob([j]),`${String(t)}.xlsx`);return}if(!d||d.length===0){io.error("明细表字段定义为空，无法导出");return}const c=new Ze.Workbook,f=c.addWorksheet(String(t)),h=u.fields||u.sourceFields||[],g=h.map(z=>z.name);f.addRow(g).eachCell(z=>{z.font={bold:!0,color:{argb:"FFFFFFFF"}},z.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF1E90FF"}},z.alignment={vertical:"middle",horizontal:"center"},z.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});const x=u.tableRow||[],b=(_=(R=n.customAttr)==null?void 0:R.tableCell)==null?void 0:_.mergeCells,A=(n.xAxis||[]).filter(z=>z.groupType==="d").map(z=>z.dataeaseName),v={};if(b&&A.length>0&&x.length>0){let z=[{start:0,end:x.length-1}];for(const N of A){v[N]=[];const F=[];for(const I of z){if(I.start>I.end||I.start>=x.length)continue;let $=I.start;for(let M=I.start;M<=I.end;M++){const H=(B=x[M])==null?void 0:B[N],J=M+1<=I.end?(E=x[M+1])==null?void 0:E[N]:void 0;(M===I.end||H!==J)&&(M>=$&&M-$+1>1&&v[N].push({start:$,end:M}),F.push({start:$,end:M}),$=M+1)}}if(z=F,z.length===0)break}}x.forEach((z,N)=>{const F=[];h.forEach($=>{const M=$.dataeaseName||$.key;let H=z[M]??"";v[M]&&v[M].some(J=>N>J.start&&N<=J.end)&&(H=""),F.push(H)}),f.addRow(F).eachCell($=>{$.alignment={vertical:"middle",horizontal:"left"},$.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})});const C=2;b&&A.length>0&&A.forEach(z=>{var F;const N=h.findIndex(I=>(I.dataeaseName||I.key)===z);N!==-1&&((F=v[z])==null?void 0:F.length)>0&&v[z].forEach(I=>{var M;f.mergeCells(I.start+C,N+1,I.end+C,N+1);const $=f.getCell(I.start+C,N+1);$.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},$.alignment={vertical:"middle",horizontal:((M=$.alignment)==null?void 0:M.horizontal)||"left"}})}),f.columns.forEach(z=>{let N=0;z.eachCell({includeEmpty:!0},F=>{const I=F.value,$=I?typeof I=="object"&&I.richText?I.richText.map(M=>M.text).join("").length:I.toString().length:10;$>N&&(N=$)}),z.width=N<10?10:N+2});const T=await c.xlsx.writeBuffer();Qe.saveAs(new Blob([T]),`${String(t)}.xlsx`)}function el(m,u,t,e,o=1,i=1,l=1){let n=i;u.forEach(a=>{const s=m.getRow(o),r=t.find(h=>h.field===a.key);let d=r?r.name:e[a.key]||a.name||a.title||a.key;const p=s.getCell(n);p.value=d,p.alignment={vertical:"middle",horizontal:"center"},p.font={bold:!0};let c=1,f=1;a.children&&a.children.length>0?(c=ol(a),m.mergeCells(o,n,o,n+c-1),el(m,a.children,t,e,o+1,n,l)):(f=l-o+1,f>1&&m.mergeCells(o,n,o+f-1,n)),n+=c})}function ol(m){return!m.children||m.children.length===0?1:m.children.reduce((u,t)=>u+ol(t),0)}function il(m,u=1){let t=u;return m.forEach(e=>{if(e.children&&e.children.length>0){const o=il(e.children,u+1);o>t&&(t=o)}}),t}function Ia(m,u,t){var i;const{mergeCells:e}=L(m.customAttr).tableCell,{showIndex:o}=L(m.customAttr).tableHeader;if(e){u.frozenColCount=0,u.frozenRowCount=0;const n=(m.data.fields||[]).reduce((c,f)=>(c[f.dataeaseName]=f,c),{})||{},a=t.meta.findIndex(c=>{var f;return((f=n[c.field])==null?void 0:f.groupType)==="q"}),s=(i=m.data)==null?void 0:i.tableRow;if(a===0||!(s!=null&&s.length))return;const r=[[[0,s.length-1]]],d=[];t.meta.filter((c,f)=>f<a||a===-1).forEach((c,f)=>{const h=r[f],g=[];r.push(g),h.forEach(y=>{const[x,b]=y;let S=s[x][c.field],A=x;for(let v=x;v<=b;v++){const C=s[v][c.field];if(C!==S||v===b){const T=v-A;if(T>1||v===b&&T===1&&S===C){const k=[],O=T%2===1?(T-1)/2:T/2-1;for(let R=0;R<T;R++)k.push({colIndex:o?f+1:f,rowIndex:A+R,showText:R===O});v===b&&S===C&&k.push({colIndex:o?f+1:f,rowIndex:v,showText:!1}),d.push(k),g.push([A,v===b&&S===C?v:v-1])}S=C,A=v}}})}),o&&d.filter(f=>f[0].colIndex===1).forEach(f=>{const h=Z(f);h.forEach(g=>{g.colIndex=0}),d.unshift(h)}),u.mergedCellsInfo=d,u.mergedCell=(c,f,h)=>(o&&h.colIndex===0&&(h.fieldValue=ll(d,h)),new Ba(c,f,h))}}function ll(m,u){if(!(m!=null&&m.length))return u.rowIndex+1;let t=u.rowIndex;const e=m.reduce((o,i)=>{if(i[0].colIndex!==0)return o;const l=i[0].rowIndex,n=i[i.length-1].rowIndex,a=n-l;return u.rowIndex>=l&&u.rowIndex<=n&&(t=l),u.rowIndex>n?o+a:o},0);return t-e+1}class Ba extends Ci{drawBackgroundShape(){const u=es(this.cells),{backgroundColor:t,backgroundColorOpacity:e}=this.getBackgroundColor(),o=this.theme.dataCell.cell;this.backgroundShape=os(this,{points:u,stroke:o.horizontalBorderColor,fill:t,lineHeight:o.horizontalBorderWidth})}}class ke extends Ao{hideInteractionShape(){this.stateShapes.forEach(u=>{ye(u,xe.backgroundOpacity,0),ye(u,xe.backgroundColor,"transparent"),ye(u,xe.borderOpacity,0),ye(u,xe.borderWidth,0),ye(u,xe.borderColor,"transparent")})}drawTextShape(){this.meta.autoWrap?sl(this,!1):super.drawTextShape()}}class Ra extends Je{drawTextShape(){this.meta.autoWrap?sl(this,!0):super.drawTextShape()}}const sl=(m,u)=>{const t=`
`,e="...",o=m.meta.maxLines??1,{options:{placeholder:i}}=m.spreadsheet,l=Kl(void 0,i),{formattedValue:n}=m.getFormattedFieldValue(),a=m.getTextStyle();let s=Lo(n?n==null?void 0:n.toString():l,a,m.meta.width,m.spreadsheet);const r=s.split(t);let d=a.fontSize;if(u){const c=s.split(t);if(r.length>o){const f=c.slice(0,o),h=c[0].length;f[f.length-1]=f[f.length-1].slice(0,h-1)+e,s=f.join(t)}}else{const c=To(s.replaceAll(t,""),a,m.spreadsheet,o),f=Math.floor(m.meta.height/c),h=r.slice(0,f);s=f<1?e:h.join(t)||e;const g=s.split(t);if(!s.endsWith(e)&&(r.length>o||r.length>f)){const y=g[0].length,x=g.slice(0,Math.min(o,f));x[x.length-1]=x[x.length-1].slice(0,y-1)+e,s=x.join(t)}s===e&&(d=12)}m.actualText=s,m.actualTextWidth=m.spreadsheet.measureTextWidth(s,a);const p=m.getTextPosition();m.textShape=ts(m,[m.textShape],p.x,p.y,s,a,{fontSize:d}),m.textShapes.push(m.textShape)},ni=(m,u,t,e,o)=>{if(t.showTableHeader===!1)return;const i=o||u.facet.layoutResult,l=e.maxLines??1,n={...u.theme.cornerCell.text},a=m.info.meta.value;let s=To(Lo(a,n,m.info.resizedWidth,i.spreadsheet),n,i.spreadsheet,l);const r=i.colLeafNodes.filter(d=>d.colIndex!==m.info.meta.colIndex).reduce((d,p)=>{const c=To(Lo(p.value,n,p.width,p.spreadsheet),n,p.spreadsheet,l);return c>d.height?{height:c,colIndex:p.colIndex}:d},{height:0});s=Math.max(s,r.height)+n.fontSize+10.5,o&&(e.tableColumnMode==="adapt"&&(s-=n.fontSize-2),i.colLeafNodes.forEach(d=>d.height=s),i.colsHierarchy.height=s),u.store.set("autoCalcHeight",s)},Lo=(m,u,t,e)=>{if(!m&&m!==0)return"";m=m.toString().trim();const o=a=>e.measureTextWidthRoughly(a,u);let i="",l="",n=0;for(let a=0;a<m.length;a++){const s=m[a],r=o(s);n+=r,l+=s;const d=s.charCodeAt(0)>=128?12:8;n>=t-u.fontSize-d&&(i+=l+(a!==m.length-1?`
`:""),l="",n=0)}return i+=l,i},To=(m,u,t,e)=>{let o=0;for(const l of m){const n=u.fontSize/(l.charCodeAt(0)>=128?5:2.5);o=Math.max(o,t.measureTextHeight(l,u)+n)}const i=m.split(`
`).length;return Math.min(i,e)*o},Eo=(m,u,t,e,o,i)=>{if(!i||!t.length)return;const l={};l[t.length]=e.tableTitleHeight,u.style.rowCfg={heightByField:l},u.frozenTrailingRowCount=1;const n=m.yAxis,a=m.xAxis,s=t.reduce((r,d)=>(m.type==="table-info"?a.filter(p=>[2,3,4].includes(p.deType)).forEach(p=>{r[p.dataeaseName]=(parseFloat(d[p.dataeaseName])||0)+(parseFloat(r[p.dataeaseName])||0)}):n.forEach(p=>{r[p.dataeaseName]=(parseFloat(d[p.dataeaseName])||0)+(parseFloat(r[p.dataeaseName])||0)}),r),{SUMMARY:!0});t.push(s),u.dataCell=r=>(r.autoWrap=o.autoWrap,r.maxLines=o.maxLines,r.rowIndex!==t.length-1?new ke(r,r.spreadsheet):(r.colIndex===0&&(e.showIndex||a.length)&&(r.fieldValue=o.summaryLabel??Wt("chart.total_show")),new Da(r,r.spreadsheet)))},Fo=(m,u,t,e,o)=>{!o||!u.length||m.on(V.LAYOUT_BEFORE_RENDER,()=>{const l=e.showTableHeader===!0?2:1,n=e.tableTitleHeight*l+t.tableItemHeight*(u.length-1);n<m.options.height&&(m.options.height=n<m.options.height-6?n+6:n)})};class Da extends ke{getTextStyle(){const u=Z(this.theme.colCell.bolderText);return u.textAlign=this.theme.dataCell.text.textAlign,u}getBackgroundColor(){const{backgroundColor:u,backgroundColorOpacity:t}=this.theme.colCell.cell;return{backgroundColor:u,backgroundColorOpacity:t}}}const zo=(m,u,t,e)=>{const o=()=>{const i=document.getElementById(e+"_empty");i&&i.parentElement.removeChild(i)};o(),!t.length&&m.on(V.LAYOUT_AFTER_HEADER_LAYOUT,i=>{if(o(),!t.length){const l=document.createElement("div"),n=Math.min(m.options.width,i.colsHierarchy.width)/2-32;l.id=e+"_empty",l.textContent=Wt("data_set.no_data"),l.setAttribute("style",`position: absolute;
        left: ${n}px;
        top: 50%;`);const a=document.getElementById(e);a.insertBefore(l,a.firstChild)}})},nl=m=>{const u=[],t=e=>{var o,i;if(!((o=e.children)!=null&&o.length)){u.push(e);return}for(let l=0;l<((i=e.children)==null?void 0:i.length);l++)t(e.children[l])};return m.forEach(e=>t(e)),u},al=(m,u)=>{var e;const t=[];for(let o=0;o<u.length;o++)m.includes(u[o].key)&&t.push(u[o]),(e=u[o].children)!=null&&e.length&&t.push(...al(m,u[o].children));return t};function rl(m,u){return m.map(t=>{let e=t.name;if(!e)if(t.children&&t.children.length>0)e=t.name||t.key;else{const i=u.find(l=>l.dataeaseName===t.key);e=(i==null?void 0:i.chartShowName)||(i==null?void 0:i.name)||t.name||t.key}const o={...t,name:e};return t.children&&t.children.length>0&&(o.children=rl(t.children,u)),o})}class qo extends ro{constructor(u,t){super(Vt.S2,u,t)}configTheme(u){return Aa(u)}configStyle(u,t){return Ca(u,t)}configEmptyDataStrategy(u){return _a(u)}configTooltip(u,t){za(u,t)}configHeaderInteraction(u,t){Fa(u,t)}configConditions(u){return wa(u)}configMergeCells(u,t,e){Ia(u,t,e)}showTooltip(u,t,e){var s;const o=u.getCell(t.target),i=o.getMeta();let l="",n;switch(o.cellType){case"dataCell":case"mergedCell":if(i.valueField===Ai){l=i.fieldValue.toString();break}n=we(e,r=>r.field===i.valueField),i.fieldValue===0&&(l="0"),i.fieldValue&&(l=(s=n==null?void 0:n.formatter)==null?void 0:s.call(n,i.fieldValue));break;case"rowCell":case"colCell":l=i.label,n=we(e,r=>r.field===l),n&&(l=n.name);break}if(!l)return;t.s2Instance=u;const a=u.options.tooltip.style;Si(u.tooltip.container,{style:a}),u.showTooltip({position:{x:t.clientX,y:t.clientY},content:l,meta:i,event:t})}configTouchEvent(u,t,e){const{touchAction:o}=t;u.once(V.LAYOUT_AFTER_RENDER,()=>{if(u.store.get("touchActionInit"))return;u.store.set("touchActionInit",!0);const l=u.getCanvasElement();let n=Date.now();l.addEventListener("touchstart",()=>{n=Date.now()}),l.addEventListener("touchend",a=>{var h;if(Date.now()-n>300)return;const r=l.getBoundingClientRect(),d=[a.changedTouches[0].pageX,a.changedTouches[0].pageY],p=[d[0]-r.x,d[1]-r.y],c=u.container.getShape(p[0],p[1]);if(((h=c.cfg)==null?void 0:h.type)==="image")return;o(()=>{if(a.preventDefault(),a.stopPropagation(),c){const g={target:c,x:p[0],y:p[1],clientX:d[0],clientY:d[1],originEvent:a};this.showTooltip(u,g,e)}})})})}}const cl=["background-overall-component","border-style","basic-style-selector","table-header-selector","table-cell-selector","title-selector","tooltip-selector","function-cfg","threshold","scroll-cfg","jump-set","linkage"],$t={"border-style":["all"],"background-overall-component":["all"],"basic-style-selector":["tableColumnMode","tableBorderColor","tableScrollBarColor","alpha"],"table-header-selector":["tableHeaderBgColor","tableTitleFontSize","tableHeaderFontColor","tableTitleHeight","tableHeaderAlign","showIndex","indexLabel","showColTooltip","showHorizonBorder","showVerticalBorder"],"table-cell-selector":["tableItemBgColor","tableItemFontSize","tableFontColor","tableItemAlign","tableItemHeight","enableTableCrossBG","tableItemSubBgColor","showTooltip","showHorizonBorder","showVerticalBorder"],"title-selector":["title","fontSize","color","hPosition","isItalic","isBolder","remarkShow","fontFamily","letterSpace","fontShadow"],"tooltip-selector":["fontSize","color","backgroundColor","show"],"function-cfg":["emptyDataStrategy"],threshold:["tableThreshold"]},{t:ai}=U();class Ma extends ke{drawTextShape(){const u=new Image,{x:t,y:e,width:o,height:i,fieldValue:l}=this.meta;u.src=l,u.setAttribute("crossOrigin","anonymous"),u.onload=()=>{!this.cfg.children&&(this.cfg.children=[]);const{width:n,height:a}=u,s=Math.max(n/o,a/i),r=n/s*.8,d=a/s*.8;this.textShape=this.addShape("image",{attrs:{x:t+(r<o?(o-r)/2:0),y:e+(d<i?(i-d)/2:0),width:r,height:d,img:u}})}}}class $a extends qo{constructor(){super("table-info",[]);w(this,"properties",cl);w(this,"propertyInner",{...$t,"table-header-selector":[...$t["table-header-selector"],"tableHeaderSort","showTableHeader","headerGroup"],"basic-style-selector":["tableColumnMode","tableBorderColor","tableScrollBarColor","alpha","tablePageMode","showHoverStyle","autoWrap","showSummary","summaryLabel"],"table-cell-selector":[...$t["table-cell-selector"],"tableFreeze","tableColumnFreezeHead","tableRowFreezeHead","mergeCells"]});w(this,"axis",["xAxis","filter","drill"]);w(this,"axisConfig",{xAxis:{name:`${ai("chart.drag_block_table_data_column")} / ${ai("chart.dimension_or_quota")}`}})}drawChart(t){var O,R;const{container:e,chart:o,pageInfo:i,action:l,resizeAction:n}=t,a=document.getElementById(e);let s=((O=o.data)==null?void 0:O.fields)??[];const r=[],d=[],p=o.xAxis.reduce((_,B)=>(_[B.dataeaseName]=B,_),{}),c={};if(o.drill){const _=o.drillFilters.map(F=>F.fieldId),B=o.drillFields[0].id,E=o.xAxis.findIndex(F=>F.id===B),z=o.drillFields[_.length].id,N=s.find(F=>F.id===z);_.push(z),s=s.filter(F=>!_.includes(F.id)),c[N.dataeaseName]=o.drillFields[0].dataeaseName,s.splice(E,0,N)}s.forEach(_=>{const B=p[_.dataeaseName];(B==null?void 0:B.hide)!==!0&&(r.push(_.dataeaseName),d.push({field:_.dataeaseName,name:_.chartShowName??_.name,formatter:function(E){if(!B||E==null||![2,3,4].includes(B.deType)||!Ue(E))return E;let z=B.formatterCfg;return z||(z=eo),D(E,z)}}))});const{basicStyle:f,tableCell:h,tableHeader:g,tooltip:y}=L(o.customAttr),{headerGroup:x,showTableHeader:b}=g;if(x&&b!==!1){const{headerGroupConfig:_}=g;if((R=_==null?void 0:_.columns)!=null&&R.length){const B=r.map(N=>c[N]||N),z=nl(_.columns).map(N=>N.key);if(Dl(z,B)){if(Object.keys(c).length){const N=Object.values(c)[0],F=Object.keys(c)[0],[I]=al([N],_.columns);I.key=F}r.splice(0,r.length,..._.columns),d.push(..._.meta)}}}const S=this.configEmptyDataStrategy(o),A={fields:{columns:r},meta:d,data:S},v={width:a.getBoundingClientRect().width,height:a.offsetHeight,showSeriesNumber:g.showIndex,conditions:this.configConditions(o),tooltip:{getContainer:()=>a,renderTooltip:_=>new _o(_)},interaction:{hoverHighlight:f.showHoverStyle!==!1,scrollbarPosition:S.length?re.CONTENT:re.CANVAS}};if(v.style=this.configStyle(o,A),f.tableColumnMode==="adapt"){const _=s.filter(B=>{var E;return B.deType===7&&!((E=p[B.dataeaseName])!=null&&E.hide)});v.style.colCfg.widthByFieldValue=_==null?void 0:_.reduce((B,E)=>(B[E.chartShowName??E.name]=120,B),{})}if(h.tableFreeze&&!h.mergeCells&&(v.frozenColCount=h.tableColumnFreezeHead??0,v.frozenRowCount=h.tableRowFreezeHead??0),v.showSeriesNumber){let _=g.indexLabel;_||(_=""),v.layoutCoordinate=(B,E,z)=>{z.colIndex===0&&z.rowIndex===0&&(z.label=_,z.value=_)}}v.dataCell=_=>{var E;const B=(E=s.filter(z=>z.dataeaseName===_.valueField))==null?void 0:E[0];return(B==null?void 0:B.deType)===7&&o.showPosition!=="dialog"?new Ma(_,_==null?void 0:_.spreadsheet):(_.colIndex===0&&v.showSeriesNumber&&(h.mergeCells?_.fieldValue=ll(v.mergedCellsInfo,_):_.fieldValue=i.pageSize*(i.currentPage-1)+_.rowIndex+1),_.autoWrap=h.mergeCells?!1:f.autoWrap,_.maxLines=f.maxLines,new ke(_,_==null?void 0:_.spreadsheet))},this.configTooltip(o,v),this.configMergeCells(o,v,A),g.showTableHeader===!1?(v.style.colCfg.height=1,h.showHorizonBorder===!1&&(v.style.colCfg.height=0),v.interaction.resize={colCellVertical:!1},v.colCell=(_,B,E)=>(_.label=" ",new Je(_,B,E))):(o.container=e,this.configHeaderInteraction(o,v),v.colCell=(_,B,E)=>(_.autoWrap=h.mergeCells?!1:f.autoWrap,_.maxLines=f.maxLines,new Ra(_,B,E))),Eo(o,v,S,g,f,f.showSummary);const C=new Co(a,A,v);Fo(C,S,h,g,f.showSummary),f.autoWrap&&!h.mergeCells&&(C.on(V.LAYOUT_RESIZE_COL_WIDTH,_=>{ni(_,C,g,f,null)}),C.on(V.LAYOUT_AFTER_HEADER_LAYOUT,_=>{var E;const B=C.store.get("autoCalcHeight");if(B)_.colLeafNodes.forEach(z=>z.height=B),_.colsHierarchy.height=B,C.store.set("autoCalcHeight",void 0);else if((E=_.colLeafNodes)!=null&&E.length){const{value:z,width:N}=_.colLeafNodes[0];ni({info:{meta:{value:z},resizedWidth:N}},C,g,f,_)}})),f.tableColumnMode==="adapt"&&(C.on(V.LAYOUT_RESIZE_COL_WIDTH,()=>{C.store.set("lastLayoutResult",C.facet.layoutResult)}),C.on(V.LAYOUT_AFTER_HEADER_LAYOUT,_=>{var H,J;const B=C.store.get("lastLayoutResult");if(B){const W=(J=(H=C.options.style)==null?void 0:H.colCfg)==null?void 0:J.widthByFieldValue,j=(B==null?void 0:B.colLeafNodes.reduce((q,G)=>(q[G.value]=(W==null?void 0:W[G.value])??G.width,q),{}))||{},tt=_.colLeafNodes.reduce((q,G)=>(G.width=j[G.value]||G.width,G.x=q,q+G.width),0);_.colNodes.forEach(q=>{q.colIndex===-1&&(q.width=ko(q),q.x=Oo(q))}),_.colsHierarchy.width=tt,C.store.set("lastLayoutResult",void 0);return}const E=s.filter(W=>{var j;return W.deType===7&&!((j=p[W.dataeaseName])!=null&&j.hide)}).map(W=>W.dataeaseName),z=_.colLeafNodes.reduce((W,j)=>W+(E.includes(j.field)?120:j.width),0),N=a.getBoundingClientRect().width;if(N<=z){_.colLeafNodes.reduce((W,j)=>(j.width=Math.round(j.width),j.x=W,W+j.width),0);return}const F=_.colLeafNodes.reduce((W,j)=>W+(E.includes(j.field)?0:j.width),0),$=(N-E.length*120)/F,M=_.colLeafNodes.reduce((W,j)=>(j.width=E.includes(j.field)?120:Math.round(j.width*$),j.x=W,W+j.width),0);_.colNodes.forEach(W=>{W.colIndex===-1&&(W.width=ko(W),W.x=Oo(W))}),M>N&&(_.colLeafNodes[_.colLeafNodes.length-1].width-=M-N),_.colsHierarchy.width=N})),zo(C,f,S,e),C.on(V.DATA_CELL_CLICK,_=>{const E=C.getCell(_.target).getMeta(),z=s.reduce(($,M)=>($[M.dataeaseName]=M.id,$),{}),N=C.dataSet.getRowData(E),F=[];for(const $ in N)z[$]&&F.push({id:z[$],value:N[$]});const I={x:_.x,y:_.y,data:{dimensionList:F,name:z[E.valueField],sourceType:"table-info",quotaList:[]}};l(I)}),C.on(V.MERGED_CELLS_CLICK,_=>C.emit(V.DATA_CELL_CLICK,_));const{show:T}=y;T&&(C.on(V.COL_CELL_HOVER,_=>this.showTooltip(C,_,d)),C.on(V.DATA_CELL_HOVER,_=>this.showTooltip(C,_,d)),C.on(V.MERGED_CELLS_HOVER,_=>this.showTooltip(C,_,d))),C.on(V.LAYOUT_RESIZE_COL_WIDTH,_=>n(_)),C.on(V.GLOBAL_CONTEXT_MENU,_=>to(C,_,d)),this.configTouchEvent(C,t,d);const k=this.configTheme(o);return C.setThemeCfg({theme:k}),C}configTheme(t){const e=super.configTheme(t),{basicStyle:o,tableCell:i}=L(t.customAttr);if(i.mergeCells){const l=P(i.tableFontColor,o.alpha);let n=i.tableItemBgColor;Ft(n)||(n=P(n,o.alpha));const{tableBorderColor:a}=o,{tableItemAlign:s,tableItemFontSize:r}=i,d=i.isItalic?"italic":"normal",p=i.isBolder===!1?"normal":"bold",c={dataCell:{cell:{crossBackgroundColor:n}},mergedCell:{cell:{backgroundColor:n,crossBackgroundColor:n,horizontalBorderColor:a,verticalBorderColor:a,horizontalBorderWidth:i.showHorizonBorder?1:0,verticalBorderWidth:i.showVerticalBorder?1:0},bolderText:{fill:l,textAlign:s,fontSize:r,fontStyle:d,fontWeight:p},text:{fill:l,textAlign:s,fontSize:r,fontStyle:d,fontWeight:p},measureText:{fill:l,textAlign:s,fontSize:r,fontStyle:d,fontWeight:p},seriesText:{fill:l,textAlign:s,fontSize:r,fontStyle:d,fontWeight:p}}};vt(e,c)}return e}}function ko(m){var u;return(u=m.children)!=null&&u.length?m.children.reduce((t,e)=>t+ko(e),0):m.width}function Oo(m){var u;return(u=m.children)!=null&&u.length?Oo(m.children[0]):m.x}const Pa=Object.freeze(Object.defineProperty({__proto__:null,TableInfo:$a},Symbol.toStringTag,{value:"Module"})),{t:He}=U();class Ha extends qo{constructor(){super("table-normal",[]);w(this,"properties",cl);w(this,"propertyInner",{...$t,"table-header-selector":[...$t["table-header-selector"],"tableHeaderSort","showTableHeader","headerGroup"],"basic-style-selector":[...$t["basic-style-selector"],"showSummary","summaryLabel","showHoverStyle"],"table-cell-selector":[...$t["table-cell-selector"],"tableFreeze","tableColumnFreezeHead","tableRowFreezeHead"]});w(this,"axis",["xAxis","yAxis","drill","filter"]);w(this,"axisConfig",{xAxis:{name:`${He("chart.drag_block_table_data_column")} / ${He("chart.dimension")}`,type:"d"},yAxis:{name:`${He("chart.drag_block_table_data_column")} / ${He("chart.quota")}`,type:"q"}})}setupDefaultOptions(t){return t.xAxis=[],t}drawChart(t){var v;const{container:e,chart:o,action:i,resizeAction:l}=t,n=document.getElementById(e);if(!n)return;let a=o.data.fields;const s=[],r=[];if(o.drill){const C=o.drillFilters.map(_=>_.fieldId),T=o.drillFields[0].id,k=o.xAxis.findIndex(_=>_.id===T),O=o.drillFields[C.length].id,R=a.filter(_=>_.id===O);C.push(O),a=a.filter(_=>!C.includes(_.id)),a.splice(k,0,...R)}const d=[...o.xAxis,...o.yAxis].reduce((C,T)=>(C[T.dataeaseName]=T,C),{});a.forEach(C=>{const T=d[C.dataeaseName];(T==null?void 0:T.hide)!==!0&&(s.push(C.dataeaseName),r.push({field:C.dataeaseName,name:C.chartShowName??C.name,formatter:function(k){if(!T||k==null||![2,3,4].includes(T.deType)||!Ue(k))return k;let O=T.formatterCfg;return O||(O=eo),D(k,O)}}))});const{basicStyle:p,tableCell:c,tableHeader:f,tooltip:h}=L(o.customAttr);if(f.headerGroup&&f.showTableHeader!==!1){const{headerGroupConfig:C}=f;if((v=C==null?void 0:C.columns)!=null&&v.length){const T=(o.xAxis||[]).concat(o.yAxis||[]),k=rl(C.columns,T);s.length=0,s.push(...k);const O=nl(k);return r.length=0,r.push(...O.map(R=>({field:R.key,name:R.name}))),console.log("[S2递归渲染] columns:",JSON.stringify(s,null,2)),console.log("[S2递归渲染] meta:",JSON.stringify(r,null,2)),this.finishDrawChart(n,s,r,o,i,l)}}const g=this.configEmptyDataStrategy(o);console.log("[S2实际渲染前] columns:",JSON.stringify(s,null,2)),console.log("[S2实际渲染前] meta:",JSON.stringify(r,null,2)),console.log("[S2实际渲染前] data.fields:",(o.data.fields||[]).map(C=>C.dataeaseName||C.key));const y={fields:{columns:s},meta:r,data:g};console.log("[S2实际渲染] columns:",JSON.stringify(s,null,2)),console.log("[S2实际渲染] meta:",JSON.stringify(r,null,2)),console.log("[S2实际渲染] data.fields:",(o.data.fields||[]).map(C=>C.dataeaseName||C.key));const x={width:n.getBoundingClientRect().width,height:n.offsetHeight,showSeriesNumber:f.showIndex,conditions:this.configConditions(o),tooltip:{getContainer:()=>n,renderTooltip:C=>new _o(C)},interaction:{hoverHighlight:p.showHoverStyle!==!1,scrollbarPosition:g.length?re.CONTENT:re.CANVAS}};if(x.style=this.configStyle(o,y),c.tableFreeze&&(x.frozenColCount=c.tableColumnFreezeHead??0,x.frozenRowCount=c.tableRowFreezeHead??0),x.showSeriesNumber){let C=f.indexLabel;C||(C=""),x.layoutCoordinate=(T,k,O)=>{O.colIndex===0&&O.rowIndex===0&&(O.label=C,O.value=C)},x.dataCell=T=>new Ao(T,T.spreadsheet)}this.configTooltip(o,x),f.showTableHeader===!1?(x.style.colCfg.height=1,c.showHorizonBorder===!1&&(x.style.colCfg.height=0),x.interaction.resize={colCellVertical:!1},x.colCell=(C,T,k)=>(C.label=" ",new Je(C,T,k))):(o.container=e,this.configHeaderInteraction(o,x)),Eo(o,x,g,f,p,p.showSummary);const b=new Co(n,y,x);Fo(b,g,c,f,p.showSummary),p.tableColumnMode==="adapt"&&(b.on(V.LAYOUT_RESIZE_COL_WIDTH,()=>{b.store.set("lastLayoutResult",b.facet.layoutResult)}),b.on(V.LAYOUT_AFTER_HEADER_LAYOUT,C=>{var _,B;const T=b.store.get("lastLayoutResult");if(T){const E=(B=(_=b.options.style)==null?void 0:_.colCfg)==null?void 0:B.widthByFieldValue,z=(T==null?void 0:T.colLeafNodes.reduce((F,I)=>(F[I.value]=(E==null?void 0:E[I.value])??I.width,F),{}))||{},N=C.colLeafNodes.reduce((F,I)=>(I.width=z[I.value]||I.width,I.x=F,F+I.width),0);C.colsHierarchy.width=N,b.store.set("lastLayoutResult",void 0);return}const k=n.getBoundingClientRect().width,O=k/C.colsHierarchy.width;if(O<=1){C.colLeafNodes.reduce((E,z)=>(z.width=Math.round(z.width),z.x=E,E+z.width),0);return}const R=C.colLeafNodes.reduce((E,z)=>(z.width=Math.round(z.width*O),z.x=E,E+z.width),0);R>k&&(C.colLeafNodes[C.colLeafNodes.length-1].width-=R-k),C.colsHierarchy.width=k})),zo(b,p,g,e),b.on(V.DATA_CELL_CLICK,C=>{const k=b.getCell(C.target).getMeta(),O=a.reduce((E,z)=>(E[z.dataeaseName]=z.id,E),{}),R=b.dataSet.getRowData(k),_=[];for(const E in R)O[E]&&_.push({id:O[E],value:R[E]});const B={x:C.x,y:C.y,data:{dimensionList:_,name:O[k.valueField],sourceType:"table-normal",quotaList:[]}};i(B)});const{show:S}=h;S&&(b.on(V.COL_CELL_HOVER,C=>this.showTooltip(b,C,r)),b.on(V.DATA_CELL_HOVER,C=>this.showTooltip(b,C,r))),b.on(V.LAYOUT_RESIZE_COL_WIDTH,C=>l(C)),b.on(V.GLOBAL_CONTEXT_MENU,C=>to(b,C,r)),this.configTouchEvent(b,t,r);const A=this.configTheme(o);return b.setThemeCfg({theme:A}),b}finishDrawChart(t,e,o,i,l,n){const a=this.configEmptyDataStrategy(i),s={fields:{columns:e},meta:o,data:a},r={width:t.getBoundingClientRect().width,height:t.offsetHeight,showSeriesNumber:i.customAttr.tableHeader.showIndex,conditions:this.configConditions(i),tooltip:{getContainer:()=>t,renderTooltip:f=>new _o(f)},interaction:{hoverHighlight:i.customAttr.basicStyle.showHoverStyle!==!1,scrollbarPosition:a.length?re.CONTENT:re.CANVAS}};if(r.style=this.configStyle(i,s),i.customAttr.tableCell.tableFreeze&&(r.frozenColCount=i.customAttr.tableCell.tableColumnFreezeHead??0,r.frozenRowCount=i.customAttr.tableCell.tableRowFreezeHead??0),r.showSeriesNumber){let f=i.customAttr.tableHeader.indexLabel;f||(f=""),r.layoutCoordinate=(h,g,y)=>{y.colIndex===0&&y.rowIndex===0&&(y.label=f,y.value=f)},r.dataCell=h=>new Ao(h,h.spreadsheet)}this.configTooltip(i,r),i.customAttr.tableHeader.showTableHeader===!1?(r.style.colCfg.height=1,i.customAttr.tableCell.showHorizonBorder===!1&&(r.style.colCfg.height=0),r.interaction.resize={colCellVertical:!1},r.colCell=(f,h,g)=>(f.label=" ",new Je(f,h,g))):(i.container=t.id,this.configHeaderInteraction(i,r)),Eo(i,r,a,i.customAttr.tableHeader,i.customAttr.basicStyle,i.customAttr.basicStyle.showSummary);const d=new Co(t,s,r);Fo(d,a,i.customAttr.tableCell,i.customAttr.tableHeader,i.customAttr.basicStyle.showSummary),i.customAttr.basicStyle.tableColumnMode==="adapt"&&(d.on(V.LAYOUT_RESIZE_COL_WIDTH,()=>{d.store.set("lastLayoutResult",d.facet.layoutResult)}),d.on(V.LAYOUT_AFTER_HEADER_LAYOUT,f=>{var b,S;const h=d.store.get("lastLayoutResult");if(h){const A=(S=(b=d.options.style)==null?void 0:b.colCfg)==null?void 0:S.widthByFieldValue,v=(h==null?void 0:h.colLeafNodes.reduce((T,k)=>(T[k.value]=(A==null?void 0:A[k.value])??k.width,T),{}))||{},C=f.colLeafNodes.reduce((T,k)=>(k.width=v[k.value]||k.width,k.x=T,T+k.width),0);f.colsHierarchy.width=C,d.store.set("lastLayoutResult",void 0);return}const g=t.getBoundingClientRect().width,y=g/f.colsHierarchy.width;if(y<=1){f.colLeafNodes.reduce((A,v)=>(v.width=Math.round(v.width),v.x=A,A+v.width),0);return}const x=f.colLeafNodes.reduce((A,v)=>(v.width=Math.round(v.width*y),v.x=A,A+v.width),0);x>g&&(f.colLeafNodes[f.colLeafNodes.length-1].width-=x-g),f.colsHierarchy.width=g})),zo(d,i.customAttr.basicStyle,a,t.id),d.on(V.DATA_CELL_CLICK,f=>{const g=d.getCell(f.target).getMeta(),y=g.field?{[g.field]:g.field}:{},x=d.dataSet.getRowData(g),b=[];for(const A in x)y[A]&&b.push({id:y[A],value:x[A]});const S={x:f.x,y:f.y,data:{dimensionList:b,name:y[g.valueField],sourceType:"table-normal",quotaList:[]}};l(S)});const{show:p}=i.customAttr.tooltip;p&&(d.on(V.COL_CELL_HOVER,f=>this.showTooltip(d,f,o)),d.on(V.DATA_CELL_HOVER,f=>this.showTooltip(d,f,o))),d.on(V.LAYOUT_RESIZE_COL_WIDTH,f=>n(f)),d.on(V.GLOBAL_CONTEXT_MENU,f=>to(d,f,o)),this.configTouchEvent(d,{container:t.id,chart:i,action:l,resizeAction:n},o);const c=this.configTheme(i);return d.setThemeCfg({theme:c}),d}}const Wa=Object.freeze(Object.defineProperty({__proto__:null,TableNormal:Ha},Symbol.toStringTag,{value:"Module"})),{t:Ut}=U();class Va extends ls{getTotalValue(u,t){const{options:e}=this.spreadsheet,i=Pl(t)?t:this.getTotalStatus(u),{aggregation:l,calcFunc:n}=Xa(i,e==null?void 0:e.totals)||{},a=Y(e==null?void 0:e.totals)&&!this.spreadsheet.isHierarchyTreeType()?Ce.SUM:"",s=Ga[l||a];if(s||n){const r=this.getMultiData(u,{queryType:ss.DetailOnly});let d;return n?d=n(u,r,this.spreadsheet,i):s&&(d=s(r,Zo)),{...u,[Zo]:d,[u[gt]]:d}}}}class Ya extends qo{constructor(){super("table-pivot",[]);w(this,"properties",["border-style","background-overall-component","basic-style-selector","table-header-selector","table-cell-selector","table-total-selector","title-selector","tooltip-selector","function-cfg","threshold","linkage","jump-set"]);w(this,"propertyInner",{...$t,"table-header-selector":["tableHeaderBgColor","tableTitleFontSize","tableHeaderFontColor","tableTitleHeight","tableHeaderAlign","showColTooltip","showRowTooltip","showHorizonBorder","showVerticalBorder"],"table-total-selector":["row","col"],"basic-style-selector":["tableColumnMode","tableBorderColor","tableScrollBarColor","alpha","tableLayoutMode","showHoverStyle"]});w(this,"axis",["xAxis","xAxisExt","yAxis","filter"]);w(this,"axisConfig",{xAxis:{name:`${Ut("chart.table_pivot_row")} / ${Ut("chart.dimension")}`,type:"d"},xAxisExt:{name:`${Ut("chart.drag_block_table_data_column")} / ${Ut("chart.dimension")}`,type:"d",allowEmpty:!0},yAxis:{name:`${Ut("chart.drag_block_table_data_column")} / ${Ut("chart.quota")}`,type:"q"}})}drawChart(t){var z,N;const{container:e,chart:o,chartObj:i,action:l}=t,n=document.getElementById(e),{xAxisExt:a,xAxis:s,yAxis:r}=o,[d,p,c]=[a,s,r].map(F=>F.map(I=>I.dataeaseName)),{fields:f,customCalc:h}=o.data;if(!f||f.length===0){i&&i.destroy();return}const g=[],y=[],x=[...o.xAxis,...o.xAxisExt,...o.yAxis].reduce((F,I)=>(F[I.dataeaseName]=I,F),{});f.forEach(F=>{const I=x[F.dataeaseName];g.push(F.dataeaseName),y.push({field:F.dataeaseName,name:F.chartShowName??F.name,formatter:$=>!I||$==null||![2,3,4].includes(I.deType)||!Ue($)?$:I.formatterCfg?D($,I.formatterCfg):D($,eo)})});const{basicStyle:b,tooltip:S,tableTotal:A}=L(o.customAttr);(!A.row.subTotalsDimensionsNew||A.row.subTotalsDimensions==null)&&(A.row.subTotalsDimensions=p),A.col.subTotalsDimensions=d;const v=[];if(A.row.totalSort&&A.row.totalSort!=="none"&&d.length>0&&A.row.showGrandTotals&&c.indexOf(A.row.totalSortField)>-1&&d.forEach(F=>{const I={sortFieldId:F,sortMethod:A.row.totalSort.toUpperCase(),sortByMeasure:ho,query:{[gt]:A.row.totalSortField}};v.push(I)}),A.col.totalSort&&A.col.totalSort!=="none"&&p.length>0&&A.col.showGrandTotals&&c.indexOf(A.col.totalSortField)>-1&&p.forEach(F=>{const I={sortFieldId:F,sortMethod:A.col.totalSort.toUpperCase(),sortByMeasure:ho,query:{[gt]:A.col.totalSortField}};v.push(I)}),!(a!=null&&a.length)){const F=r==null?void 0:r.find(I=>!["none","custom_sort"].includes(I.sort));if(F){const I={sortFieldId:p[0],sortMethod:F.sort.toUpperCase(),sortByMeasure:ho,query:{[gt]:F.dataeaseName}};v.push(I)}}const C=[A.row.calcTotals,A.row.calcSubTotals,A.col.calcTotals,A.col.calcSubTotals],T={row:o.xAxis,col:o.xAxisExt,quota:o.yAxis};(z=o.xAxisExt)!=null&&z.length||(b.tableLayoutMode==="tree"?(A.col.calcTotals=A.row.calcSubTotals,(N=A.col.calcTotals.cfg)!=null&&N.length||(A.col.calcTotals.cfg=o.yAxis.map(F=>({dataeaseName:F.dataeaseName,aggregation:"SUM"})))):A.col.calcTotals.calcFunc=()=>"-"),C.forEach(F=>{var I;if((I=F.cfg)!=null&&I.length){delete F.aggregation;const $=F.cfg.reduce((M,H)=>(M[H.dataeaseName]=H,M),{});F.calcFunc=(M,H,J,W)=>qa(M,H,W,o,$,T,h)}});const k=this.configEmptyDataStrategy(o),O={fields:{rows:p,columns:d,values:c},meta:y,data:k,sortParams:v},R={width:n.offsetWidth,height:n.offsetHeight,totals:A,conditions:this.configConditions(o),tooltip:{getContainer:()=>n},hierarchyType:b.tableLayoutMode??"grid",dataSet:F=>new Va(F),interaction:{hoverHighlight:b.showHoverStyle!==!1},dataCell:F=>new ke(F,F.spreadsheet)};if(R.style=this.configStyle(o,O),b.tableLayoutMode==="tree"){const{defaultExpandLevel:F}=b;Ue(F)&&(F>=o.xAxis.length?R.style.rowExpandDepth=F:R.style.rowExpandDepth=F-2),F==="all"&&(R.style.rowExpandDepth=o.xAxis.length),F||(R.style.hierarchyCollapse=!0)}this.configTooltip(o,R);const _=new is(n,O,R);b.tableColumnMode==="adapt"&&(_.on(V.LAYOUT_RESIZE_COL_WIDTH,()=>{_.store.set("lastLayoutResult",_.facet.layoutResult)}),_.on(V.LAYOUT_RESIZE_ROW_WIDTH,()=>{_.store.set("lastLayoutResult",_.facet.layoutResult)}),_.on(V.LAYOUT_RESIZE_TREE_WIDTH,()=>{_.store.set("lastLayoutResult",_.facet.layoutResult)}),_.on(V.LAYOUT_AFTER_HEADER_LAYOUT,F=>{var j,tt,q,G,xt;const I=_.store.get("lastLayoutResult");if(I){const X=(tt=(j=_.options.style)==null?void 0:j.colCfg)==null?void 0:tt.widthByFieldValue,K=(G=(q=_.options.style)==null?void 0:q.rowCfg)==null?void 0:G.widthByField,ot=((xt=_.options.style)==null?void 0:xt.treeRowsWidth)||I.rowsHierarchy.width,St=I.colLeafNodes.reduce((et,nt)=>(et[nt.id]=(X==null?void 0:X[nt.value])??nt.width,et),{})||{},wt=F.colLeafNodes.reduce((et,nt)=>(nt.width=St[nt.id]||nt.width,nt.x=et,et+nt.width),0);if(F.colNodes.forEach(et=>{et.isLeaf||(et.width=this.getColWidth(et),et.x=this.getLeftChild(et).x)}),b.tableLayoutMode==="tree")F.rowNodes.forEach(et=>{et.width=ot}),F.rowsHierarchy.width=ot,F.colsHierarchy.width=wt;else{const et=I.rowNodes.reduce((ht,At)=>(ht[At.id]=(K==null?void 0:K[At.field])??At.width,ht),{})||{};F.rowNodes.forEach(ht=>{ht.x=0,ht.width=et[ht.id]||ht.width;let At=ht;for(;At.parent.id!=="root";)ht.x+=At.parent.width,At=At.parent});const nt=F.rowsHierarchy.sampleNodesForAllLevels.reduce((ht,At)=>ht+At.width,0),Yt=F.rowsHierarchy.maxLevel;F.rowNodes.forEach(ht=>{if(ht.isTotalRoot||ht.isSubTotals&&ht.level<Yt){let At=0;for(let mo=ht.level;mo<=Yt;mo++)At+=F.rowsHierarchy.sampleNodesForAllLevels[mo].width;ht.width=At}}),F.rowsHierarchy.width=nt,F.colsHierarchy.width=wt}_.store.set("lastLayoutResult",void 0);return}const $=n.getBoundingClientRect().width,M=$/(F.colsHierarchy.width+F.rowsHierarchy.width);if(M<=1)return;const H=Math.round(F.rowsHierarchy.width*M);F.rowNodes.forEach(X=>{X.width=Math.round(X.width*M)}),b.tableLayoutMode!=="tree"&&F.rowNodes.forEach(X=>{X.x=0;let K=X;for(;K.parent.id!=="root";)X.x+=K.parent.width,K=K.parent});let J=F.colLeafNodes.reduce((X,K)=>(K.width=Math.round(K.width*M),K.x=X,X+K.width),0);F.colNodes.forEach(X=>{X.isLeaf||(X.width=this.getColWidth(X),X.x=this.getLeftChild(X).x)});const W=J+H;W>$&&(F.colLeafNodes[F.colLeafNodes.length-1].width-=W-$,J=J-(W-$)),F.colsHierarchy.width=J,F.rowsHierarchy.width=H}));const{show:B}=S;B&&(_.on(V.COL_CELL_HOVER,F=>this.showTooltip(_,F,y)),_.on(V.ROW_CELL_HOVER,F=>this.showTooltip(_,F,y)),_.on(V.DATA_CELL_HOVER,F=>this.showTooltip(_,F,y))),Qa(_,k),_.on(V.DATA_CELL_CLICK,F=>this.dataCellClickAction(o,F,_,l)),_.on(V.ROW_CELL_CLICK,F=>this.headerCellClickAction(o,F,_,l)),_.on(V.COL_CELL_CLICK,F=>this.headerCellClickAction(o,F,_,l)),_.on(V.GLOBAL_CONTEXT_MENU,F=>to(_,F,y)),this.configTouchEvent(_,t,y);const E=this.configTheme(o);return _.setThemeCfg({theme:E}),_}getColWidth(t){var o;let e=0;return(o=t.children)!=null&&o.length?t.children.forEach(i=>{e+=this.getColWidth(i)}):e=t.width,e}getLeftChild(t){var e;return(e=t.children)!=null&&e.length?this.getLeftChild(t.children[0]):t}dataCellClickAction(t,e,o,i){const n=o.getCell(e.target).getMeta(),a=t.data.fields.reduce((p,c)=>(p[c.dataeaseName]=c.id,p),{}),s={...n.rowQuery,...n.colQuery};s[n.valueField]=n.fieldValue;const r=[];for(const p in s)a[p]&&r.push({id:a[p],value:s[p]});const d={x:e.x,y:e.y,data:{dimensionList:r,name:a[n.valueField],sourceType:"table-pivot",quotaList:[]}};i(d)}headerCellClickAction(t,e,o,i){const n=o.getCell(e.target).getMeta(),a=n.query,s=t.data.fields.reduce((p,c)=>(p[c.dataeaseName]=c.id,p),{}),r=[];for(const p in a)s[p]&&r.push({id:s[p],value:a[p]});const d={x:e.x,y:e.y,data:{dimensionList:r,name:s[n.valueField],sourceType:"table-pivot",quotaList:[]}};i(d)}configTheme(t){const e=super.configTheme(t),{basicStyle:o,tableHeader:i}=L(t.customAttr);let l=i.tableHeaderBgColor;Ft(l)||(l=P(l,o.alpha));let n=i.tableHeaderCornerBgColor??at.tableHeaderCornerBgColor;Ft(n)||(n=P(n,o.alpha));let a=i.tableHeaderColBgColor??at.tableHeaderColBgColor;Ft(a)||(a=P(a,o.alpha));let s=o.tableBorderColor;Ft(s)||(s=P(s,o.alpha));const r=P(i.tableHeaderColFontColor,o.alpha),d=P(i.tableHeaderCornerFontColor,o.alpha),p=i.isColItalic?"italic":"normal",c=i.isCornerItalic?"italic":"normal",f=i.isColBolder===!1?"normal":"bold",h=i.isCornerBolder===!1?"normal":"bold",g={rowCell:{cell:{backgroundColor:a,horizontalBorderColor:s,verticalBorderColor:s},text:{fill:r,fontSize:i.tableTitleColFontSize,textAlign:i.tableHeaderColAlign,textBaseline:"top",fontStyle:p,fontWeight:f},bolderText:{fill:r,fontSize:i.tableTitleColFontSize,textAlign:i.tableHeaderColAlign,fontStyle:p,fontWeight:f},measureText:{fill:r,fontSize:i.tableTitleColFontSize,textAlign:i.tableHeaderColAlign,fontStyle:p,fontWeight:f},seriesText:{fill:r,fontSize:i.tableTitleColFontSize,textAlign:i.tableHeaderColAlign,fontStyle:p,fontWeight:f}},cornerCell:{cell:{backgroundColor:n},text:{fill:d,fontSize:i.tableTitleCornerFontSize,textAlign:i.tableHeaderCornerAlign,fontStyle:c,fontWeight:h},bolderText:{fill:d,fontSize:i.tableTitleCornerFontSize,textAlign:i.tableHeaderCornerAlign,fontStyle:c,fontWeight:h},measureText:{fill:d,fontSize:i.tableTitleCornerFontSize,textAlign:i.tableHeaderCornerAlign,fontStyle:c,fontWeight:h}}};return vt(e,g),i.showHorizonBorder===!1&&vt(e,{cornerCell:{cell:{horizontalBorderColor:l,horizontalBorderWidth:0}},rowCell:{cell:{horizontalBorderColor:l,horizontalBorderWidth:0}}}),i.showVerticalBorder===!1&&vt(e,{cornerCell:{cell:{verticalBorderColor:l,verticalBorderWidth:0}},rowCell:{cell:{verticalBorderColor:l,verticalBorderWidth:0}}}),e}setupDefaultOptions(t){const{customAttr:e}=t;return e.basicStyle.tableColumnMode==="field"&&(e.basicStyle.tableColumnMode="custom"),t}}function qa(m,u,t,e,o,i,l){var a;if(!(u!=null&&u.length)||!m[gt])return"-";switch(((a=o[m[gt]])==null?void 0:a.aggregation)||"SUM"){case"SUM":return u.reduce((s,r)=>s+parseFloat(r[m[gt]]??0),0);case"AVG":return u.reduce((r,d)=>r+parseFloat(d[m[gt]]??0),0)/u.length;case"MIN":{const s=$l(u,r=>parseFloat(r[m[gt]]));return s==null?void 0:s[m[gt]]}case"MAX":{const s=Ml(u,r=>parseFloat(r[m[gt]]));return s==null?void 0:s[m[gt]]}case"NONE":return"-";case"CUSTOM":{const s=Ja(m,i,e,t,l||{});return s===""||s===void 0?"-":parseFloat(s)}default:return u.reduce((s,r)=>s+parseFloat(r[m[gt]]??0),0)}}function ja(m,u,t,e){var n,a,s,r,d,p,c,f,h;const o=m[gt],{row:i,col:l}=u;if(t.isRowTotal&&t.isColTotal)return(a=(n=e.rowColTotal)==null?void 0:n.data)==null?void 0:a[o];if(t.isColTotal&&!t.isRowSubTotal){const{colTotal:g,rowSubInColTotal:y}=e,x=ut(m,i);let b;if(x.length){const S=Ct(m,i);if(S+1===i.length&&g&&(x.push(o),b=dt(g.data,x)),S+1<i.length&&y){const A=(s=y==null?void 0:y[S])==null?void 0:s.data;x.push(o),b=dt(A,x)}}return b}if(t.isColSubTotal&&!t.isRowTotal&&!t.isRowSubTotal){const{colSubTotal:g}=e,y=Ct(m,l),x=ut(m,i),b=ut(m,l),S=[...x,...b],A=(r=g==null?void 0:g[y])==null?void 0:r.data;let v;return S.length&&A&&(S.push(o),v=dt(A,S)),v}if(t.isRowTotal&&!t.isColSubTotal){const{rowTotal:g}=e,y=ut(m,l);let x;return g&&(y.length&&(y.push(o),x=dt(g.data,y)),!l.length&&i.length&&(x=dt(g.data,o))),x}if(t.isRowSubTotal&&(!t.isColTotal&&!t.isColSubTotal||!l.length&&t.isColTotal&&t.isRowSubTotal)){const{rowSubTotal:g}=e,y=Ct(m,i),x=ut(m,l),b=ut(m,i),S=[...x,...b],A=(d=g==null?void 0:g[y])==null?void 0:d.data;let v;return S.length&&g&&(S.push(o),v=dt(A,S)),v}if(t.isRowTotal&&t.isColSubTotal){const{colSubInRowTotal:g}=e,y=Ct(m,l),x=(p=g==null?void 0:g[y])==null?void 0:p.data,b=ut(m,l);let S;return b.length&&g&&(b.push(o),S=dt(x,b)),S}if(t.isColTotal&&t.isRowSubTotal){const{rowSubInColTotal:g}=e,y=Ct(m,i),x=(c=g==null?void 0:g[y])==null?void 0:c.data,b=ut(m,i);let S;return b.length&&g&&(b.push(o),S=dt(x,b)),S}if(t.isColSubTotal&&t.isRowSubTotal){const{rowSubInColSub:g}=e,y=Ct(m,i),x=Ct(m,l),b=(h=(f=g==null?void 0:g[y])==null?void 0:f[x])==null?void 0:h.data,S=ut(m,i),A=ut(m,l),v=[...S,...A];let C;return v.length&&g&&(v.push(o),C=dt(b,v)),C}return"-"}function Ua(m,u,t,e){var n,a,s,r,d,p,c,f;const o=m[gt],{row:i,col:l}=u;if(t.isRowTotal&&t.isColTotal)return(a=(n=e.rowColTotal)==null?void 0:n.data)==null?void 0:a[o];if(t.isColTotal&&!t.isRowSubTotal){const{colTotal:h}=e,g=ut(m,i);let y;return g.length&&h&&(g.push(o),y=dt(h.data,g)),y}if(t.isColSubTotal&&!t.isRowTotal&&!t.isRowSubTotal){const{colSubTotal:h}=e,g=Ct(m,l),y=ut(m,i),x=ut(m,l),b=[...y,...x],S=(s=h==null?void 0:h[g])==null?void 0:s.data;let A;return b.length&&S&&(b.push(o),A=dt(S,b)),A}if(t.isRowTotal&&!t.isColSubTotal){const{rowTotal:h}=e,g=ut(m,l);let y;return h&&(g.length&&(g.push(o),y=dt(h.data,g)),!l.length&&i.length&&(y=dt(h.data,o))),y}if(t.isRowSubTotal&&!t.isColTotal&&!t.isColSubTotal){const{rowSubTotal:h}=e,g=Ct(m,i),y=ut(m,l),x=ut(m,i),b=[...y,...x],S=(r=h==null?void 0:h[g])==null?void 0:r.data;let A;return b.length&&h&&(b.push(o),A=dt(S,b)),A}if(t.isRowTotal&&t.isColSubTotal){const{colSubInRowTotal:h}=e,g=Ct(m,l),y=(d=h==null?void 0:h[g])==null?void 0:d.data,x=ut(m,l);let b;return x.length&&h&&(x.push(o),b=dt(y,x)),b}if(t.isColTotal&&t.isRowSubTotal){const{rowSubInColTotal:h}=e,g=Ct(m,i),y=(p=h==null?void 0:h[g])==null?void 0:p.data,x=ut(m,i);let b;return x.length&&h&&(x.push(o),b=dt(y,x)),b}if(t.isColSubTotal&&t.isRowSubTotal){const{rowSubInColSub:h}=e,g=Ct(m,i),y=Ct(m,l),x=(f=(c=h==null?void 0:h[g])==null?void 0:c[y])==null?void 0:f.data,b=ut(m,i),S=ut(m,l),A=[...b,...S];let v;return A.length&&h&&(A.push(o),v=dt(x,A)),v}}function Ja(m,u,t,e,o){const{tableLayoutMode:i}=t.customAttr.basicStyle;return i==="tree"?ja(m,u,e,o):Ua(m,u,e,o)}function Ct(m,u){const t=u.map(i=>i.dataeaseName);let e=-1;const o=oo(m);for(let i=t.length-1;i>=0;i--){const l=t[i];o.findIndex(a=>a===l)!==-1&&e++}return e}function ut(m,u){const t=[],e=oo(m);return u.forEach(o=>{e.findIndex(l=>l===o.dataeaseName)!==-1&&t.push(m[o.dataeaseName])}),t}function Xa(m,u){const{isRowTotal:t,isRowSubTotal:e,isColTotal:o,isColSubTotal:i}=m,{row:l,col:n}=u||{},{calcTotals:a={},calcSubTotals:s={}}=l||{},{calcTotals:r={},calcSubTotals:d={}}=n||{},p=(c,f)=>{if((c.aggregation||c.calcFunc)&&f)return{aggregation:c.aggregation,calcFunc:c.calcFunc}};return p(r,o)||p(d,i)||p(a,t)||p(s,e)}const ul=m=>typeof m=="number"?Number.isNaN(m):m&&typeof m=="string"?Number.isNaN(Number(m)):!0,jo=(m,u,t=!1)=>m!=null&&m.length?m.reduce((e,o)=>{const i=dt(o,u),l=ul(i);if(t&&l)return e;const n=l?0:i;return e.push(new lo(n)),e},[]):[],dl=(m,u)=>{const t=jo(m,u);return t.length?lo.sum(...t).toNumber():0},No=(m,u,t)=>{const e=jo(u,t,!0);if(e!=null&&e.length)return lo[m](...e).toNumber()},fl=(m,u)=>{const t=jo(m,u);return t!=null&&t.length?lo.sum(...t).dividedBy(t.length).toNumber():0},Ga={[Ce.SUM]:dl,[Ce.MIN]:(m,u)=>No("min",m,u),[Ce.MAX]:(m,u)=>No("max",m,u),[Ce.AVG]:fl};class Za extends Ci{drawTextShape(){this.meta.fieldValue=" ",super.drawTextShape();const{rowHeader:u,columnHeader:t}=this.spreadsheet.facet,e=t.getConfig().viewportWidth/2,o=u.getConfig().viewportHeight/2,l={attrs:{...this.getTextStyle(),x:e,y:o,text:Ut("data_set.no_data"),opacity:1,textAlign:"center",textBaseline:"middle"}};this.addShape("text",l)}drawBackgroundShape(){const u=this.theme.dataCell.cell;u.backgroundColor=ml(u.backgroundColor,1),super.drawBackgroundShape()}}function ml(m,u){if(m.indexOf("rgba")!==-1){const t=m.split(",");return t[3]=`${u})`,t.join(",")}if(m.indexOf("rgb")!==-1)return`${m.replace("rgb","rgba").replace(")",`,${u})`)}`;if(m.indexOf("#")!==-1){if(m.length===7)return`${m}${Math.round(u*255).toString(16)}`;if(m.length===9)return m.slice(0,7)+Math.round(u*255).toString(16)}return m}function Qa(m,u){u!=null&&u.length||m.on(V.LAYOUT_AFTER_RENDER,()=>{var i;const{colLeafNodes:t,rowLeafNodes:e}=((i=m.facet)==null?void 0:i.layoutResult)||{};if(!(t!=null&&t.length)||!(e!=null&&e.length))return;const o=[];t.forEach((l,n)=>{e.forEach((a,s)=>{o.push({rowIndex:s,colIndex:n})})}),m.options.mergedCell=(l,n,a)=>new Za(l,n,a),m.interaction.mergeCells(o)})}const Ka=Object.freeze(Object.defineProperty({__proto__:null,TablePivot:Ya,getDataAvgByField:fl,getDataExtremumByField:No,getDataSumByField:dl,isNotNumber:ul,setColorOpacity:ml},Symbol.toStringTag,{value:"Module"})),Jt=class Jt{registerChartView(u,t,e){Jt.CHART_VIEW_MAP.has(u)?Jt.CHART_VIEW_MAP.get(u).set(t,e):Jt.CHART_VIEW_MAP.set(u,new Map([[t,e]]))}getChartView(u,t){var e;return(e=Jt.CHART_VIEW_MAP.get(u))==null?void 0:e.get(t)}};w(Jt,"CHART_VIEW_MAP",new Map);let Io=Jt;const pl=new Io,ri=Object.assign({"./charts/bar/bar.ts":Us,"./charts/bar/bidirectional-bar.ts":Xs,"./charts/bar/horizontal-bar.ts":Qs,"./charts/bar/progress-bar.ts":tn,"./charts/bar/range-bar.ts":ln,"./charts/bar/waterfall.ts":nn,"./charts/line/area.ts":cn,"./charts/line/line.ts":fn,"./charts/line/stock-line.ts":hn,"./charts/liquid/liquid.ts":xn,"./charts/map/bubble-map.ts":An,"./charts/map/flow-map.ts":wn,"./charts/map/heat-map.ts":_n,"./charts/map/map.ts":Tn,"./charts/map/symbolic-map.ts":Fn,"./charts/map/tooltip-carousel.ts":bn,"./charts/others/chart-mix-common.ts":zn,"./charts/others/chart-mix.ts":Bn,"./charts/others/circle-packing.ts":Mn,"./charts/others/funnel.ts":Pn,"./charts/others/gauge.ts":Vn,"./charts/others/indicator.ts":jn,"./charts/others/picture-group.ts":Jn,"./charts/others/quadrant.ts":Gn,"./charts/others/radar.ts":Qn,"./charts/others/rich-text.ts":ta,"./charts/others/sankey-common.ts":ea,"./charts/others/sankey.ts":la,"./charts/others/scatter.ts":na,"./charts/others/treemap.ts":ra,"./charts/others/word-cloud.ts":da,"./charts/pie/pie.ts":ha,"./charts/pie/rose.ts":ya,"./charts/table/t-heatmap.ts":Sa,"./charts/table/table-info.ts":Pa,"./charts/table/table-normal.ts":Wa,"./charts/table/table-pivot.ts":Ka});for(const m in ri){const u=ri[m];Object.getOwnPropertyNames(u).forEach(t=>{if(El(u[t],Ee)){const e=new u[t];pl.registerChartView(e.render,e.name,e)}})}const _r=pl;export{Vt as C,vr as a,ze as b,_r as c,Ye as d,Cr as e,wr as f,nl as g,Bs as h,rl as i,Aa as j,al as k,si as m,Sr as n,$s as s};

import{d as b,p as N,h as x,g as Zt,f as Qt,R as ea,S as ta,T as aa,L as oa,a as sa,l as na,q as he,e as ia,r as la,I as ra,J as da,G as ca,t as ua,Q as ma,U as pa,V as _a,w as fa,v as va}from"./element-plus-secondary-0.0.0-dataease.js";import{d as ha,r as u,l as Xe,k as I,x as ge,a0 as o,h as C,R as ga,w as ya,ak as Ze,o as d,c as y,W as R,z as V,a3 as ye,u as t,_ as s,a as p,Z as m,M as $,a2 as h,Y as f,s as wa,n as we,q as ba,ab as be,a4 as D,a1 as Qe,$ as Ta}from"./@vue-0.0.0-dataease.js";import{i as ka}from"./icon_copy_filled-0.0.0-dataease.js";import{i as et}from"./icon_dataset-0.0.0-dataease.js";import{i as xa}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as Ca,_ as Da,t as Sa}from"./index.vue_vue_type_style_index_0_lang-0.0.0-dataease2.js";import{i as Ea}from"./icon_rename_outlined-0.0.0-dataease.js";import{d as Na,i as Ia}from"./icon_file-add_outlined-0.0.0-dataease.js";import{e as La,f as Aa,h as Fa,i as Pa,j as Ra,p as Va,k as Te,m as $a}from"./dataset-0.0.0-dataease.js";import{i as za}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{d as Ba,a as Oa}from"./dv-sort-desc-0.0.0-dataease.js";import{d as tt}from"./dv-folder-0.0.0-dataease.js";import{i as at}from"./icon_add_outlined-0.0.0-dataease.js";import{i as Ma}from"./icon_info_outlined-0.0.0-dataease.js";import{i as Ga}from"./icon_dashboard_outlined-0.0.0-dataease.js";import{i as ja}from"./icon_operation-analysis_outlined-0.0.0-dataease.js";import{i as Ua}from"./icon_download_outlined-0.0.0-dataease.js";import{i as ot}from"./icon_edit_outlined-0.0.0-dataease.js";import{B as Ka,h as v,j as qa,C as Wa,l as ke}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import st from"./DeResourceArrow-0.0.0-dataease.js";import{a as Ha,b as Ya,u as oe}from"./index-0.0.0-dataease.js";import{_ as nt}from"./HandleMore.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{u as Ja}from"./useMoveLine-0.0.0-dataease.js";import{u as Xa,b as Za}from"./vue-router-0.0.0-dataease.js";import Qa from"./CreatDsGroup-0.0.0-dataease.js";import{E as se}from"./EmptyBackground-0.0.0-dataease.js";import eo from"./DeResourceGroupOpt-0.0.0-dataease.js";import to from"./DatasetDetail-0.0.0-dataease.js";import{t as ao,g as oo}from"./util-0.0.0-dataease.js";import{f as S}from"./attr-0.0.0-dataease20.js";import{useAppStoreWithOut as so}from"./app-0.0.0-dataease.js";import{t as it}from"./treeSortUtils-0.0.0-dataease.js";import no from"./RowAuth-0.0.0-dataease2.js";import{D as io,b as lo}from"./dataVisualization-0.0.0-dataease2.js";import{i as ro}from"./interactive-0.0.0-dataease.js";import{y as co}from"./@element-plus-0.0.0-dataease.js";import{i as xe}from"./field-list-0.0.0-dataease.js";import{e as ne,d as uo}from"./lodash-es-0.0.0-dataease.js";import{_ as mo}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./icon_left_outlined-0.0.0-dataease.js";import"./icon_right_outlined-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./icon_more_outlined-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./AuthTree-0.0.0-dataease2.js";import"./FilterFiled-0.0.0-dataease2.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./options-0.0.0-dataease.js";import"./icon_down_outlined-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";const po={class:"resource-tree"},_o={class:"tree-header"},fo={class:"icon-methods"},vo={class:"title"},ho={key:0,class:"flex-align-center"},go={key:0,class:"ed-dropdown-menu__item--divided"},yo={class:"custom-tree-node"},wo=["title"],bo={key:2,class:"icon-more"},To={class:"dataset-info"},ko={class:"info-method"},xo=["title"],Co={class:"create-user"},Do={class:"right-btn"},So={class:"tab-border"},Eo={class:"dataset-table-info"},No={key:0,class:"preview-num"},Io={class:"flex-align-center"},Lo=["title"],Ao={key:2,class:"table-row-column"},Fo={class:"tree-cont"},Po={class:"content"},Ro={class:"tip"},Vo={class:"dialog-footer"};function lt(Y){return typeof Y=="function"||Object.prototype.toString.call(Y)==="[object Object]"&&!wa(Y)}const $o=ha({__name:"index",setup(Y){const{t:n}=qa(),rt=ro(),{wsCache:T}=Ha(),z=so(),ie=u(!1),L=u(!1),B=u(),le=u(!1),Ce=u(n("data_set.ten_wan")),A=u({}),O=u({}),De=u(),dt={name:[{required:!0,message:n("commons.input_content"),trigger:"change"},{max:50,message:n("commons.char_can_not_more_50"),trigger:"change"}]},Se=u([]);ba("filedList",Se);const M=u(""),re=Za(),Ee=Xa(),_=Xe({datasetTree:[],curSortType:"time_desc"}),ct=u(),J=u(""),de=u(!1),Ne=T.get("open-backend")==="1"?"_self":"_blank",X=I(()=>z.getIsDataEaseBi),Ie=I(()=>z.getIsIframe),ut=I(()=>Ka(c.weight,c.ext)),Le=e=>{const a=`#/${e}?opt=create&id=${c.id}`;T.set("dataset-info-id",c.id),window.open(a,Ne)},mt=e=>{e&&e.opt==="newLeaf"&&_t(e.pid,e.name)},G=ge([]),pt=e=>{_.datasetTree=it(G.value,e),_.curSortType=e,T.set("TreeSort-dataset",_.curSortType)},Ae=e=>{_.datasetTree=it(G.value,e),_.curSortType=e},_t=(e,a)=>{const i=oo(),r={dataState:"ready",id:i,name:a,pid:e,type:J.value,status:1,selfWatermarkStatus:!0},k=J.value==="dashboard"?io:lo,W={canvasStyleData:JSON.stringify(k),componentData:JSON.stringify([]),canvasViewInfo:{},...r};Be(W).then(()=>{const H=J.value==="dataV"?"#/dvCanvas?dvId=":"#/dashboard?resourceId=";window.open(H+i,Ne)})},ce=u(),Fe={name:"",createBy:"",creator:"",id:"",nodeType:"",createTime:0,weight:0},c=Xe(ne(Fe));let ue=[],j=[],Z=[];const ft=[{key:"name",dataKey:"name",title:n("data_set.field_name"),width:250},{key:"deType",dataKey:"deType",title:n("data_set.field_type"),width:250,cellRenderer:({cellData:e})=>{let a;return o("div",{style:{width:"100%",display:"flex",alignItems:"center"}},[o(b,{style:{marginRight:"6px"}},{default:()=>[o(v,null,lt(a=C(xe[S[e]],{class:`svg-icon field-icon-${S[e]}`}))?a:{default:()=>[a]})]}),n(`dataset.${S[e]}`)+`${e===3?"("+n("dataset.float")+")":""}`])}},{key:"description",dataKey:"description",title:n("data_set.field_notes"),width:250}],Q=u(!1),{width:me,node:vt}=Ja("DATASOURCE"),Pe=I(()=>({creator:c.creator,createTime:c.createTime&&ao(c.createTime)})),{handleDrop:ht,allowDrop:gt,handleDragStart:yt}=Sa(_,"datasetTree",$a,"dataset",G),wt=e=>e.map(a=>({key:a.dataeaseName,deType:a.deType,dataKey:a.dataeaseName,title:a.name,width:150,headerCellRenderer:({column:i})=>{let r;return o("div",{class:"flex-align-center"},[o(b,{style:{marginRight:"6px"}},{default:()=>[o(v,null,lt(r=C(xe[S[i.deType]],{class:`svg-icon field-icon-${S[i.deType]}`}))?r:{default:()=>[r]})]}),o("span",{class:"ellipsis",title:i.title,style:{width:"120px"}},[i.title])])}})),pe=u(!1),Re=u(!1),U=()=>{pe.value=!0;let e=ve[Number(T.get("TreeSort-backend"))??1].value;e=T.get("TreeSort-dataset")??e;const a={busiFlag:"dataset"};rt.setInteractive(a).then(i=>{const r=i||[];if(r.length&&r[0].id==="0"&&r[0].name==="root"){ie.value=r[0].weight>=7,_.datasetTree=r[0].children||[],G.value=ne(t(_.datasetTree)),Ae(e);return}_.datasetTree=r,G.value=ne(t(_.datasetTree)),Ae(e)}).finally(()=>{pe.value=!1,de.value=!0,we(()=>{M.value.length&&q.value.filter(M.value)});const i=c.id;i&&(Object.assign(c,ne(Fe)),Ve(_.datasetTree,i),we(()=>{Re.value||(Re.value=!0,q.value.setCurrentKey(i,!0))}))})},Ve=(e,a)=>{e.some(i=>{var r;return i.id===a?($e(i),!0):((r=i.children)!=null&&r.length&&Ve(i.children,a),!1)})};ga(()=>{const e=T.get("dataset-info-id")||Ee.params.id;c.id=e||Ee.query.id||"",T.delete("dataset-info-id"),T.delete("db-info-id"),T.delete("dv-info-id"),At(),U(),Ft()});const F=ge([]),K=ge([]),_e=u(null),$e=e=>{if(!e.leaf){q.value.setCurrentKey(null);return}Aa(e.id).then(a=>{Object.assign(c,a),c.weight=e.weight,c.ext=e.ext||0,j=[],Z=[],w.value="dataPreview",Me(w.value)})},bt=()=>{L.value=!0,A.value.name=c.name,A.value.expressionTree="",we(()=>{B.value.init({}),B.value.relationList=[],B.value.logic="or"})},ze=()=>{L.value=!1},Be=({logic:e,items:a,errorMessage:i})=>{if(O.value.id=c.id,O.value.row=1e5,O.value.filename=A.value.name,i){N.error(i);return}O.value.expressionTree=JSON.stringify({items:a,logic:e}),le.value=!0,Fa(O.value).then(r=>{r.code===0?Ct(kt):N.error(r.msg)}).finally(()=>{le.value=!1,L.value=!1})},Tt=()=>{De.value.validate(e=>{if(e)B.value.submit();else return!1})},kt=()=>{oe().emitter.emit("data-export-center",{activeName:"IN_PROGRESS"})},xt=(e,a,i)=>{const r=i.target.parentNode.parentNode;if([...r.classList].includes("no-hide")){r.classList.remove("no-hide");return}r.classList.add("no-hide")},Ct=e=>{const a="el-icon-loading",i="de-message-loading de-message-export";N({message:C("p",null,[n("data_set.can_go_to"),C(x,{text:!0,size:"small",class:"btn-text",onClick:()=>{e()}},n("data_export.export_center")),n("data_set.progress_and_download")]),iconClass:a,icon:C(co),showClose:!0,customClass:i})},Dt=()=>{Oe(c.id)},E=Ya(),Oe=e=>{if(X.value){E.clearState(),E.setDatasetId(e),oe().emitter.emit("changeCurrentComponent","DatasetEditor");return}re.push({path:"/dataset-form",query:{id:e}})},fe=e=>{if(X.value){E.clearState(),E.setdatasetPid(e==null?void 0:e.id),oe().emitter.emit("changeCurrentComponent","DatasetEditor");return}re.push({path:"/dataset-form",query:{pid:e==null?void 0:e.id}})},Me=e=>{switch(e){case"dataPreview":if(j.length){F.value=j,K.value=Z;break}Q.value=!0,_e.value=null,Pa(c.id).then(a=>{var i,r;ue=(a==null?void 0:a.allFields)||[],Se.value=ue,j=wt(((i=a==null?void 0:a.data)==null?void 0:i.fields)||[]),Z=((r=a==null?void 0:a.data)==null?void 0:r.data)||[],F.value=j,K.value=Z}).finally(()=>{Q.value=!1}),Ra(c.id).then(a=>{_e.value=a});break;case"structPreview":F.value=ft,K.value=ue;break}},Ge=u(),St=(e,a,i)=>{var r;if(e==="copy"){if(X.value){E.clearState(),E.setDatasetCopyId(a.id),oe().emitter.emit("changeCurrentComponent","DatasetEditor");return}re.push({name:E.getToken&&z.getIsIframe?"dataset-embedded-form":"dataset-form",params:{id:a.id}});return}if(e==="delete"){let k={confirmButtonType:"danger",type:"warning",autofocus:!1,showClose:!1,tip:""};(r=a.children)!=null&&r.length?k.tip=n("data_set.operate_with_caution"):delete k.tip,i!=="folder"?Va(a.id).then(W=>{if(W===!0){const H=()=>{Ge.value.getChartData({queryType:"dataset",num:a.id,label:a.name})};he.confirm("",{confirmButtonType:"danger",type:"warning",autofocus:!1,confirmButtonText:n("userimport.sure"),showClose:!1,dangerouslyUseHTMLString:!0,message:C("div",null,[C("p",{style:"margin-bottom: 8px;"},n("data_set.this_data_set")),C("p",{class:"tip"},n("data_set.to_delete_them")),C(x,{text:!0,onClick:H,style:"margin-left: -4px;"},n("data_set.check_blood_relationship"))])}).then(()=>{Te(a.id).then(()=>{U(),N.success(n("dataset.delete_success"))})})}else he.confirm(n("datasource.delete_this_dataset"),k).then(()=>{Te(a.id).then(()=>{U(),N.success(n("dataset.delete_success"))})})}):he.confirm(n("data_set.delete_this_folder"),k).then(()=>{Te(a.id).then(()=>{U(),N.success(n("dataset.delete_success"))})})}else ce.value.createInit(i,a,e)},je=(e,a)=>{e==="dataset"&&fe(a),e==="folder"&&ce.value.createInit(e,a||{})},w=u("dataPreview"),Ue=[{label:n("visualization.move_to"),svgName:Ca,command:"move"},{label:n("visualization.rename"),svgName:Ea,command:"rename"},{label:n("common.delete"),divided:!0,svgName:xa,command:"delete"}],ee=u([]),Et=e=>{e.id&&ee.value.push(e.id)},Nt=e=>{e.id&&ee.value.splice(ee.value.indexOf(e.id),1)},It=I(()=>[{label:n("data_set.a_new_dataset"),svgName:et,command:"dataset"},{label:n("deDataset.new_folder"),divided:!0,svgName:tt,command:"folder"}]),Lt={children:"children",label:"name"},Ke=[{title:n("chart.data_preview"),name:"dataPreview"},{title:n("data_set.structure_preview"),name:"structPreview"}],ve=[{name:n("visualization.time_asc"),value:"time_asc"},{name:n("visualization.time_desc"),value:"time_desc",divided:!0},{name:n("visualization.name_asc"),value:"name_asc"},{name:n("visualization.name_desc"),value:"name_desc"}],At=()=>{const e=T.get("TreeSort-dataset");e&&(_.curSortType=e)},Ft=()=>{La().then(e=>{Ce.value=e})},qe=I(()=>ve.find(e=>e.value===_.curSortType).name),We=u([]),Pt=I(()=>c.weight>=7?[...Ke,...We.value]:[...Ke]),Rt=e=>{We.value=e},q=u();ya(M,e=>{q.value.filter(e)});const P=u(!0),He=e=>{P.value=e},Vt=(e,a)=>{var i;return e?(i=a.name)==null?void 0:i.toLowerCase().includes(e.toLowerCase()):!0},$t=()=>{z.setArrowSide(!0)},zt=()=>{z.setArrowSide(!1)},Bt=e=>e?[{label:n("common.copy"),svgName:ka,command:"copy"}].concat(Ue):Ue,Ot=uo((e,a)=>{const r=["dashboard","dataV","dataset","datasource"].findIndex(k=>k==="dataset");return r<0||!Wa(a,r+1)?gt(e,a):(N.warning(n("free.save_error")),!1)},300);return(e,a)=>{const i=ia,r=la,k=ra,W=da,H=ca,Mt=ua,Gt=Zt,jt=Qt,Ut=ma,Kt=ea,qt=pa,Wt=ta,Ht=_a,Yt=aa,Ye=fa,Jt=va,Xt=oa,Je=Ze("permission"),te=Ze("loading");return d(),y($,null,[R((d(),y("div",{class:V(["dataset-manage",Ie.value&&"de-100vh"])},[o(st,{style:ye({left:(P.value?t(me)-12:0)+"px"}),onChangeSideTreeStatus:He,isInside:!P.value},null,8,["style","isInside"]),o(t(na),{class:V(["resource-area",{retract:!P.value}]),onMouseenter:$t,onMouseleave:zt,ref_key:"node",ref:vt,style:ye({width:t(me)+"px"})},{default:s(()=>[o(st,{isInside:!P.value,style:ye({left:(P.value?t(me)-12:0)+"px"}),onChangeSideTreeStatus:He},null,8,["isInside","style"]),p("div",po,[p("div",_o,[p("div",fo,[p("span",vo,h(t(n)("auth.dataset")),1),ie.value?(d(),y("div",ho,[o(i,{class:"box-item",effect:"dark",content:t(n)("deDataset.new_folder"),placement:"top"},{default:s(()=>[o(t(b),{class:"custom-icon btn",style:{"margin-right":"20px"},onClick:a[0]||(a[0]=l=>je("folder"))},{default:s(()=>[o(t(v),{name:"dv-new-folder"},{default:s(()=>[o(t(Na),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["content"]),o(i,{class:"box-item",effect:"dark",content:t(n)("data_set.a_new_dataset"),placement:"top"},{default:s(()=>[o(t(b),{class:"custom-icon btn",onClick:fe},{default:s(()=>[o(t(v),{name:"icon_file-add_outlined"},{default:s(()=>[o(t(Ia),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["content"])])):f("",!0)]),o(r,{placeholder:t(n)("commons.search"),modelValue:M.value,"onUpdate:modelValue":a[1]||(a[1]=l=>M.value=l),clearable:"",class:"search-bar"},{prefix:s(()=>[o(t(b),null,{default:s(()=>[o(t(v),{name:"icon_search-outline_outlined"},{default:s(()=>[o(t(za),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["placeholder","modelValue"]),o(H,{onCommand:pt,trigger:"click"},{dropdown:s(()=>[o(W,{style:{width:"246px"}},{default:s(()=>[(d(),y($,null,be(ve,l=>(d(),y($,{key:l.value},[o(k,{class:V(["ed-select-dropdown__item",l.value===_.curSortType&&"selected"]),command:l.value},{default:s(()=>[D(h(l.name),1)]),_:2},1032,["class","command"]),l.divided?(d(),y("li",go)):f("",!0)],64))),64))]),_:1})]),default:s(()=>[o(t(b),{class:"filter-icon-span"},{default:s(()=>[o(i,{offset:16,effect:"dark",content:qe.value,placement:"top"},{default:s(()=>[o(t(v),{name:"dv-sort-asc",class:"opt-icon"},{default:s(()=>[_.curSortType.includes("asc")?(d(),m(t(Ba),{key:0,class:"svg-icon opt-icon"})):f("",!0)]),_:1})]),_:1},8,["content"]),o(i,{offset:16,effect:"dark",content:qe.value,placement:"top"},{default:s(()=>[o(t(v),{name:"dv-sort-desc",class:"opt-icon"},{default:s(()=>[_.curSortType.includes("desc")?(d(),m(t(Oa),{key:0,class:"svg-icon"})):f("",!0)]),_:1})]),_:1},8,["content"])]),_:1})]),_:1})]),o(t(sa),{class:"custom-tree"},{default:s(()=>[o(Mt,{menu:"",ref_key:"datasetListTree",ref:q,"node-key":"id",data:_.datasetTree,"filter-node-method":Vt,"expand-on-click-node":"","highlight-current":"",onNodeDragStart:t(yt),"allow-drop":t(Ot),onNodeDrop:t(ht),draggable:"",onNodeExpand:Et,onNodeCollapse:Nt,"default-expanded-keys":ee.value,props:Lt,onNodeClick:$e},{default:s(({node:l,data:g})=>[p("span",yo,[g.leaf?f("",!0):(d(),m(t(b),{key:0,style:{"font-size":"18px"}},{default:s(()=>[o(t(v),{name:"dv-folder"},{default:s(()=>[o(t(tt),{class:"svg-icon"})]),_:1})]),_:1})),g.leaf?(d(),m(t(b),{key:1,style:{"font-size":"18px"}},{default:s(()=>[o(t(v),{name:"icon_dataset"},{default:s(()=>[o(t(et),{class:"svg-icon"})]),_:1})]),_:1})):f("",!0),p("span",{title:l.label,class:"label-tooltip ellipsis"},h(l.label),9,wo),g.weight>=7?(d(),y("div",bo,[g.leaf?(d(),m(t(b),{key:1,class:"hover-icon",onClick:Qe(ae=>Oe(g.id),["stop"])},{default:s(()=>[o(t(v),{name:"icon_edit_outlined"},{default:s(()=>[o(t(ot),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])):(d(),m(t(nt),{key:0,"icon-size":"24px",onHandleCommand:ae=>je(ae,g),"menu-list":It.value,"icon-name":t(at),placement:"bottom-start"},null,8,["onHandleCommand","menu-list","icon-name"])),o(t(nt),{onHandleCommand:ae=>St(ae,g,g.leaf?"dataset":"folder"),"menu-list":Bt(g.leaf)},null,8,["onHandleCommand","menu-list"])])):f("",!0)])]),_:1},8,["data","onNodeDragStart","allow-drop","onNodeDrop","default-expanded-keys"])]),_:1})])]),_:1},8,["class","style"]),p("div",{class:V(["dataset-content",{auto:Ie.value||X.value}])},[!_.datasetTree.length&&de.value?(d(),m(se,{key:0,description:t(n)("data_set.data_set_yet"),"img-type":"none"},{default:s(()=>[ie.value?(d(),m(t(x),{key:0,onClick:a[2]||(a[2]=()=>fe()),type:"primary"},{icon:s(()=>[o(t(v),{name:"icon_add_outlined"},{default:s(()=>[o(t(at),{class:"svg-icon"})]),_:1})]),default:s(()=>[D(" "+h(t(n)("deDataset.create")+t(n)("auth.dataset")),1)]),_:1})):f("",!0)]),_:1},8,["description"])):c.id?(d(),y($,{key:1},[p("div",To,[p("div",ko,[p("span",{title:c.name,class:"dataset-name ellipsis"},h(c.name),9,xo),o(Gt,{style:{margin:"0 12px"},direction:"vertical"}),p("span",Co,h(t(n)("visualization.create_by"))+":"+h(c.creator),1),o(jt,{"show-arrow":"",offset:8,placement:"bottom",width:"290",trigger:"hover"},{reference:s(()=>[o(t(b),{size:"16px",class:"create-user"},{default:s(()=>[o(t(v),{name:"icon_info_outlined"},{default:s(()=>[o(t(Ma),{class:"svg-icon"})]),_:1})]),_:1})]),default:s(()=>[o(to,{"create-time":Pe.value.createTime,creator:Pe.value.creator},null,8,["create-time","creator"])]),_:1}),p("div",Do,[R((d(),m(t(x),{secondary:"",onClick:a[3]||(a[3]=l=>Le("dashboard"))},{icon:s(()=>[o(t(v),{name:"icon_dashboard_outlined"},{default:s(()=>[o(t(Ga),{class:"svg-icon"})]),_:1})]),default:s(()=>[D(" "+h(t(n)("visualization.panelAdd")),1)]),_:1})),[[Je,["panel"]]]),R((d(),m(t(x),{secondary:"",onClick:a[4]||(a[4]=l=>Le("dvCanvas"))},{icon:s(()=>[o(t(v),{name:"icon_operation-analysis_outlined"},{default:s(()=>[o(t(ja),{class:"svg-icon"})]),_:1})]),default:s(()=>[D(h(t(n)("data_set.new_data_screen")),1)]),_:1})),[[Je,["screen"]]]),ut.value[0]?(d(),m(t(x),{key:0,secondary:"",onClick:bt},{icon:s(()=>[o(t(v),{name:"icon_download_outlined"},{default:s(()=>[o(t(Ua),{class:"svg-icon"})]),_:1})]),default:s(()=>[D(" "+h(t(n)("data_set.dataset_export")),1)]),_:1})):f("",!0),c.weight>=7?(d(),m(t(x),{key:1,type:"primary",onClick:Dt},{icon:s(()=>[o(t(v),{name:"icon_edit_outlined"},{default:s(()=>[o(t(ot),{class:"svg-icon"})]),_:1})]),default:s(()=>[D(" "+h(t(n)("visualization.edit")),1)]),_:1})):f("",!0)])]),p("div",So,[o(Kt,{modelValue:w.value,"onUpdate:modelValue":a[5]||(a[5]=l=>w.value=l),onTabChange:Me},{default:s(()=>[(d(!0),y($,null,be(Pt.value,l=>(d(),m(Ut,{key:l.name,label:l.title,name:l.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),o(t(ke),{jsname:"L2NvbXBvbmVudC9yb3ctY29sLXBlcm1pc3Npb24vcGFuZS9pbmRleA==",onLoaded:Rt})])]),p("div",Eo,[w.value==="dataPreview"?(d(),y("div",No,h(t(n)("data_set.pieces_in_total",{msg:_e.value})),1)):f("",!0),["dataPreview","structPreview"].includes(w.value)?(d(),y("div",{key:1,class:V(["info-table",[{"struct-preview":w.value==="structPreview"}]])},[w.value==="structPreview"?(d(),m(Wt,{key:0},{default:s(({height:l,width:g})=>[R((d(),m(qt,{key:"structPreview",columns:F.value,"header-class":"header-cell",data:K.value,width:g,height:l,fixed:""},{empty:s(()=>[o(se,{description:t(n)("data_set.no_data"),"img-type":"noneWhite"},null,8,["description"])]),_:2},1032,["columns","data","width","height"])),[[te,Q.value]])]),_:1})):f("",!0),w.value==="dataPreview"?R((d(),m(Yt,{class:"dataset-preview_table","header-class":"header-cell",data:K.value,onRowClick:xt,key:"dataPreview",border:"",style:{width:"100%",height:"100%"}},{empty:s(()=>[o(se,{description:t(n)("data_set.no_data"),"img-type":"noneWhite"},null,8,["description"])]),default:s(()=>[(d(!0),y($,null,be(F.value,(l,g)=>(d(),m(Ht,{key:l.dataKey,prop:l.dataKey,label:l.title,"min-width":150,fixed:F.value.length-1===g?"right":!1},{header:s(()=>[p("div",Io,[o(t(b),{style:{"margin-right":"6px"}},{default:s(()=>[o(t(v),{className:`field-icon-${t(S)[l.deType]}`},{default:s(()=>[(d(),m(Ta(t(xe)[t(S)[l.deType]]),{class:V(["svg-icon",`field-icon-${t(S)[l.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024),p("span",{class:"ellipsis",title:l.title,style:{width:"120px"}},h(l.title),9,Lo)])]),_:2},1032,["prop","label","fixed"]))),128))]),_:1},8,["data"])),[[te,Q.value]]):f("",!0)],2)):f("",!0),["row","column"].includes(w.value)?(d(),y("div",Ao,[o(t(ke),{"active-name":w.value,"dataset-id":c.id,jsname:"ZGF0YXNldC1yb3ctcGVybWlzc2lvbnM="},null,8,["active-name","dataset-id"]),o(t(ke),{"active-name":w.value,"dataset-id":c.id,jsname:"ZGF0YXNldC1jb2x1bW4tcGVybWlzc2lvbnM="},null,8,["active-name","dataset-id"])])):f("",!0)])],64)):de.value?(d(),m(se,{key:2,description:t(n)("deDataset.on_the_left"),"img-type":"select"},null,8,["description"])):f("",!0)],2),o(Da,{ref_key:"relationChartRef",ref:Ge},null,512),o(eo,{"cur-canvas-type":J.value,onFinish:mt,ref_key:"resourceGroupOpt",ref:ct},null,8,["cur-canvas-type"]),o(Qa,{onFinish:a[6]||(a[6]=l=>U()),ref_key:"creatDsFolder",ref:ce},null,512)],2)),[[te,pe.value]]),L.value?(d(),m(Xt,{key:0,modelValue:L.value,"onUpdate:modelValue":a[9]||(a[9]=l=>L.value=l),width:"800px",class:"de-dialog-form form-tree-cont",title:e.$t("dataset.export_dataset"),"append-to-body":""},{footer:s(()=>[p("div",Vo,[o(t(x),{secondary:"",onClick:ze},{default:s(()=>[D(h(e.$t("dataset.cancel")),1)]),_:1}),R((d(),m(t(x),{type:"primary",onClick:Tt},{default:s(()=>[D(h(e.$t("dataset.confirm")),1)]),_:1})),[[te,le.value]])])]),default:s(()=>[o(Jt,{ref_key:"exportFormRef",ref:De,class:"de-form-item",onSubmit:a[8]||(a[8]=Qe(()=>{},["prevent"])),model:A.value,rules:dt,"before-close":ze},{default:s(()=>[o(Ye,{label:e.$t("dataset.filename"),prop:"name"},{default:s(()=>[o(r,{modelValue:A.value.name,"onUpdate:modelValue":a[7]||(a[7]=l=>A.value.name=l),modelModifiers:{trim:!0},placeholder:e.$t("dataset.pls_input_filename")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(Ye,{label:e.$t("dataset.export_filter"),prop:"expressionTree"},{default:s(()=>[p("div",Fo,[p("div",Po,[o(no,{onSave:Be,ref_key:"rowAuth",ref:B},null,512)])])]),_:1},8,["label"])]),_:1},8,["model"]),p("span",Ro,h(t(n)("data_set.pieces_of_data",{limit:Ce.value})),1)]),_:1},8,["modelValue","title"])):f("",!0)],64)}}});const Ln=mo($o,[["__scopeId","data-v-6f60c2b4"]]);export{Ln as default};

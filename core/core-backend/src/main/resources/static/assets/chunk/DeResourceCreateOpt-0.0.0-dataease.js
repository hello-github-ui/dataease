import{p as v,O as $,B as q,h as M,o as W,r as j,L as A}from"./element-plus-secondary-0.0.0-dataease.js";import{d as J,r as P,l as Y,k as T,w as Z,ak as G,o as f,Z as _,_ as o,W as H,a0 as a,a4 as s,a2 as u,u as n,a as K,Y as y,a3 as h,a1 as Q}from"./@vue-0.0.0-dataease.js";import{s as X}from"./template-0.0.0-dataease.js";import{j as ee}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as te}from"./imgUtils-0.0.0-dataease.js";import{h as oe}from"./dataVisualization-0.0.0-dataease.js";import ae from"./DeTemplatePreviewList-0.0.0-dataease.js";import{_ as re}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./vue-router-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./html2canvas-0.0.0-dataease.js";import"./dvMain-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./index-0.0.0-dataease12.js";import"./util-0.0.0-dataease2.js";import"./chart-0.0.0-dataease2.js";import"./app-0.0.0-dataease.js";import"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./mathjs-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./exceljs-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./html-to-image-0.0.0-dataease.js";import"./dv-folder-0.0.0-dataease.js";import"./dv-dashboard-spine-0.0.0-dataease.js";import"./icon_operation-analysis_outlined-0.0.0-dataease.js";const ie=J({__name:"DeResourceCreateOpt",props:{curCanvasType:{type:String,required:!0}},emits:["finish"],setup(S,{expose:D,emit:k}){const{t:i}=ee(),I=k,g=P(null),V=S,e=Y({dialogShow:!1,loading:!1,inputType:"new_outer_template",fieldName:"name",tableRadio:null,keyWordSearch:"",columnLabel:i("visualization.belong_to_category"),templateList:[],importTemplateInfo:{snapshot:""},dvCreateInfo:{pid:-1,name:null,canvasStyleData:null,componentData:null,templateId:null,dynamicData:null,staticResource:null},templateSelected:!1}),b=T(()=>e.dvCreateInfo.name&&e.templateSelected),C=T(()=>e.importTemplateInfo.snapshot?{background:`url(${te(e.importTemplateInfo.snapshot)}) no-repeat`}:{});Z(()=>e.inputType,()=>{w()});const w=()=>{e.templateSelected=!1,e.dvCreateInfo.name=null,e.dvCreateInfo.canvasStyleData=null,e.dvCreateInfo.componentData=null,e.importTemplateInfo.snapshot=null,e.dvCreateInfo.templateId=null},z=r=>{e.dvCreateInfo.templateId=r.id,r.nodeType==="folder"?(e.dvCreateInfo.name=null,e.importTemplateInfo.snapshot=null,e.templateSelected=!1):(e.dvCreateInfo.name=r.name,e.importTemplateInfo.snapshot=r.snapshot,e.templateSelected=!0)},x=()=>{const r={level:"0",leafDvType:V.curCanvasType,withChildren:!0};e.loading=!0,X(r).then(t=>{e.templateList=t.data,e.loading=!1})},R=()=>{I("finish")},E=()=>{if(!e.dvCreateInfo.name)return v.warning(i("common.save_success")),!1;if(e.dvCreateInfo.name.length>50)return v.warning(i("common.char_can_not_more_50")),!1;if(!e.dvCreateInfo.templateId&&e.inputType==="new_inner_template")return v.warning("chart.template_can_not_empty"),!1;e.dvCreateInfo.newFrom=e.inputType,e.loading=!0,oe(e.dvCreateInfo).then(r=>{e.loading=!1,I("finish",r.data)}).catch(()=>{e.loading=!1})},L=r=>{const t=r.target.files[0],d=new FileReader;d.onload=l=>{e.templateSelected=!0;const c=l.target.result;e.importTemplateInfo=JSON.parse(c),e.dvCreateInfo.name=e.importTemplateInfo.name.name,e.dvCreateInfo.canvasStyleData=e.importTemplateInfo.canvasStyleData,e.dvCreateInfo.componentData=e.importTemplateInfo.componentData,e.dvCreateInfo.dynamicData=e.importTemplateInfo.dynamicData,e.dvCreateInfo.staticResource=e.importTemplateInfo.staticResource},d.readAsText(t)},B=()=>{g.value.click()},N=()=>{e.dialogShow=!1};return D({optInit:()=>{e.dialogShow=!0,w()}}),(r,t)=>{const d=$,l=q,c=M,m=W,O=j,U=A,F=G("loading");return f(),_(U,{class:"create-dialog",title:n(i)("visualization.new_from_template"),modelValue:e.dialogShow,"onUpdate:modelValue":t[5]||(t[5]=p=>e.dialogShow=p),width:"700","before-close":N,onSubmit:t[6]||(t[6]=Q(()=>{},["prevent"]))},{default:o(()=>[H((f(),_(m,{class:"create-main"},{default:o(()=>[a(m,null,{default:o(()=>[a(l,{span:18,style:{height:"40px"}},{default:o(()=>[a(d,{modelValue:e.inputType,"onUpdate:modelValue":t[0]||(t[0]=p=>e.inputType=p),label:"new_outer_template"},{default:o(()=>[s(u(n(i)("visualization.import_template")),1)]),_:1},8,["modelValue"]),a(d,{modelValue:e.inputType,"onUpdate:modelValue":t[1]||(t[1]=p=>e.inputType=p),label:"new_inner_template",onClick:x},{default:o(()=>[s(u(n(i)("visualization.copy_template")),1)]),_:1},8,["modelValue"])]),_:1}),e.inputType==="new_outer_template"?(f(),_(l,{key:0,span:6,class:"button-main"},{default:o(()=>[a(c,{class:"el-icon-upload",size:"small",type:"primary",onClick:B},{default:o(()=>[s(u(n(i)("visualization.upload_template")),1)]),_:1}),K("input",{id:"input",ref_key:"files",ref:g,type:"file",accept:".DET2",hidden:"",onChange:L},null,544)]),_:1})):y("",!0)]),_:1}),a(m,{style:{"margin-top":"5px"}},{default:o(()=>[a(l,{span:4,class:"name-area"},{default:o(()=>[s(u(n(i)("visualization.name")),1)]),_:1}),a(l,{span:20},{default:o(()=>[a(O,{modelValue:e.dvCreateInfo.name,"onUpdate:modelValue":t[2]||(t[2]=p=>e.dvCreateInfo.name=p),clearable:"",size:"small"},null,8,["modelValue"])]),_:1})]),_:1}),e.inputType==="new_inner_template"?(f(),_(m,{key:0,class:"preview"},{default:o(()=>[a(l,{span:8,style:{height:"100%","overflow-y":"auto"}},{default:o(()=>[a(ae,{"template-list":e.templateList,onShowCurrentTemplateInfo:z},null,8,["template-list"])]),_:1}),a(l,{span:16,style:h(C.value),class:"preview-show"},null,8,["style"])]),_:1})):y("",!0),e.inputType==="new_outer_template"?(f(),_(m,{key:1,class:"preview",style:h(C.value)},null,8,["style"])):y("",!0),a(m,{class:"root-class"},{default:o(()=>[a(c,{size:"small",onClick:t[3]||(t[3]=p=>R())},{default:o(()=>[s(u(n(i)("commons.cancel")),1)]),_:1}),a(c,{type:"primary",size:"small",disabled:!b.value,onClick:t[4]||(t[4]=p=>E())},{default:o(()=>[s(u(n(i)("commons.confirm")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})),[[F,e.loading]])]),_:1},8,["title","modelValue"])}}});const Vo=re(ie,[["__scopeId","data-v-b3ac9a5a"]]);export{Vo as default};

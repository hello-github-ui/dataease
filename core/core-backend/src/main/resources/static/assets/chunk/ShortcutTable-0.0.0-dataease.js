import{R as Ne,o as Ue,a3 as Fe,e as $e,Q as Ae,x as Be,y as Ge,B as Oe,d as je,r as Ze,V as ze}from"./element-plus-secondary-0.0.0-dataease.js";import{a as Pe,j as Re,l as Q,h as J}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as qe,r as u,l as He,k as M,w as Qe,b as Je,ak as Xe,o as n,c as d,W as Ke,z as T,a0 as l,_ as o,u as s,M as y,Z as c,Y as m,ab as N,a as k,a2 as f,$ as U,a4 as et,a1 as V,a3 as tt}from"./@vue-0.0.0-dataease.js";import{v as X,i as at}from"./visual-star-0.0.0-dataease.js";import{i as ot}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{S as nt,i as lt,a as rt}from"./ShareGrid-0.0.0-dataease.js";import{i as K}from"./icon_dashboard_outlined-0.0.0-dataease.js";import{i as ee}from"./icon_operation-analysis_outlined-0.0.0-dataease.js";import{d as te}from"./dv-dashboard-spine-mobile-0.0.0-dataease.js";import{i as ae}from"./icon_pc_outlined-0.0.0-dataease.js";import{G as st}from"./GridTable-0.0.0-dataease.js";import{b as oe}from"./vue-router-0.0.0-dataease.js";import{d as it}from"./dayjs-0.0.0-dataease.js";import{s as L}from"./ShortcutOption-0.0.0-dataease.js";import{i as ct}from"./interactive-0.0.0-dataease.js";import{f as ne}from"./dataVisualization-0.0.0-dataease.js";import{a as dt,b as pt}from"./index-0.0.0-dataease.js";import ut from"./ShareHandler-0.0.0-dataease.js";import{useAppStoreWithOut as mt}from"./app-0.0.0-dataease.js";import{u as _t}from"./share-0.0.0-dataease.js";import{e as ft}from"./lodash-es-0.0.0-dataease.js";import{_ as vt}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./EmptyBackground-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./de-copy-0.0.0-dataease.js";import"./icon_refresh_outlined-0.0.0-dataease.js";import"./icon_edit_outlined-0.0.0-dataease.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./icon_done_outlined-0.0.0-dataease.js";import"./ShareTicket-0.0.0-dataease.js";import"./dv-info-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./vue-clipboard3-0.0.0-dataease.js";import"./clipboard-0.0.0-dataease.js";import"./TicketEdit-0.0.0-dataease.js";import"./CustomLinkPwd-0.0.0-dataease.js";import"./TicketDialog-0.0.0-dataease.js";const bt={class:"custom-tabs-label"},ht={key:1},yt={key:2,class:"panel-table"},kt={class:"ellipsis",style:{"max-width":"250px"}},wt={key:0},gt={key:1},Ct={key:2},St={key:3},xt={style:{display:"flex","flex-direction":"row","align-items":"center"}},Dt=qe({__name:"ShortcutTable",props:{expand:{type:Boolean,default:!1}},setup(le){const re=Pe(),{resolve:F}=oe(),{t:r}=Re(),se=ct(),{wsCache:$}=dt(),ie=mt(),ce=pt(),de=_t(),{push:A}=oe(),B=$.get("app.desktop"),w=u(),i=u("recent"),x=u("all_types"),b=He({tableData:[],curTypeList:[],tableColumn:[]}),G=M(()=>se.getData),E=M(()=>de.getShareDisable||B),O={panel:K,panelMobile:te,dashboard:K,dashboardMobile:te,screen:ee,dataV:ee,dataset:lt,datasource:rt},j=t=>t&&["dashboard","panel","dataV","screen"].includes(t.type),Z=t=>{(t.paneName==="recent"||t.paneName==="store")&&(S.value=!0,L.setBusiFlag(t.paneName),b.curTypeList=L.getBusiList().filter(a=>a==="all_types"||D.includes(a)),b.tableColumn=L.getColmunList(),g())},pe=()=>{const t=["panel","screen","dataset","datasource"],a=[];for(const p in G.value)G.value[p].menuAuth&&a.push(t[parseInt(p)]);return I.value[0].disabled=!(a!=null&&a.length),I.value[1].disabled=!a.includes("panel")&&!a.includes("screen"),a},ue=()=>{g()},me=$.get("open-backend")==="1"?"_self":"_blank",_e=t=>{const a=F({path:"/preview",query:{dvId:t}});window.open(a.href,"_blank")},fe=t=>{const a=F({path:"/dataset-form",query:{id:t}});window.open(a.href,me)},ve=(t,a,p)=>it(new Date(p)).format("YYYY-MM-DD HH:mm:ss"),be={screen:r("work_branch.big_data_screen"),dataV:r("work_branch.big_data_screen"),dashboard:r("work_branch.dashboard"),panel:r("work_branch.dashboard"),dataset:r("work_branch.data_set"),datasource:r("work_branch.data_source")},g=()=>{S.value=!0;const t=x.value==="all_types"?"":x.value;L.loadData({type:t,keyword:w.value,asc:!W.value}).then(a=>{b.tableData=a.data}).finally(()=>{R.value=Se(),q.value=xe(),S.value=!1})},I=u([{title:r("work_branch.recently_used"),name:"recent",disabled:!1},{title:r("work_branch.my_collection"),name:"store",disabled:!1},{title:r("visualization.share_out"),name:"share",disabled:!1}]),z=u([]),he=t=>{z.value.push(t)},D=pe(),C=M(()=>{const t=ft(D.length?I.value:[]);for(const a of z.value)t.push(a);return t}),P=u(!1);Qe(()=>C.value.length,()=>{C.value.length>0&&!P.value&&(P.value=!0,i.value=C.value[0].name)}),Je(()=>{D.length&&Z({paneName:"recent",uid:0,slots:void 0,props:void 0,active:!1,index:"",isClosable:!1})});const W=u(!0),S=u(!1),ye=t=>{W.value=!0;const a=t.order.substring(0,t.order.indexOf("ending"));W.value=a==="desc",g()},ke=t=>{if(t){const a=i.value==="recent"?t.id:t.resourceId;if(["dashboard","panel"].includes(t.type))window.open("#/panel/index?dvId="+a,"_self");else if(["dataV","screen"].includes(t.type))window.open("#/screen/index?dvId="+a,"_self");else if(["dataset"].includes(t.type)){const p=ce.getToken&&ie.getIsIframe?"dataset-embedded":"dataset";A({name:p,params:{id:a}})}else["datasource"].includes(t.type)&&A({name:"datasource",params:{id:a}})}},we=t=>{S.value=t},ge=t=>{const a={id:t.id,type:t.type};ne(a).then(()=>{t.favorite=!t.favorite})},Ce=t=>{const a={id:t.resourceId,type:t.type==="dataV"?"screen":"panel"};ne(a).then(()=>{g()})},R=u(),q=u(""),Se=()=>w.value?"tree":"noneWhite",xe=()=>w.value?r("work_branch.relevant_content_found"):i.value==="recent"?r("work_branch.no_content_yet"):i.value==="store"?r("work_branch.no_favorites_yet"):"";return(t,a)=>{const p=$e,De=Ae,Te=Ne,Ve=Be,Le=Ge,H=Oe,h=J,v=je,Ee=Ze,Ie=Ue,We=J,Y=ze,Ye=Fe,Me=Xe("loading");return n(),d(y,null,[C.value.length?Ke((n(),d("div",{key:0,class:T(["dashboard-type",le.expand&&"expand"])},[l(Te,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),class:"dashboard-type-tabs",onTabClick:Z},{default:o(()=>[(n(!0),d(y,null,N(C.value.filter(e=>!E.value||e.name!=="share"),e=>(n(),c(De,{key:e.name,disabled:e.disabled,label:e.title,name:e.name},{label:o(()=>[k("span",bt,[e.disabled?(n(),c(p,{key:0,placement:"top",content:s(r)("work_branch.permission_denied")},{default:o(()=>[k("span",null,f(e.title),1)]),_:2},1032,["content"])):(n(),d("span",ht,f(e.title),1))])]),_:2},1032,["disabled","label","name"]))),128))]),_:1},8,["modelValue"]),s(D).length?(n(),d(y,{key:0},[E.value?m("",!0):(n(),c(nt,{key:0,"active-name":i.value,onSetLoading:we},null,8,["active-name"])),i.value==="recent"||i.value==="store"?(n(),c(Ie,{key:1},{default:o(()=>[l(H,{span:12},{default:o(()=>[l(Le,{"popper-class":"menu-panel-select_popper",class:"select-type-list",modelValue:x.value,"onUpdate:modelValue":a[1]||(a[1]=e=>x.value=e),onChange:g},{default:o(()=>[(n(!0),d(y,null,N(b.curTypeList,e=>(n(),c(Ve,{key:e,label:s(r)(`auth.${e}`),value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(H,{class:"search",span:12},{default:o(()=>[l(Ee,{modelValue:w.value,"onUpdate:modelValue":a[2]||(a[2]=e=>w.value=e),clearable:"",onChange:ue,placeholder:s(r)("work_branch.search_keyword")},{prefix:o(()=>[l(v,null,{default:o(()=>[l(h,{name:"icon_search-outline_outlined"},{default:o(()=>[l(s(ot),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1})):m("",!0),i.value==="recent"||i.value==="store"?(n(),d("div",yt,[l(st,{"show-pagination":!1,"table-data":b.tableData,onSortChange:ye,onCellClick:ke,"empty-desc":q.value,"empty-img":R.value,class:"workbranch-grid"},{default:o(()=>[l(Y,{key:"name",width:"280",prop:"name",label:s(r)("common.name")},{default:o(e=>[k("div",{class:T(["name-content",{"jump-active":j(e.row)}])},[e.row.extFlag?(n(),c(v,{key:0,style:{"margin-right":"12px","font-size":"18px"}},{default:o(()=>[l(h,null,{default:o(()=>[(n(),c(U(O[e.row.type+"Mobile"]),{class:"svg-icon"}))]),_:2},1024)]),_:2},1024)):(n(),c(v,{key:1,class:T(`main-color color-${e.row.type}`)},{default:o(()=>[l(h,null,{default:o(()=>[(n(),c(U(O[e.row.type]),{class:"svg-icon"}))]),_:2},1024)]),_:2},1032,["class"])),l(p,{placement:"top"},{content:o(()=>[et(f(e.row.name),1)]),default:o(()=>[k("span",kt,f(e.row.name),1)]),_:2},1024),i.value==="recent"&&["screen","panel"].includes(e.row.type)?(n(),c(v,{key:2,class:"custom-icon",onClick:V(_=>ge(e.row),["stop"]),style:tt({color:e.row.favorite?"#FFC60A":"#646A73"})},{default:o(()=>[l(We,null,{default:o(()=>[(n(),c(U(e.row.favorite?s(X):s(at))))]),_:2},1024)]),_:2},1032,["onClick","style"])):m("",!0)],2)]),_:1},8,["label"]),(n(!0),d(y,null,N(b.tableColumn,e=>(n(),c(Y,{key:e.label,prop:e.field,"show-overflow-tooltip":"",sortable:e.type==="time",label:e.label},{default:o(_=>[k("span",{class:T({"jump-active":j(_.row)})},[e.type&&e.type==="time"?(n(),d("span",wt,f(ve(null,null,_.row[e.field])),1)):e.field&&e.field==="type"?(n(),d("span",gt,f(be[_.row[e.field]]),1)):s(B)&&e.field&&e.field.endsWith("tor")?(n(),d("span",Ct,f(s(re).getName),1)):(n(),d("span",St,f(_.row[e.field]),1))],2)]),_:2},1032,["prop","sortable","label"]))),128)),l(Y,{width:"100",fixed:"right",key:"_operation",label:t.$t("common.operate")},{default:o(e=>[k("div",xt,[["dashboard","dataV","panel","screen"].includes(e.row.type)?(n(),d(y,{key:0},[l(p,{effect:"dark",content:s(r)("work_branch.new_page_preview"),placement:"top"},{default:o(()=>[l(v,{class:"hover-icon hover-icon-in-table",onClick:V(_=>_e(i.value==="recent"?e.row.id:e.row.resourceId),["stop"])},{default:o(()=>[l(h,{name:"icon_pc_outlined"},{default:o(()=>[l(s(ae),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["content"]),E.value?m("",!0):(n(),c(ut,{key:0,"in-grid":!0,weight:e.row.weight,"resource-id":i.value==="recent"?e.row.id:e.row.resourceId,"resource-type":e.row.type},null,8,["weight","resource-id","resource-type"])),i.value==="store"?(n(),c(p,{key:1,effect:"dark",content:s(r)("work_branch.cancel_favorites"),placement:"top"},{default:o(()=>[l(v,{class:"hover-icon hover-icon-in-table",onClick:V(_=>Ce(e.row),["stop"])},{default:o(()=>[l(h,{name:"icon_cancel_store"},{default:o(()=>[l(s(X),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["content"])):m("",!0)],64)):m("",!0),["dataset"].includes(e.row.type)?(n(),c(p,{key:1,effect:"dark",content:s(r)("work_branch.open_dataset"),placement:"top"},{default:o(()=>[l(v,{class:"hover-icon hover-icon-in-table",onClick:V(_=>fe(i.value==="recent"?e.row.id:e.row.resourceId),["stop"])},{default:o(()=>[l(h,{name:"icon_pc_outlined"},{default:o(()=>[l(s(ae),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["content"])):m("",!0)])]),_:1},8,["label"])]),_:1},8,["table-data","empty-desc","empty-img"])])):m("",!0)],64)):m("",!0),i.value==="data-filling"?(n(),c(s(Q),{key:1,jsname:"L21lbnUvZGF0YS9kYXRhLWZpbGxpbmcvZmlsbC9UYWJQYW5lVGFibGU="})):m("",!0)],2)),[[Me,S.value]]):(n(),c(Ye,{key:1,class:"dashboard-type",description:s(r)("work_branch.administrator_for_authorization")},null,8,["description"])),l(s(Q),{jsname:"L21lbnUvZGF0YS9kYXRhLWZpbGxpbmcvZmlsbC9UYWJQYW5l",onLoaded:he})],64)}}});const ro=vt(Dt,[["__scopeId","data-v-36fe6973"]]);export{ro as default};

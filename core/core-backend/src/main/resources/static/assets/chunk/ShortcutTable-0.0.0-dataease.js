import{a as Ne,b as Ue}from"./index-0.0.0-dataease.js";import{E as Ge}from"./el-empty-0.0.0-dataease.js";import{a as Fe}from"./el-table-column-0.0.0-dataease.js";import"./el-checkbox-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{a as Ae,o as $e,v as J,n as Q,j as je,G as Be}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{E as Oe}from"./el-row-0.0.0-dataease.js";import{E as Ze}from"./el-col-0.0.0-dataease.js";import{E as Pe,a as ze}from"./el-select-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{a as Re,E as qe}from"./el-tabs-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import{d as He,r as p,Z as Je,G as M,w as Qe,o as Xe,aa as Ke,f as n,L as d,T as et,U as E,k as l,i as o,j as r,Y as y,g as c,a0 as m,a7 as X,a9 as N,M as k,a6 as f,m as U,a5 as tt,ab as T,V as at}from"./vue-0.0.0-dataease.js";import{v as K,i as ot}from"./visual-star-0.0.0-dataease.js";import{i as nt}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{S as lt,i as st,a as rt}from"./ShareGrid-0.0.0-dataease.js";import{i as ee}from"./icon_dashboard_outlined-0.0.0-dataease.js";import{i as te}from"./icon_operation-analysis_outlined-0.0.0-dataease.js";import{d as ae}from"./dv-dashboard-spine-mobile-0.0.0-dataease.js";import{i as oe}from"./icon_pc_outlined-0.0.0-dataease.js";import{G as it}from"./GridTable-0.0.0-dataease.js";import{d as ct}from"./dayjs.min-0.0.0-dataease.js";import{s as V}from"./ShortcutOption-0.0.0-dataease.js";import{i as dt}from"./interactive-0.0.0-dataease.js";import{f as ne}from"./dataVisualization-0.0.0-dataease.js";import ut from"./ShareHandler-0.0.0-dataease.js";import{useAppStoreWithOut as pt}from"./app-0.0.0-dataease.js";import{u as mt}from"./share-0.0.0-dataease.js";import{d as _t}from"./lodash-0.0.0-dataease.js";import{E as ft}from"./index-0.0.0-dataease3.js";import{_ as vt}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./index-0.0.0-dataease16.js";import"./strings-0.0.0-dataease.js";import"./el-pagination-0.0.0-dataease.js";import"./EmptyBackground-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./el-dialog-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./el-date-picker-0.0.0-dataease.js";import"./arrays-0.0.0-dataease.js";import"./index-0.0.0-dataease17.js";import"./el-switch-0.0.0-dataease.js";import"./de-copy-0.0.0-dataease.js";import"./icon_refresh_outlined-0.0.0-dataease.js";import"./icon_edit_outlined-0.0.0-dataease.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./icon_done_outlined-0.0.0-dataease.js";import"./ShareTicket-0.0.0-dataease.js";import"./dv-info-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./index-0.0.0-dataease18.js";import"./TicketEdit-0.0.0-dataease.js";import"./el-drawer-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-form-item-0.0.0-dataease.js";import"./el-input-number-0.0.0-dataease.js";import"./CustomLinkPwd-0.0.0-dataease.js";import"./TicketDialog-0.0.0-dataease.js";const bt={class:"custom-tabs-label"},ht={key:1},yt={key:2,class:"panel-table"},kt={class:"ellipsis",style:{"max-width":"250px"}},wt={key:0},gt={key:1},Ct={key:2},St={key:3},xt={style:{display:"flex","flex-direction":"row","align-items":"center"}},Dt=He({__name:"ShortcutTable",props:{expand:{type:Boolean,default:!1}},setup(le){const se=Ae(),{resolve:G}=X(),{t:s}=$e(),re=dt(),{wsCache:F}=Ne(),ie=pt(),ce=Ue(),de=mt(),{push:A}=X(),$=F.get("app.desktop"),w=p(),i=p("recent"),x=p("all_types"),b=Je({tableData:[],curTypeList:[],tableColumn:[]}),j=M(()=>re.getData),L=M(()=>de.getShareDisable||$),B={panel:ee,panelMobile:ae,dashboard:ee,dashboardMobile:ae,screen:te,dataV:te,dataset:st,datasource:rt},O=t=>t&&["dashboard","panel","dataV","screen"].includes(t.type),Z=t=>{(t.paneName==="recent"||t.paneName==="store")&&(S.value=!0,V.setBusiFlag(t.paneName),b.curTypeList=V.getBusiList().filter(a=>a==="all_types"||D.includes(a)),b.tableColumn=V.getColmunList(),g())},ue=()=>{const t=["panel","screen","dataset","datasource"],a=[];for(const u in j.value)j.value[u].menuAuth&&a.push(t[parseInt(u)]);return I.value[0].disabled=!(a!=null&&a.length),I.value[1].disabled=!a.includes("panel")&&!a.includes("screen"),a},pe=()=>{g()},me=F.get("open-backend")==="1"?"_self":"_blank",_e=t=>{const a=G({path:"/preview",query:{dvId:t}});window.open(a.href,"_blank")},fe=t=>{const a=G({path:"/dataset-form",query:{id:t}});window.open(a.href,me)},ve=(t,a,u)=>ct(new Date(u)).format("YYYY-MM-DD HH:mm:ss"),be={screen:s("work_branch.big_data_screen"),dataV:s("work_branch.big_data_screen"),dashboard:s("work_branch.dashboard"),panel:s("work_branch.dashboard"),dataset:s("work_branch.data_set"),datasource:s("work_branch.data_source")},g=()=>{S.value=!0;const t=x.value==="all_types"?"":x.value;V.loadData({type:t,keyword:w.value,asc:!W.value}).then(a=>{b.tableData=a.data}).finally(()=>{R.value=Se(),q.value=xe(),S.value=!1})},I=p([{title:s("work_branch.recently_used"),name:"recent",disabled:!1},{title:s("work_branch.my_collection"),name:"store",disabled:!1},{title:s("visualization.share_out"),name:"share",disabled:!1}]),P=p([]),he=t=>{P.value.push(t)},D=ue(),C=M(()=>{const t=_t(D.length?I.value:[]);for(const a of P.value)t.push(a);return t}),z=p(!1);Qe(()=>C.value.length,()=>{C.value.length>0&&!z.value&&(z.value=!0,i.value=C.value[0].name)}),Xe(()=>{D.length&&Z({paneName:"recent",uid:0,slots:void 0,props:void 0,active:!1,index:"",isClosable:!1})});const W=p(!0),S=p(!1),ye=t=>{W.value=!0;const a=t.order.substring(0,t.order.indexOf("ending"));W.value=a==="desc",g()},ke=t=>{if(t){const a=i.value==="recent"?t.id:t.resourceId;if(["dashboard","panel"].includes(t.type))window.open("#/panel/index?dvId="+a,"_self");else if(["dataV","screen"].includes(t.type))window.open("#/screen/index?dvId="+a,"_self");else if(["dataset"].includes(t.type)){const u=ce.getToken&&ie.getIsIframe?"dataset-embedded":"dataset";A({name:u,params:{id:a}})}else["datasource"].includes(t.type)&&A({name:"datasource",params:{id:a}})}},we=t=>{S.value=t},ge=t=>{const a={id:t.id,type:t.type};ne(a).then(()=>{t.favorite=!t.favorite})},Ce=t=>{const a={id:t.resourceId,type:t.type==="dataV"?"screen":"panel"};ne(a).then(()=>{g()})},R=p(),q=p(""),Se=()=>w.value?"tree":"noneWhite",xe=()=>w.value?s("work_branch.relevant_content_found"):i.value==="recent"?s("work_branch.no_content_yet"):i.value==="store"?s("work_branch.no_favorites_yet"):"";return(t,a)=>{const u=ft,De=qe,Ee=Re,Te=Pe,Ve=ze,H=Ze,h=Q,v=je,Le=Be,Ie=Oe,We=Q,Y=Fe,Ye=Ge,Me=Ke("loading");return n(),d(y,null,[C.value.length?et((n(),d("div",{key:0,class:E(["dashboard-type",le.expand&&"expand"])},[l(Ee,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),class:"dashboard-type-tabs",onTabClick:Z},{default:o(()=>[(n(!0),d(y,null,N(C.value.filter(e=>!L.value||e.name!=="share"),e=>(n(),c(De,{key:e.name,disabled:e.disabled,label:e.title,name:e.name},{label:o(()=>[k("span",bt,[e.disabled?(n(),c(u,{key:0,placement:"top",content:r(s)("work_branch.permission_denied")},{default:o(()=>[k("span",null,f(e.title),1)]),_:2},1032,["content"])):(n(),d("span",ht,f(e.title),1))])]),_:2},1032,["disabled","label","name"]))),128))]),_:1},8,["modelValue"]),r(D).length?(n(),d(y,{key:0},[L.value?m("",!0):(n(),c(lt,{key:0,"active-name":i.value,onSetLoading:we},null,8,["active-name"])),i.value==="recent"||i.value==="store"?(n(),c(Ie,{key:1},{default:o(()=>[l(H,{span:12},{default:o(()=>[l(Ve,{"popper-class":"menu-panel-select_popper",class:"select-type-list",modelValue:x.value,"onUpdate:modelValue":a[1]||(a[1]=e=>x.value=e),onChange:g},{default:o(()=>[(n(!0),d(y,null,N(b.curTypeList,e=>(n(),c(Te,{key:e,label:r(s)(`auth.${e}`),value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(H,{class:"search",span:12},{default:o(()=>[l(Le,{modelValue:w.value,"onUpdate:modelValue":a[2]||(a[2]=e=>w.value=e),clearable:"",onChange:pe,placeholder:r(s)("work_branch.search_keyword")},{prefix:o(()=>[l(v,null,{default:o(()=>[l(h,{name:"icon_search-outline_outlined"},{default:o(()=>[l(r(nt),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1})):m("",!0),i.value==="recent"||i.value==="store"?(n(),d("div",yt,[l(it,{"show-pagination":!1,"table-data":b.tableData,onSortChange:ye,onCellClick:ke,"empty-desc":q.value,"empty-img":R.value,class:"workbranch-grid"},{default:o(()=>[l(Y,{key:"name",width:"280",prop:"name",label:r(s)("common.name")},{default:o(e=>[k("div",{class:E(["name-content",{"jump-active":O(e.row)}])},[e.row.extFlag?(n(),c(v,{key:0,style:{"margin-right":"12px","font-size":"18px"}},{default:o(()=>[l(h,null,{default:o(()=>[(n(),c(U(B[e.row.type+"Mobile"]),{class:"svg-icon"}))]),_:2},1024)]),_:2},1024)):(n(),c(v,{key:1,class:E(`main-color color-${e.row.type}`)},{default:o(()=>[l(h,null,{default:o(()=>[(n(),c(U(B[e.row.type]),{class:"svg-icon"}))]),_:2},1024)]),_:2},1032,["class"])),l(u,{placement:"top"},{content:o(()=>[tt(f(e.row.name),1)]),default:o(()=>[k("span",kt,f(e.row.name),1)]),_:2},1024),i.value==="recent"&&["screen","panel"].includes(e.row.type)?(n(),c(v,{key:2,class:"custom-icon",onClick:T(_=>ge(e.row),["stop"]),style:at({color:e.row.favorite?"#FFC60A":"#646A73"})},{default:o(()=>[l(We,null,{default:o(()=>[(n(),c(U(e.row.favorite?r(K):r(ot))))]),_:2},1024)]),_:2},1032,["onClick","style"])):m("",!0)],2)]),_:1},8,["label"]),(n(!0),d(y,null,N(b.tableColumn,e=>(n(),c(Y,{key:e.label,prop:e.field,"show-overflow-tooltip":"",sortable:e.type==="time",label:e.label},{default:o(_=>[k("span",{class:E({"jump-active":O(_.row)})},[e.type&&e.type==="time"?(n(),d("span",wt,f(ve(null,null,_.row[e.field])),1)):e.field&&e.field==="type"?(n(),d("span",gt,f(be[_.row[e.field]]),1)):r($)&&e.field&&e.field.endsWith("tor")?(n(),d("span",Ct,f(r(se).getName),1)):(n(),d("span",St,f(_.row[e.field]),1))],2)]),_:2},1032,["prop","sortable","label"]))),128)),l(Y,{width:"100",fixed:"right",key:"_operation",label:t.$t("common.operate")},{default:o(e=>[k("div",xt,[["dashboard","dataV","panel","screen"].includes(e.row.type)?(n(),d(y,{key:0},[l(u,{effect:"dark",content:r(s)("work_branch.new_page_preview"),placement:"top"},{default:o(()=>[l(v,{class:"hover-icon hover-icon-in-table",onClick:T(_=>_e(i.value==="recent"?e.row.id:e.row.resourceId),["stop"])},{default:o(()=>[l(h,{name:"icon_pc_outlined"},{default:o(()=>[l(r(oe),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["content"]),L.value?m("",!0):(n(),c(ut,{key:0,"in-grid":!0,weight:e.row.weight,"resource-id":i.value==="recent"?e.row.id:e.row.resourceId,"resource-type":e.row.type},null,8,["weight","resource-id","resource-type"])),i.value==="store"?(n(),c(u,{key:1,effect:"dark",content:r(s)("work_branch.cancel_favorites"),placement:"top"},{default:o(()=>[l(v,{class:"hover-icon hover-icon-in-table",onClick:T(_=>Ce(e.row),["stop"])},{default:o(()=>[l(h,{name:"icon_cancel_store"},{default:o(()=>[l(r(K),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["content"])):m("",!0)],64)):m("",!0),["dataset"].includes(e.row.type)?(n(),c(u,{key:1,effect:"dark",content:r(s)("work_branch.open_dataset"),placement:"top"},{default:o(()=>[l(v,{class:"hover-icon hover-icon-in-table",onClick:T(_=>fe(i.value==="recent"?e.row.id:e.row.resourceId),["stop"])},{default:o(()=>[l(h,{name:"icon_pc_outlined"},{default:o(()=>[l(r(oe),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["content"])):m("",!0)])]),_:1},8,["label"])]),_:1},8,["table-data","empty-desc","empty-img"])])):m("",!0)],64)):m("",!0),i.value==="data-filling"?(n(),c(r(J),{key:1,jsname:"L21lbnUvZGF0YS9kYXRhLWZpbGxpbmcvZmlsbC9UYWJQYW5lVGFibGU="})):m("",!0)],2)),[[Me,S.value]]):(n(),c(Ye,{key:1,class:"dashboard-type",description:r(s)("work_branch.administrator_for_authorization")},null,8,["description"])),l(r(J),{jsname:"L21lbnUvZGF0YS9kYXRhLWZpbGxpbmcvZmlsbC9UYWJQYW5l",onLoaded:he})],64)}}});const Ba=vt(Dt,[["__scopeId","data-v-36fe6973"]]);export{Ba as default};

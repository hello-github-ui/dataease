import"./index-0.0.0-dataease.js";import{o as k,y as V,G as u}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{E as F}from"./el-drawer-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import{a as d,E as U}from"./el-form-item-0.0.0-dataease.js";import{x as C}from"./dataVisualization-0.0.0-dataease.js";import{d as O}from"./dvMain-0.0.0-dataease.js";import{d as j,r as B,t as S,Z as G,f as L,g as M,i as n,j as e,M as b,k as t,a5 as x,a6 as y}from"./vue-0.0.0-dataease.js";import{_ as T}from"./_plugin-vue_export-helper-0.0.0-dataease.js";const J={class:"app-export"},R={class:"apply",style:{width:"100%"}},W=j({__name:"AppExportForm",props:{componentData:{type:Object,required:!0},canvasViewInfo:{type:Object,required:!0},dvInfo:{type:Object,required:!0}},emits:["closeDraw","downLoadApp"],setup(D,{expose:g,emit:q}){const{t:l}=k(),f=q,_=B(null);O();const E=D,{componentData:I,canvasViewInfo:v,dvInfo:w}=S(E),o=G({applyDownloadDrawer:!1,form:{appName:null,icon:null,version:null,creator:null,required:"2.8.0",description:null},rule:{appName:[{required:!0,min:2,max:25,message:l("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],creator:[{required:!0,min:2,max:25,message:l("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],required:[{required:!0,min:2,max:25,message:l("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],version:[{required:!0,min:2,max:25,message:l("datasource.input_limit_2_25",[2,25]),trigger:"blur"}]}}),A=s=>{o.applyDownloadDrawer=!0,o.form=s},N=()=>{f("closeDraw"),o.applyDownloadDrawer=!1},m=(s,a,r)=>{r.forEach(p=>{if(p.component==="UserView"&&v.value[p.id]){const i=v.value[p.id],{id:c,tableId:z}=i;s.push(c),a.push(z)}else p.component==="Group"?m(s,a,p.propValue):p.component==="DeTabs"&&p.propValue.forEach(i=>{m(s,a,i.componentData)})})},h=()=>{var s;(s=_.value)==null||s.validate(a=>{if(a){const r=[],p=[];m(r,p,I.value),C({dvId:w.value.id,viewIds:r,dsIds:p}).then(i=>{const c={...i.data,...o.form,visualizationInfo:JSON.stringify(w.value)};f("downLoadApp",c),o.applyDownloadDrawer=!1})}else return!1})};return g({init:A}),(s,a)=>(L(),M(e(F),{title:e(l)("visualization.app_export"),modelValue:o.applyDownloadDrawer,"onUpdate:modelValue":a[5]||(a[5]=r=>o.applyDownloadDrawer=r),"custom-class":"de-user-drawer",size:"600px",direction:"rtl"},{footer:n(()=>[b("div",R,[t(e(V),{secondary:"",onClick:N},{default:n(()=>[x(y(e(l)("commons.cancel")),1)]),_:1}),t(e(V),{type:"primary",onClick:h},{default:n(()=>[x(y(e(l)("chart.export")),1)]),_:1})])]),default:n(()=>[b("div",J,[t(e(U),{ref_key:"applyDownloadForm",ref:_,model:o.form,rules:o.rule,class:"de-form-item","label-width":"180px","label-position":"top"},{default:n(()=>[t(e(d),{label:e(l)("visualization.app_name"),prop:"appName"},{default:n(()=>[t(e(u),{modelValue:o.form.appName,"onUpdate:modelValue":a[0]||(a[0]=r=>o.form.appName=r),autocomplete:"off",placeholder:e(l)("common.input_name")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(e(d),{label:e(l)("visualization.app_version"),prop:"version"},{default:n(()=>[t(e(u),{modelValue:o.form.version,"onUpdate:modelValue":a[1]||(a[1]=r=>o.form.version=r),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),t(e(d),{label:e(l)("visualization.app_export"),prop:"required"},{default:n(()=>[t(e(u),{modelValue:o.form.required,"onUpdate:modelValue":a[2]||(a[2]=r=>o.form.required=r),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),t(e(d),{label:e(l)("visualization.creator"),prop:"creator"},{default:n(()=>[t(e(u),{modelValue:o.form.creator,"onUpdate:modelValue":a[3]||(a[3]=r=>o.form.creator=r),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),t(e(d),{label:e(l)("visualization.description"),prop:"description"},{default:n(()=>[t(e(u),{placeholder:e(l)("commons.input_content"),"show-word-limit":"",modelValue:o.form.description,"onUpdate:modelValue":a[4]||(a[4]=r=>o.form.description=r),type:"textarea"},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),_:1},8,["title","modelValue"]))}});const oe=T(W,[["__scopeId","data-v-411785b2"]]);export{oe as A};

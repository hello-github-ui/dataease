import{h as V,w as u,r as d,v as F,X as U}from"./element-plus-secondary-0.0.0-dataease.js";import{j as k}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{x as C}from"./dataVisualization-0.0.0-dataease.js";import{d as O}from"./dvMain-0.0.0-dataease.js";import{d as j,r as B,t as S,l as L,o as T,Z as G,_ as n,u as e,a as b,a0 as t,a4 as x,a2 as D}from"./@vue-0.0.0-dataease.js";import{_ as J}from"./_plugin-vue_export-helper-0.0.0-dataease.js";const M={class:"app-export"},R={class:"apply",style:{width:"100%"}},W=j({__name:"AppExportForm",props:{componentData:{type:Object,required:!0},canvasViewInfo:{type:Object,required:!0},dvInfo:{type:Object,required:!0}},emits:["closeDraw","downLoadApp"],setup(y,{expose:g,emit:q}){const{t:r}=k(),f=q,_=B(null);O();const E=y,{componentData:I,canvasViewInfo:v,dvInfo:w}=S(E),o=L({applyDownloadDrawer:!1,form:{appName:null,icon:null,version:null,creator:null,required:"2.8.0",description:null},rule:{appName:[{required:!0,min:2,max:25,message:r("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],creator:[{required:!0,min:2,max:25,message:r("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],required:[{required:!0,min:2,max:25,message:r("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],version:[{required:!0,min:2,max:25,message:r("datasource.input_limit_2_25",[2,25]),trigger:"blur"}]}}),h=s=>{o.applyDownloadDrawer=!0,o.form=s},A=()=>{f("closeDraw"),o.applyDownloadDrawer=!1},m=(s,a,l)=>{l.forEach(p=>{if(p.component==="UserView"&&v.value[p.id]){const i=v.value[p.id],{id:c,tableId:z}=i;s.push(c),a.push(z)}else p.component==="Group"?m(s,a,p.propValue):p.component==="DeTabs"&&p.propValue.forEach(i=>{m(s,a,i.componentData)})})},N=()=>{var s;(s=_.value)==null||s.validate(a=>{if(a){const l=[],p=[];m(l,p,I.value),C({dvId:w.value.id,viewIds:l,dsIds:p}).then(i=>{const c={...i.data,...o.form,visualizationInfo:JSON.stringify(w.value)};f("downLoadApp",c),o.applyDownloadDrawer=!1})}else return!1})};return g({init:h}),(s,a)=>(T(),G(e(U),{title:e(r)("visualization.app_export"),modelValue:o.applyDownloadDrawer,"onUpdate:modelValue":a[5]||(a[5]=l=>o.applyDownloadDrawer=l),"custom-class":"de-user-drawer",size:"600px",direction:"rtl"},{footer:n(()=>[b("div",R,[t(e(V),{secondary:"",onClick:A},{default:n(()=>[x(D(e(r)("commons.cancel")),1)]),_:1}),t(e(V),{type:"primary",onClick:N},{default:n(()=>[x(D(e(r)("chart.export")),1)]),_:1})])]),default:n(()=>[b("div",M,[t(e(F),{ref_key:"applyDownloadForm",ref:_,model:o.form,rules:o.rule,class:"de-form-item","label-width":"180px","label-position":"top"},{default:n(()=>[t(e(u),{label:e(r)("visualization.app_name"),prop:"appName"},{default:n(()=>[t(e(d),{modelValue:o.form.appName,"onUpdate:modelValue":a[0]||(a[0]=l=>o.form.appName=l),autocomplete:"off",placeholder:e(r)("common.input_name")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(e(u),{label:e(r)("visualization.app_version"),prop:"version"},{default:n(()=>[t(e(d),{modelValue:o.form.version,"onUpdate:modelValue":a[1]||(a[1]=l=>o.form.version=l),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),t(e(u),{label:e(r)("visualization.app_export"),prop:"required"},{default:n(()=>[t(e(d),{modelValue:o.form.required,"onUpdate:modelValue":a[2]||(a[2]=l=>o.form.required=l),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),t(e(u),{label:e(r)("visualization.creator"),prop:"creator"},{default:n(()=>[t(e(d),{modelValue:o.form.creator,"onUpdate:modelValue":a[3]||(a[3]=l=>o.form.creator=l),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),t(e(u),{label:e(r)("visualization.description"),prop:"description"},{default:n(()=>[t(e(d),{placeholder:e(r)("commons.input_content"),"show-word-limit":"",modelValue:o.form.description,"onUpdate:modelValue":a[4]||(a[4]=l=>o.form.description=l),type:"textarea"},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),_:1},8,["title","modelValue"]))}});const Y=J(W,[["__scopeId","data-v-411785b2"]]);export{Y as A};

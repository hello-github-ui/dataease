import{u as q,M as fe}from"./index-0.0.0-dataease.js";import{E as Ce}from"./el-row-0.0.0-dataease.js";import{o as he,j as ye,G as _e,n as Se}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{a as be}from"./el-form-item-0.0.0-dataease.js";import{i as ge}from"./icon_admin_outlined-0.0.0-dataease.js";import{E as Q}from"./el-radio-button-0.0.0-dataease.js";import"./el-input-number-0.0.0-dataease.js";import"./el-radio-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{E as ke}from"./el-popover-0.0.0-dataease.js";import{v as we,a as Ie}from"./chart-0.0.0-dataease.js";import Ve from"./GradientColorSelector-0.0.0-dataease.js";import{J as Ee,K as Fe}from"./util-0.0.0-dataease2.js";import{d as xe}from"./dvMain-0.0.0-dataease.js";import{d as Pe,ah as $e,r as P,Z as Ne,G as k,w as Be,o as Re,e as Ae,f as n,L as p,k as v,i as f,g as L,j as C,U as y,a0 as $,M as d,Y as N,a9 as G,V as B,a6 as T,a5 as Oe,af as Ge,n as ee}from"./vue-0.0.0-dataease.js";import{c as Me}from"./index-0.0.0-dataease19.js";import{d as oe}from"./lodash-0.0.0-dataease.js";import{_ as ze}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./index-0.0.0-dataease3.js";import"./position-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease17.js";import"./dropdown-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./el-tabs-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./app-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./antv-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./index-0.0.0-dataease20.js";import"./pureFunctionsAny.generated-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";const De={class:"custom-color-selector-container"},Le=["onClick","title"],Te={style:{float:"left"}},Ue={class:"cases-list__text"},We={key:0,class:"custom-color-extend-setting colors"},je=["onClick"],He={class:"inner-selector"},Je={key:1,class:"series-color-setting colors"},Ke=["id"],Xe=["onClick"],Ye=["id"],Ze=["title"],qe={class:"series-color-picker-wrapper"},Qe=Pe({__name:"CustomColorStyleSelect",props:{themes:{default:"light"},modelValue:{},propertyInner:{},chart:{},sub:{type:Boolean,default:!1}},emits:["update:modelValue","changeBasicStyle"],setup(re,{emit:te}){const{t:M}=he(),s=re,H=xe(),{batchOptStatus:J}=$e(H),K=te,le=()=>{g.value&&(l.value.basicStyleForm[b.value]="default",j({value:"default"}))},U=P(),a=Ne({seriesColor:[],curSeriesColor:{id:"",name:"",color:""},curColorIndex:0,seriesColorPickerId:"body"}),w=P(),_=k(()=>s.sub?"subColors":"colors"),b=k(()=>s.sub?"subColorScheme":"colorScheme"),I=k(()=>s.sub?"subSeriesColor":"seriesColor"),se=k(()=>{var e,o,r,i,u,m;return((r=(o=(e=w.value)==null?void 0:e.propertyInner)==null?void 0:o["basic-style-selector"])==null?void 0:r.includes("seriesColor"))||((m=(u=(i=w.value)==null?void 0:i.propertyInner)==null?void 0:u["dual-basic-style-selector"])==null?void 0:m.includes("seriesColor"))}),ae=k(()=>{var e,o,r;return(r=(o=(e=w.value)==null?void 0:e.propertyInner)==null?void 0:o["dual-basic-style-selector"])==null?void 0:r.includes("subSeriesColor")}),R=()=>{var u,m,S,F,x,t;if(J.value||!s.chart)return;if(w.value=Me.getChartView(s.chart.render,s.chart.type),s.sub){if(!ae.value)return}else if(!se.value)return;let e=H.getViewOriginData(s.chart.id);if(!e||(s.chart.type.includes("chart-mix")&&(s.sub?e=(m=(u=e.right)==null?void 0:u.data)==null?void 0:m[0]:e=(F=(S=e.left)==null?void 0:S.data)==null?void 0:F[0]),!e))return;const o=s.sub?(x=w.value)==null?void 0:x.setupSubSeriesColor:w.value.setupSeriesColor;if(!o)return;const r=o(s.chart,e.data),i=((t=s.chart.customAttr.basicStyle[I.value])==null?void 0:t.reduce((c,h)=>(c[h.id]=h,c),{}))||{};r==null||r.forEach(c=>{const h=i[c.id];h&&(c.color=h.color)}),a.seriesColor.splice(0,a.seriesColor.length,...r),a.seriesColor.length&&(a.curColorIndex>a.seriesColor.length-1&&(a.curColorIndex=0),a.curSeriesColor=a.seriesColor[a.curColorIndex],ee(()=>{var c;(c=W.value)==null||c.hide(),a.seriesColorPickerId=`#seriesr-picker-slot-${s.sub?1:0}`}))},ce=(e,o)=>{var i;(i=U.value)==null||i.hide(),a.curSeriesColor=oe(e),a.curColorIndex=o;const r=`series-color-picker-${s.sub?1:0}-${o}`;a.seriesColorPickerId=`#${r}`,ee(()=>{var m;document.getElementById(r)&&((m=U.value)==null||m.show())})},ie=()=>{let e=!1;a.seriesColor.forEach(o=>{o.id===a.curSeriesColor.id&&o.color!==a.curSeriesColor.color&&(e=!0,o.color=a.curSeriesColor.color)}),e&&(l.value.basicStyleForm[I.value]=oe(a.seriesColor),V(I.value))};Be([()=>s.chart,()=>{var e;return(e=s.chart)==null?void 0:e.type},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.calcTopN},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.topN},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.topNLabel}],R,{deep:!1}),Re(()=>{q({name:"chart-type-change",callback:le}),q({name:"chart-data-change",callback:R}),R()});const l=k({get(){return s.modelValue},set(e){K("update:modelValue",e)}}),A=we,X=Ie,O=P(!1),Y=P(),W=P();function Z(e){var o;l.value.basicStyleForm[b.value]=e.value,V(b.value),(o=Y.value)==null||o.hide(),j(e)}const j=e=>{var u,m;const i=(((u=e==null?void 0:e.value)==null?void 0:u.endsWith("_split_gradient"))||g.value?Ee(A):A).filter(S=>S.value===l.value.basicStyleForm[b.value]);i.length>0&&(l.value.basicStyleForm[_.value]=[...i[0].colors],l.value.customColor=l.value.basicStyleForm[_.value][0],l.value.colorIndex=0,(m=l.value.basicStyleForm[I.value])==null||m.forEach((S,F)=>{const x=i[0].colors.length;S.color=i[0].colors[F%x]}),V(),R())},ne=()=>{var r;const{type:e}=s.chart,{basicStyleForm:o}=l.value;if(e.includes("map"))j();else{o[I.value]=[],V(I.value);const i=o[b.value];o[_.value]=((r=A.find(u=>u.value===i))==null?void 0:r.colors)??A[0].colors,V(_.value),R()}},ue=()=>{const{colorIndex:e,customColor:o,basicStyleForm:r}=l.value,i=r[_.value];if(g.value){let u=e===0?o:i[0],m=e===0?i[8]:o;r[_.value]=Fe(u,m,9,1)}else i[e]=o;V()},g=k(()=>l.value.basicStyleForm[b.value].endsWith("_split_gradient")),z=e=>e===0||e===l.value.basicStyleForm[_.value].length-1,me=(e,o)=>{var r;g.value&&!z(e)||(l.value.colorIndex=e,l.value.customColor=o,(r=W.value)==null||r.show())};function V(e=_.value){K("changeBasicStyle",e)}const D=P(!1);function de(){D.value=!0}function pe(){D.value=!1}const E=e=>{var o;return(o=s.propertyInner)==null?void 0:o.includes(e)},ve=(e,o)=>{const r=o.colorIndex===e;return g.value?z(e)?r?"var(--ed-color-primary)":"rgb(230,230,230)":"rgb(230,230,230,0.01)":r?"var(--ed-color-primary)":""};return(e,o)=>{const r=be,i=Ae("ArrowDown"),u=ye,m=_e,S=fe,F=Se,x=Ce;return n(),p("div",{style:B([{width:"100%"},{"margin-bottom":O.value?"16px":0}])},[v(x,null,{default:f(()=>[E("gradient-color")?(n(),L(r,{key:0,label:C(M)("chart.color_case"),class:y(["form-item","form-item-"+e.themes]),style:{flex:"1","padding-right":"8px","margin-bottom":"16px"}},{default:f(()=>[v(Ve,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=t=>l.value=t),themes:e.themes,onSelectColorCase:Z},null,8,["modelValue","themes"])]),_:1},8,["label","class"])):$("",!0),E("gradient-color")?$("",!0):(n(),L(r,{key:1,label:C(M)("chart.color_case"),class:y(["form-item","form-item-"+e.themes]),style:{flex:"1","padding-right":"8px","margin-bottom":"16px"}},{default:f(()=>[v(C(ke),{placement:"bottom-start",ref_key:"colorCaseSelectorRef",ref:Y,width:"268",offset:4,trigger:"click",persistent:!1,"show-arrow":!1,onShow:de,onHide:pe,"popper-style":{padding:0},effect:e.themes},{reference:f(()=>[v(m,{effect:e.themes,readonly:"",class:"custom-color-selector"},{prefix:f(()=>[d("div",De,[(n(!0),p(N,null,G(l.value.basicStyleForm[_.value],(t,c)=>(n(),p("div",{key:c,style:B({flex:1,height:"100%",backgroundColor:t})},null,4))),128))])]),suffix:f(()=>[v(u,{class:y(["input-arrow-icon",{reverse:D.value}])},{default:f(()=>[v(i)]),_:1},8,["class"])]),_:1},8,["effect"])]),default:f(()=>[v(S,{"max-height":"274px",class:y(["cases-list",{dark:e.themes==="dark"}])},{default:f(()=>[(n(!0),p(N,null,G(C(A),t=>(n(),p("div",{key:t.value,class:y(["select-color-item",{active:l.value.basicStyleForm[b.value]===t.value}]),onClick:c=>Z(t),title:t.name},[d("div",Te,[(n(!0),p(N,null,G(t.colors,(c,h)=>(n(),p("span",{key:h,style:B({width:"20px",height:"20px",float:"left",backgroundColor:c})},null,4))),128))]),d("span",Ue,T(t.name),1)],10,Le))),128))]),_:1},8,["class"])]),_:1},8,["effect"])]),_:1},8,["label","class"])),d("div",null,[d("div",{class:y(["custom-color-setting-btn",{active:O.value,dark:e.themes==="dark"}]),onClick:o[1]||(o[1]=t=>O.value=!O.value)},[v(u,{style:{"font-size":"12px"}},{default:f(()=>[v(F,{name:"icon_admin_outlined"},{default:f(()=>[v(C(ge),{class:"svg-icon"})]),_:1})]),_:1})],2)])]),_:1}),O.value?(n(),p(N,{key:0},[d("div",{class:y(["custom-color-extend-setting",{dark:e.themes==="dark"}])},[Oe(T(C(M)("chart.custom_case"))+" ",1),d("span",{style:{color:"var(--ed-color-primary)",cursor:"pointer"},onClick:ne},T(C(M)("chart.reset")),1)],2),!e.sub&&E("seriesColor")||e.sub&&E("subSeriesColor")?$("",!0):(n(),p("div",We,[(n(!0),p(N,null,G(l.value.basicStyleForm[_.value],(t,c)=>(n(),p("div",{key:c,class:y([{active:l.value.colorIndex===c,hover:g.value?z(c):!0},"color-item"]),style:B({"border-color":ve(c,l.value)}),onClick:h=>me(c,t)},[d("div",{class:"color-item__inner",style:B({backgroundColor:t})},[g.value&&z(c)?(n(),L(u,{key:0,class:y(["input-arrow-icon",{reverse:D.value}]),style:{color:"white","font-size":"x-small",left:"2px",bottom:"2px"}},{default:f(()=>[v(i)]),_:1},8,["class"])):$("",!0)],4)],14,je))),128)),d("div",He,[v(C(Q),{ref_key:"customColorPickerRef",ref:W,modelValue:l.value.customColor,"onUpdate:modelValue":o[2]||(o[2]=t=>l.value.customColor=t),size:"small",predefine:C(X),onChange:ue},null,8,["modelValue","predefine"])])])),(!e.sub&&E("seriesColor")||e.sub&&E("subSeriesColor"))&&!C(J)?(n(),p("div",Je,[d("div",{id:`seriesr-picker-slot-${e.sub?1:0}`,style:{overflow:"hidden",transform:"translateX(0)"}},null,8,Ke),(n(!0),p(N,null,G(a.seriesColor,(t,c)=>{var h;return n(),p("div",{key:t.id,class:"color-list-item"},[d("div",{class:y([{active:t.id===((h=a.curSeriesColor)==null?void 0:h.id)},"color-item"]),onClick:eo=>ce(t,c)},[d("div",{class:"color-item__inner",style:B({backgroundColor:t.color})},null,4)],10,Xe),d("div",{id:`series-color-picker-${e.sub?1:0}-${c}`},null,8,Ye),d("span",{class:y(["color-item-name",e.themes==="dark"?"dark":""]),title:t.name},T(t.name),11,Ze)])}),128))])):$("",!0)],64)):$("",!0),(n(),L(Ge,{defer:"",to:a.seriesColorPickerId},[d("div",qe,[v(C(Q),{ref_key:"seriesColorPickerRef",ref:U,modelValue:a.curSeriesColor.color,"onUpdate:modelValue":o[3]||(o[3]=t=>a.curSeriesColor.color=t),size:"small","popper-class":"series-color-picker",teleported:!1,predefine:C(X),onChange:ie},null,8,["modelValue","predefine"])])],8,["to"]))],4)}}});const Xo=ze(Qe,[["__scopeId","data-v-6ea9b615"]]);export{Xo as default};

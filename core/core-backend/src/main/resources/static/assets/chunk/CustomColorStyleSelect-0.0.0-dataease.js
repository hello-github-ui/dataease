import{f as fe,M as q,w as Ce,d as he,r as _e,a as ye,o as be}from"./element-plus-secondary-0.0.0-dataease.js";import{j as Se,h as ge}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as ke}from"./icon_admin_outlined-0.0.0-dataease.js";import{x as we,a as Ie}from"./chart-0.0.0-dataease.js";import Ve from"./GradientColorSelector-0.0.0-dataease.js";import{J as xe,K as Fe}from"./util-0.0.0-dataease2.js";import{u as Q}from"./index-0.0.0-dataease.js";import{d as Ee}from"./dvMain-0.0.0-dataease.js";import{s as Pe}from"./pinia-0.0.0-dataease.js";import{c as $e}from"./index-0.0.0-dataease12.js";import{e as ee}from"./lodash-es-0.0.0-dataease.js";import{d as Ne,r as P,l as Be,k,w as Re,b as Ae,ah as Oe,o as n,c as d,a0 as v,_ as f,Z as G,u as C,z as _,Y as $,a as p,M as N,ab as z,a3 as B,a2 as L,a4 as ze,aa as Me,n as oe}from"./@vue-0.0.0-dataease.js";import{_ as De}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./vue-router-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./app-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./mathjs-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./exceljs-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";const Te={class:"custom-color-selector-container"},Ge=["onClick","title"],Le={style:{float:"left"}},Ue={class:"cases-list__text"},We={key:0,class:"custom-color-extend-setting colors"},He=["onClick"],je={class:"inner-selector"},Je={key:1,class:"series-color-setting colors"},Ke=["id"],Xe=["onClick"],Ye=["id"],Ze=["title"],qe={class:"series-color-picker-wrapper"},Qe=Ne({__name:"CustomColorStyleSelect",props:{themes:{default:"light"},modelValue:{},propertyInner:{},chart:{},sub:{type:Boolean,default:!1}},emits:["update:modelValue","changeBasicStyle"],setup(re,{emit:te}){const{t:M}=Se(),s=re,j=Ee(),{batchOptStatus:J}=Pe(j),K=te,le=()=>{g.value&&(l.value.basicStyleForm[S.value]="default",H({value:"default"}))},U=P(),i=Be({seriesColor:[],curSeriesColor:{id:"",name:"",color:""},curColorIndex:0,seriesColorPickerId:"body"}),w=P(),y=k(()=>s.sub?"subColors":"colors"),S=k(()=>s.sub?"subColorScheme":"colorScheme"),I=k(()=>s.sub?"subSeriesColor":"seriesColor"),se=k(()=>{var e,o,r,c,m,u;return((r=(o=(e=w.value)==null?void 0:e.propertyInner)==null?void 0:o["basic-style-selector"])==null?void 0:r.includes("seriesColor"))||((u=(m=(c=w.value)==null?void 0:c.propertyInner)==null?void 0:m["dual-basic-style-selector"])==null?void 0:u.includes("seriesColor"))}),ie=k(()=>{var e,o,r;return(r=(o=(e=w.value)==null?void 0:e.propertyInner)==null?void 0:o["dual-basic-style-selector"])==null?void 0:r.includes("subSeriesColor")}),R=()=>{var m,u,b,F,E,t;if(J.value||!s.chart)return;if(w.value=$e.getChartView(s.chart.render,s.chart.type),s.sub){if(!ie.value)return}else if(!se.value)return;let e=j.getViewOriginData(s.chart.id);if(!e||(s.chart.type.includes("chart-mix")&&(s.sub?e=(u=(m=e.right)==null?void 0:m.data)==null?void 0:u[0]:e=(F=(b=e.left)==null?void 0:b.data)==null?void 0:F[0]),!e))return;const o=s.sub?(E=w.value)==null?void 0:E.setupSubSeriesColor:w.value.setupSeriesColor;if(!o)return;const r=o(s.chart,e.data),c=((t=s.chart.customAttr.basicStyle[I.value])==null?void 0:t.reduce((a,h)=>(a[h.id]=h,a),{}))||{};r==null||r.forEach(a=>{const h=c[a.id];h&&(a.color=h.color)}),i.seriesColor.splice(0,i.seriesColor.length,...r),i.seriesColor.length&&(i.curColorIndex>i.seriesColor.length-1&&(i.curColorIndex=0),i.curSeriesColor=i.seriesColor[i.curColorIndex],oe(()=>{var a;(a=W.value)==null||a.hide(),i.seriesColorPickerId=`#seriesr-picker-slot-${s.sub?1:0}`}))},ae=(e,o)=>{var c;(c=U.value)==null||c.hide(),i.curSeriesColor=ee(e),i.curColorIndex=o;const r=`series-color-picker-${s.sub?1:0}-${o}`;i.seriesColorPickerId=`#${r}`,oe(()=>{var u;document.getElementById(r)&&((u=U.value)==null||u.show())})},ce=()=>{let e=!1;i.seriesColor.forEach(o=>{o.id===i.curSeriesColor.id&&o.color!==i.curSeriesColor.color&&(e=!0,o.color=i.curSeriesColor.color)}),e&&(l.value.basicStyleForm[I.value]=ee(i.seriesColor),V(I.value))};Re([()=>s.chart,()=>{var e;return(e=s.chart)==null?void 0:e.type},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.calcTopN},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.topN},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.topNLabel}],R,{deep:!1}),Ae(()=>{Q({name:"chart-type-change",callback:le}),Q({name:"chart-data-change",callback:R}),R()});const l=k({get(){return s.modelValue},set(e){K("update:modelValue",e)}}),A=we,X=Ie,O=P(!1),Y=P(),W=P();function Z(e){var o;l.value.basicStyleForm[S.value]=e.value,V(S.value),(o=Y.value)==null||o.hide(),H(e)}const H=e=>{var m,u;const c=(((m=e==null?void 0:e.value)==null?void 0:m.endsWith("_split_gradient"))||g.value?xe(A):A).filter(b=>b.value===l.value.basicStyleForm[S.value]);c.length>0&&(l.value.basicStyleForm[y.value]=[...c[0].colors],l.value.customColor=l.value.basicStyleForm[y.value][0],l.value.colorIndex=0,(u=l.value.basicStyleForm[I.value])==null||u.forEach((b,F)=>{const E=c[0].colors.length;b.color=c[0].colors[F%E]}),V(),R())},ne=()=>{var r;const{type:e}=s.chart,{basicStyleForm:o}=l.value;if(e.includes("map"))H();else{o[I.value]=[],V(I.value);const c=o[S.value];o[y.value]=((r=A.find(m=>m.value===c))==null?void 0:r.colors)??A[0].colors,V(y.value),R()}},me=()=>{const{colorIndex:e,customColor:o,basicStyleForm:r}=l.value,c=r[y.value];if(g.value){let m=e===0?o:c[0],u=e===0?c[8]:o;r[y.value]=Fe(m,u,9,1)}else c[e]=o;V()},g=k(()=>l.value.basicStyleForm[S.value].endsWith("_split_gradient")),D=e=>e===0||e===l.value.basicStyleForm[y.value].length-1,ue=(e,o)=>{var r;g.value&&!D(e)||(l.value.colorIndex=e,l.value.customColor=o,(r=W.value)==null||r.show())};function V(e=y.value){K("changeBasicStyle",e)}const T=P(!1);function pe(){T.value=!0}function de(){T.value=!1}const x=e=>{var o;return(o=s.propertyInner)==null?void 0:o.includes(e)},ve=(e,o)=>{const r=o.colorIndex===e;return g.value?D(e)?r?"var(--ed-color-primary)":"rgb(230,230,230)":"rgb(230,230,230,0.01)":r?"var(--ed-color-primary)":""};return(e,o)=>{const r=Ce,c=Oe("ArrowDown"),m=he,u=_e,b=ye,F=ge,E=be;return n(),d("div",{style:B([{width:"100%"},{"margin-bottom":O.value?"16px":0}])},[v(E,null,{default:f(()=>[x("gradient-color")?(n(),G(r,{key:0,label:C(M)("chart.color_case"),class:_(["form-item","form-item-"+e.themes]),style:{flex:"1","padding-right":"8px","margin-bottom":"16px"}},{default:f(()=>[v(Ve,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=t=>l.value=t),themes:e.themes,onSelectColorCase:Z},null,8,["modelValue","themes"])]),_:1},8,["label","class"])):$("",!0),x("gradient-color")?$("",!0):(n(),G(r,{key:1,label:C(M)("chart.color_case"),class:_(["form-item","form-item-"+e.themes]),style:{flex:"1","padding-right":"8px","margin-bottom":"16px"}},{default:f(()=>[v(C(fe),{placement:"bottom-start",ref_key:"colorCaseSelectorRef",ref:Y,width:"268",offset:4,trigger:"click",persistent:!1,"show-arrow":!1,onShow:pe,onHide:de,"popper-style":{padding:0},effect:e.themes},{reference:f(()=>[v(u,{effect:e.themes,readonly:"",class:"custom-color-selector"},{prefix:f(()=>[p("div",Te,[(n(!0),d(N,null,z(l.value.basicStyleForm[y.value],(t,a)=>(n(),d("div",{key:a,style:B({flex:1,height:"100%",backgroundColor:t})},null,4))),128))])]),suffix:f(()=>[v(m,{class:_(["input-arrow-icon",{reverse:T.value}])},{default:f(()=>[v(c)]),_:1},8,["class"])]),_:1},8,["effect"])]),default:f(()=>[v(b,{"max-height":"274px",class:_(["cases-list",{dark:e.themes==="dark"}])},{default:f(()=>[(n(!0),d(N,null,z(C(A),t=>(n(),d("div",{key:t.value,class:_(["select-color-item",{active:l.value.basicStyleForm[S.value]===t.value}]),onClick:a=>Z(t),title:t.name},[p("div",Le,[(n(!0),d(N,null,z(t.colors,(a,h)=>(n(),d("span",{key:h,style:B({width:"20px",height:"20px",float:"left",backgroundColor:a})},null,4))),128))]),p("span",Ue,L(t.name),1)],10,Ge))),128))]),_:1},8,["class"])]),_:1},8,["effect"])]),_:1},8,["label","class"])),p("div",null,[p("div",{class:_(["custom-color-setting-btn",{active:O.value,dark:e.themes==="dark"}]),onClick:o[1]||(o[1]=t=>O.value=!O.value)},[v(m,{style:{"font-size":"12px"}},{default:f(()=>[v(F,{name:"icon_admin_outlined"},{default:f(()=>[v(C(ke),{class:"svg-icon"})]),_:1})]),_:1})],2)])]),_:1}),O.value?(n(),d(N,{key:0},[p("div",{class:_(["custom-color-extend-setting",{dark:e.themes==="dark"}])},[ze(L(C(M)("chart.custom_case"))+" ",1),p("span",{style:{color:"var(--ed-color-primary)",cursor:"pointer"},onClick:ne},L(C(M)("chart.reset")),1)],2),!e.sub&&x("seriesColor")||e.sub&&x("subSeriesColor")?$("",!0):(n(),d("div",We,[(n(!0),d(N,null,z(l.value.basicStyleForm[y.value],(t,a)=>(n(),d("div",{key:a,class:_([{active:l.value.colorIndex===a,hover:g.value?D(a):!0},"color-item"]),style:B({"border-color":ve(a,l.value)}),onClick:h=>ue(a,t)},[p("div",{class:"color-item__inner",style:B({backgroundColor:t})},[g.value&&D(a)?(n(),G(m,{key:0,class:_(["input-arrow-icon",{reverse:T.value}]),style:{color:"white","font-size":"x-small",left:"2px",bottom:"2px"}},{default:f(()=>[v(c)]),_:1},8,["class"])):$("",!0)],4)],14,He))),128)),p("div",je,[v(C(q),{ref_key:"customColorPickerRef",ref:W,modelValue:l.value.customColor,"onUpdate:modelValue":o[2]||(o[2]=t=>l.value.customColor=t),size:"small",predefine:C(X),onChange:me},null,8,["modelValue","predefine"])])])),(!e.sub&&x("seriesColor")||e.sub&&x("subSeriesColor"))&&!C(J)?(n(),d("div",Je,[p("div",{id:`seriesr-picker-slot-${e.sub?1:0}`,style:{overflow:"hidden",transform:"translateX(0)"}},null,8,Ke),(n(!0),d(N,null,z(i.seriesColor,(t,a)=>{var h;return n(),d("div",{key:t.id,class:"color-list-item"},[p("div",{class:_([{active:t.id===((h=i.curSeriesColor)==null?void 0:h.id)},"color-item"]),onClick:eo=>ae(t,a)},[p("div",{class:"color-item__inner",style:B({backgroundColor:t.color})},null,4)],10,Xe),p("div",{id:`series-color-picker-${e.sub?1:0}-${a}`},null,8,Ye),p("span",{class:_(["color-item-name",e.themes==="dark"?"dark":""]),title:t.name},L(t.name),11,Ze)])}),128))])):$("",!0)],64)):$("",!0),(n(),G(Me,{defer:"",to:i.seriesColorPickerId},[p("div",qe,[v(C(q),{ref_key:"seriesColorPickerRef",ref:U,modelValue:i.curSeriesColor.color,"onUpdate:modelValue":o[3]||(o[3]=t=>i.curSeriesColor.color=t),size:"small","popper-class":"series-color-picker",teleported:!1,predefine:C(X),onChange:ce},null,8,["modelValue","predefine"])])],8,["to"]))],4)}}});const vt=De(Qe,[["__scopeId","data-v-6ea9b615"]]);export{vt as default};

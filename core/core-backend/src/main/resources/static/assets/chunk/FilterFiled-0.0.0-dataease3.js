import{r as ze,d as Se,J as De,G as Ue,x as $e,y as Pe,A as Le,z as Me,a as Ne,a9 as Oe,h as Ae,f as Be}from"./element-plus-secondary-0.0.0-dataease.js";import{j as je,h as Ge}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as Re,r as p,t as We,i as q,k as V,w as H,R as Ke,o as c,c as v,a as o,a2 as _,u as a,a0 as u,_ as r,a1 as Je,M as k,ab as T,a3 as Q,Z as w,$ as Ye,z as Ze,Y as $,a4 as F,a5 as qe,W as He,al as Qe}from"./@vue-0.0.0-dataease.js";import{i as Xe}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{i as el}from"./icon_close_outlined-0.0.0-dataease.js";import{i as ll}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{G as tl}from"./dataset-0.0.0-dataease.js";import{s as al,t as nl,a as ol,d as sl,v as ul,f as X}from"./options-0.0.0-dataease.js";import{i as il}from"./field-list-0.0.0-dataease.js";import{_ as rl}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./vue-router-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";const dl={class:"white-nowrap"},cl={class:"filed-title"},ml={class:"dimension"},pl=["onClick"],vl={key:0,class:"white-nowrap flex-align-center",style:{position:"relative"}},fl={class:"filed-title"},_l={class:"filed-title"},hl={class:"de-panel clearfix"},yl={class:"mod-left"},gl={class:"autochecker-list",style:{height:"260px"}},kl={class:"select-all"},bl=["title"],Vl={class:"mod-left right-de"},wl={class:"right-top clearfix"},xl={class:"right-btn"},Cl={key:0,class:"de-el-dropdown-menu-manu"},Tl={class:"text-area"},Il=["placeholder"],El={class:"text-area-btn"},Fl={class:"autochecker-list"},zl={class:"clear-checkbox__label"},Sl=["title"],Dl={class:"right-menu-foot"},Ul=Re({__name:"FilterFiled",props:{index:{default:0},item:{default:()=>({term:"",fieldId:"",filterType:"",deType:0,enumValue:"",name:"",value:null})}},emits:["update:item","del"],setup(ee,{emit:le}){const te=ee,{t:d}=je(),P=p(),ae=p(),L=p(!1),z=p(""),S=p(""),D=p(""),b=p([]),I=p(),B=p(!1),m=p([]),U=p([]),M=p(""),{item:n}=We(te),N=q("getAuthTargetType"),ne=q("filedList"),h=V(()=>D.value?b.value.filter(t=>t.includes(D.value)):b.value),oe=V(()=>m.value.join(",")),se=V(()=>{const{term:t,fieldId:e,filterType:s}=n.value,f=["null","empty","not_null","not_empty"].includes(t)&&s==="logic";return{width:e?f?"670px":"750px":"270px"}}),ue=V(()=>["in","not in"].includes(n.value.term)?[{value:"${sysParams.roles}",label:d("auth.sysParams_type.role")}]:al),ie=V(()=>{const{deType:t}=n.value;return x.value==="sysParams"?nl:[0,5].includes(t)?ol:t===1?sl:ul}),re=V(()=>z.value?j.value.filter(t=>t.name.includes(z.value)):j.value),j=V(()=>Object.values(ne.value||{})),x=p("");H(()=>N==null?void 0:N.authTargetType,t=>{x.value===t||!t||(x.value=t)},{immediate:!0}),Ke(()=>{me(),R(n.value.deType)});const de=()=>{he(),P.value.$el.click()},ce=()=>{const{enumValue:t}=n.value,e=t.trim()?t.split(","):[];m.value=e,i.value=h.value.filter(s=>e.includes(s)),i.value.length&&(g.value=i.value.length===h.value.length,y.value=i.value.length!==h.value.length),i.value.length||(g.value=!1,y.value=!1),P.value.$el.click()},me=()=>{const{name:t,enumValue:e,fieldId:s}=n.value,f=e.trim()?e.split(","):[];!t&&s&&(m.value=f),!(!t&&!s)&&(G(),S.value=n.value.name,m.value=f)},pe=()=>{!I.value&&!B.value&&(B.value=!0),I.value=!0},ve=()=>{n.value.term="",n.value.value=null,G()},G=()=>{if(x.value==="sysParams")return;const{deType:t,filterType:e,fieldId:s}=n.value;e==="enum"&&[0,5].includes(t)&&tl({fieldIds:[s]}).then(f=>{b.value=fe(f.data),i.value=b.value.filter(C=>m.value.includes(C)),i.value.length&&(g.value=i.value.length===b.value.length,y.value=i.value.length!==b.value.length),i.value.length||(g.value=!1,y.value=!1)})},fe=t=>t?t.filter(e=>!!e):null,_e=()=>{n.value.name=S.value||""},he=()=>{n.value.enumValue=oe.value||""},ye=(t,e)=>{m.value.splice(t,1),i.value=i.value.filter(s=>s!==e),W()},ge=({name:t,id:e,deType:s})=>{S.value=t,Object.assign(n.value,{fieldId:e,name:t,deType:s,filterType:"logic",enumValue:"",value:"",term:""}),R(s),m.value=[]},R=t=>{U.value=[{value:"logic",label:d("deDataset.logic_filter")},{value:"enum",label:d("deDataset.enum_filter")}],(x.value==="sysParams"||[1,2,3].includes(t))&&(U.value=[U.value[0]])},ke=()=>{m.value=[],i.value=[],g.value=!1,y.value=!1},be=()=>{h.value.forEach(t=>{m.value.includes(t)||m.value.push(t)}),i.value=[...new Set([...h.value,...i.value])]},y=p(!1),g=p(!1),i=p([]);let E=[];H(()=>h.value,t=>{!E.length&&t.length!==b.value.length&&(E=[...i.value]),E.length&&t.length===b.value.length&&(E=[]);const e=t.every(s=>i.value.includes(s));y.value=t.length&&i.value.length&&!e,g.value=t.length&&e});const W=()=>{const t=h.value.filter(s=>!i.value.includes(s)),e=[...i.value];m.value=[...new Set(m.value.concat(i.value))].filter(s=>!t.includes(s)),i.value=[...new Set(E.concat(i.value))].filter(s=>!t.includes(s)),e.length&&(g.value=e.length===h.value.length,y.value=e.length!==h.value.length),e.length||(g.value=!1,y.value=!1)},Ve=t=>{t?be():(i.value=i.value.filter(e=>!h.value.includes(e)),m.value=m.value.filter(e=>!h.value.includes(e))),y.value=!1},we=()=>{const t=M.value.split(`
`).reduce((e,s)=>{const f=s.trim();return f&&e.add(f),e},new Set([]));t.size&&(m.value=[...new Set([...m.value,...Array.from(t)])]),I.value=!1},xe=le;return(t,e)=>{const s=ze,f=Ge,C=Se,Ce=De,Te=Ue,O=$e,A=Pe,Ie=Le,K=Me,J=Ne,Ee=Oe,Y=Ae,Fe=Be;return c(),v("div",dl,[o("div",{class:"filed",style:Q(se.value),onMouseover:e[15]||(e[15]=l=>L.value=!0),onMouseleave:e[16]||(e[16]=l=>L.value=!1)},[o("span",cl,_(a(d)("auth.filter_fields")),1),u(Te,{trigger:"click","hide-on-click":!1},{dropdown:r(()=>[u(Ce,{class:"de-el-dropdown-menu"},{default:r(()=>[u(s,{onKeydown:e[1]||(e[1]=Je(()=>{},["stop"])),placeholder:a(d)("auth.enter_keywords"),size:"small",modelValue:z.value,"onUpdate:modelValue":e[2]||(e[2]=l=>z.value=l)},{prefix:r(()=>[u(C,null,{default:r(()=>[u(f,{name:"icon_search-outline_outlined"},{default:r(()=>[u(a(Xe),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["placeholder","modelValue"]),o("ul",ml,[(c(!0),v(k,null,T(re.value,l=>(c(),v("li",{onClick:Z=>ge(l),style:Q({backgroundColor:S.value===l.name?"#f0f7ff":""}),key:l.id},[u(C,null,{default:r(()=>[u(f,null,{default:r(()=>[(c(),w(Ye(a(il)[a(X)[l.deType]]),{class:Ze(["svg-icon",`field-icon-${a(X)[l.deType]}`])},null,8,["class"]))]),_:2},1024)]),_:2},1024),o("span",null,_(l.name),1)],12,pl))),128))])]),_:1})]),default:r(()=>[u(s,{placeholder:a(d)("auth.select_filter_fields"),modelValue:a(n).name,"onUpdate:modelValue":e[0]||(e[0]=l=>a(n).name=l),size:"small",onInput:_e},null,8,["placeholder","modelValue"])]),_:1}),a(n).fieldId?(c(),v("div",vl,[o("span",fl,_(a(d)("auth.screen_method")),1),u(A,{size:"small",onChange:ve,modelValue:a(n).filterType,"onUpdate:modelValue":e[3]||(e[3]=l=>a(n).filterType=l),placeholder:a(d)("auth.select")},{default:r(()=>[(c(!0),v(k,null,T(U.value,l=>(c(),w(O,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),o("span",_l,_(a(d)("auth.fixed_value")),1),a(n).filterType==="logic"?(c(),v(k,{key:0},[u(A,{class:"w100",size:"small",modelValue:a(n).term,"onUpdate:modelValue":e[4]||(e[4]=l=>a(n).term=l),placeholder:a(d)("auth.default_method")},{default:r(()=>[(c(!0),v(k,null,T(ie.value,l=>(c(),w(O,{key:l.value,label:a(d)(l.label),value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),x.value==="sysParams"?(c(),w(A,{key:0,class:"w70 mar5",size:"small",modelValue:a(n).value,"onUpdate:modelValue":e[5]||(e[5]=l=>a(n).value=l)},{default:r(()=>[(c(!0),v(k,null,T(ue.value,l=>(c(),w(O,{key:l.value,label:a(d)(l.label),value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):[2,3].includes(a(n).deType)&&!["null","empty","not_null","not_empty"].includes(a(n).term)?(c(),v(k,{key:1},[u(Ie,{class:"w70 mar5",size:"small",effect:"plain",modelValue:a(n).value,"onUpdate:modelValue":e[6]||(e[6]=l=>a(n).value=l),"controls-position":"right"},null,8,["modelValue"]),e[17]||(e[17]=o("div",{class:"bottom-line"},null,-1))],64)):["null","empty","not_null","not_empty"].includes(a(n).term)?$("",!0):(c(),v(k,{key:2},[u(s,{class:"w70 mar5",size:"small",modelValue:a(n).value,"onUpdate:modelValue":e[7]||(e[7]=l=>a(n).value=l)},null,8,["modelValue"]),e[18]||(e[18]=o("div",{class:"bottom-line"},null,-1))],64))],64)):(c(),w(Fe,{key:1,"popper-class":"de-el-dropdown-menu-fixed",width:"360px",trigger:"click",ref_key:"deElDropdownMenuFixed",ref:ae,"hide-on-click":!1},{reference:r(()=>[u(s,{modelValue:a(n).enumValue,"onUpdate:modelValue":e[8]||(e[8]=l=>a(n).enumValue=l),ref_key:"enumInput",ref:P,size:"small",readonly:"",clearable:""},null,8,["modelValue"])]),default:r(()=>[o("div",hl,[o("div",yl,[u(s,{placeholder:a(d)("auth.enter_keywords"),modelValue:D.value,"onUpdate:modelValue":e[9]||(e[9]=l=>D.value=l)},null,8,["placeholder","modelValue"]),o("ul",gl,[o("div",kl,[u(K,{modelValue:g.value,"onUpdate:modelValue":e[10]||(e[10]=l=>g.value=l),indeterminate:y.value,label:a(d)("component.allSelect"),onChange:Ve},null,8,["modelValue","indeterminate","label"])]),u(Ee,{modelValue:i.value,"onUpdate:modelValue":e[11]||(e[11]=l=>i.value=l),onChange:W},{default:r(()=>[u(J,{height:"230px"},{default:r(()=>[(c(!0),v(k,null,T(h.value,l=>(c(),v("li",{key:l,title:l},[u(K,{label:l},{default:r(()=>[F(_(l),1)]),_:2},1032,["label"])],8,bl))),128))]),_:1})]),_:1},8,["modelValue"])])]),o("div",Vl,[o("div",wl,[F(_(a(d)("common.list_selection"))+" ",1),o("div",xl,[o("span",{onClick:pe},[e[19]||(e[19]=o("i",{class:"el-icon-edit"},null,-1)),F(" "+_(a(d)("auth.manual_input")),1)]),u(qe,{name:"el-zoom-in-top"},{default:r(()=>[I.value?(c(),v("div",Cl,[o("div",Tl,[He(o("textarea",{placeholder:a(d)("auth.please_fill"),class:"input","onUpdate:modelValue":e[12]||(e[12]=l=>M.value=l)},null,8,Il),[[Qe,M.value]]),o("div",El,[o("button",{type:"button",onClick:e[13]||(e[13]=l=>I.value=!1),class:"btn"},[o("span",null,_(a(d)("auth.close")),1)]),o("button",{type:"button",onClick:we,class:"btn right-add"},[o("span",null,_(a(d)("auth.add")),1)])])])])):$("",!0)]),_:1})])]),o("ul",Fl,[o("div",zl,[o("span",null,_(a(d)("auth.added")+" "+m.value.length),1),o("span",{onClick:ke},_(a(d)("user.clear_button")),1)]),u(J,{height:"230px"},{default:r(()=>[(c(!0),v(k,null,T(m.value,(l,Z)=>(c(),v("li",{key:l},[o("div",{title:l,class:"right-checkbox__label"},_(l),9,Sl),u(C,{onClick:$l=>ye(Z,l),class:"remove-hover-icon"},{default:r(()=>[u(f,null,{default:r(()=>[u(a(el),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]))),128))]),_:1})])]),o("div",Dl,[u(Y,{secondary:"",onClick:ce},{default:r(()=>[F(_(a(d)("common.cancel")),1)]),_:1}),u(Y,{type:"primary",onClick:de},{default:r(()=>[F(_(a(d)("auth.sure")),1)]),_:1})])])]),_:1},512))])):$("",!0),L.value?(c(),w(C,{key:1,class:"font12",onClick:e[14]||(e[14]=l=>xe("del"))},{default:r(()=>[u(f,{name:"icon_delete-trash_outlined"},{default:r(()=>[u(a(ll),{class:"svg-icon"})]),_:1})]),_:1})):$("",!0)],36)])}}});const Bt=rl(Ul,[["__scopeId","data-v-092d6aab"]]);export{Bt as default};

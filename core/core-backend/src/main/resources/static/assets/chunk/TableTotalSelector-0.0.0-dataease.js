import"./index-0.0.0-dataease.js";import{E as ie}from"./el-dialog-0.0.0-dataease.js";import{o as fe,G as ce,j as be,y as ge}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import{E as Te}from"./el-col-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{E as he,a as we}from"./el-select-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import{E as Se,a as ve}from"./el-radio-0.0.0-dataease.js";import{a as Fe,E as Ve}from"./el-form-item-0.0.0-dataease.js";import{E as ye}from"./el-checkbox-0.0.0-dataease.js";import{E as Ne}from"./el-divider-0.0.0-dataease.js";import{d as xe,w as Ce,Z as Ie,Q as X,r as Z,o as Ae,e as ke,f as i,L as N,k as o,i as m,g as V,a5 as c,a6 as b,j as s,U as g,a0 as C,T as E,W as U,M as O,Y as x,a9 as I,n as Ee}from"./vue-0.0.0-dataease.js";import{b as H,L as K}from"./chart-0.0.0-dataease.js";import Ue from"./CustomAggrEdit-0.0.0-dataease.js";import{d as p,y as _,z as ee,O as De}from"./lodash-0.0.0-dataease.js";import{_ as Le}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./index-0.0.0-dataease3.js";import"./index-0.0.0-dataease16.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./formatter-0.0.0-dataease.js";import"./el-row-0.0.0-dataease.js";import"./el-popover-0.0.0-dataease.js";import"./dropdown-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./icon_info_outlined-0.0.0-dataease.js";import"./icon_search-outline_outlined-0.0.0-dataease.js";import"./icon_adjustment_outlined-0.0.0-dataease.js";import"./icon_edit_outlined-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./CodeMirror-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./attr-0.0.0-dataease20.js";import"./field-list-0.0.0-dataease.js";const $e={key:1},Me={style:{display:"flex"}},Oe={style:{flex:"1"}},pe=xe({__name:"TableTotalSelector",props:{chart:{type:Object,required:!0},themes:{type:String,default:"dark"},propertyInner:{type:Array}},emits:["onTableTotalChange"],setup(l,{emit:te}){const{t:r}=fe(),y=l;Ce([()=>y.chart.customAttr.tableTotal,()=>y.chart.xAxis,()=>y.chart.yAxis],()=>{Y()},{deep:!0});const G=[{name:r("chart.none"),value:"NONE"},{name:r("chart.sum"),value:"SUM"},{name:r("chart.avg"),value:"AVG"},{name:r("chart.max"),value:"MAX"},{name:r("chart.min"),value:"MIN"},{name:r("commons.custom"),value:"CUSTOM"}],t=Ie({tableTotalForm:p(K),rowSubTotalItem:{},rowTotalItem:{},colSubTotalItem:{},colTotalItem:{},totalCfg:[],totalCfgAttr:"",totalItem:{},selectedSubTotalDimensionName:"",selectedSubTotalDimension:void 0,subTotalDimensionList:[],basicStyleForm:JSON.parse(JSON.stringify(H))});function ae(n){t.selectedSubTotalDimension=_(t.subTotalDimensionList,e=>e.name===n)}function J(){const n=[];for(let e=0;e<t.subTotalDimensionList.length;e++)t.subTotalDimensionList[e].checked&&n.push(t.subTotalDimensionList[e].name);t.tableTotalForm.row.subTotalsDimensions=n,h("row")}const le=()=>{var f;const n=[];if(y.chart.xAxis.length>=2)for(let d=0;d<y.chart.xAxis.length-1;d++){const u=De(t.tableTotalForm.row.subTotalsDimensions,y.chart.xAxis[d].dataeaseName);n.push({displayName:y.chart.xAxis[d].name,name:y.chart.xAxis[d].dataeaseName,checked:t.tableTotalForm.row.subTotalsDimensionsNew?u:!0})}t.subTotalDimensionList=n;const e=_(t.subTotalDimensionList,d=>d.name===t.selectedSubTotalDimensionName);e?t.selectedSubTotalDimension=e:(t.selectedSubTotalDimensionName=(f=n[0])==null?void 0:f.name,t.selectedSubTotalDimension=n[0]),t.tableTotalForm.row.subTotalsDimensionsNew||(t.tableTotalForm.row.subTotalsDimensionsNew=!0,J())},oe=te,h=n=>{oe("onTableTotalChange",t.tableTotalForm,n)},Y=()=>{var F,k,D;const n=(k=(F=y.chart)==null?void 0:F.customAttr)==null?void 0:k.tableTotal;n&&(n.row&&(n.row.subTotalsDimensionsNew=!!((D=n.row)!=null&&D.subTotalsDimensionsNew)),t.tableTotalForm=ee(p(n),p(K)));const e=y.chart.yAxis;if((e==null?void 0:e.length)>0){const v=e.map(T=>T.dataeaseName);v.indexOf(t.tableTotalForm.row.totalSortField)===-1&&(t.tableTotalForm.row.totalSortField=e[0].dataeaseName),v.indexOf(t.tableTotalForm.col.totalSortField)===-1&&(t.tableTotalForm.col.totalSortField=e[0].dataeaseName)}else t.tableTotalForm.row.totalSortField="",t.tableTotalForm.col.totalSortField="";[{...t.tableTotalForm.row.calcTotals},{...t.tableTotalForm.row.calcSubTotals},{...t.tableTotalForm.col.calcTotals},{...t.tableTotalForm.col.calcSubTotals}].forEach(v=>{me(v.cfg,e)}),[[t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg],[t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg],[t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg],[t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg]].forEach(v=>{const[T,w]=v;if(!w.length){T.dataeaseName="",T.aggregation="",T.originName="";return}const L=w.findIndex($=>$.dataeaseName===T.dataeaseName);L!==-1?T.aggregation=w[L].aggregation:(T.dataeaseName=w[0].dataeaseName,T.aggregation=w[0].aggregation,T.originName=w[0].originName)});const u=p(y.chart.customAttr.basicStyle);t.basicStyleForm=ee(u,p(H)),le()},A=n=>{var e;return(e=y.propertyInner)==null?void 0:e.includes(n)},B=(n,e)=>{for(let f=0;f<e.length;f++){const d=e[f];if(d.dataeaseName===n.dataeaseName){n.aggregation=d.aggregation,n.originName=d.originName;return}}},z=(n,e,f)=>{for(let d=0;d<e.length;d++){const u=e[d];if(u.dataeaseName===n.dataeaseName){u.aggregation=n.aggregation;break}}n.aggregation=="CUSTOM"&&!n.originName||h(f)},me=(n,e)=>{if(!n.length){e.forEach(d=>{n.push({dataeaseName:d.dataeaseName,aggregation:"SUM"})});return}if(!e.length){n.splice(0,n.length);return}const f=n.reduce((d,u)=>(d[u.dataeaseName]=u,d),{});n.splice(0,n.length),e.forEach(d=>{n.push({dataeaseName:d.dataeaseName,aggregation:f[d.dataeaseName]?f[d.dataeaseName].aggregation:"SUM",originName:f[d.dataeaseName]?f[d.dataeaseName].originName:""})})},P=X("quota",()=>[]),re=X("dimension",()=>[]),j=Z(),q=Z(!1),R=(n,e,f)=>{q.value=!0,t.totalCfg=e,t.totalCfgAttr=f,t.totalItem=n,Ee(()=>{j.value.initEdit(n,P().filter(d=>d.id!=="-1"))})},Q=()=>{q.value=!1},se=()=>{var e;j.value.setFieldForm();const n=p(j.value.fieldForm);(e=t.totalCfg)==null||e.forEach(f=>{f.dataeaseName===n.dataeaseName&&(f.originName=n.originName,ne(f),t.totalItem.originName=f.originName)}),Q(),h(t.totalCfgAttr)},ne=n=>{n.extField=2,n.chartId=y.chart.id,n.datasetGroupId=y.chart.tableId,n.lastSyncTime=null,n.columnIndex=re().length+P().length,n.deExtractType=n.deType};return Ae(()=>{Y()}),(n,e)=>{const f=Ne,d=ye,u=Fe,F=Se,k=ve,D=ce,v=he,T=we,w=Te,L=ke("Setting"),$=be,de=Ve,W=ge,ue=ie;return i(),N(x,null,[o(de,{ref:"tableTotalForm",model:t.tableTotalForm,"label-position":"top"},{default:m(()=>{var M;return[A("row")?(i(),V(f,{key:0,"content-position":"center",class:g("divider-style-"+l.themes)},{default:m(()=>[c(b(s(r)("chart.row_cfg")),1)]),_:1},8,["class"])):C("",!0),E(o(u,{label:s(r)("chart.total_show"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(d,{effect:l.themes,modelValue:t.tableTotalForm.row.showGrandTotals,"onUpdate:modelValue":e[0]||(e[0]=a=>t.tableTotalForm.row.showGrandTotals=a),onChange:e[1]||(e[1]=a=>h("row.showGrandTotals"))},{default:m(()=>[c(b(s(r)("chart.show")),1)]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),[[U,A("row")]]),E(O("div",null,[o(u,{label:s(r)("chart.total_position"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(k,{effect:l.themes,modelValue:t.tableTotalForm.row.reverseLayout,"onUpdate:modelValue":e[2]||(e[2]=a=>t.tableTotalForm.row.reverseLayout=a),onChange:e[3]||(e[3]=a=>h("row.reverseLayout"))},{default:m(()=>[o(F,{effect:l.themes,label:!0},{default:m(()=>[c(b(s(r)("chart.total_pos_top")),1)]),_:1},8,["effect"]),o(F,{effect:l.themes,label:!1},{default:m(()=>[c(b(s(r)("chart.total_pos_bottom")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),o(u,{label:s(r)("chart.total_label"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(D,{effect:l.themes,placeholder:s(r)("chart.total_label"),size:"small",maxlength:"20",modelValue:t.tableTotalForm.row.label,"onUpdate:modelValue":e[4]||(e[4]=a=>t.tableTotalForm.row.label=a),clearable:"",onChange:e[5]||(e[5]=a=>h("row.label"))},null,8,["effect","placeholder","modelValue"])]),_:1},8,["label","class"]),o(u,{label:s(r)("chart.aggregation"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(w,{span:11},{default:m(()=>[o(T,{effect:l.themes,modelValue:t.rowTotalItem.dataeaseName,"onUpdate:modelValue":e[6]||(e[6]=a=>t.rowTotalItem.dataeaseName=a),placeholder:s(r)("chart.aggregation"),onChange:e[7]||(e[7]=a=>B(t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg))},{default:m(()=>[(i(!0),N(x,null,I(l.chart.yAxis,a=>(i(),V(v,{key:a.dataeaseName,label:a.name,value:a.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1}),o(w,{span:t.rowTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>[o(T,{effect:l.themes,modelValue:t.rowTotalItem.aggregation,"onUpdate:modelValue":e[8]||(e[8]=a=>t.rowTotalItem.aggregation=a),placeholder:s(r)("chart.aggregation"),onChange:e[9]||(e[9]=a=>z(t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg,"row.calcTotals.cfg"))},{default:m(()=>[(i(),N(x,null,I(G,a=>o(v,{key:a.value,label:a.name,value:a.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["span"]),t.rowTotalItem.aggregation==="CUSTOM"?(i(),V(w,{key:0,span:2,offset:1},{default:m(()=>[o($,null,{default:m(()=>[o(L,{onClick:e[10]||(e[10]=a=>R(t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg,"row.calcTotals.cfg"))})]),_:1})]),_:1})):C("",!0)]),_:1},8,["label","class"]),l.chart.type==="table-pivot"?(i(),V(u,{key:0,label:s(r)("chart.total_sort"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(k,{effect:l.themes,modelValue:t.tableTotalForm.row.totalSort,"onUpdate:modelValue":e[11]||(e[11]=a=>t.tableTotalForm.row.totalSort=a),onChange:e[12]||(e[12]=a=>h("row.totalSort"))},{default:m(()=>[o(F,{effect:l.themes,label:"none"},{default:m(()=>[c(b(s(r)("chart.total_sort_none")),1)]),_:1},8,["effect"]),o(F,{effect:l.themes,label:"asc"},{default:m(()=>[c(b(s(r)("chart.total_sort_asc")),1)]),_:1},8,["effect"]),o(F,{effect:l.themes,label:"desc"},{default:m(()=>[c(b(s(r)("chart.total_sort_desc")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"])):C("",!0),l.chart.type==="table-pivot"&&t.tableTotalForm.row.totalSort!=="none"?(i(),V(u,{key:1,label:s(r)("chart.total_sort_field"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(T,{effect:l.themes,modelValue:t.tableTotalForm.row.totalSortField,"onUpdate:modelValue":e[13]||(e[13]=a=>t.tableTotalForm.row.totalSortField=a),class:"form-item-select",placeholder:s(r)("chart.total_sort_field"),onChange:e[14]||(e[14]=a=>h("row.totalSortField"))},{default:m(()=>[(i(!0),N(x,null,I(l.chart.yAxis,a=>(i(),V(v,{key:a.dataeaseName,label:a.name,value:a.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["label","class"])):C("",!0)],512),[[U,A("row")&&t.tableTotalForm.row.showGrandTotals]]),E(o(u,{label:s(r)("chart.sub_total_show"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(d,{effect:l.themes,modelValue:t.tableTotalForm.row.showSubTotals,"onUpdate:modelValue":e[15]||(e[15]=a=>t.tableTotalForm.row.showSubTotals=a),disabled:l.chart.xAxis.length<2,onChange:e[16]||(e[16]=a=>h("row"))},{default:m(()=>[c(b(s(r)("chart.show")),1)]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["label","class"]),[[U,A("row")]]),A("row")&&t.tableTotalForm.row.showSubTotals?(i(),N("div",$e,[O("div",Me,[e[57]||(e[57]=O("div",{style:{width:"22px","flex-direction":"row"}},null,-1)),O("div",Oe,[o(u,{class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(T,{effect:l.themes,modelValue:t.selectedSubTotalDimensionName,"onUpdate:modelValue":e[17]||(e[17]=a=>t.selectedSubTotalDimensionName=a),disabled:l.chart.xAxis.length<2||t.basicStyleForm.tableLayoutMode==="tree",onChange:ae},{default:m(()=>[(i(!0),N(x,null,I(t.subTotalDimensionList,a=>(i(),V(v,{key:a.name,label:a.displayName,value:a.name},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["class"]),t.selectedSubTotalDimension?(i(),V(u,{key:0,class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(d,{effect:l.themes,modelValue:t.selectedSubTotalDimension.checked,"onUpdate:modelValue":e[18]||(e[18]=a=>t.selectedSubTotalDimension.checked=a),disabled:l.chart.xAxis.length<2||t.basicStyleForm.tableLayoutMode==="tree",onChange:J},{default:m(()=>[c(b(s(r)("chart.show")),1)]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["class"])):C("",!0)])]),o(u,{label:s(r)("chart.total_position"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(k,{effect:l.themes,modelValue:t.tableTotalForm.row.reverseSubLayout,"onUpdate:modelValue":e[19]||(e[19]=a=>t.tableTotalForm.row.reverseSubLayout=a),disabled:l.chart.xAxis.length<2||t.basicStyleForm.tableLayoutMode==="tree",onChange:e[20]||(e[20]=a=>h("row"))},{default:m(()=>[o(F,{effect:l.themes,label:!0},{default:m(()=>[c(b(s(r)("chart.total_pos_top")),1)]),_:1},8,["effect"]),o(F,{effect:l.themes,label:!1},{default:m(()=>[c(b(s(r)("chart.total_pos_bottom")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["label","class"]),o(u,{label:s(r)("chart.total_label"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(D,{effect:l.themes,disabled:l.chart.xAxis.length<2,placeholder:s(r)("chart.total_label"),modelValue:t.tableTotalForm.row.subLabel,"onUpdate:modelValue":e[21]||(e[21]=a=>t.tableTotalForm.row.subLabel=a),size:"small",maxlength:"20",clearable:"",onChange:e[22]||(e[22]=a=>h("row.subLabel"))},null,8,["effect","disabled","placeholder","modelValue"])]),_:1},8,["label","class"]),o(u,{label:s(r)("chart.aggregation"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(w,{span:11},{default:m(()=>[o(T,{effect:l.themes,modelValue:t.rowSubTotalItem.dataeaseName,"onUpdate:modelValue":e[23]||(e[23]=a=>t.rowSubTotalItem.dataeaseName=a),disabled:l.chart.xAxis.length<2,placeholder:s(r)("chart.aggregation"),onChange:e[24]||(e[24]=a=>B(t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg))},{default:m(()=>[(i(!0),N(x,null,I(l.chart.yAxis,a=>(i(),V(v,{key:a.dataeaseName,label:a.name,value:a.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","disabled","placeholder"])]),_:1}),o(w,{span:t.rowSubTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>[o(T,{effect:l.themes,modelValue:t.rowSubTotalItem.aggregation,"onUpdate:modelValue":e[25]||(e[25]=a=>t.rowSubTotalItem.aggregation=a),disabled:l.chart.xAxis.length<2,placeholder:s(r)("chart.aggregation"),onChange:e[26]||(e[26]=a=>z(t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg,"row"))},{default:m(()=>[(i(),N(x,null,I(G,a=>o(v,{key:a.value,label:a.name,value:a.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","disabled","placeholder"])]),_:1},8,["span"]),t.rowSubTotalItem.aggregation==="CUSTOM"?(i(),V(w,{key:0,span:2,offset:1},{default:m(()=>[o($,null,{default:m(()=>[o(L,{onClick:e[27]||(e[27]=a=>R(t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg,"row.calcSubTotals.cfg"))})]),_:1})]),_:1})):C("",!0)]),_:1},8,["label","class"])])):C("",!0),A("col")?(i(),V(f,{key:2,"content-position":"center",class:g("divider-style-"+l.themes)},{default:m(()=>[c(b(s(r)("chart.col_cfg")),1)]),_:1},8,["class"])):C("",!0),E(o(u,{label:s(r)("chart.total_show"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(d,{effect:l.themes,modelValue:t.tableTotalForm.col.showGrandTotals,"onUpdate:modelValue":e[28]||(e[28]=a=>t.tableTotalForm.col.showGrandTotals=a),onChange:e[29]||(e[29]=a=>h("col"))},{default:m(()=>[c(b(s(r)("chart.show")),1)]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),[[U,A("col")]]),E(O("div",null,[o(u,{label:s(r)("chart.total_position"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(k,{effect:l.themes,modelValue:t.tableTotalForm.col.reverseLayout,"onUpdate:modelValue":e[30]||(e[30]=a=>t.tableTotalForm.col.reverseLayout=a),onChange:e[31]||(e[31]=a=>h("col"))},{default:m(()=>[o(F,{effect:l.themes,label:!0},{default:m(()=>[c(b(s(r)("chart.total_pos_left")),1)]),_:1},8,["effect"]),o(F,{effect:l.themes,label:!1},{default:m(()=>[c(b(s(r)("chart.total_pos_right")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),o(u,{label:s(r)("chart.total_label"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(D,{effect:l.themes,placeholder:s(r)("chart.total_label"),size:"small",maxlength:"20",modelValue:t.tableTotalForm.col.label,"onUpdate:modelValue":e[32]||(e[32]=a=>t.tableTotalForm.col.label=a),clearable:"",onBlur:e[33]||(e[33]=a=>h("col.label"))},null,8,["effect","placeholder","modelValue"])]),_:1},8,["label","class"]),o(u,{label:s(r)("chart.aggregation"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(w,{span:11},{default:m(()=>[o(T,{effect:l.themes,modelValue:t.colTotalItem.dataeaseName,"onUpdate:modelValue":e[34]||(e[34]=a=>t.colTotalItem.dataeaseName=a),placeholder:s(r)("chart.aggregation"),onChange:e[35]||(e[35]=a=>B(t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg))},{default:m(()=>[(i(!0),N(x,null,I(l.chart.yAxis,a=>(i(),V(v,{key:a.dataeaseName,label:a.name,value:a.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1}),o(w,{span:t.colTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>[o(T,{effect:l.themes,modelValue:t.colTotalItem.aggregation,"onUpdate:modelValue":e[36]||(e[36]=a=>t.colTotalItem.aggregation=a),placeholder:s(r)("chart.aggregation"),onChange:e[37]||(e[37]=a=>z(t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg,"col.calcTotals.cfg"))},{default:m(()=>[(i(),N(x,null,I(G,a=>o(v,{key:a.value,label:a.name,value:a.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["span"]),t.colTotalItem.aggregation==="CUSTOM"?(i(),V(w,{key:0,span:2,offset:1},{default:m(()=>[o($,null,{default:m(()=>[o(L,{onClick:e[38]||(e[38]=a=>R(t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg,"col.calcTotals.cfg"))})]),_:1})]),_:1})):C("",!0)]),_:1},8,["label","class"]),l.chart.type==="table-pivot"?(i(),V(u,{key:0,label:s(r)("chart.total_sort"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(k,{effect:l.themes,modelValue:t.tableTotalForm.col.totalSort,"onUpdate:modelValue":e[39]||(e[39]=a=>t.tableTotalForm.col.totalSort=a),onChange:e[40]||(e[40]=a=>h("col"))},{default:m(()=>[o(F,{effect:l.themes,label:"none"},{default:m(()=>[c(b(s(r)("chart.total_sort_none")),1)]),_:1},8,["effect"]),o(F,{effect:l.themes,label:"asc"},{default:m(()=>[c(b(s(r)("chart.total_sort_asc")),1)]),_:1},8,["effect"]),o(F,{effect:l.themes,label:"desc"},{default:m(()=>[c(b(s(r)("chart.total_sort_desc")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"])):C("",!0),E(o(u,{label:s(r)("chart.total_sort_field"),class:"form-item"},{default:m(()=>[o(T,{effect:l.themes,modelValue:t.tableTotalForm.col.totalSortField,"onUpdate:modelValue":e[41]||(e[41]=a=>t.tableTotalForm.col.totalSortField=a),class:"form-item-select",placeholder:s(r)("chart.total_sort_field"),onChange:e[42]||(e[42]=a=>h("col"))},{default:m(()=>[(i(!0),N(x,null,I(l.chart.yAxis,a=>(i(),V(v,{key:a.dataeaseName,label:a.name,value:a.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["label"]),[[U,l.chart.type==="table-pivot"&&((M=t.tableTotalForm.col)==null?void 0:M.totalSort)!=="none"]])],512),[[U,A("col")&&t.tableTotalForm.col.showGrandTotals]]),E(o(u,{label:s(r)("chart.sub_total_show"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(d,{effect:l.themes,modelValue:t.tableTotalForm.col.showSubTotals,"onUpdate:modelValue":e[43]||(e[43]=a=>t.tableTotalForm.col.showSubTotals=a),disabled:l.chart.xAxisExt.length<2,onChange:e[44]||(e[44]=a=>h("col"))},{default:m(()=>[c(b(s(r)("chart.show")),1)]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["label","class"]),[[U,A("col")]]),E(O("div",null,[o(u,{label:s(r)("chart.total_position"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>{var a;return[o(k,{effect:l.themes,modelValue:t.tableTotalForm.col.reverseSubLayout,"onUpdate:modelValue":e[45]||(e[45]=S=>t.tableTotalForm.col.reverseSubLayout=S),disabled:((a=l.chart.xAxisExt)==null?void 0:a.length)<2,onChange:e[46]||(e[46]=S=>h("col"))},{default:m(()=>[o(F,{effect:l.themes,label:!0},{default:m(()=>[c(b(s(r)("chart.total_pos_left")),1)]),_:1},8,["effect"]),o(F,{effect:l.themes,label:!1},{default:m(()=>[c(b(s(r)("chart.total_pos_right")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue","disabled"])]}),_:1},8,["label","class"]),o(u,{label:s(r)("chart.total_label"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>{var a;return[o(D,{effect:l.themes,disabled:((a=l.chart.xAxisExt)==null?void 0:a.length)<2,placeholder:s(r)("chart.total_label"),modelValue:t.tableTotalForm.col.subLabel,"onUpdate:modelValue":e[47]||(e[47]=S=>t.tableTotalForm.col.subLabel=S),size:"small",maxlength:"20",clearable:"",onChange:e[48]||(e[48]=S=>h("col.subLabel"))},null,8,["effect","disabled","placeholder","modelValue"])]}),_:1},8,["label","class"]),o(u,{label:s(r)("chart.aggregation"),class:g(["form-item","form-item-"+l.themes])},{default:m(()=>[o(w,{span:11},{default:m(()=>{var a;return[o(T,{effect:l.themes,modelValue:t.colSubTotalItem.dataeaseName,"onUpdate:modelValue":e[49]||(e[49]=S=>t.colSubTotalItem.dataeaseName=S),disabled:((a=l.chart.xAxisExt)==null?void 0:a.length)<2,placeholder:s(r)("chart.aggregation"),onChange:e[50]||(e[50]=S=>B(t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg))},{default:m(()=>[(i(!0),N(x,null,I(l.chart.yAxis,S=>(i(),V(v,{key:S.dataeaseName,label:S.name,value:S.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","disabled","placeholder"])]}),_:1}),o(w,{span:t.colSubTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>{var a;return[o(T,{effect:l.themes,modelValue:t.colSubTotalItem.aggregation,"onUpdate:modelValue":e[51]||(e[51]=S=>t.colSubTotalItem.aggregation=S),disabled:((a=l.chart.xAxisExt)==null?void 0:a.length)<2,placeholder:s(r)("chart.aggregation"),onChange:e[52]||(e[52]=S=>z(t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg,"col.calcSubTotals.cfg"))},{default:m(()=>[(i(),N(x,null,I(G,S=>o(v,{key:S.value,label:S.name,value:S.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","disabled","placeholder"])]}),_:1},8,["span"]),t.colSubTotalItem.aggregation==="CUSTOM"?(i(),V(w,{key:0,span:2,offset:1},{default:m(()=>[o($,null,{default:m(()=>[o(L,{onClick:e[53]||(e[53]=a=>R(t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg,"col.calcSubTotals.cfg"))})]),_:1})]),_:1})):C("",!0)]),_:1},8,["label","class"])],512),[[U,A("col")&&t.tableTotalForm.col.showSubTotals]])]}),_:1},8,["model"]),o(ue,{modelValue:q.value,"onUpdate:modelValue":e[56]||(e[56]=M=>q.value=M),width:"1000px",title:"自定义聚合公式","close-on-click-modal":!1},{footer:m(()=>[o(W,{secondary:"",onClick:e[54]||(e[54]=M=>Q())},{default:m(()=>[c(b(s(r)("dataset.cancel")),1)]),_:1}),o(W,{type:"primary",onClick:e[55]||(e[55]=M=>se())},{default:m(()=>[c(b(s(r)("dataset.confirm")),1)]),_:1})]),default:m(()=>[o(Ue,{ref_key:"calcEdit",ref:j},null,512)]),_:1},8,["modelValue"])],64)}}});const It=Le(pe,[["__scopeId","data-v-bf57aa31"]]);export{It as default};

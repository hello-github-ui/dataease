import{g as ue,z as fe,w as ce,O as be,P as ge,r as Te,x as he,y as we,B as Se,d as ve,v as Fe,h as Ve,L as ye}from"./element-plus-secondary-0.0.0-dataease.js";import{d as Ne,w as xe,l as Ce,i as Z,r as H,b as Ie,ah as Ae,o as u,c as N,a0 as o,_ as m,Z as V,a4 as c,a2 as b,u as s,z as g,Y as C,W as k,X as U,a as M,M as x,ab as I,n as pe}from"./@vue-0.0.0-dataease.js";import{j as ke}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{b as K,L as Q}from"./chart-0.0.0-dataease.js";import Ue from"./CustomAggrEdit-0.0.0-dataease.js";import{e as O,z as _,A as ee,L as De}from"./lodash-es-0.0.0-dataease.js";import{_ as Ee}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./vue-router-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./icon_info_outlined-0.0.0-dataease.js";import"./icon_search-outline_outlined-0.0.0-dataease.js";import"./icon_adjustment_outlined-0.0.0-dataease.js";import"./icon_edit_outlined-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./CodeMirror-0.0.0-dataease2.js";import"./@codemirror-0.0.0-dataease.js";import"./@lezer-0.0.0-dataease.js";import"./style-mod-0.0.0-dataease.js";import"./crelt-0.0.0-dataease.js";import"./@marijn-0.0.0-dataease.js";import"./w3c-keyname-0.0.0-dataease.js";import"./codemirror-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./attr-0.0.0-dataease20.js";import"./field-list-0.0.0-dataease.js";const Le={key:1},$e={style:{display:"flex"}},Me={style:{flex:"1"}},Oe=Ne({__name:"TableTotalSelector",props:{chart:{type:Object,required:!0},themes:{type:String,default:"dark"},propertyInner:{type:Array}},emits:["onTableTotalChange"],setup(a,{emit:te}){const{t:r}=ke(),y=a;xe([()=>y.chart.customAttr.tableTotal,()=>y.chart.xAxis,()=>y.chart.yAxis],()=>{P()},{deep:!0});const G=[{name:r("chart.none"),value:"NONE"},{name:r("chart.sum"),value:"SUM"},{name:r("chart.avg"),value:"AVG"},{name:r("chart.max"),value:"MAX"},{name:r("chart.min"),value:"MIN"},{name:r("commons.custom"),value:"CUSTOM"}],t=Ce({tableTotalForm:O(Q),rowSubTotalItem:{},rowTotalItem:{},colSubTotalItem:{},colTotalItem:{},totalCfg:[],totalCfgAttr:"",totalItem:{},selectedSubTotalDimensionName:"",selectedSubTotalDimension:void 0,subTotalDimensionList:[],basicStyleForm:JSON.parse(JSON.stringify(K))});function le(n){t.selectedSubTotalDimension=_(t.subTotalDimensionList,e=>e.name===n)}function J(){const n=[];for(let e=0;e<t.subTotalDimensionList.length;e++)t.subTotalDimensionList[e].checked&&n.push(t.subTotalDimensionList[e].name);t.tableTotalForm.row.subTotalsDimensions=n,h("row")}const ae=()=>{var f;const n=[];if(y.chart.xAxis.length>=2)for(let i=0;i<y.chart.xAxis.length-1;i++){const d=De(t.tableTotalForm.row.subTotalsDimensions,y.chart.xAxis[i].dataeaseName);n.push({displayName:y.chart.xAxis[i].name,name:y.chart.xAxis[i].dataeaseName,checked:t.tableTotalForm.row.subTotalsDimensionsNew?d:!0})}t.subTotalDimensionList=n;const e=_(t.subTotalDimensionList,i=>i.name===t.selectedSubTotalDimensionName);e?t.selectedSubTotalDimension=e:(t.selectedSubTotalDimensionName=(f=n[0])==null?void 0:f.name,t.selectedSubTotalDimension=n[0]),t.tableTotalForm.row.subTotalsDimensionsNew||(t.tableTotalForm.row.subTotalsDimensionsNew=!0,J())},oe=te,h=n=>{oe("onTableTotalChange",t.tableTotalForm,n)},P=()=>{var F,p,D;const n=(p=(F=y.chart)==null?void 0:F.customAttr)==null?void 0:p.tableTotal;n&&(n.row&&(n.row.subTotalsDimensionsNew=!!((D=n.row)!=null&&D.subTotalsDimensionsNew)),t.tableTotalForm=ee(O(n),O(Q)));const e=y.chart.yAxis;if((e==null?void 0:e.length)>0){const v=e.map(T=>T.dataeaseName);v.indexOf(t.tableTotalForm.row.totalSortField)===-1&&(t.tableTotalForm.row.totalSortField=e[0].dataeaseName),v.indexOf(t.tableTotalForm.col.totalSortField)===-1&&(t.tableTotalForm.col.totalSortField=e[0].dataeaseName)}else t.tableTotalForm.row.totalSortField="",t.tableTotalForm.col.totalSortField="";[{...t.tableTotalForm.row.calcTotals},{...t.tableTotalForm.row.calcSubTotals},{...t.tableTotalForm.col.calcTotals},{...t.tableTotalForm.col.calcSubTotals}].forEach(v=>{me(v.cfg,e)}),[[t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg],[t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg],[t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg],[t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg]].forEach(v=>{const[T,w]=v;if(!w.length){T.dataeaseName="",T.aggregation="",T.originName="";return}const E=w.findIndex(L=>L.dataeaseName===T.dataeaseName);E!==-1?T.aggregation=w[E].aggregation:(T.dataeaseName=w[0].dataeaseName,T.aggregation=w[0].aggregation,T.originName=w[0].originName)});const d=O(y.chart.customAttr.basicStyle);t.basicStyleForm=ee(d,O(K)),ae()},A=n=>{var e;return(e=y.propertyInner)==null?void 0:e.includes(n)},B=(n,e)=>{for(let f=0;f<e.length;f++){const i=e[f];if(i.dataeaseName===n.dataeaseName){n.aggregation=i.aggregation,n.originName=i.originName;return}}},z=(n,e,f)=>{for(let i=0;i<e.length;i++){const d=e[i];if(d.dataeaseName===n.dataeaseName){d.aggregation=n.aggregation;break}}n.aggregation=="CUSTOM"&&!n.originName||h(f)},me=(n,e)=>{if(!n.length){e.forEach(i=>{n.push({dataeaseName:i.dataeaseName,aggregation:"SUM"})});return}if(!e.length){n.splice(0,n.length);return}const f=n.reduce((i,d)=>(i[d.dataeaseName]=d,i),{});n.splice(0,n.length),e.forEach(i=>{n.push({dataeaseName:i.dataeaseName,aggregation:f[i.dataeaseName]?f[i.dataeaseName].aggregation:"SUM",originName:f[i.dataeaseName]?f[i.dataeaseName].originName:""})})},X=Z("quota",()=>[]),re=Z("dimension",()=>[]),j=H(),q=H(!1),R=(n,e,f)=>{q.value=!0,t.totalCfg=e,t.totalCfgAttr=f,t.totalItem=n,pe(()=>{j.value.initEdit(n,X().filter(i=>i.id!=="-1"))})},Y=()=>{q.value=!1},se=()=>{var e;j.value.setFieldForm();const n=O(j.value.fieldForm);(e=t.totalCfg)==null||e.forEach(f=>{f.dataeaseName===n.dataeaseName&&(f.originName=n.originName,ne(f),t.totalItem.originName=f.originName)}),Y(),h(t.totalCfgAttr)},ne=n=>{n.extField=2,n.chartId=y.chart.id,n.datasetGroupId=y.chart.tableId,n.lastSyncTime=null,n.columnIndex=re().length+X().length,n.deExtractType=n.deType};return Ie(()=>{P()}),(n,e)=>{const f=ue,i=fe,d=ce,F=be,p=ge,D=Te,v=he,T=we,w=Se,E=Ae("Setting"),L=ve,ie=Fe,W=Ve,de=ye;return u(),N(x,null,[o(ie,{ref:"tableTotalForm",model:t.tableTotalForm,"label-position":"top"},{default:m(()=>{var $;return[A("row")?(u(),V(f,{key:0,"content-position":"center",class:g("divider-style-"+a.themes)},{default:m(()=>[c(b(s(r)("chart.row_cfg")),1)]),_:1},8,["class"])):C("",!0),k(o(d,{label:s(r)("chart.total_show"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(i,{effect:a.themes,modelValue:t.tableTotalForm.row.showGrandTotals,"onUpdate:modelValue":e[0]||(e[0]=l=>t.tableTotalForm.row.showGrandTotals=l),onChange:e[1]||(e[1]=l=>h("row.showGrandTotals"))},{default:m(()=>[c(b(s(r)("chart.show")),1)]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),[[U,A("row")]]),k(M("div",null,[o(d,{label:s(r)("chart.total_position"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(p,{effect:a.themes,modelValue:t.tableTotalForm.row.reverseLayout,"onUpdate:modelValue":e[2]||(e[2]=l=>t.tableTotalForm.row.reverseLayout=l),onChange:e[3]||(e[3]=l=>h("row.reverseLayout"))},{default:m(()=>[o(F,{effect:a.themes,label:!0},{default:m(()=>[c(b(s(r)("chart.total_pos_top")),1)]),_:1},8,["effect"]),o(F,{effect:a.themes,label:!1},{default:m(()=>[c(b(s(r)("chart.total_pos_bottom")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),o(d,{label:s(r)("chart.total_label"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(D,{effect:a.themes,placeholder:s(r)("chart.total_label"),size:"small",maxlength:"20",modelValue:t.tableTotalForm.row.label,"onUpdate:modelValue":e[4]||(e[4]=l=>t.tableTotalForm.row.label=l),clearable:"",onChange:e[5]||(e[5]=l=>h("row.label"))},null,8,["effect","placeholder","modelValue"])]),_:1},8,["label","class"]),o(d,{label:s(r)("chart.aggregation"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(w,{span:11},{default:m(()=>[o(T,{effect:a.themes,modelValue:t.rowTotalItem.dataeaseName,"onUpdate:modelValue":e[6]||(e[6]=l=>t.rowTotalItem.dataeaseName=l),placeholder:s(r)("chart.aggregation"),onChange:e[7]||(e[7]=l=>B(t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg))},{default:m(()=>[(u(!0),N(x,null,I(a.chart.yAxis,l=>(u(),V(v,{key:l.dataeaseName,label:l.name,value:l.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1}),o(w,{span:t.rowTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>[o(T,{effect:a.themes,modelValue:t.rowTotalItem.aggregation,"onUpdate:modelValue":e[8]||(e[8]=l=>t.rowTotalItem.aggregation=l),placeholder:s(r)("chart.aggregation"),onChange:e[9]||(e[9]=l=>z(t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg,"row.calcTotals.cfg"))},{default:m(()=>[(u(),N(x,null,I(G,l=>o(v,{key:l.value,label:l.name,value:l.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["span"]),t.rowTotalItem.aggregation==="CUSTOM"?(u(),V(w,{key:0,span:2,offset:1},{default:m(()=>[o(L,null,{default:m(()=>[o(E,{onClick:e[10]||(e[10]=l=>R(t.rowTotalItem,t.tableTotalForm.row.calcTotals.cfg,"row.calcTotals.cfg"))})]),_:1})]),_:1})):C("",!0)]),_:1},8,["label","class"]),a.chart.type==="table-pivot"?(u(),V(d,{key:0,label:s(r)("chart.total_sort"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(p,{effect:a.themes,modelValue:t.tableTotalForm.row.totalSort,"onUpdate:modelValue":e[11]||(e[11]=l=>t.tableTotalForm.row.totalSort=l),onChange:e[12]||(e[12]=l=>h("row.totalSort"))},{default:m(()=>[o(F,{effect:a.themes,label:"none"},{default:m(()=>[c(b(s(r)("chart.total_sort_none")),1)]),_:1},8,["effect"]),o(F,{effect:a.themes,label:"asc"},{default:m(()=>[c(b(s(r)("chart.total_sort_asc")),1)]),_:1},8,["effect"]),o(F,{effect:a.themes,label:"desc"},{default:m(()=>[c(b(s(r)("chart.total_sort_desc")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"])):C("",!0),a.chart.type==="table-pivot"&&t.tableTotalForm.row.totalSort!=="none"?(u(),V(d,{key:1,label:s(r)("chart.total_sort_field"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(T,{effect:a.themes,modelValue:t.tableTotalForm.row.totalSortField,"onUpdate:modelValue":e[13]||(e[13]=l=>t.tableTotalForm.row.totalSortField=l),class:"form-item-select",placeholder:s(r)("chart.total_sort_field"),onChange:e[14]||(e[14]=l=>h("row.totalSortField"))},{default:m(()=>[(u(!0),N(x,null,I(a.chart.yAxis,l=>(u(),V(v,{key:l.dataeaseName,label:l.name,value:l.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["label","class"])):C("",!0)],512),[[U,A("row")&&t.tableTotalForm.row.showGrandTotals]]),k(o(d,{label:s(r)("chart.sub_total_show"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(i,{effect:a.themes,modelValue:t.tableTotalForm.row.showSubTotals,"onUpdate:modelValue":e[15]||(e[15]=l=>t.tableTotalForm.row.showSubTotals=l),disabled:a.chart.xAxis.length<2,onChange:e[16]||(e[16]=l=>h("row"))},{default:m(()=>[c(b(s(r)("chart.show")),1)]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["label","class"]),[[U,A("row")]]),A("row")&&t.tableTotalForm.row.showSubTotals?(u(),N("div",Le,[M("div",$e,[e[57]||(e[57]=M("div",{style:{width:"22px","flex-direction":"row"}},null,-1)),M("div",Me,[o(d,{class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(T,{effect:a.themes,modelValue:t.selectedSubTotalDimensionName,"onUpdate:modelValue":e[17]||(e[17]=l=>t.selectedSubTotalDimensionName=l),disabled:a.chart.xAxis.length<2||t.basicStyleForm.tableLayoutMode==="tree",onChange:le},{default:m(()=>[(u(!0),N(x,null,I(t.subTotalDimensionList,l=>(u(),V(v,{key:l.name,label:l.displayName,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["class"]),t.selectedSubTotalDimension?(u(),V(d,{key:0,class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(i,{effect:a.themes,modelValue:t.selectedSubTotalDimension.checked,"onUpdate:modelValue":e[18]||(e[18]=l=>t.selectedSubTotalDimension.checked=l),disabled:a.chart.xAxis.length<2||t.basicStyleForm.tableLayoutMode==="tree",onChange:J},{default:m(()=>[c(b(s(r)("chart.show")),1)]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["class"])):C("",!0)])]),o(d,{label:s(r)("chart.total_position"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(p,{effect:a.themes,modelValue:t.tableTotalForm.row.reverseSubLayout,"onUpdate:modelValue":e[19]||(e[19]=l=>t.tableTotalForm.row.reverseSubLayout=l),disabled:a.chart.xAxis.length<2||t.basicStyleForm.tableLayoutMode==="tree",onChange:e[20]||(e[20]=l=>h("row"))},{default:m(()=>[o(F,{effect:a.themes,label:!0},{default:m(()=>[c(b(s(r)("chart.total_pos_top")),1)]),_:1},8,["effect"]),o(F,{effect:a.themes,label:!1},{default:m(()=>[c(b(s(r)("chart.total_pos_bottom")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["label","class"]),o(d,{label:s(r)("chart.total_label"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(D,{effect:a.themes,disabled:a.chart.xAxis.length<2,placeholder:s(r)("chart.total_label"),modelValue:t.tableTotalForm.row.subLabel,"onUpdate:modelValue":e[21]||(e[21]=l=>t.tableTotalForm.row.subLabel=l),size:"small",maxlength:"20",clearable:"",onChange:e[22]||(e[22]=l=>h("row.subLabel"))},null,8,["effect","disabled","placeholder","modelValue"])]),_:1},8,["label","class"]),o(d,{label:s(r)("chart.aggregation"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(w,{span:11},{default:m(()=>[o(T,{effect:a.themes,modelValue:t.rowSubTotalItem.dataeaseName,"onUpdate:modelValue":e[23]||(e[23]=l=>t.rowSubTotalItem.dataeaseName=l),disabled:a.chart.xAxis.length<2,placeholder:s(r)("chart.aggregation"),onChange:e[24]||(e[24]=l=>B(t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg))},{default:m(()=>[(u(!0),N(x,null,I(a.chart.yAxis,l=>(u(),V(v,{key:l.dataeaseName,label:l.name,value:l.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","disabled","placeholder"])]),_:1}),o(w,{span:t.rowSubTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>[o(T,{effect:a.themes,modelValue:t.rowSubTotalItem.aggregation,"onUpdate:modelValue":e[25]||(e[25]=l=>t.rowSubTotalItem.aggregation=l),disabled:a.chart.xAxis.length<2,placeholder:s(r)("chart.aggregation"),onChange:e[26]||(e[26]=l=>z(t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg,"row"))},{default:m(()=>[(u(),N(x,null,I(G,l=>o(v,{key:l.value,label:l.name,value:l.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","disabled","placeholder"])]),_:1},8,["span"]),t.rowSubTotalItem.aggregation==="CUSTOM"?(u(),V(w,{key:0,span:2,offset:1},{default:m(()=>[o(L,null,{default:m(()=>[o(E,{onClick:e[27]||(e[27]=l=>R(t.rowSubTotalItem,t.tableTotalForm.row.calcSubTotals.cfg,"row.calcSubTotals.cfg"))})]),_:1})]),_:1})):C("",!0)]),_:1},8,["label","class"])])):C("",!0),A("col")?(u(),V(f,{key:2,"content-position":"center",class:g("divider-style-"+a.themes)},{default:m(()=>[c(b(s(r)("chart.col_cfg")),1)]),_:1},8,["class"])):C("",!0),k(o(d,{label:s(r)("chart.total_show"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(i,{effect:a.themes,modelValue:t.tableTotalForm.col.showGrandTotals,"onUpdate:modelValue":e[28]||(e[28]=l=>t.tableTotalForm.col.showGrandTotals=l),onChange:e[29]||(e[29]=l=>h("col"))},{default:m(()=>[c(b(s(r)("chart.show")),1)]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),[[U,A("col")]]),k(M("div",null,[o(d,{label:s(r)("chart.total_position"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(p,{effect:a.themes,modelValue:t.tableTotalForm.col.reverseLayout,"onUpdate:modelValue":e[30]||(e[30]=l=>t.tableTotalForm.col.reverseLayout=l),onChange:e[31]||(e[31]=l=>h("col"))},{default:m(()=>[o(F,{effect:a.themes,label:!0},{default:m(()=>[c(b(s(r)("chart.total_pos_left")),1)]),_:1},8,["effect"]),o(F,{effect:a.themes,label:!1},{default:m(()=>[c(b(s(r)("chart.total_pos_right")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"]),o(d,{label:s(r)("chart.total_label"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(D,{effect:a.themes,placeholder:s(r)("chart.total_label"),size:"small",maxlength:"20",modelValue:t.tableTotalForm.col.label,"onUpdate:modelValue":e[32]||(e[32]=l=>t.tableTotalForm.col.label=l),clearable:"",onBlur:e[33]||(e[33]=l=>h("col.label"))},null,8,["effect","placeholder","modelValue"])]),_:1},8,["label","class"]),o(d,{label:s(r)("chart.aggregation"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(w,{span:11},{default:m(()=>[o(T,{effect:a.themes,modelValue:t.colTotalItem.dataeaseName,"onUpdate:modelValue":e[34]||(e[34]=l=>t.colTotalItem.dataeaseName=l),placeholder:s(r)("chart.aggregation"),onChange:e[35]||(e[35]=l=>B(t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg))},{default:m(()=>[(u(!0),N(x,null,I(a.chart.yAxis,l=>(u(),V(v,{key:l.dataeaseName,label:l.name,value:l.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1}),o(w,{span:t.colTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>[o(T,{effect:a.themes,modelValue:t.colTotalItem.aggregation,"onUpdate:modelValue":e[36]||(e[36]=l=>t.colTotalItem.aggregation=l),placeholder:s(r)("chart.aggregation"),onChange:e[37]||(e[37]=l=>z(t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg,"col.calcTotals.cfg"))},{default:m(()=>[(u(),N(x,null,I(G,l=>o(v,{key:l.value,label:l.name,value:l.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["span"]),t.colTotalItem.aggregation==="CUSTOM"?(u(),V(w,{key:0,span:2,offset:1},{default:m(()=>[o(L,null,{default:m(()=>[o(E,{onClick:e[38]||(e[38]=l=>R(t.colTotalItem,t.tableTotalForm.col.calcTotals.cfg,"col.calcTotals.cfg"))})]),_:1})]),_:1})):C("",!0)]),_:1},8,["label","class"]),a.chart.type==="table-pivot"?(u(),V(d,{key:0,label:s(r)("chart.total_sort"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(p,{effect:a.themes,modelValue:t.tableTotalForm.col.totalSort,"onUpdate:modelValue":e[39]||(e[39]=l=>t.tableTotalForm.col.totalSort=l),onChange:e[40]||(e[40]=l=>h("col"))},{default:m(()=>[o(F,{effect:a.themes,label:"none"},{default:m(()=>[c(b(s(r)("chart.total_sort_none")),1)]),_:1},8,["effect"]),o(F,{effect:a.themes,label:"asc"},{default:m(()=>[c(b(s(r)("chart.total_sort_asc")),1)]),_:1},8,["effect"]),o(F,{effect:a.themes,label:"desc"},{default:m(()=>[c(b(s(r)("chart.total_sort_desc")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue"])]),_:1},8,["label","class"])):C("",!0),k(o(d,{label:s(r)("chart.total_sort_field"),class:"form-item"},{default:m(()=>[o(T,{effect:a.themes,modelValue:t.tableTotalForm.col.totalSortField,"onUpdate:modelValue":e[41]||(e[41]=l=>t.tableTotalForm.col.totalSortField=l),class:"form-item-select",placeholder:s(r)("chart.total_sort_field"),onChange:e[42]||(e[42]=l=>h("col"))},{default:m(()=>[(u(!0),N(x,null,I(a.chart.yAxis,l=>(u(),V(v,{key:l.dataeaseName,label:l.name,value:l.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","placeholder"])]),_:1},8,["label"]),[[U,a.chart.type==="table-pivot"&&(($=t.tableTotalForm.col)==null?void 0:$.totalSort)!=="none"]])],512),[[U,A("col")&&t.tableTotalForm.col.showGrandTotals]]),k(o(d,{label:s(r)("chart.sub_total_show"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(i,{effect:a.themes,modelValue:t.tableTotalForm.col.showSubTotals,"onUpdate:modelValue":e[43]||(e[43]=l=>t.tableTotalForm.col.showSubTotals=l),disabled:a.chart.xAxisExt.length<2,onChange:e[44]||(e[44]=l=>h("col"))},{default:m(()=>[c(b(s(r)("chart.show")),1)]),_:1},8,["effect","modelValue","disabled"])]),_:1},8,["label","class"]),[[U,A("col")]]),k(M("div",null,[o(d,{label:s(r)("chart.total_position"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>{var l;return[o(p,{effect:a.themes,modelValue:t.tableTotalForm.col.reverseSubLayout,"onUpdate:modelValue":e[45]||(e[45]=S=>t.tableTotalForm.col.reverseSubLayout=S),disabled:((l=a.chart.xAxisExt)==null?void 0:l.length)<2,onChange:e[46]||(e[46]=S=>h("col"))},{default:m(()=>[o(F,{effect:a.themes,label:!0},{default:m(()=>[c(b(s(r)("chart.total_pos_left")),1)]),_:1},8,["effect"]),o(F,{effect:a.themes,label:!1},{default:m(()=>[c(b(s(r)("chart.total_pos_right")),1)]),_:1},8,["effect"])]),_:1},8,["effect","modelValue","disabled"])]}),_:1},8,["label","class"]),o(d,{label:s(r)("chart.total_label"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>{var l;return[o(D,{effect:a.themes,disabled:((l=a.chart.xAxisExt)==null?void 0:l.length)<2,placeholder:s(r)("chart.total_label"),modelValue:t.tableTotalForm.col.subLabel,"onUpdate:modelValue":e[47]||(e[47]=S=>t.tableTotalForm.col.subLabel=S),size:"small",maxlength:"20",clearable:"",onChange:e[48]||(e[48]=S=>h("col.subLabel"))},null,8,["effect","disabled","placeholder","modelValue"])]}),_:1},8,["label","class"]),o(d,{label:s(r)("chart.aggregation"),class:g(["form-item","form-item-"+a.themes])},{default:m(()=>[o(w,{span:11},{default:m(()=>{var l;return[o(T,{effect:a.themes,modelValue:t.colSubTotalItem.dataeaseName,"onUpdate:modelValue":e[49]||(e[49]=S=>t.colSubTotalItem.dataeaseName=S),disabled:((l=a.chart.xAxisExt)==null?void 0:l.length)<2,placeholder:s(r)("chart.aggregation"),onChange:e[50]||(e[50]=S=>B(t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg))},{default:m(()=>[(u(!0),N(x,null,I(a.chart.yAxis,S=>(u(),V(v,{key:S.dataeaseName,label:S.name,value:S.dataeaseName},null,8,["label","value"]))),128))]),_:1},8,["effect","modelValue","disabled","placeholder"])]}),_:1}),o(w,{span:t.colSubTotalItem.aggregation==="CUSTOM"?8:11,offset:2},{default:m(()=>{var l;return[o(T,{effect:a.themes,modelValue:t.colSubTotalItem.aggregation,"onUpdate:modelValue":e[51]||(e[51]=S=>t.colSubTotalItem.aggregation=S),disabled:((l=a.chart.xAxisExt)==null?void 0:l.length)<2,placeholder:s(r)("chart.aggregation"),onChange:e[52]||(e[52]=S=>z(t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg,"col.calcSubTotals.cfg"))},{default:m(()=>[(u(),N(x,null,I(G,S=>o(v,{key:S.value,label:S.name,value:S.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue","disabled","placeholder"])]}),_:1},8,["span"]),t.colSubTotalItem.aggregation==="CUSTOM"?(u(),V(w,{key:0,span:2,offset:1},{default:m(()=>[o(L,null,{default:m(()=>[o(E,{onClick:e[53]||(e[53]=l=>R(t.colSubTotalItem,t.tableTotalForm.col.calcSubTotals.cfg,"col.calcSubTotals.cfg"))})]),_:1})]),_:1})):C("",!0)]),_:1},8,["label","class"])],512),[[U,A("col")&&t.tableTotalForm.col.showSubTotals]])]}),_:1},8,["model"]),o(de,{modelValue:q.value,"onUpdate:modelValue":e[56]||(e[56]=$=>q.value=$),width:"1000px",title:"自定义聚合公式","close-on-click-modal":!1},{footer:m(()=>[o(W,{secondary:"",onClick:e[54]||(e[54]=$=>Y())},{default:m(()=>[c(b(s(r)("dataset.cancel")),1)]),_:1}),o(W,{type:"primary",onClick:e[55]||(e[55]=$=>se())},{default:m(()=>[c(b(s(r)("dataset.confirm")),1)]),_:1})]),default:m(()=>[o(Ue,{ref_key:"calcEdit",ref:j},null,512)]),_:1},8,["modelValue"])],64)}}});const al=Ee(Oe,[["__scopeId","data-v-bf57aa31"]]);export{al as default};

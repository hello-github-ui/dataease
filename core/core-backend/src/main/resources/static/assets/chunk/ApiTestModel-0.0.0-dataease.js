import{P as be,J as B,I as we,d as Z,ag as Ee,r as f,G as b,o as Ae,f as $,g as Oe,i as v,M as x,U as V,j as a,V as z,k,L as W,Y as Se,a9 as $e,$ as w,a5 as Ve,a6 as ke,a4 as Te,ac as E,ab as J,aw as Ne,n as Fe,H as C}from"./vue-0.0.0-dataease.js";import{i as Ie,o as X,f as Pe,ah as _e,M as Be,P as We,t as Ce,w as De}from"./index-0.0.0-dataease.js";import{a8 as T,an as K,ak as ee,I as Ke,a9 as Me,j as Re,G as Le}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{b as je,g as Ue,E as He}from"./index-0.0.0-dataease3.js";import{e as Ge}from"./lodash-0.0.0-dataease.js";const Ye=Ie({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:X(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:X([Function,Array]),default:be},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},label:{type:String},teleported:je.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1}}),qe={[T]:o=>B(o),[K]:o=>B(o),[ee]:o=>B(o),focus:o=>o instanceof FocusEvent,blur:o=>o instanceof FocusEvent,clear:()=>!0,select:o=>we(o)},xe=["aria-expanded","aria-owns"],ze={key:0},Je=["id","aria-selected","onClick"],te="ElAutocomplete",Xe=Z({name:te,inheritAttrs:!1}),Qe=Z({...Xe,props:Ye,emits:qe,setup(o,{expose:t,emit:n}){const s=o,N=Ke(),ae=Ee(),le=Me(),c=Pe("autocomplete"),i=f(),M=f(),R=f(),L=f();let j=!1,A=!1;const d=f([]),r=f(-1),U=f(""),p=f(!1),O=f(!1),g=f(!1),y=b(()=>c.b(String(Ue()))),ne=b(()=>ae.style),h=b(()=>(d.value.length>0||g.value)&&p.value),H=b(()=>!s.hideLoading&&g.value),oe=b(()=>i.value?Array.from(i.value.$el.querySelectorAll("input")):[]),re=async()=>{await Fe(),h.value&&(U.value=`${i.value.$el.offsetWidth}px`)},ie=()=>{A=!0},ue=()=>{A=!1,r.value=-1},G=Ge(async e=>{if(O.value)return;const l=u=>{g.value=!1,!O.value&&(C(u)?(d.value=u,r.value=s.highlightFirstItem?0:-1):Ce(te,"autocomplete suggestions must be an array"))};if(g.value=!0,C(s.fetchSuggestions))l(s.fetchSuggestions);else{const u=await s.fetchSuggestions(e,l);C(u)&&l(u)}},s.debounce),ce=e=>{const l=!!e;if(n(K,e),n(T,e),O.value=!1,p.value||(p.value=l),!s.triggerOnFocus&&!e){O.value=!0,d.value=[];return}G(e)},de=e=>{var l;le.value||(((l=e.target)==null?void 0:l.tagName)!=="INPUT"||oe.value.includes(document.activeElement))&&(p.value=!0)},fe=e=>{n(ee,e)},pe=e=>{A||(p.value=!0,n("focus",e),s.triggerOnFocus&&!j&&G(String(s.modelValue)))},ve=e=>{A||n("blur",e)},he=()=>{p.value=!1,n(T,""),n("clear")},Y=async()=>{h.value&&r.value>=0&&r.value<d.value.length?F(d.value[r.value]):s.selectWhenUnmatched&&(n("select",{value:s.modelValue}),d.value=[],r.value=-1)},ge=e=>{h.value&&(e.preventDefault(),e.stopPropagation(),S())},S=()=>{p.value=!1},me=()=>{var e;(e=i.value)==null||e.focus()},ye=()=>{var e;(e=i.value)==null||e.blur()},F=async e=>{n(K,e[s.valueKey]),n(T,e[s.valueKey]),n("select",e),d.value=[],r.value=-1},I=e=>{if(!h.value||g.value)return;if(e<0){r.value=-1;return}e>=d.value.length&&(e=d.value.length-1);const l=M.value.querySelector(`.${c.be("suggestion","wrap")}`),m=l.querySelectorAll(`.${c.be("suggestion","list")} li`)[e],P=l.scrollTop,{offsetTop:q,scrollHeight:_}=m;q+_>P+l.clientHeight&&(l.scrollTop+=_),q<P&&(l.scrollTop-=_),r.value=e,i.value.ref.setAttribute("aria-activedescendant",`${y.value}-item-${r.value}`)};return _e(L,()=>{h.value&&S()}),Ae(()=>{i.value.ref.setAttribute("role","textbox"),i.value.ref.setAttribute("aria-autocomplete","list"),i.value.ref.setAttribute("aria-controls","id"),i.value.ref.setAttribute("aria-activedescendant",`${y.value}-item-${r.value}`),j=i.value.ref.hasAttribute("readonly")}),t({highlightedIndex:r,activated:p,loading:g,inputRef:i,popperRef:R,suggestions:d,handleSelect:F,handleKeyEnter:Y,focus:me,blur:ye,close:S,highlight:I}),(e,l)=>($(),Oe(a(He),{ref_key:"popperRef",ref:R,visible:a(h),placement:e.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[a(c).e("popper"),e.popperClass],teleported:e.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${a(c).namespace.value}-zoom-in-top`,persistent:"",onBeforeShow:re,onShow:ie,onHide:ue},{content:v(()=>[x("div",{ref_key:"regionRef",ref:M,class:V([a(c).b("suggestion"),a(c).is("loading",a(H))]),style:z({[e.fitInputWidth?"width":"minWidth"]:U.value,outline:"none"}),role:"region"},[k(a(Be),{id:a(y),tag:"ul","wrap-class":a(c).be("suggestion","wrap"),"view-class":a(c).be("suggestion","list"),role:"listbox"},{default:v(()=>[a(H)?($(),W("li",ze,[k(a(Re),{class:V(a(c).is("loading"))},{default:v(()=>[k(a(We))]),_:1},8,["class"])])):($(!0),W(Se,{key:1},$e(d.value,(u,m)=>($(),W("li",{id:`${a(y)}-item-${m}`,key:m,class:V({highlighted:r.value===m}),role:"option","aria-selected":r.value===m,onClick:P=>F(u)},[w(e.$slots,"default",{item:u},()=>[Ve(ke(u[e.valueKey]),1)])],10,Je))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:v(()=>[x("div",{ref_key:"listboxRef",ref:L,class:V([a(c).b(),e.$attrs.class]),style:z(a(ne)),role:"combobox","aria-haspopup":"listbox","aria-expanded":a(h),"aria-owns":a(y)},[k(a(Le),Te({ref_key:"inputRef",ref:i},a(N),{"model-value":e.modelValue,onInput:ce,onChange:fe,onFocus:pe,onBlur:ve,onClear:he,onKeydown:[l[0]||(l[0]=E(J(u=>I(r.value-1),["prevent"]),["up"])),l[1]||(l[1]=E(J(u=>I(r.value+1),["prevent"]),["down"])),E(Y,["enter"]),E(S,["tab"]),E(ge,["esc"])],onMousedown:de}),Ne({_:2},[e.$slots.prepend?{name:"prepend",fn:v(()=>[w(e.$slots,"prepend")])}:void 0,e.$slots.append?{name:"append",fn:v(()=>[w(e.$slots,"append")])}:void 0,e.$slots.prefix?{name:"prefix",fn:v(()=>[w(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:v(()=>[w(e.$slots,"suffix")])}:void 0]),1040,["model-value","onKeydown"])],14,xe)]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}}),nt=De(Qe);class se{set(t,n){t=this.initOptions(t);for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(this[s]instanceof Array||(n===!0?this[s]=t[s]===void 0?this[s]:t[s]:this[s]=t[s]))}sets(t,n){if(n=this.initOptions(n),t)for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&Object.prototype.hasOwnProperty.call(n,s)&&n[s].forEach(N=>{this[s].push(new t[s](N))})}initOptions(t){return t||{}}isValid(){return!0}}class Q extends se{constructor(t){t=t||{},t.enable=t.enable===void 0?!0:t.enable,super(),this.name=void 0,this.value=void 0,this.type=void 0,this.files=void 0,this.enable=void 0,this.uuid=void 0,this.time=void 0,this.contentType=void 0,this.set(t)}isValid(){return(!!this.name||!!this.value)&&this.type!=="file"}isFile(){return(!!this.name||!!this.value)&&this.type==="file"}}class ot extends se{constructor(t){super(),this.type="KeyValue",this.raw=void 0,this.kvs=[],this.binary=[],this.set(t),this.sets({kvs:Q},{binary:Q},t)}isValid(){return this.isKV()?this.kvs.some(t=>t.isValid()):!!this.raw}isKV(){return[D.FORM_DATA,D.WWW_FORM,D.BINARY].indexOf(this.type)>0}}const D={KV:"KeyValue",FORM_DATA:"Form_Data",RAW:"Raw",WWW_FORM:"WWW_FORM",XML:"XML",JSON:"JSON"};export{D as B,nt as E,Q as K,ot as a};

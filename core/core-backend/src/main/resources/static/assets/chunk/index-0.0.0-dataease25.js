import{r as et,G as ot,d as rt,I as at,J as it}from"./element-plus-secondary-0.0.0-dataease.js";import{j as nt,h as st}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as lt}from"./dv-folder-0.0.0-dataease.js";import{i as mt}from"./icon_dashboard-0.0.0-dataease.js";import{i as z}from"./icon_right_outlined-0.0.0-dataease.js";import{i as ct}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{d as pt,a as dt}from"./dv-sort-desc-0.0.0-dataease.js";import{s as ut}from"./pinia-0.0.0-dataease.js";import{d as vt}from"./dvMain-0.0.0-dataease.js";import{a as _t}from"./index-0.0.0-dataease.js";import{t as ft}from"./treeSortUtils-0.0.0-dataease.js";import{i as ht}from"./interactive-0.0.0-dataease.js";import gt from"./DashboardCell-0.0.0-dataease.js";import{b as bt}from"./vue-router-0.0.0-dataease.js";import{d as kt,e as yt}from"./vant-0.0.0-dataease.js";import{e as k}from"./lodash-es-0.0.0-dataease.js";import{d as wt,r as f,k as Ct,w as Dt,j as Tt,b as It,o as l,c as d,a0 as a,_ as n,u as c,a as x,Y as g,M as D,ab as S,z as M,a2 as L,Z as T,a4 as Nt}from"./@vue-0.0.0-dataease.js";import{_ as xt}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./index-0.0.0-dataease12.js";import"./util-0.0.0-dataease2.js";import"./chart-0.0.0-dataease2.js";import"./app-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./mathjs-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./exceljs-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./@vant-0.0.0-dataease.js";const St={class:"mobile-dashboard"},Mt={key:0,class:"direct-name-arr"},Lt={class:"label primary-name"},Vt=["onClick"],Et={key:0,class:"dashboard-cell-group_filter"},Bt={key:0,class:"ed-dropdown-menu__item--divided"},Ft=wt({__name:"index",emits:["hiddenTabbar","setLoading"],setup(Ot,{emit:J}){const P=f(!1),R=f(!1),u=f([]),o=f([]),p=f([]),v=f(""),V=ht(),E=vt(),{dvInfo:I}=ut(E),{wsCache:s}=_t("sessionStorage"),{t:y}=nt(),B=(t,r)=>{const e=t.shift();return r.reduce((m,_)=>{if(e&&_.id===e){if(!t.length)return _.children||[];m=B([...t],_.children||[])||[]}return m},[])};let b=[];const U=Ct(()=>p.value.length?B([...p.value],u.value):u.value),F=J,W=()=>{o.value.pop(),v.value=o.value[o.value.length-1],p.value.pop(),o.value.length&&(u.value=k(b),F("hiddenTabbar",!1))},A=()=>{o.value=[],p.value=[],v.value=""},G=bt(),Y=t=>{s.set("directName",o.value),s.set("activeDirectName",v.value),s.set("activeTabbar","direct"),s.set("directId",p.value),G.push({path:"/panel/mobile",query:{dvId:t.id}})},w=f(""),h=f("time_desc"),Z=[{name:"按创建时间升序",value:"time_asc"},{name:"按创建时间降序",value:"time_desc",divided:!0},{name:"按照名称升序",value:"name_asc"},{name:"按照名称降序",value:"name_desc"}],O=t=>{u.value=ft(k(b),t),h.value=t},$=(t,r)=>t.filter(e=>{var m,_;return(m=e.name)!=null&&m.toLocaleLowerCase().includes(r.toLocaleLowerCase())?!0:(_=e.children)!=null&&_.length?(e.children=$(e.children,r),!!e.children.length):!1});Dt(w,t=>{u.value=$(k(b),t)});const H=t=>{if(w.value="",t.leaf){F("hiddenTabbar",!0),Y(t);return}o.value.push(t.name),v.value=t.name,p.value.push(t.id)},K=t=>{t!==p.value.length-1&&(p.value=p.value.slice(0,t+1),o.value=o.value.slice(0,t+1),v.value=o.value[o.value.length-1])},N=t=>t.filter(r=>{var e,m;return(e=r.children)!=null&&e.length&&(r.children=N(r.children)),r.extraFlag===1||((m=r.children)==null?void 0:m.length)}),Q=async()=>{const t={busiFlag:"dashboard"};await V.setInteractive(t);const r=V.getPanel,e=r.treeNodes;if(R.value=r.rootManage,P.value=r.anyManage,I.value&&I.value.id&&!JSON.stringify(e).includes(I.value.id)&&E.resetDvInfo(),e.length&&e[0].id==="0"&&e[0].name==="root"){u.value=N(e[0].children||[]),b=k(u.value),j();return}u.value=N(e),b=k(u.value),j()},j=()=>{const t=s.get("mobile-sort-type");O(t||h.value)};return Tt(()=>{s.set("mobile-sort-type",h.value)}),It(()=>{Q(),v.value=s.get("activeDirectName"),!(s.get("activeTabbar")!=="direct"||!v.value)&&(o.value=s.get("directName"),p.value=s.get("directId"),s.set("directName",[]),s.set("activeDirectName",""),s.set("directId",[]),s.set("activeTabbar",""))}),(t,r)=>{const e=st,m=rt,_=et,q=at,X=it,tt=ot;return l(),d("div",St,[a(c(yt),null,{default:n(()=>[a(c(kt),{"safe-area-inset-top":"",title:v.value||c(y)("work_branch.dashboard"),"left-arrow":!!v.value,onClickLeft:W},null,8,["title","left-arrow"]),o.value.length?(l(),d("div",Mt,[(l(),d("div",{onClick:A,key:c(y)("work_branch.dashboard")},[x("span",Lt,L(c(y)("work_branch.dashboard")),1),a(m,null,{default:n(()=>[a(e,{name:"icon_right_outlined"},{default:n(()=>[a(c(z),{class:"svg-icon"})]),_:1})]),_:1})])),(l(!0),d(D,null,S([...o.value],(i,C)=>(l(),d("div",{onClick:$t=>K(C),key:i},[x("span",{class:M(["label ellipsis",C!==o.value.length-1&&"primary-name"])},L(i),3),C!==o.value.length-1?(l(),T(m,{key:0},{default:n(()=>[a(e,{name:"icon_right_outlined"},{default:n(()=>[a(c(z),{class:"svg-icon"})]),_:1})]),_:1})):g("",!0)],8,Vt))),128))])):g("",!0)]),_:1}),x("div",{class:M([!!o.value.length&&"dashboard-cell-group-tab","dashboard-cell-group"])},[o.value.length?g("",!0):(l(),d("div",Et,[a(_,{placeholder:c(y)("commons.search"),modelValue:w.value,"onUpdate:modelValue":r[0]||(r[0]=i=>w.value=i),clearable:"",class:"search-bar"},{prefix:n(()=>[a(m,null,{default:n(()=>[a(e,{name:"icon_search-outline_outlined"},{default:n(()=>[a(c(ct),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["placeholder","modelValue"]),a(tt,{onCommand:O,trigger:"click"},{dropdown:n(()=>[a(X,{style:{width:"246px"}},{default:n(()=>[(l(),d(D,null,S(Z,i=>(l(),d(D,{key:i.value},[a(q,{class:M(["ed-select-dropdown__item",i.value===h.value&&"selected"]),command:i.value},{default:n(()=>[Nt(L(i.name),1)]),_:2},1032,["class","command"]),i.divided?(l(),d("li",Bt)):g("",!0)],64))),64))]),_:1})]),default:n(()=>[a(m,{class:"filter-icon-span"},{default:n(()=>[h.value.includes("asc")?(l(),T(e,{key:0,name:"dv-sort-asc",class:"opt-icon"},{default:n(()=>[a(c(pt),{class:"svg-icon opt-icon"})]),_:1})):g("",!0),h.value.includes("desc")?(l(),T(e,{key:1,name:"dv-sort-desc",class:"opt-icon"},{default:n(()=>[a(c(dt),{class:"svg-icon opt-icon"})]),_:1})):g("",!0)]),_:1})]),_:1})])),(l(!0),d(D,null,S(U.value,i=>(l(),T(gt,{key:i.id,onClick:C=>H(i),label:i.name,nextlevel:!i.leaf,"prefix-icon":i.leaf?c(mt):c(lt)},null,8,["onClick","label","nextlevel","prefix-icon"]))),128))],2)])}}});const sr=xt(Ft,[["__scopeId","data-v-59724517"]]);export{sr as default};

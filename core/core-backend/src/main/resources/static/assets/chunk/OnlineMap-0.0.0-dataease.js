import"./index-0.0.0-dataease.js";import"./el-footer-0.0.0-dataease.js";import"./el-aside-0.0.0-dataease.js";import"./el-main-0.0.0-dataease.js";import{o as A,D as N,G as T,y as D}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{E as L}from"./el-row-0.0.0-dataease.js";import{E as K}from"./el-col-0.0.0-dataease.js";import{d as O,Z as S,r as _,o as q,f as E,g as C,i as c,k as s,M as o,a6 as w,j as v,a5 as R,T as U,L as W,W as j,a0 as g,n as z}from"./vue-0.0.0-dataease.js";import{s as G,q as H}from"./sysParameter-0.0.0-dataease.js";import{E as P}from"./EmptyBackground-0.0.0-dataease.js";import{a as Z,b as $,c as F}from"./index-0.0.0-dataease14.js";import{_ as J}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";const Q={class:"geo-title"},X={class:"online-form-item"},Y={class:"map-item"},ee={class:"map-item"},oe={class:"map-item-label"},te={class:"form-label"},ae={class:"map-item"},ne=["id"],se=O({__name:"OnlineMap",setup(le){const{t:d}=A(),t=S({key:"",securityCode:""}),l=_(null),f=_(!1),m=_("de-map-container"),y=_(!1),V=()=>{if(!t.key)return;const a=`https://webapi.amap.com/maps?v=2.0&key=${t.key}`;B(a).then(()=>{var n;if(l.value){(n=l.value)==null||n.destroy(),l.value=null,f.value=!0,setTimeout(()=>{m.value=m.value+"-de-",f.value=!1,z(()=>{M()})},1500);return}M()}).catch(n=>{l.value&&(l.value.destroy(),l.value=null),console.error(n)})},M=()=>{l.value=new window.AMap.Map(m.value,{viewMode:"2D",zoom:11,center:[116.397428,39.90923]}),y.value=!0},x=()=>{G(t).then(()=>{N.success(d("commons.save_success")),b()}).catch(e=>{console.error(e)})},b=()=>{H().then(e=>{t.key=e.data.key,t.securityCode=e.data.securityCode,V()}).catch(e=>{console.error(e)})},B=e=>new Promise(function(a,n){var u;const p="de-gaode-script-id";let i=document.getElementById(p);i&&((u=i.parentElement)==null||u.removeChild(i),i=null,window.AMap=null);var r=document.createElement("script");r.id=p,r.onload=function(){return a(null)},r.onerror=function(){return n(new Error("Load script from ".concat(e," failed")))},r.src=e;var h=document.head||document.getElementsByTagName("head")[0];(document.body||h).appendChild(r)});return q(()=>{b()}),(e,a)=>{const n=T,p=K,i=L,r=D,h=Z,u=$,I=F;return E(),C(I,{class:"online-map-container"},{default:c(()=>[s(h,{width:"200px",class:"online-map-aside"},{default:c(()=>[o("div",Q,[o("span",null,w(v(d)("online_map.onlinemap")),1)]),s(i,null,{default:c(()=>[s(p,null,{default:c(()=>[o("div",X,[a[2]||(a[2]=o("div",{class:"map-item"},[o("div",{class:"map-item-label"},[o("span",{class:"form-label"},"Key")])],-1)),o("div",Y,[s(n,{modelValue:t.key,"onUpdate:modelValue":a[0]||(a[0]=k=>t.key=k)},null,8,["modelValue"])]),o("div",ee,[o("div",oe,[o("span",te,w(v(d)("chart.security_code")),1)])]),o("div",ae,[s(n,{modelValue:t.securityCode,"onUpdate:modelValue":a[1]||(a[1]=k=>t.securityCode=k)},null,8,["modelValue"])])])]),_:1})]),_:1}),s(i,null,{default:c(()=>[s(r,{type:"primary",disabled:!t.key,onClick:x},{default:c(()=>[R(w(v(d)("commons.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1}),s(u,null,{default:c(()=>[f.value?g("",!0):U((E(),W("div",{key:0,class:"de-map-container",id:m.value},null,8,ne)),[[j,y.value]]),y.value?g("",!0):(E(),C(P,{key:1,"img-type":"noneWhite",description:v(d)("online_map.empty_desc")},null,8,["description"]))]),_:1})]),_:1})}}});const Be=J(se,[["__scopeId","data-v-bfa0b21a"]]);export{Be as default};

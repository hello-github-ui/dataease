import{r as Y,B as Z,x as G,y as H,A as W,d as X,e as ee,M as le,o as te,h as ae}from"./element-plus-secondary-0.0.0-dataease.js";import{j as oe,h as ne}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{d as ie,l as se,k as q,b as re,o as r,c as h,a as b,M as g,ab as x,Z as m,_ as n,a0 as a,u as d,Y as V,$ as de,z as ue,a2 as U,a1 as O,a4 as pe}from"./@vue-0.0.0-dataease.js";import{i as ce}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as me}from"./icon_add_outlined-0.0.0-dataease.js";import{a as fe}from"./chart-0.0.0-dataease.js";import{f as k}from"./attr-0.0.0-dataease20.js";import{i as _e}from"./field-list-0.0.0-dataease.js";import{z as A}from"./lodash-es-0.0.0-dataease.js";import{_ as ye}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./vue-router-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";const he={style:{float:"left"}},ve={style:{float:"left",color:"#8492a6",fontSize:"12px"}},ge={class:"flex-align-center",style:{"margin-left":"-4px"}},xe=ie({__name:"AssistLineEdit",props:{chart:{type:Object,required:!0},line:{type:Array,required:!0},quotaFields:{type:Array,required:!0},quotaExtFields:{type:Array,required:!0},useQuotaExt:{type:Boolean,default:!1}},emits:["onAssistLineChange"],setup(y,{emit:z}){const{t:s}=oe(),i=y,L=[{type:"left",name:s("chart.drag_block_value_axis_left")},{type:"right",name:s("chart.drag_block_value_axis_right")}],p=se({lineArr:[],lineObj:{name:s("chart.assist_line"),field:"0",fieldId:"",summary:"avg",axis:"y",yAxisType:"left",value:"0",lineType:"solid",color:"#ff0000",curField:{},fontSize:"10"},fieldOptions:[{label:s("chart.field_fixed"),value:"0"},{label:s("chart.field_dynamic"),value:"1"}],lineOptions:[{label:s("chart.line_type_solid"),value:"solid"},{label:s("chart.line_type_dashed"),value:"dashed"},{label:s("chart.line_type_dotted"),value:"dotted"}],predefineColors:fe,fontSize:[]}),N=q(()=>{const l=[];for(let t=10;t<=60;t=t+2)l.push({name:t+"",value:t+""});return l}),S=z,Q=()=>{p.lineArr=JSON.parse(JSON.stringify(i.line)),p.lineArr.forEach(l=>{i.useQuotaExt?(l.yAxisType==="left"&&A(i.quotaFields,t=>t.id===l.fieldId)==null&&(l.fieldId=void 0),l.yAxisType==="right"&&A(i.quotaExtFields,t=>t.id===l.fieldId)==null&&(l.fieldId=void 0)):A(i.quotaFields,t=>t.id===l.fieldId)==null&&(l.fieldId=void 0)}),u()},w=()=>{var t;const l={...p.lineObj,curField:i.quotaFields?i.quotaFields[0]:null,fieldId:i.quotaFields?(t=i.quotaFields[0])==null?void 0:t.id:null};p.lineArr.push(JSON.parse(JSON.stringify(l))),u()},B=l=>{p.lineArr.splice(l,1),u()},$=l=>{var t,f;i.useQuotaExt&&l.yAxisType==="right"?(l.fieldId=i.quotaExtFields?(t=i.quotaExtFields[0])==null?void 0:t.id:null,l.curField=C(l.fieldId)):(l.fieldId=i.quotaFields?(f=i.quotaFields[0])==null?void 0:f.id:null,l.curField=F(l.fieldId)),u()},u=()=>{S("onAssistLineChange",p.lineArr)},j=l=>{i.useQuotaExt&&l.yAxisType==="right"?l.curField=C(l.fieldId):l.curField=F(l.fieldId),u()},F=l=>{if(!l)return{};const t=i.quotaFields.filter(f=>f.id===l);return t.length===0?{}:t[0]},C=l=>{if(!l)return{};const t=i.quotaExtFields.filter(f=>f.id===l);return t.length===0?{}:t[0]},M=q(()=>["percentage-bar-stack","percentage-bar-stack-horizontal"].includes(i.chart.type)?p.fieldOptions.filter(l=>l.value==="0"):p.fieldOptions);return re(()=>{Q()}),(l,t)=>{const f=Y,c=Z,_=G,v=H,J=W,E=ne,I=X,D=ee,K=le,P=te,R=ae;return r(),h("div",null,[b("div",{onKeydown:t[0]||(t[0]=O(()=>{},["stop"])),onKeyup:t[1]||(t[1]=O(()=>{},["stop"])),style:{"max-height":"50vh","margin-top":"-4px","overflow-y":"auto"}},[(r(!0),h(g,null,x(p.lineArr,(o,T)=>(r(),m(P,{key:T,class:"line-item",gutter:8},{default:n(()=>[a(c,{span:4},{default:n(()=>[a(f,{modelValue:o.name,"onUpdate:modelValue":e=>o.name=e,class:"value-item",style:{width:"100% !important"},placeholder:d(s)("chart.name"),clearable:"",onChange:u},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024),y.useQuotaExt?(r(),m(c,{key:0,span:3},{default:n(()=>[a(v,{modelValue:o.yAxisType,"onUpdate:modelValue":e=>o.yAxisType=e,class:"select-item",onChange:e=>$(o)},{default:n(()=>[(r(),h(g,null,x(L,e=>a(_,{key:e.type,label:e.name,value:e.type},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)):V("",!0),a(c,{span:3},{default:n(()=>[a(v,{modelValue:o.field,"onUpdate:modelValue":e=>o.field=e,class:"select-item",onChange:u},{default:n(()=>[(r(!0),h(g,null,x(M.value,e=>(r(),m(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),o.field==="0"?(r(),m(c,{key:1,span:7},{default:n(()=>[a(J,{modelValue:o.value,"onUpdate:modelValue":e=>o.value=e,"controls-position":"right",class:"value-item",placeholder:d(s)("chart.drag_block_label_value"),clearable:"",onChange:u},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)):V("",!0),o.field==="1"?(r(),m(c,{key:2,span:4},{default:n(()=>[a(v,{modelValue:o.fieldId,"onUpdate:modelValue":e=>o.fieldId=e,class:"select-item",placeholder:d(s)("chart.field"),onChange:e=>j(o)},{default:n(()=>[(r(!0),h(g,null,x(y.useQuotaExt&&o.yAxisType==="right"?y.quotaExtFields:y.quotaFields,e=>(r(),m(_,{key:e.id,label:e.name,value:e.id},{default:n(()=>[b("span",he,[a(I,null,{default:n(()=>[a(E,{className:`field-icon-${d(k)[o.deType]}`},{default:n(()=>[(r(),m(de(d(_e)[d(k)[o.deType]]),{class:ue(["svg-icon",`field-icon-${d(k)[o.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024)]),b("span",ve,U(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"])]),_:2},1024)):V("",!0),o.field==="1"?(r(),m(c,{key:3,span:3},{default:n(()=>[a(v,{modelValue:o.summary,"onUpdate:modelValue":e=>o.summary=e,class:"select-item",placeholder:d(s)("chart.aggregation"),onChange:u},{default:n(()=>[a(_,{key:"avg",value:"avg",label:"平均值"}),a(_,{key:"max",value:"max",label:d(s)("chart.max")},null,8,["label"]),a(_,{key:"min",value:"min",label:d(s)("chart.min")},null,8,["label"])]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)):V("",!0),a(c,{span:y.useQuotaExt?2:3},{default:n(()=>[a(D,{effect:"dark",content:d(s)("chart.font_size"),placement:"top"},{default:n(()=>[a(v,{modelValue:o.fontSize,"onUpdate:modelValue":e=>o.fontSize=e,class:"select-item",placeholder:d(s)("chart.text_fontsize"),onChange:u},{default:n(()=>[(r(!0),h(g,null,x(N.value,e=>(r(),m(_,{key:e.value,label:e.name,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["content"])]),_:2},1032,["span"]),a(c,{span:y.useQuotaExt?2:4},{default:n(()=>[a(v,{modelValue:o.lineType,"onUpdate:modelValue":e=>o.lineType=e,class:"select-item",onChange:u},{default:n(()=>[(r(!0),h(g,null,x(p.lineOptions,e=>(r(),m(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["span"]),a(c,{span:2,style:{"text-align":"center"}},{default:n(()=>[a(K,{"is-custom":"",size:"large",modelValue:o.color,"onUpdate:modelValue":e=>o.color=e,class:"color-picker-style",predefine:p.predefineColors,onChange:u},null,8,["modelValue","onUpdate:modelValue","predefine"])]),_:2},1024),a(c,{span:1},{default:n(()=>[b("div",ge,[a(I,{style:{width:"28px !important",height:"28px !important","font-size":"20px !important"},class:"hover-icon",onClick:e=>B(T)},{default:n(()=>[a(E,{name:"icon_delete-trash_outlined"},{default:n(()=>[a(d(ce),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))],32),a(R,{class:"circle-button",text:"",style:{"margin-left":"5px"},onClick:w},{icon:n(()=>[a(E,{name:"icon_add_outlined"},{default:n(()=>[a(d(me),{class:"svg-icon"})]),_:1})]),default:n(()=>[pe(" "+U(d(s)("chart.add_assist_line")),1)]),_:1})])}}});const Cl=ye(xe,[["__scopeId","data-v-d854bba8"]]);export{Cl as default};

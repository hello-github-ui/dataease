import"./index-0.0.0-dataease.js";import{o as R,G as Y,n as Z,j as H,y as W}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{E as X}from"./el-row-0.0.0-dataease.js";import{E as ee}from"./el-radio-button-0.0.0-dataease.js";import{E as le}from"./el-input-number-0.0.0-dataease.js";import"./el-radio-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{E as ae,a as te}from"./el-select-0.0.0-dataease.js";import{E as oe}from"./el-col-0.0.0-dataease.js";import{d as ne,Z as se,G as U,o as ie,f as d,L as h,M as b,Y as v,a9 as x,g as f,i as n,k as t,j as r,a0 as V,m as de,U as re,a6 as q,ab as O,a5 as ue}from"./vue-0.0.0-dataease.js";import{i as ce}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as pe}from"./icon_add_outlined-0.0.0-dataease.js";import{a as fe}from"./chart-0.0.0-dataease.js";import{f as k}from"./attr-0.0.0-dataease20.js";import{i as me}from"./field-list-0.0.0-dataease.js";import{y as F}from"./lodash-0.0.0-dataease.js";import{E as _e}from"./index-0.0.0-dataease3.js";import{_ as ye}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./position-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease17.js";import"./index-0.0.0-dataease16.js";import"./strings-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";const he={style:{float:"left"}},ge={style:{float:"left",color:"#8492a6",fontSize:"12px"}},ve={class:"flex-align-center",style:{"margin-left":"-4px"}},xe=ne({__name:"AssistLineEdit",props:{chart:{type:Object,required:!0},line:{type:Array,required:!0},quotaFields:{type:Array,required:!0},quotaExtFields:{type:Array,required:!0},useQuotaExt:{type:Boolean,default:!1}},emits:["onAssistLineChange"],setup(y,{emit:L}){const{t:i}=R(),s=y,z=[{type:"left",name:i("chart.drag_block_value_axis_left")},{type:"right",name:i("chart.drag_block_value_axis_right")}],c=se({lineArr:[],lineObj:{name:i("chart.assist_line"),field:"0",fieldId:"",summary:"avg",axis:"y",yAxisType:"left",value:"0",lineType:"solid",color:"#ff0000",curField:{},fontSize:"10"},fieldOptions:[{label:i("chart.field_fixed"),value:"0"},{label:i("chart.field_dynamic"),value:"1"}],lineOptions:[{label:i("chart.line_type_solid"),value:"solid"},{label:i("chart.line_type_dashed"),value:"dashed"},{label:i("chart.line_type_dotted"),value:"dotted"}],predefineColors:fe,fontSize:[]}),N=U(()=>{const l=[];for(let a=10;a<=60;a=a+2)l.push({name:a+"",value:a+""});return l}),S=L,Q=()=>{c.lineArr=JSON.parse(JSON.stringify(s.line)),c.lineArr.forEach(l=>{s.useQuotaExt?(l.yAxisType==="left"&&F(s.quotaFields,a=>a.id===l.fieldId)==null&&(l.fieldId=void 0),l.yAxisType==="right"&&F(s.quotaExtFields,a=>a.id===l.fieldId)==null&&(l.fieldId=void 0)):F(s.quotaFields,a=>a.id===l.fieldId)==null&&(l.fieldId=void 0)}),u()},w=()=>{var a;const l={...c.lineObj,curField:s.quotaFields?s.quotaFields[0]:null,fieldId:s.quotaFields?(a=s.quotaFields[0])==null?void 0:a.id:null};c.lineArr.push(JSON.parse(JSON.stringify(l))),u()},j=l=>{c.lineArr.splice(l,1),u()},B=l=>{var a,m;s.useQuotaExt&&l.yAxisType==="right"?(l.fieldId=s.quotaExtFields?(a=s.quotaExtFields[0])==null?void 0:a.id:null,l.curField=C(l.fieldId)):(l.fieldId=s.quotaFields?(m=s.quotaFields[0])==null?void 0:m.id:null,l.curField=A(l.fieldId)),u()},u=()=>{S("onAssistLineChange",c.lineArr)},$=l=>{s.useQuotaExt&&l.yAxisType==="right"?l.curField=C(l.fieldId):l.curField=A(l.fieldId),u()},A=l=>{if(!l)return{};const a=s.quotaFields.filter(m=>m.id===l);return a.length===0?{}:a[0]},C=l=>{if(!l)return{};const a=s.quotaExtFields.filter(m=>m.id===l);return a.length===0?{}:a[0]},J=U(()=>["percentage-bar-stack","percentage-bar-stack-horizontal"].includes(s.chart.type)?c.fieldOptions.filter(l=>l.value==="0"):c.fieldOptions);return ie(()=>{Q()}),(l,a)=>{const m=Y,p=oe,_=ae,g=te,M=le,E=Z,I=H,D=_e,G=ee,K=X,P=W;return d(),h("div",null,[b("div",{onKeydown:a[0]||(a[0]=O(()=>{},["stop"])),onKeyup:a[1]||(a[1]=O(()=>{},["stop"])),style:{"max-height":"50vh","margin-top":"-4px","overflow-y":"auto"}},[(d(!0),h(v,null,x(c.lineArr,(o,T)=>(d(),f(K,{key:T,class:"line-item",gutter:8},{default:n(()=>[t(p,{span:4},{default:n(()=>[t(m,{modelValue:o.name,"onUpdate:modelValue":e=>o.name=e,class:"value-item",style:{width:"100% !important"},placeholder:r(i)("chart.name"),clearable:"",onChange:u},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024),y.useQuotaExt?(d(),f(p,{key:0,span:3},{default:n(()=>[t(g,{modelValue:o.yAxisType,"onUpdate:modelValue":e=>o.yAxisType=e,class:"select-item",onChange:e=>B(o)},{default:n(()=>[(d(),h(v,null,x(z,e=>t(_,{key:e.type,label:e.name,value:e.type},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)):V("",!0),t(p,{span:3},{default:n(()=>[t(g,{modelValue:o.field,"onUpdate:modelValue":e=>o.field=e,class:"select-item",onChange:u},{default:n(()=>[(d(!0),h(v,null,x(J.value,e=>(d(),f(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),o.field==="0"?(d(),f(p,{key:1,span:7},{default:n(()=>[t(M,{modelValue:o.value,"onUpdate:modelValue":e=>o.value=e,"controls-position":"right",class:"value-item",placeholder:r(i)("chart.drag_block_label_value"),clearable:"",onChange:u},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)):V("",!0),o.field==="1"?(d(),f(p,{key:2,span:4},{default:n(()=>[t(g,{modelValue:o.fieldId,"onUpdate:modelValue":e=>o.fieldId=e,class:"select-item",placeholder:r(i)("chart.field"),onChange:e=>$(o)},{default:n(()=>[(d(!0),h(v,null,x(y.useQuotaExt&&o.yAxisType==="right"?y.quotaExtFields:y.quotaFields,e=>(d(),f(_,{key:e.id,label:e.name,value:e.id},{default:n(()=>[b("span",he,[t(I,null,{default:n(()=>[t(E,{className:`field-icon-${r(k)[o.deType]}`},{default:n(()=>[(d(),f(de(r(me)[r(k)[o.deType]]),{class:re(["svg-icon",`field-icon-${r(k)[o.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024)]),b("span",ge,q(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"])]),_:2},1024)):V("",!0),o.field==="1"?(d(),f(p,{key:3,span:3},{default:n(()=>[t(g,{modelValue:o.summary,"onUpdate:modelValue":e=>o.summary=e,class:"select-item",placeholder:r(i)("chart.aggregation"),onChange:u},{default:n(()=>[t(_,{key:"avg",value:"avg",label:"平均值"}),t(_,{key:"max",value:"max",label:r(i)("chart.max")},null,8,["label"]),t(_,{key:"min",value:"min",label:r(i)("chart.min")},null,8,["label"])]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)):V("",!0),t(p,{span:y.useQuotaExt?2:3},{default:n(()=>[t(D,{effect:"dark",content:r(i)("chart.font_size"),placement:"top"},{default:n(()=>[t(g,{modelValue:o.fontSize,"onUpdate:modelValue":e=>o.fontSize=e,class:"select-item",placeholder:r(i)("chart.text_fontsize"),onChange:u},{default:n(()=>[(d(!0),h(v,null,x(N.value,e=>(d(),f(_,{key:e.value,label:e.name,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["content"])]),_:2},1032,["span"]),t(p,{span:y.useQuotaExt?2:4},{default:n(()=>[t(g,{modelValue:o.lineType,"onUpdate:modelValue":e=>o.lineType=e,class:"select-item",onChange:u},{default:n(()=>[(d(!0),h(v,null,x(c.lineOptions,e=>(d(),f(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["span"]),t(p,{span:2,style:{"text-align":"center"}},{default:n(()=>[t(G,{"is-custom":"",size:"large",modelValue:o.color,"onUpdate:modelValue":e=>o.color=e,class:"color-picker-style",predefine:c.predefineColors,onChange:u},null,8,["modelValue","onUpdate:modelValue","predefine"])]),_:2},1024),t(p,{span:1},{default:n(()=>[b("div",ve,[t(I,{style:{width:"28px !important",height:"28px !important","font-size":"20px !important"},class:"hover-icon",onClick:e=>j(T)},{default:n(()=>[t(E,{name:"icon_delete-trash_outlined"},{default:n(()=>[t(r(ce),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))],32),t(P,{class:"circle-button",text:"",style:{"margin-left":"5px"},onClick:w},{icon:n(()=>[t(E,{name:"icon_add_outlined"},{default:n(()=>[t(r(pe),{class:"svg-icon"})]),_:1})]),default:n(()=>[ue(" "+q(r(i)("chart.add_assist_line")),1)]),_:1})])}}});const Xe=ye(xe,[["__scopeId","data-v-d854bba8"]]);export{Xe as default};

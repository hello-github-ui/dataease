import{o as ee,x as te,y as ae,B as oe,d as ne,r as le,e as se,V as re}from"./element-plus-secondary-0.0.0-dataease.js";import{j as ie,n as ce,h as de}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as ue}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{o as l,c as i,a as g,d as pe,k as _e,r as m,l as me,w as fe,Z as u,_ as t,Y as B,a0 as a,M as V,ab as N,u as r,$ as Ce,z as he,a4 as ve,a2 as b}from"./@vue-0.0.0-dataease.js";import{i as Z}from"./icon_dashboard_outlined-0.0.0-dataease.js";import{i as z}from"./icon_operation-analysis_outlined-0.0.0-dataease.js";import{d as M}from"./dv-dashboard-spine-mobile-0.0.0-dataease.js";import{i as ye}from"./icon_pc_outlined-0.0.0-dataease.js";import{G as be}from"./GridTable-0.0.0-dataease.js";import{d as ge}from"./dayjs-0.0.0-dataease.js";import{p as we,a as ke}from"./index-0.0.0-dataease.js";import Le from"./ShareHandler-0.0.0-dataease.js";import{i as xe}from"./interactive-0.0.0-dataease.js";import{_ as Ve}from"./_plugin-vue_export-helper-0.0.0-dataease.js";const Me={width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};function De(w,c){return l(),i("svg",Me,c[0]||(c[0]=[g("path",{d:"M1 7.64384C1 7.2517 1.2292 6.89575 1.5862 6.73348L11.5862 2.18802C11.8491 2.06851 12.1509 2.06851 12.4138 2.18802L22.4138 6.73348C22.7708 6.89575 23 7.2517 23 7.64384V17.3819C23 17.7607 22.786 18.1069 22.4472 18.2763L12.4472 23.2763C12.1657 23.4171 11.8343 23.4171 11.5528 23.2763L1.55279 18.2763C1.214 18.1069 1 17.7607 1 17.3819V7.64384ZM19.2178 7.47768L12 4.19685L4.7432 7.49539L11.96 10.6042L19.2178 7.47768ZM13 12.3338V20.7639L21 16.7639V8.88765L13 12.3338ZM3 8.92215V16.7639L11 20.7639V12.3683L3 8.92215Z"},null,-1)]))}const Se={render:De},Ie={width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};function Te(w,c){return l(),i("svg",Ie,c[0]||(c[0]=[g("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M20.9117 19.9531C21.4811 19.5044 22 18.8519 22 18V6C22 5.14805 21.4811 4.49559 20.9117 4.04685C20.331 3.58923 19.5528 3.22085 18.6802 2.93C16.9246 2.3448 14.5629 2 12 2C9.43715 2 7.07541 2.3448 5.31981 2.93C4.44724 3.22085 3.66896 3.58923 3.08829 4.04685C2.51889 4.49559 2 5.14805 2 6V18C2 18.8519 2.51889 19.5044 3.08829 19.9531C3.66896 20.4108 4.44724 20.7791 5.31981 21.07C7.07541 21.6552 9.43715 22 12 22C14.5629 22 16.9246 21.6552 18.6802 21.07C19.5528 20.7791 20.331 20.4108 20.9117 19.9531ZM4 5.99973C4.00058 4.89529 7.58208 4 12 4C16.4183 4 20 4.89543 20 6C20 7.10457 16.4183 8 12 8C7.58172 8 4 7.10457 4 6C4 5.99998 4 5.99996 4 5.99994C4 5.99987 4 5.9998 4 5.99973ZM18.6802 9.07C19.1533 8.91229 19.5988 8.73177 20 8.5266V12.0002C20 12.0014 19.9999 12.0057 19.9969 12.0153C19.9935 12.0264 19.9852 12.0485 19.9649 12.0814C19.9225 12.1506 19.8359 12.2545 19.6738 12.3823C19.3436 12.6425 18.8038 12.9206 18.0477 13.1726C16.546 13.6732 14.4077 14 12 14C9.59229 14 7.45402 13.6732 5.95227 13.1726C5.19616 12.9206 4.65642 12.6425 4.32624 12.3823C4.16408 12.2545 4.07752 12.1506 4.03507 12.0814C4.01483 12.0485 4.00645 12.0264 4.00305 12.0153C4.00016 12.0058 4.00001 12.0012 4 12V8.5266C4.40123 8.73177 4.84666 8.91229 5.31981 9.07C7.07541 9.6552 9.43715 10 12 10C14.5629 10 16.9246 9.6552 18.6802 9.07ZM18.6802 15.07C19.1533 14.9123 19.5988 14.7318 20 14.5266V18.0001C20 18.001 20 18.0052 19.9969 18.0153C19.9935 18.0264 19.9852 18.0485 19.9649 18.0814C19.9225 18.1506 19.8359 18.2545 19.6738 18.3823C19.3436 18.6425 18.8038 18.9206 18.0477 19.1726C16.546 19.6732 14.4077 20 12 20C9.59229 20 7.45402 19.6732 5.95227 19.1726C5.19616 18.9206 4.65642 18.6425 4.32624 18.3823C4.16408 18.2545 4.07752 18.1506 4.03507 18.0814C4.01483 18.0485 4.00645 18.0264 4.00305 18.0153C3.99998 18.0052 4 18.0009 4 18V14.5266C4.40123 14.7318 4.84666 14.9123 5.31981 15.07C7.07541 15.6552 9.43715 16 12 16C14.5629 16 16.9246 15.6552 18.6802 15.07Z"},null,-1)]))}const Ee={render:Te},$e={key:1,class:"panel-table"},Be={class:"name-content"},Ne={class:"ellipsis",style:{"max-width":"250px"}},Ze={key:0},ze={key:1},Ge=pe({__name:"ShareGrid",props:{activeName:we.string.def("")},emits:["setLoading"],setup(w,{emit:c}){const f=w;ke("localStorage");const{t:s}=ie(),G=xe(),D=_e(()=>G.getData),p=m(),_=m("all_types"),C=me({tableData:[],curTypeList:["all_types","panel","screen"],tableColumn:[{field:"creator",label:s("visualization.who_share")},{field:"time",label:s("visualization.when_share"),type:"time"},{field:"exp",label:s("visualization.over_time"),type:"time"}]}),O=o=>{_.value=o,h()},F=()=>{h()},Y=o=>{const n=`/#/preview?dvId=${o}`;window.open(n,"_blank")},j=(o,n,d)=>d?ge(new Date(d)).format("YYYY-MM-DD HH:mm:ss"):"-",P=()=>{S("setLoading",!0)},W=()=>{S("setLoading",!1)},S=c,h=()=>{P();const o=_.value==="all_types"?"":_.value;ce.post({url:"/share/query",data:{type:o,keyword:p.value,asc:!k.value}}).then(n=>{C.tableData=n.data}).finally(()=>{I.value=H(),T.value=U(),W()})},k=m(!0),q=o=>{k.value=!0;const n=o.order.substring(0,o.order.indexOf("ending"));k.value=n==="desc",h()},A=(()=>{const o=["panel","screen"],n=[];for(const d in D.value)D.value[d].menuAuth&&n.push(o[parseInt(d)]);return n})(),I=m(),T=m(""),H=()=>p.value?"tree":"noneWhite",U=()=>p.value?s("work_branch.relevant_content_found"):"",K=o=>{if(o){const n=o.resourceId;["dashboard","panel"].includes(o.type)?window.open("#/panel/index?dvId="+n,"_self"):["dataV","screen"].includes(o.type)&&window.open("#/screen/index?dvId="+n,"_self")}},R={panel:Z,panelMobile:M,dashboard:Z,dashboardMobile:M,screen:z,dataV:z,dataset:Se,datasource:Ee};return fe(()=>f.activeName,()=>{f.activeName==="share"&&h()},{immediate:!0}),(o,n)=>{const d=te,J=ae,E=oe,v=de,y=ne,Q=le,X=ee,$=se,L=re;return l(),i(V,null,[f.activeName==="share"?(l(),u(X,{key:0},{default:t(()=>[a(E,{span:12},{default:t(()=>[a(J,{"popper-class":"menu-panel-select_popper",class:"select-type-list",modelValue:_.value,"onUpdate:modelValue":n[0]||(n[0]=e=>_.value=e),onChange:O},{default:t(()=>[(l(!0),i(V,null,N(C.curTypeList.filter(e=>e==="all_types"||r(A).includes(e)),e=>(l(),u(d,{key:e,label:r(s)(`auth.${e}`),value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(E,{class:"search",span:12},{default:t(()=>[a(Q,{modelValue:p.value,"onUpdate:modelValue":n[1]||(n[1]=e=>p.value=e),clearable:"",onChange:F,placeholder:r(s)("work_branch.search_keyword")},{prefix:t(()=>[a(y,null,{default:t(()=>[a(v,{name:"icon_search-outline_outlined"},{default:t(()=>[a(r(ue),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1})):B("",!0),f.activeName==="share"?(l(),i("div",$e,[a(be,{"show-pagination":!1,"table-data":C.tableData,onSortChange:q,"empty-desc":T.value,"empty-img":I.value,onCellClick:K,class:"workbranch-grid"},{default:t(()=>[a(L,{key:"name",width:"280",prop:"name",label:r(s)("common.name")},{default:t(e=>[g("div",Be,[e.row.extFlag?(l(),u(y,{key:0,style:{"margin-right":"12px","font-size":"18px"}},{default:t(()=>[a(v,{name:"dv-dashboard-spine-mobile"},{default:t(()=>[a(r(M),{class:"svg-icon"})]),_:1})]),_:1})):(l(),u(y,{key:1,class:he(`main-color color-${e.row.type}`)},{default:t(()=>[a(v,null,{default:t(()=>[(l(),u(Ce(R[e.row.type]),{class:"svg-icon"}))]),_:2},1024)]),_:2},1032,["class"])),a($,{placement:"top"},{content:t(()=>[ve(b(e.row.name),1)]),default:t(()=>[g("span",Ne,b(e.row.name),1)]),_:2},1024)])]),_:1},8,["label"]),(l(!0),i(V,null,N(C.tableColumn,e=>(l(),u(L,{key:e.label,prop:"name","show-overflow-tooltip":"",label:e.label,sortable:e.type==="time"&&e.field==="time"},{default:t(x=>[e.type&&e.type==="time"?(l(),i("span",Ze,b(j(null,null,x.row[e.field])),1)):(l(),i("span",ze,b(x.row[e.field]),1))]),_:2},1032,["label","sortable"]))),128)),a(L,{width:"96",fixed:"right",key:"_operation",label:r(s)("common.operate")},{default:t(e=>[a($,{effect:"dark",content:r(s)("work_branch.new_page_preview"),placement:"top"},{default:t(()=>[a(y,{class:"hover-icon hover-icon-in-table",onClick:x=>Y(e.row.resourceId)},{default:t(()=>[a(v,null,{default:t(()=>[a(r(ye),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["content"]),a(Le,{"in-grid":!0,"resource-id":e.row.resourceId,weight:e.row.weight},null,8,["resource-id","weight"])]),_:1},8,["label"])]),_:1},8,["table-data","empty-desc","empty-img"])])):B("",!0)],64)}}});const Oe=Ve(Ge,[["__scopeId","data-v-48311ae1"]]),t1=Object.freeze(Object.defineProperty({__proto__:null,default:Oe},Symbol.toStringTag,{value:"Module"}));export{Oe as S,Ee as a,t1 as b,Se as i};

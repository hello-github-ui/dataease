import{L as Zt,p as ze,r as Xt,d as Ge,e as Qt}from"./element-plus-secondary-0.0.0-dataease.js";import{A as Kt,l as ct,j as ei,n as ti,h as ii}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{o as D,c as te,a as Ce,d as mt,t as Ot,r as E,l as Qe,x as Mt,k as _,a3 as de,a2 as Xe,Y as ee,a0 as z,_ as G,u as a,M as Pt,w as Me,R as li,n as we,b as ri,ak as ni,W as ut,Z as K,a1 as ai,ac as oi,a5 as si,z as Lt,q as ui,X as ci}from"./@vue-0.0.0-dataease.js";import{i as di}from"./icon_info_outlined-0.0.0-dataease.js";import fi from"./ChartComponentG2Plot-0.0.0-dataease.js";import{b as mi}from"./chart-0.0.0-dataease2.js";import{d as pt,v as pi}from"./dvMain-0.0.0-dataease.js";import{r as Tt,e as vi,f as hi}from"./canvasStyle-0.0.0-dataease.js";import{l as V,G as ke,m as xe,B as gi,H as Et,k as yi}from"./chart-0.0.0-dataease.js";import{v as wi}from"./formatter-0.0.0-dataease.js";import{s as vt}from"./pinia-0.0.0-dataease.js";import{x as Fe,e as dt,A as xi}from"./lodash-es-0.0.0-dataease.js";import{useAppearanceStoreWithOut as ki}from"./appearance-0.0.0-dataease.js";import{useAppStoreWithOut as Ci}from"./app-0.0.0-dataease.js";import{b as Vt,a as _i,u as W,e as bi}from"./index-0.0.0-dataease.js";import{_ as Si}from"./PluginComponent.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{h as Di,p as Ii}from"./util-0.0.0-dataease2.js";import Fi from"./DrillPath-0.0.0-dataease.js";import{d as Pe}from"./dayjs-0.0.0-dataease.js";import{k as Li,g as ft}from"./time-format-0.0.0-dataease.js";import{c as Ti}from"./time-format-dayjs-0.0.0-dataease.js";import Ei from"./ChartComponentS2-0.0.0-dataease.js";import{a as Ai,c as At,C as Le}from"./index-0.0.0-dataease12.js";import{N as Ri,O as Oi}from"./canvasUtils-0.0.0-dataease.js";import{g as Ze}from"./js-base64-0.0.0-dataease.js";import Mi from"./DeRichTextView-0.0.0-dataease.js";import Pi from"./Component-0.0.0-dataease10.js";import Vi from"./ChartEmptyInfo-0.0.0-dataease.js";import{s as Hi}from"./snapshot-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import{_ as Ni}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./vue-router-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./ViewTrackBar-0.0.0-dataease.js";import"./ChartError-0.0.0-dataease.js";import"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./translate-0.0.0-dataease.js";import"./mathjs-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./exceljs-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";import"./eventBus-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./ModelUtil-0.0.0-dataease.js";import"./@tinymce-0.0.0-dataease.js";import"./@npkg-0.0.0-dataease.js";import"./imgUtils-0.0.0-dataease.js";import"./html2canvas-0.0.0-dataease.js";import"./html-to-image-0.0.0-dataease.js";import"./chart-dark-list-0.0.0-dataease.js";import"./chart-list-0.0.0-dataease.js";const qi={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function ji(o,s){return D(),te("svg",qi,s[0]||(s[0]=[Ce("path",{d:"M8.622 5.77734C8.76928 5.77734 8.88867 5.89674 8.88867 6.04401V6.84401C8.88867 6.99129 8.76928 7.11068 8.622 7.11068H6.88867C6.77958 7.11068 6.68885 7.18929 6.67003 7.29295L6.66645 7.3329V12.6662C6.66645 12.7753 6.74506 12.8661 6.84873 12.8849L6.88867 12.8885H13.9998C14.1089 12.8885 14.1996 12.8098 14.2184 12.7062L14.222 12.6662V7.3329C14.222 7.22381 14.1434 7.13307 14.0397 7.11426L13.9998 7.11068H12.2664C12.1192 7.11068 11.9998 6.99129 11.9998 6.84401V6.04401C11.9998 5.89674 12.1192 5.77734 12.2664 5.77734H13.9998C14.8303 5.77734 15.5087 6.42813 15.553 7.24755L15.5553 7.3329V12.6662C15.5553 13.4967 14.9045 14.1752 14.0851 14.2195L13.9998 14.2218H6.88867C6.0582 14.2218 5.37973 13.571 5.33542 12.7516L5.33312 12.6662V7.3329C5.33312 6.50243 5.98391 5.82395 6.80332 5.77965L6.88867 5.77734H8.622ZM9.55534 1.77734C10.3858 1.77734 11.0643 2.42813 11.1086 3.24755L11.1109 3.3329V8.66623C11.1109 9.49671 10.4601 10.1752 9.64069 10.2195L9.55534 10.2218H7.822C7.67473 10.2218 7.55534 10.1024 7.55534 9.95512V9.15512C7.55534 9.00785 7.67473 8.88846 7.822 8.88846H9.55534C9.66443 8.88846 9.75516 8.80984 9.77398 8.70618L9.77756 8.66623V3.3329C9.77756 3.22381 9.69895 3.13307 9.59528 3.11426L9.55534 3.11068H2.44423C2.33513 3.11068 2.2444 3.18929 2.22559 3.29295L2.22201 3.3329V8.66623C2.22201 8.77533 2.30062 8.86606 2.40428 8.88488L2.44423 8.88846H4.17756C4.32484 8.88846 4.44423 9.00785 4.44423 9.15512V9.95512C4.44423 10.1024 4.32484 10.2218 4.17756 10.2218H2.44423C1.61375 10.2218 0.935282 9.571 0.890973 8.75158L0.888672 8.66623V3.3329C0.888672 2.50243 1.53946 1.82395 2.35888 1.77965L2.44423 1.77734H9.55534Z",fill:"currentColor"},null,-1)]))}const zi={render:ji},Bi={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Yi(o,s){return D(),te("svg",Bi,s[0]||(s[0]=[Ce("path",{d:"M11.9858 11L10.5036 9.51778C10.3083 9.32252 10.3083 9.00594 10.5036 8.81067L11.2107 8.10357C11.4059 7.90831 11.7225 7.90831 11.9178 8.10357L15.4749 11.6607C15.6701 11.8559 15.6701 12.1725 15.4749 12.3678L11.9393 15.9033C11.7441 16.0986 11.4275 16.0986 11.2322 15.9033L10.5251 15.1962C10.3299 15.0009 10.3299 14.6844 10.5251 14.4891L12.0142 13H2.5C2.22386 13 2 12.7762 2 12.5V11.5C2 11.2239 2.22386 11 2.5 11H11.9858ZM4 4V9H2V3C2 2.49625 2.47102 2 3 2H21C21.529 2 22 2.49625 22 3V21C22 21.5037 21.529 22 21 22H3C2.47102 22 2 21.5037 2 21V15H4V20H20V4H4Z",fill:"currentColor"},null,-1)]))}const $i={render:Yi},Ji={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Wi(o,s){return D(),te("svg",Ji,s[0]||(s[0]=[Ce("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.34423 1.50735C5.34246 1.22627 5.56945 0.999292 5.85087 1.00071L18.271 1C18.5524 1.00141 18.7787 1.22769 18.7766 1.50558L18.7791 2.49801C18.7773 2.77554 18.5503 3.00253 18.2724 3.00465L16.0653 3.0043L16.0646 7.53066C16.0646 7.66501 16.1588 7.79441 16.2507 7.88634L20.3954 12.6558C20.4908 12.7512 20.5449 12.881 20.5449 13.0153L20.5439 14.3245C20.5453 14.606 20.3187 14.8326 20.0372 14.8312L13.0651 14.8337L13.065 18H15.3988C15.9133 18 16.1892 18.605 15.8519 18.9934L12.4531 22.9077C12.2138 23.1832 11.7862 23.1832 11.5469 22.9077L8.14813 18.9934C7.81084 18.605 8.08675 18 8.60119 18H11.0371L11.0372 14.8322L4.0505 14.8313C3.77272 14.8333 3.54644 14.607 3.54492 14.3257L3.54584 13.0166C3.54588 12.8822 3.5981 12.7522 3.6931 12.6572L7.84885 7.88775C7.94395 7.79264 8.05642 7.66254 8.05642 7.52819L8.05678 3.00217L5.84875 3.00182C5.57086 3.00394 5.34459 2.77767 5.34317 2.49624L5.34423 1.50735ZM10.0578 3.00197L10.061 8.39982L6.19585 12.8316L11 12.8331C11.1142 12.8334 11.5511 12.8334 11.991 12.8334C12.4309 12.8334 12.8738 12.8334 13 12.8337L17.8942 12.8351L14.0678 8.41842L14.0624 2.99973L10.0578 3.00197Z",fill:"currentColor"},null,-1)]))}const Ui={render:Wi},Gi=mt({__name:"DeIndicator",props:{view:{type:Object,default(){return{propValue:null}}},showPosition:{type:String,required:!1,default:"canvas"},scale:{type:Number,required:!1,default:1},terminal:{type:String,default:"pc"},suffixId:{type:String,required:!1,default:"common"},fontFamily:{type:String,required:!1,default:"inherit"}},emits:["onChartClick","onDrillFilters","onJumpClick"],setup(o,{expose:s,emit:r}){const l=o,{view:u,scale:p,terminal:d}=Ot(l),k=pt();vt(k);const x=E(""),H=E(!1),F=Qe({data:null,loading:!1,totalItems:0}),U=Mt({fields:[]}),ae=_(()=>{var c;const v=(c=U.value)==null?void 0:c.series;if(v&&v.length>0)return v[0]}),N=_(()=>{var v,c;if((c=(v=u.value)==null?void 0:v.yAxis)!=null&&c.length){const y=u.value.yAxis[0];return y.chartShowName?y.chartShowName:y.name}}),ie=_(()=>{var y,f,L;const v=(y=ae.value)==null?void 0:y.data;let c;if(v&&v.length>0&&(c=v[0]),c==null)if(u.value.senior&&((L=(f=u.value.senior)==null?void 0:f.functionCfg)==null?void 0:L.emptyDataStrategy)==="setZero")c=0;else return"-";return c}),fe=E(V.color),le=_(()=>{var f,L,m;let v=fe.value,c=V.backgroundColor;if(ie.value==="-")return{color:v,backgroundColor:c};const y=ie.value;if(u.value.senior&&((f=u.value.senior.threshold)!=null&&f.enable)&&((m=(L=u.value.senior.threshold)==null?void 0:L.labelThreshold)==null?void 0:m.length)>0){const oe=u.value.senior;for(let De=0;De<oe.threshold.labelThreshold.length;De++){let M=!1;const C=oe.threshold.labelThreshold[De],q=C.value;if(C.term==="eq"?y===q&&(v=C.color,c=C.backgroundColor,M=!0):C.term==="not_eq"?y!==q&&(v=C.color,c=C.backgroundColor,M=!0):C.term==="lt"?y<q&&(v=C.color,c=C.backgroundColor,M=!0):C.term==="gt"?y>q&&(v=C.color,c=C.backgroundColor,M=!0):C.term==="le"?y<=q&&(v=C.color,c=C.backgroundColor,M=!0):C.term==="ge"?y>=q&&(v=C.color,c=C.backgroundColor,M=!0):C.term==="between"&&C.min<=y&&y<=C.max&&(v=C.color,c=C.backgroundColor,M=!0),M)break}}return{color:v,backgroundColor:c}}),me=_(()=>{let v=ie.value;return v==="-"?v:u.value.yAxis&&u.value.yAxis.length>0&&u.value.yAxis[0].formatterCfg?wi(v,u.value.yAxis[0].formatterCfg):v}),Z=r,X=E({display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",height:"100%","background-color":le.value.backgroundColor}),be=E({color:le.value.color,"font-size":V.fontSize+"px","font-family":Fe(l.fontFamily,ke[V.fontFamily]),"font-weight":V.isBolder?"bold":"normal","font-style":V.isItalic?"italic":"normal","letter-spacing":V.letterSpace+"px","text-shadow":V.fontShadow?"2px 2px 4px":"none","font-synthesis":"weight style"}),Se=E({color:V.suffixColor,"font-size":V.suffixFontSize+"px","font-family":Fe(l.fontFamily,ke[V.fontFamily]),"font-weight":V.suffixIsBolder?"bold":"normal","font-style":V.suffixIsItalic?"italic":"normal","letter-spacing":V.suffixLetterSpace+"px","text-shadow":V.suffixFontShadow?"2px 2px 4px":"none","font-synthesis":"weight style"}),Ve=E(V.suffixEnable),re=E(""),pe=E(!1),t=Qe({"margin-top":xe.nameValueSpacing+"px"}),O=E({color:xe.color,"font-size":xe.fontSize+"px","font-family":Fe(l.fontFamily,ke[V.fontFamily]),"font-weight":xe.isBolder?"bold":"normal","font-style":xe.isItalic?"italic":"normal","letter-spacing":xe.letterSpace+"px","text-shadow":xe.fontShadow?"2px 2px 4px":"none","font-synthesis":"weight style"}),b=async v=>{if(!v)return;const c=dt(gi);delete c.customAttr.basicStyle.alpha;const y=Kt({...xi(v,c),data:U.value});if(Tt(vi,y.customAttr,p.value,d.value),Tt(hi,y.customStyle,p.value,d.value),y.customAttr){const{indicator:f,indicatorName:L,basicStyle:m}=y.customAttr;if(f){switch(f.hPosition){case"left":X.value["align-items"]="flex-start";break;case"right":X.value["align-items"]="flex-end";break;default:X.value["align-items"]="center"}switch(f.vPosition){case"top":X.value["justify-content"]="flex-start";break;case"bottom":X.value["justify-content"]="flex-end";break;default:X.value["justify-content"]="center"}fe.value=f.color;let oe=f.suffixColor;be.value={color:le.value.color,"font-size":f.fontSize+"px","font-family":Fe(f.fontFamily,ke[V.fontFamily]),"font-weight":f.isBolder?"bold":"normal","font-style":f.isItalic?"italic":"normal","letter-spacing":f.letterSpace+"px","text-shadow":f.fontShadow?"2px 2px 4px":"none","font-synthesis":"weight style"},X.value["background-color"]=le.value.backgroundColor,Se.value={color:oe,"font-size":f.suffixFontSize+"px","font-family":Fe(f.suffixFontFamily,ke[V.suffixFontFamily]),"font-weight":f.suffixIsBolder?"bold":"normal","font-style":f.suffixIsItalic?"italic":"normal","letter-spacing":f.suffixLetterSpace+"px","text-shadow":f.suffixFontShadow?"2px 2px 4px":"none","font-synthesis":"weight style"},Ve.value=f.suffixEnable,re.value=Fe(f.suffix,"")}if(L!=null&&L.show){let oe=L.color;pe.value=!0,O.value={color:oe,"font-size":L.fontSize+"px","font-family":Fe(L.fontFamily,ke[xe.fontFamily]),"font-weight":L.isBolder?"bold":"normal","font-style":L.isItalic?"italic":"normal","letter-spacing":L.letterSpace+"px","text-shadow":L.fontShadow?"2px 2px 4px":"none","font-synthesis":"weight style"},t["margin-top"]=(L.nameValueSpacing??xe.nameValueSpacing)+"px"}else pe.value=!1}};return s({calcData:(v,c)=>{if(v.tableId||v.dataFrom==="template"){F.loading=!0,H.value=!1;const y=JSON.parse(JSON.stringify(v));mi(y).then(f=>{f.code&&f.code!==0?(H.value=!0,x.value=f.msg):(U.value=f==null?void 0:f.data,Z("onDrillFilters",f==null?void 0:f.drillFilters),k.setViewDataDetails(v.id,f),b(f)),c==null||c()}).catch(()=>{c==null||c()})}else c==null||c()},renderChart:b}),(v,c)=>(D(),te("div",{style:de(X.value)},[Ce("div",null,[Ce("span",{style:de(be.value)},Xe(me.value),5),Ve.value?(D(),te("span",{key:0,style:de(Se.value)},Xe(re.value),5)):ee("",!0)]),pe.value?(D(),te("div",{key:0,style:de(t)},[Ce("span",{style:de(O.value)},Xe(N.value),5)],4)):ee("",!0)],4))}}),Zi=pt(),{componentData:Rt,canvasStyleData:Xi}=vt(Zi),Qi=(o,s,r)=>{const l=(r||"").split("range")[0];if(r==="datetimerange"||o===1||!l)return s.map(d=>+new Date(d));const[u,p]=s;return[+new Date(u),+ft(1,l,l,"b",null,r,"start-config",new Date(p))-1e3]},Ki=(o,s,r,l)=>[1,7].includes(o)?Array.isArray(s)?Qi(o,s,l):el(s,r):Array.isArray(s)?s:[s],el=(o,s)=>{switch(s){case"year":return tl(o);case"month":return il(o);case"date":return ll(o);case"datetime":return[+new Date(o),+new Date(o)]}},tl=o=>[+new Date(Pe(o).startOf("year").format("YYYY/MM/DD HH:mm:ss")),+new Date(Pe(o).endOf("year").format("YYYY/MM/DD HH:mm:ss"))],il=o=>[+new Date(Pe(o).startOf("month").format("YYYY/MM/DD HH:mm:ss")),+new Date(Pe(o).endOf("month").format("YYYY/MM/DD HH:mm:ss"))],ll=o=>[+new Date(Pe(o).startOf("day").format("YYYY/MM/DD HH:mm:ss")),+new Date(Pe(o).endOf("day").format("YYYY/MM/DD HH:mm:ss"))],rl=(o,s)=>{const[r]=s,l=r.split(",");return o.map(u=>u.id).slice(0,l.length).join(",")},nl=(o,s,r,l,u,p,d,k,x,H)=>+x==9?l?o?u?s.map(F=>F.split("-de-").join(",")):(s||"").split("-de-").join(","):[]:r!=null&&r.length?u?r.map(F=>F.split("-de-").join(",")):(r||"").split("-de-").join(","):[]:d===1&&(p!=null&&p.length||H)&&![1,7].includes(+x)?l?o?p:u?[]:"":(r!=null&&r.length?k:r)||"":l&&!(r!=null&&r.length)?o?s:u?[]:"":r||"",al=(o,s=!1)=>{const r=Xi.value.popupAvailable,l=[],u=Rt.value.filter(p=>p.component==="VQuery"&&(r||!r&&p.category!=="hidden"));return Ye(u,l,o,s),Rt.value.forEach(p=>{if(p.component==="Group"){const d=p.propValue.filter(k=>k.innerType==="VQuery"&&(r||!r&&p.category!=="hidden"));Ye(d,l,o,s),d.forEach(k=>{k.innerType==="DeTabs"&&k.propValue.forEach(x=>{const H=x.componentData.filter(F=>F.innerType==="VQuery"&&(r||!r&&p.category!=="hidden"));Ye(H,l,o,s)})})}p.innerType==="DeTabs"&&p.propValue.forEach(d=>{d.componentData.forEach(x=>{if(x.component==="Group"){const H=x.propValue.filter(F=>F.innerType==="VQuery"&&(r||!r&&x.category!=="hidden"));Ye(H,l,o,s)}});const k=d.componentData.filter(x=>x.innerType==="VQuery");Ye(k,l,o,s)})}),{filter:l}},ol=(o,s,r,l,u,p)=>{const d=p?s:l,k=p?r:u;return o===0?d===""?[]:d:[d||"",k||""].filter(x=>x!=="")},sl=(o,s,r,l,u,p)=>p&&!u?[]:[(p?l:r)??"",(p?o:s)??""].filter(x=>x!==""),ul=(o,s,r,l,u,p,d,k,x,H,F,U)=>{if(+o==9)return s?"in":"eq";if(+o==22)return"between";const ae=U?u:x,N=U?d:F,ie=U?l:k,fe=U?p:H;if(o==="8"){if(r===0)return ie;const le=[ae===""?"":ie,N===""?"":fe].filter(me=>me!=="");return le.length===2?le.join(`-${r===1?"and":"or"}-`):ae===""?fe:ie}return[1,7].includes(+o)?"between":s?"in":"eq"},Be=o=>{const s=[];let r=o.map(l=>l.id);for(let l=0;l<o.length;l++){const u=o[l];r.includes(u.id)&&(s.push(u),r=r.filter(p=>p!==u.id))}return s},Ye=(o,s,r,l)=>{o.forEach(u=>{var p;(p=u.propValue)!=null&&p.length&&u.propValue.forEach(d=>{var k,x,H,F,U,ae;if(d.checkedFields.includes(r)&&d.checkedFieldsMap[r]){let N;const{id:ie,selectValue:fe,timeGranularityMultiple:le,defaultNumValueEnd:me,numValueEnd:Z,numValueStart:X,defaultNumValueStart:be,conditionType:Se=0,treeFieldList:Ve=[],defaultConditionValueOperatorF:re="eq",defaultConditionValueF:pe="",defaultConditionValueOperatorS:t="like",defaultConditionValueS:O="",conditionValueOperatorF:b="eq",conditionValueF:Te="",conditionValueOperatorS:v="like",conditionValueS:c="",defaultValueCheck:y,timeType:f="fixed",defaultValue:L,optionValueSource:m,defaultMapValue:oe,mapValue:De,parameters:M=[],timeGranularity:C="date",displayType:q,displayId:Ke,multiple:se}=d,Ie=+q==9;if(f==="dynamic"&&[1,7].includes(+q)&&l&&y)if(+q==1)N=Li(d),d.defaultValue=new Date(N[0]),d.selectValue=new Date(N[0]);else{const{timeNum:A,relativeToCurrentType:ne,around:ue,relativeToCurrentRange:ve,arbitraryTime:j,timeGranularity:B,timeNumRange:_e,relativeToCurrentTypeRange:Y,aroundRange:He,timeGranularityMultiple:he,arbitraryTimeRange:Ne}=d;let ce=ft(A,ne,B,ue,j,he,"start-panel"),Ee=ft(_e,Y,B,He,Ne,he,"end-panel");ve&&ve!=="custom"&&([ce,Ee]=Ti(ve)),d.defaultValue=[ce,Ee],d.selectValue=[ce,Ee],N=[ce,Ee]}else q==="8"?N=ol(Se,pe,O,Te,c,l):q==="22"?N=sl(me,Z,X,be,y,l):N=nl(y,L,fe,l,se,oe,m,De,q,Ke);if(N!=null&&N.length||["[object Number]","[object Date]"].includes(Object.prototype.toString.call(N))||q==="8"){let A=Ki(+q,N,C,le);const ne=ul(q,se,Se,re,pe,t,O,b,Te,v,c,l);if(A!=null&&A.length){const ue=Ie?rl(Ve,A):d.checkedFieldsMap[r];let ve=Be(M.reduce((j,B)=>(B.id===ue&&!j.length&&j.push(B),j),[]));if((x=(k=d.checkedFieldsMapArr)==null?void 0:k[r])!=null&&x.length){const j=(H=d.checkedFieldsMapArr)==null?void 0:H[r].find(Y=>Y!==ue),B=Array(2).fill(j===d.checkedFieldsMapEnd[r]?A[1]:A[0]);A=Array(2).fill(j===d.checkedFieldsMapEnd[r]?A[0]:A[1]),ve=Be(d.parametersArr[r].filter(Y=>Y.id===ue));const _e=Be(d.parametersArr[r].filter(Y=>Y.id===j));s.push({componentId:u.id,fieldId:j,operator:ne,value:B,parameters:_e,isTree:Ie})}if((U=(F=d.checkedFieldsMapArrNum)==null?void 0:F[r])!=null&&U.length){const j=(ae=d.checkedFieldsMapArrNum)==null?void 0:ae[r].find(Y=>Y!==ue),B=Array(2).fill(j===d.checkedFieldsMapEndNum[r]?A[1]:A[0]);A=Array(2).fill(j===d.checkedFieldsMapEndNum[r]?A[0]:A[1]),ve=Be(d.parametersArr[r].filter(Y=>Y.id===ue));const _e=Be(d.parametersArr[r].filter(Y=>Y.id===j));s.push({componentId:u.id,fieldId:j,operator:ne,value:B,parameters:_e,isTree:Ie})}s.push({filterId:ie,componentId:u.id,fieldId:ue,operator:ne,value:A,parameters:ve,isTree:Ie})}}}})})},cl={key:0,class:"preview-main-frame-outer"},dl=["src"],fl=mt({__name:"DePreviewPopDialog",setup(o,{expose:s}){const r=Qe({dialogShow:!1,name:"",fullscreen:!1,url:"",width:"70vw",height:"70%"}),l=E(),u=Vt(),p=_(()=>r.fullscreen?{}:{height:r.height});return s({previewInit:k=>{if(k.url.includes("?")?r.url=`${k.url}&popWindow=true`:r.url=`${k.url}&popWindow=true`,k.size==="large"?r.fullscreen=!0:k.size==="middle"?(r.fullscreen=!1,r.width="80vw",r.height="80%"):(r.fullscreen=!1,r.width="65vw",r.height="65%"),r.dialogShow=!0,u.getToken&&r.url.includes("#/preview?dvId=")&&l!=null&&l.value){const x={methodName:"iframeInit",args:null};l.value.invokeMethod(x)}}}),(k,x)=>{const H=Zt;return D(),te(Pt,null,[z(H,{ref:"previewPopDialog","custom-class":"preview_pop_custom","append-to-body":!0,fullscreen:r.fullscreen,modelValue:r.dialogShow,"onUpdate:modelValue":x[0]||(x[0]=F=>r.dialogShow=F),style:de(p.value),modal:!1,width:r.width},{default:G(()=>[r.url?(D(),te("div",cl,[r.dialogShow?(D(),te("iframe",{key:0,class:"preview-main-frame",id:"iframe-de-preview-pop",src:r.url,scrolling:"auto",frameborder:"0"},null,8,dl)):ee("",!0)])):ee("",!0)]),_:1},8,["fullscreen","modelValue","style","width"]),z(a(ct),{ref_key:"xpackIframe",ref:l,jsname:"L2NvbXBvbmVudC9lbWJlZGRlZC1pZnJhbWUvSWZyYW1lU2VsZg=="},null,512)],64)}}});const ml=["innerHTML"],pl={key:0,style:{flex:"1",overflow:"hidden"}},vl=mt({__name:"index",props:{active:{type:Boolean,default:!1},element:{type:Object,default(){return{propValue:null}}},view:{type:Object,default(){return{propValue:null}}},themes:{type:String,required:!1,default:"dark"},showPosition:{type:String,required:!1,default:"preview"},searchCount:{type:Number,required:!1,default:0},disabled:{type:Boolean,required:!1,default:!1},scale:{type:Number,required:!1,default:1},suffixId:{type:String,required:!1,default:"common"},fontFamily:{type:String,required:!1,default:"inherit"},optType:{type:String,required:!1}},emits:["onPointClick"],setup(o,{emit:s}){const{wsCache:r}=_i(),l=E(),{t:u}=ei(),p=pt(),{emitter:d}=W(),k=E(null);let x=null;const H=Ci(),F=ki(),U=_(()=>H.getIsDataEaseBi),ae=_(()=>H.getIsIframe),N=s,{nowPanelJumpInfo:ie,publicLinkStatus:fe,dvInfo:le,curComponent:me,canvasStyleData:Z,mobileInPc:X,inMobile:be,editMode:Se,hiddenListStatus:Ve}=vt(p),re=o,pe=E(""),{view:t,showPosition:O,element:b,active:Te,searchCount:v,scale:c,suffixId:y}=Ot(re),f=_(()=>!["rich-text","picture-group"].includes(b.value.innerType)&&m.title_show&&O.value!=="viewDialog"),L=Hi(),m=Qe({initReady:!0,title_show:!0,title_remark:{show:!1,remark:""},title_class:{fontSize:"18px",color:"#303133",textAlign:"left",fontStyle:"normal",fontWeight:"normal",background:"",fontFamily:"",textShadow:"none",letterSpacing:"0px",fontSynthesis:"style weight",width:"fit-content",maxWidth:"100%",wordBreak:"break-word",whiteSpace:"pre-wrap"},drillFilters:[],viewInfoData:null,drillClickDimensionList:[]}),oe=_(()=>m.drillClickDimensionList.length),De=_(()=>f.value?m.title_class.textAlign==="center"?"center":m.title_class.textAlign==="right"?"flex-end":"flex-start":"flex-start"),M=_(()=>{var e;return((e=l==null?void 0:l.value)==null?void 0:e.trackMenu)??[]}),C=_(()=>M.value.indexOf("linkage")>-1||M.value.indexOf("linkageAndDrill")>-1),q=_(()=>M.value.indexOf("jump")>-1&&!X.value),Ke=_(()=>M.value.indexOf("drill")>-1||M.value.indexOf("linkageAndDrill")>-1),se=E(!1),Ie=_(()=>{var e;return((e=Z.value.dashboard)==null?void 0:e.resultMode)||null}),A=_(()=>{var e;return((e=Z.value.dashboard)==null?void 0:e.resultCount)||null}),ne=Vt(),ue=(e=!1,i="minute",n=5)=>{if(O.value==="preview"&&!x&&e){x&&clearInterval(x);const h=i==="second"?n*1e3:n*6e4;x=setInterval(()=>{ve(),Ae()},h)}},ve=()=>{p.clearViewLinkage(b.value.id),W().emitter.emit("clearPanelLinkage",{viewId:b.value.id})};Me([()=>c.value],()=>{B()}),Me([()=>v.value],()=>{x||Ae()}),Me([()=>A.value],()=>{Ae()}),Me([()=>Ie.value],()=>{Ae()}),Me([()=>c.value],()=>{we(()=>{var e,i;(i=(e=l==null?void 0:l.value)==null?void 0:e.renderChart)==null||i.call(e,t.value)})}),Me([()=>me.value],()=>{me.value&&me.value.id===t.value.id&&(m.initReady=!1,we(()=>{m.initReady=!0}))});const j=Mt(null);ui("chartExtRequest",j);const B=()=>{var e;if(t.value.customStyle){const i=t.value.customStyle;i.text&&(m.title_show=i.text.show,m.title_class.fontSize=i.text.fontSize*c.value+"px",m.title_class.color=i.text.color,m.title_class.textAlign=i.text.hPosition,m.title_class.fontStyle=i.text.isItalic?"italic":"normal",m.title_class.fontWeight=i.text.isBolder?"bold":"normal",F.fontList.length&&F.fontList.forEach(n=>{ke[n.name]=n.name}),m.title_class.fontFamily=i.text.fontFamily?ke[i.text.fontFamily]:Et.fontFamily,ke[i.text.fontFamily]||(m.title_class.fontFamily=(e=F.fontList.find(n=>n.isDefault))==null?void 0:e.name,i.text.fontFamily=m.title_class.fontFamily),F.setCurrentFont(m.title_class.fontFamily),m.title_class.letterSpacing=(i.text.letterSpace?i.text.letterSpace:Et.letterSpace)+"px",m.title_class.textShadow=i.text.fontShadow?"2px 2px 4px":"none"),i.background&&(m.title_class.background=Di(i.background.color,i.background.alpha)),m.title_remark.show=i.text.show&&i.text.remarkShow,m.title_remark.remark=i.text.remark}},_e=e=>{m.drillClickDimensionList.splice(e),t.value.chartExtRequest=he(),Re(t.value)},Y=e=>{try{const i={sourceDvId:le.value.id,sourceViewId:t.value.id,message:Ze.encode(JSON.stringify(e))};N("onPointClick",i)}catch{console.warn("de_inner_params send error")}},He=e=>{if(t.value.xAxis.map(n=>n.id).indexOf(re.view.drillFields[0].id)==-1){ze.error(u("chart.drill_field_error"));return}if(t.value.type==="circle-packing"&&e.data.name===u("commons.all")){ze.error(u("chart.last_layer"));return}m.drillClickDimensionList.length<re.view.drillFields.length-1?(m.drillClickDimensionList.push({dimensionList:e.data.dimensionList,extra:e.extra}),t.value.chartExtRequest=he(),Re(t.value)):re.view.drillFields.length>0&&ze.error(u("chart.last_layer"))},he=e=>{const{filter:i}=al(t.value.id,e);return{user:r.get("user.uid"),filter:i,linkageFilters:b.value.linkageFilters,outerParamsFilters:b.value.outerParamsFilters,webParamsFilters:b.value.webParamsFilters,drill:m.drillClickDimensionList,resultCount:A.value,resultMode:Ie.value}},Ne=e=>{m.drillFilters=e||[]},ce=E(null),Ee=e=>{if(ce!=null&&ce.value){const i={methodName:"initOpenHandler",args:e};ce.value.invokeMethod(i)}},ht=e=>{W().emitter.emit("changeCurrentComponent",e)},et=(e,i,n="middle")=>{try{let h;i==="newPop"?k.value.previewInit({url:e,size:n}):i==="_self"?(h=window.open(e,i),be.value&&window.location.reload()):h=window.open(e,i),Ee(h)}catch{console.warn(u("visualization.url_check_error")+":"+e)}},tt=e=>{let i,n,h;if(e.name)e.dimensionList.forEach(S=>{(S.id===e.name||S.value===e.name)&&(i=S,h=e.viewId+"#"+i.id,n=ie.value[h])});else for(let S=e.dimensionList.length-1;S>=0&&(i=e.dimensionList[S],h=e.viewId+"#"+i.id,n=ie.value[h],!n);S--);if(n){pi(p.getViewDataDetails(e.viewId),e),e.sourceDvId=le.value.id,e.sourceViewId=e.viewId,e.sourceFieldId=i.id;let S="";const g=U.value&&n.jumpType==="_self",w=ae.value&&n.jumpType==="_self";U.value&&(S=ne.baseUrl);const R=`&jumpInfoParam=${encodeURIComponent(Ze.encode(JSON.stringify(e)))}`;if(n.linkType==="inner")if(n.targetDvId){const $={},I=p.getLastViewRequestInfo(e.viewId),P=n.targetViewInfoList;I&&I.filter&&I.filter.length>0&&P&&P.length>0&&I.filter.forEach(T=>{P.forEach(Q=>{Q.sourceFieldActiveId===T.filterId&&($[Q.outerParamsName]={operator:T.operator,value:T.value})})});let J;if(Object.keys($).length>0&&($.outerParamsVersion="v2",J="&attachParams="+encodeURIComponent(Ze.encode(JSON.stringify($)))),fe.value)if(n.publicJumpId){let T=`${S}#/de-link/${n.publicJumpId}?fromLink=true`;J?T=T+J+R:T=T+"&ignoreParams=true"+J+R;const Q=window.location.href;localStorage.setItem("beforeJumpUrl",Q),et(T,n.jumpType,n.windowSize)}else ze.warning(u("visualization.public_link_tips"));else{let T=`${S}#/preview?dvId=${n.targetDvId}&fromLink=true`;J?T=T+J+R:T=T+"&ignoreParams=true"+J+R;const Q=window.location.href;if(localStorage.setItem("beforeJumpUrl",Q),g||w){ne.setDvId(n.targetDvId),ne.setJumpInfoParam(encodeURIComponent(Ze.encode(JSON.stringify(e)))),ht("Preview");return}et(T,n.jumpType,n.windowSize)}}else ze.warning("未指定跳转仪表板");else{const $=[...e.dimensionList,...e.quotaList];let I=Ri("id","value",n.content,$);if(I=Oi(I),(ae.value||U.value)&&ne.clearState(),g){ne.setOuterUrl(I),ht("Iframe");return}et(I,n.jumpType,n.windowSize)}}},Ae=(e=!1)=>{if(se.value)return;const i=p.firstLoadMap.includes(b.value.id),n=he(i?!1:e);let h=dt(t.value);h.chartExtRequest=n,j.value=n,Re(h)},Re=e=>{var i,n,h;p.setLastViewRequestInfo(e.id,e.chartExtRequest),l!=null&&l.value&&(se.value=!0,t.value.isPlugin?(i=l==null?void 0:l.value)==null||i.invokeMethod({methodName:"calcData",args:[e,S=>{se.value=!1}]}):(h=(n=l==null?void 0:l.value)==null?void 0:n.calcData)==null||h.call(n,e,S=>{se.value=!1}))},qe=(...e)=>{var i,n;if((i=t.value)!=null&&i.render&&((n=t.value)!=null&&n.type)){const h=At.getChartView(t.value.render,t.value.type);return h&&(e==null?void 0:e.includes(h.library))}else return!1};li(()=>{O.value.includes("viewDialog")||we(()=>{W({name:`query-data-${t.value.id}`,callback:Ae})})});const Ht=_(()=>!O.value.includes("viewDialog")),it=new Map,ge=E(!1),lt=e=>{var i,n,h,S,g,w,R,$,I,P,J,T,Q,nt,We,St,Dt;if(ge.value=!1,(i=t.value)!=null&&i.render&&((n=t.value)!=null&&n.type)){const It=At.getChartView(t.value.render,t.value.type);if(!It)return;const at=Ii(t.value.customAttr).map;if(["bubble-map","map"].includes((h=t.value)==null?void 0:h.type)&&!(at!=null&&at.id)){ge.value=!0;return}const Ft=new Map(Object.entries(It.axisConfig));let Ue=!1;if(e&&e.length>0){it.set(t.value.id,e);e:for(const[ye,Oe]of Ft)if(!Oe.allowEmpty&&(g=(S=t.value)==null?void 0:S[ye])!=null&&g.length){for(const ot of t.value[ye])if(!e.find(st=>st.id===ot.id)){Ue=!0;break e}}}if(Ue){ge.value=!0;return}for(const[ye,Oe]of Ft)if(!Oe.allowEmpty){if(it.get((w=t.value)==null?void 0:w.id)){if(($=(R=t.value)==null?void 0:R[ye])!=null&&$.length){for(const ot of t.value[ye])if(!it.get((I=t.value)==null?void 0:I.id).find(st=>st.id===ot.id)){Ue=!0;break}}if(Ue){ge.value=!0;break}}if(!Oe.limit&&((J=(P=t.value)==null?void 0:P[ye])==null?void 0:J.length)===0){ge.value=!0;break}if(Oe.limit&&(!((T=t.value)!=null&&T[ye])||((nt=(Q=t.value)==null?void 0:Q[ye])==null?void 0:nt.length)<parseInt(Oe.limit))){ge.value=!0;break}if(((We=t.value)==null?void 0:We.type)==="table-info"&&((Dt=(St=t.value)==null?void 0:St[ye])==null?void 0:Dt.length)===0){ge.value=!0;break}}}},Nt=()=>{lt()},qt=()=>{lt()};ri(()=>{var h,S;if(t.value.isPlugin||(m.drillClickDimensionList=((S=(h=t.value)==null?void 0:h.chartExtRequest)==null?void 0:S.drill)??[],Ae(!O.value.includes("viewDialog"))),!Ht.value)return;W({name:"checkShowEmpty",callback:g=>{var w;((w=g.view)==null?void 0:w.id)===t.value.id&&lt(g.allFields)}}),W({name:"chart-type-change",callback:Nt}),W({name:"dataset-change",callback:qt}),W({name:"clearPanelLinkage",callback:function(g){var w,R;(g.viewId==="all"||g.viewId===b.value.id)&&((R=(w=l==null?void 0:l.value)==null?void 0:w.clearLinkage)==null||R.call(w))}}),W({name:"snapshotChangeToView",callback:function(g){B(),we(()=>{var w,R;g.snapshotCacheViewCalc.includes(t.value.id)||g.snapshotCacheViewCalc.includes("all")?(t.value.chartExtRequest=he(!1),Re(t.value)):(g.snapshotCacheViewRender.includes(t.value.id)||g.snapshotCacheViewRender.includes("all"))&&((R=(w=l==null?void 0:l.value)==null?void 0:w.renderChart)==null||R.call(w,t.value))})}}),W({name:"calcData-"+t.value.id,callback:function(g){m.initReady&&(B(),we(()=>{t.value.chartExtRequest=he(!1);const w=g||t.value;Re(w)}))}}),W({name:"calcData-all",callback:function(){m.initReady&&(B(),we(()=>{t.value.chartExtRequest=he(!1),Re(t.value)}))}}),W({name:"renderChart-"+t.value.id,callback:function(g){if(!m.initReady)return;B();const w=g||t.value;we(()=>{var R,$,I,P,J;if(($=(R=t.value)==null?void 0:R.plugin)!=null&&$.isPlugin){(I=l==null?void 0:l.value)==null||I.invokeMethod({methodName:"renderChart",args:[w]});return}(J=(P=l==null?void 0:l.value)==null?void 0:P.renderChart)==null||J.call(P,w)})}}),W({name:"resetDrill-"+t.value.id,callback:function(g){we(()=>{_e(g)})}}),W({name:"tabCanvasChange-"+b.value.canvasId,callback:function(){!m.initReady&&!t.value.type.includes("table")||setTimeout(function(){var g,w;(w=(g=l==null?void 0:l.value)==null?void 0:g.renderChart)==null||w.call(g,t.value)},200)}}),W({name:"updateTitle-"+t.value.id,callback:()=>{B()}}),W({name:"chart-type-change-"+t.value.id,callback:()=>{const g=dt(t.value);g.container="container-"+O.value+"-"+t.value.id+"-"+y.value,Ai(g)}});const{refreshViewEnable:e,refreshUnit:i,refreshTime:n}=t.value;ue(e,i,n),B()});const gt=_(()=>(Z.value.refreshViewLoading||v.value===0)&&se.value),yt=_(()=>{var e,i,n;return!!(t.value.tableId&&(b.value.state===void 0||b.value.state==="ready")||["rich-text","picture-group"].includes(t.value.type)||(e=t.value)!=null&&e.isPlugin||t.value.dataFrom==="template"||(n=(i=t.value.customAttr)==null?void 0:i.map)!=null&&n.id&&["map","bubble-map","flow-map"].includes(t.value.type))}),wt=E(),je=E(!1);function jt(){re.active&&(je.value||(je.value=!0,we(()=>{var e;(e=wt.value)==null||e.focus(),b.value.editing=!0})))}function xt(){b.value.editing=!1,je.value=!1}const zt={beforeMount(e,i){e.clickOutsideEvent=function(n){e===n.target||e.contains(n.target)||i.value(n)},document.addEventListener("click",e.clickOutsideEvent)},unmounted(e){document.removeEventListener("click",e.clickOutsideEvent)}};function Bt(){b.value.name=t.value.title,b.value.label=t.value.title,L.recordSnapshotCache("onTitleChange")}const $e=_(()=>re.themes==="dark"?"ndark":"dark"),Yt=_(()=>f.value&&(f.value||M.value.length>0||m.title_remark.show)?12*c.value+"px":0),Je=_(()=>16*c.value+"px"),kt=e=>{const{backgroundColor:i,backgroundType:n,backgroundImageEnable:h,backgroundColorSelect:S}=b.value.commonBackground,g="rgba(0,0,0,0.01)";if(n==="outerImage"&&h)return g;if(i.includes("#"))return e||!S?g:i;const w=i.match(/rgba\((\d+), (\d+), (\d+), (\d+|0.\d+)\)/);if(!w)return i;const[R,$,I,P]=w.slice(1).map(Number);return`rgba(${R}, ${$}, ${I}, ${!S||e?.01:P})`},$t=_(()=>{const e=kt(!1),n={position:"absolute",border:`1px solid ${kt(!0)}`,"background-color":e,"border-radius":"2px",padding:"0 2px 0 2px","z-index":1,top:"2px",left:"2px",...M.value.length?{}:{display:"none"}};return{color:Z.value.component.seniorStyleSetting.linkageIconColor,...f.value?{}:n}}),rt=E(!1),Jt=_(()=>rt.value?M.value.length>0||m.title_remark.show:!1),Ct=E(yi),Wt=_(()=>{let e=!1;return Ct.value.forEach(i=>{e=i.details.find(n=>{var h;return((h=t.value)==null?void 0:h.type)===n.value})!==void 0}),e}),Ut=e=>{e.forEach(i=>{var T;const{category:n,title:h,render:S,chartValue:g,chartTitle:w,icon:R,staticMap:$}=i,I={render:S,category:n,icon:R,value:g,title:w,isPlugin:!0,staticMap:$};((T=t.value)==null?void 0:T.type)===I.value&&(t.value.plugin={isPlugin:!0,staticMap:$});const P=[...Ct.value];let J=!1;for(;P!=null&&P.length;){const Q=P.pop();Q.category===n&&(Q.details.find(We=>We.value===I.value)||Q.details.push(I),J=!0)}J||P.push({category:n,title:h,display:"show",details:[I]})})},_t=_(()=>["rich-text","picture-group"].includes(b.value.innerType)),Gt=_(()=>be.value?`${screen.width-10}px`:X.value?"270px":"500px"),bt=()=>{const e=document.getElementById("g2-tooltip-wrapper");if(e)for(const i of e.children)i.style.display="none"};return(e,i)=>{var g;const n=ii,h=Qt,S=ni("loading");return ut((D(),te("div",{class:Lt(["chart-area report-load",{"report-load-finish":!gt.value}]),"element-loading-background":"rgba(0,0,0,0)",onMouseover:i[4]||(i[4]=w=>rt.value=!0),onMouseleave:i[5]||(i[5]=w=>rt.value=!1)},[Ce("div",{class:"title-container",style:de({"justify-content":De.value,"margin-bottom":Yt.value})},[je.value?ut((D(),K(a(Xt),{key:1,style:{flex:"1"},effect:a(Z).dashboard.themeColor,ref_key:"titleInputRef",ref:wt,modelValue:a(t).title,"onUpdate:modelValue":i[0]||(i[0]=w=>a(t).title=w),onKeydown:[i[1]||(i[1]=ai(()=>{},["stop"])),oi(xt,["enter"])],onChange:Bt},null,8,["effect","modelValue"])),[[zt,xt]]):(D(),te(Pt,{key:0},[f.value?(D(),te("p",{key:0,style:de(m.title_class),onDblclick:jt},Xe(a(t).title),37)):ee("",!0)],64)),z(si,{name:"fade"},{default:G(()=>[ut(Ce("div",{class:Lt(["icons-container",{"is-editing":je.value}]),style:de($t.value)},[m.title_remark.show?(D(),K(h,{key:0,effect:$e.value,placement:"top"},{content:G(()=>[Ce("div",{style:de({maxWidth:Gt.value,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap"}),innerHTML:m.title_remark.remark},null,12,ml)]),default:G(()=>[z(a(Ge),{size:Je.value,class:"inner-icon"},{default:G(()=>[z(n,{name:"icon_info_outlined"},{default:G(()=>[z(a(di),{class:"svg-icon"})]),_:1})]),_:1},8,["size"])]),_:1},8,["effect"])):ee("",!0),C.value?(D(),K(h,{key:1,effect:$e.value,placement:"top",content:"已设置联动"},{default:G(()=>[z(a(Ge),{size:Je.value,class:"inner-icon"},{default:G(()=>[z(n,{name:"icon_link-record_outlined"},{default:G(()=>[z(a(zi),{class:"svg-icon"})]),_:1})]),_:1},8,["size"])]),_:1},8,["effect"])):ee("",!0),q.value?(D(),K(h,{key:2,effect:$e.value,placement:"top",content:a(u)("visualization.jump_set_tips")},{default:G(()=>[z(a(Ge),{size:Je.value,class:"inner-icon"},{default:G(()=>[z(n,{name:"icon_viewinchat_outlined"},{default:G(()=>[z(a($i),{class:"svg-icon"})]),_:1})]),_:1},8,["size"])]),_:1},8,["effect","content"])):ee("",!0),Ke.value?(D(),K(h,{key:3,effect:$e.value,placement:"top",content:a(u)("visualization.drill_set_tips")},{default:G(()=>[z(a(Ge),{size:Je.value,class:"inner-icon"},{default:G(()=>[z(n,{name:"icon_drilling_outlined"},{default:G(()=>[z(a(Ui),{class:"svg-icon"})]),_:1})]),_:1},8,["size"])]),_:1},8,["effect","content"])):ee("",!0)],6),[[ci,Jt.value]])]),_:1})],4),_t.value||yt.value&&!ge.value?(D(),te("div",pl,[(g=a(t).plugin)!=null&&g.isPlugin?(D(),K(a(Si),{key:0,jsname:a(t).plugin.staticMap.index,scale:a(c),"dynamic-area-id":pe.value,view:a(t),"show-position":a(O),element:a(b),request:a(ti),emitter:a(d),store:a(bi),suffixId:a(y),ref_key:"chartComponent",ref:l,onOnChartClick:He,onOnPointClick:Y,onOnDrillFilters:Ne,onOnJumpClick:tt,onResetLoading:i[2]||(i[2]=()=>se.value=!1)},null,8,["jsname","scale","dynamic-area-id","view","show-position","element","request","emitter","store","suffixId"])):qe(a(Le).PICTURE_GROUP)?(D(),K(Pi,{key:1,themes:a(Z).dashboard.themeColor,ref_key:"chartComponent",ref:l,element:a(b),active:a(Te),view:a(t),"show-position":a(O),suffixId:a(y)},null,8,["themes","element","active","view","show-position","suffixId"])):qe(a(Le).RICH_TEXT)?(D(),K(Mi,{key:2,scale:a(c),themes:a(Z).dashboard.themeColor,ref_key:"chartComponent",ref:l,element:a(b),disabled:!["canvas","canvasDataV"].includes(a(O))||o.disabled,active:a(Te),"show-position":a(O),"edit-mode":a(Se),suffixId:a(y)},null,8,["scale","themes","element","disabled","active","show-position","edit-mode","suffixId"])):qe(a(Le).INDICATOR)?(D(),K(Gi,{key:3,scale:a(c),themes:a(Z).dashboard.themeColor,ref_key:"chartComponent",ref:l,view:a(t),"show-position":a(O),suffixId:a(y),"font-family":o.fontFamily,onTouchstart:bt},null,8,["scale","themes","view","show-position","suffixId","font-family"])):qe(a(Le).G2_PLOT,a(Le).L7_PLOT,a(Le).L7)?(D(),K(fi,{key:4,scale:a(c),"dynamic-area-id":pe.value,view:a(t),"show-position":a(O),element:a(b),suffixId:a(y),"font-family":o.fontFamily,ref_key:"chartComponent",ref:l,onOnChartClick:He,onOnPointClick:Y,onOnDrillFilters:Ne,onOnJumpClick:tt,onResetLoading:i[3]||(i[3]=()=>se.value=!1)},null,8,["scale","dynamic-area-id","view","show-position","element","suffixId","font-family"])):qe(a(Le).S2)?(D(),K(Ei,{key:5,view:a(t),scale:a(c),"show-position":a(O),element:a(b),"drill-length":oe.value,"font-family":o.fontFamily,ref_key:"chartComponent",ref:l,onOnPointClick:Y,onOnChartClick:He,onOnDrillFilters:Ne,onOnJumpClick:tt,suffixId:a(y)},null,8,["view","scale","show-position","element","drill-length","font-family","suffixId"])):ee("",!0)])):ee("",!0),(!yt.value||ge.value)&&!_t.value?(D(),K(Vi,{key:1,themes:a(Z).dashboard.themeColor,"view-icon":a(t).type,onTouchstart:bt},null,8,["themes","view-icon"])):ee("",!0),z(Fi,{disabled:o.optType==="enlarge","drill-filters":m.drillFilters,onOnDrillJump:_e},null,8,["disabled","drill-filters"]),z(a(ct),{ref_key:"openHandler",ref:ce,jsname:"L2NvbXBvbmVudC9lbWJlZGRlZC1pZnJhbWUvT3BlbkhhbmRsZXI="},null,512),!Wt.value&&a(t).isPlugin?(D(),K(a(ct),{key:2,jsname:"L2NvbXBvbmVudC9wbHVnaW5zLWhhbmRsZXIvVmlld0NhdGVnb3J5SGFuZGxlcg==",onLoadPluginCategory:Ut})):ee("",!0),z(fl,{ref_key:"dePreviewPopDialogRef",ref:k},null,512)],34)),[[S,gt.value]])}}});const ea=Ni(vl,[["__scopeId","data-v-120a8410"]]);export{ea as default};

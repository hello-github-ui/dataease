import{k}from"./DePreview-0.0.0-dataease.js";import{i as I,V as S,o as C}from"./canvasUtils-0.0.0-dataease.js";import{i as D}from"./interactive-0.0.0-dataease.js";import{a as E,b as M,u as O}from"./index-0.0.0-dataease.js";import{j as B,n as V,i as F}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{a as x}from"./CrossPermission-0.0.0-dataease.js";import{g as T}from"./outerParams-0.0.0-dataease.js";import{p as j}from"./element-plus-secondary-0.0.0-dataease.js";import{d as q}from"./dvMain-0.0.0-dataease.js";import"./vant-0.0.0-dataease.js";import{E as N}from"./EmptyBackground-0.0.0-dataease.js";import{d as z,r as u,i as G,l as R,R as W,n as A,o as c,c as v,z as J,a0 as L,Y as f,Z as Y,M as Z}from"./@vue-0.0.0-dataease.js";import{_ as H}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./style-0.0.0-dataease.js";import"./translate-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./mathjs-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./imgUtils-0.0.0-dataease.js";import"./html2canvas-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./util-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";import"./html-to-image-0.0.0-dataease.js";import"./util-0.0.0-dataease2.js";import"./chart-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./app-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./vue-router-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./eventBus-0.0.0-dataease.js";import"./Component-0.0.0-dataease16.js";import"./DeShortcutKey-0.0.0-dataease.js";import"./snapshot-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./canvasStyle-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./ModelUtil-0.0.0-dataease.js";import"./index-0.0.0-dataease12.js";import"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./exceljs-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./Component-0.0.0-dataease15.js";import"./icon_edit_outlined-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./HandleMore.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import"./icon_more_outlined-0.0.0-dataease.js";import"./more_v-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./icon_drag_outlined-0.0.0-dataease.js";import"./icon_visible_outlined-0.0.0-dataease.js";import"./dv-folder-0.0.0-dataease.js";import"./icon_dataset-0.0.0-dataease.js";import"./icon_warning_filled-0.0.0-dataease.js";import"./icon_info_outlined-0.0.0-dataease.js";import"./vuedraggable-0.0.0-dataease.js";import"./time-format-0.0.0-dataease.js";import"./time-format-dayjs-0.0.0-dataease.js";import"./attr-0.0.0-dataease20.js";import"./icon_admin_outlined-0.0.0-dataease.js";import"./chart-list-0.0.0-dataease.js";import"./field-list-0.0.0-dataease.js";import"./treeSortUtils-0.0.0-dataease.js";import"./Attr-0.0.0-dataease19.js";import"./CommonAttr-0.0.0-dataease.js";import"./CommonBorderSetting.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./BackgroundOverallCommon-0.0.0-dataease.js";import"./board-list-0.0.0-dataease.js";import"./ImgViewDialog-0.0.0-dataease.js";import"./icon_italic_outlined-0.0.0-dataease.js";import"./icon_right-alignment_outlined-0.0.0-dataease.js";import"./CarouselSetting.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./CollapseSwitchItem-0.0.0-dataease.js";import"./icon_replace_outlined-0.0.0-dataease.js";import"./icon_download_outlined-0.0.0-dataease.js";import"./Component.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./watermark-0.0.0-dataease2.js";import"./user-0.0.0-dataease.js";import"./jquery-0.0.0-dataease.js";import"./ChartComponentS2-0.0.0-dataease.js";import"./ViewTrackBar-0.0.0-dataease.js";import"./ChartError-0.0.0-dataease.js";import"./LinkageSet-0.0.0-dataease.js";import"./dv-link-target-0.0.0-dataease.js";import"./dv-dashboard-spine-0.0.0-dataease.js";import"./dv-screen-spine-0.0.0-dataease.js";import"./CodeMirror-0.0.0-dataease2.js";import"./@codemirror-0.0.0-dataease.js";import"./@lezer-0.0.0-dataease.js";import"./style-mod-0.0.0-dataease.js";import"./crelt-0.0.0-dataease.js";import"./@marijn-0.0.0-dataease.js";import"./w3c-keyname-0.0.0-dataease.js";import"./codemirror-0.0.0-dataease.js";import"./dv-empty-0.0.0-dataease.js";import"./Attr.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import"./Component-0.0.0-dataease14.js";import"./index-0.0.0-dataease17.js";import"./ChartComponentG2Plot-0.0.0-dataease.js";import"./PluginComponent.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./DrillPath-0.0.0-dataease.js";import"./js-base64-0.0.0-dataease.js";import"./DeRichTextView-0.0.0-dataease.js";import"./@tinymce-0.0.0-dataease.js";import"./@npkg-0.0.0-dataease.js";import"./Component-0.0.0-dataease10.js";import"./ChartEmptyInfo-0.0.0-dataease.js";import"./chart-dark-list-0.0.0-dataease.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./Component-0.0.0-dataease11.js";import"./Attr-0.0.0-dataease13.js";import"./Attr-0.0.0-dataease.js";import"./Component-0.0.0-dataease3.js";import"./Attr.vue_vue_type_style_index_0_lang-0.0.0-dataease2.js";import"./Attr-0.0.0-dataease7.js";import"./Component-0.0.0-dataease5.js";import"./Attr-0.0.0-dataease5.js";import"./Component-0.0.0-dataease4.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease2.js";import"./Component-0.0.0-dataease12.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease3.js";import"./Component.vue_vue_type_script_setup_true_lang-0.0.0-dataease2.js";import"./Attr-0.0.0-dataease8.js";import"./Component-0.0.0-dataease9.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease4.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease5.js";import"./Component-0.0.0-dataease8.js";import"./@videojs-player-0.0.0-dataease.js";import"./video.js-0.0.0-dataease.js";import"./global-0.0.0-dataease.js";import"./keycode-0.0.0-dataease.js";import"./safe-json-parse-0.0.0-dataease.js";import"./@videojs-0.0.0-dataease.js";import"./is-function-0.0.0-dataease.js";import"./url-toolkit-0.0.0-dataease.js";import"./videojs-vtt.js-0.0.0-dataease.js";import"./m3u8-parser-0.0.0-dataease.js";import"./mpd-parser-0.0.0-dataease.js";import"./@xmldom-0.0.0-dataease.js";import"./mux.js-0.0.0-dataease.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease6.js";import"./Component-0.0.0-dataease6.js";import"./flv.js-0.0.0-dataease.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease7.js";import"./Component-0.0.0-dataease13.js";import"./Attr-0.0.0-dataease16.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease8.js";import"./Attr-0.0.0-dataease12.js";import"./DatasetSelect-0.0.0-dataease.js";import"./icon_done_outlined-0.0.0-dataease.js";import"./Threshold-0.0.0-dataease.js";import"./TableThresholdEdit-0.0.0-dataease.js";import"./icon_info_filled-0.0.0-dataease.js";import"./TextLabelThresholdEdit-0.0.0-dataease.js";import"./TextThresholdEdit-0.0.0-dataease.js";import"./LineThresholdEdit-0.0.0-dataease.js";import"./PictureGroupThresholdEdit-0.0.0-dataease.js";import"./Component-0.0.0-dataease2.js";import"./icon_left_outlined-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./@vant-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";const K=z({__name:"DashboardPreview",setup(Q){const{wsCache:_}=E(),w=D(),p=M(),d=u(null),a=G("embeddedParams"),o=a!=null&&a.dvId?a:p,{t:P}=B(),t=R({canvasDataPreview:null,canvasStylePreview:null,canvasViewInfoPreview:null,dvInfo:null,curPreviewGap:0,initState:!0}),e=q(),g=async s=>{if(!window.DataEaseBi||!s)return!0;const i={busiFlag:o.busiFlag};await w.setInteractive(i);const m=o.busiFlag==="dataV"?"screen-weight":"panel-weight";return x(_.get(m),s,1)},n=u(!0);return W(async()=>{if(!await g(o.dvId))return;let i=null;if(p.getToken&&!Object.keys(i=p.getTokenInfo).length){const r=await V.get({url:"/embedded/getTokenArgs"});p.setTokenInfo(r.data),i=p.getTokenInfo}let m;if(await T(o.dvId).then(r=>{e.setNowPanelOuterParamsInfoV2(r.data,o.dvId)}),o.outerParams)try{const r=JSON.parse(o.outerParams);m=r.attachParams,e.setEmbeddedCallBack(r.callBackFlag||"no")}catch(r){console.error(r),j.error(P("visualization.outer_param_decode_error"));return}i&&Object.keys(i).length&&(m=Object.assign({},m,i)),n.value=!F(),(n.value?I:S)(o.dvId,o.busiFlag,function({canvasDataResult:r,canvasStyleResult:b,dvInfo:l,canvasViewInfoPreview:h,curPreviewGap:y}){if(!n.value)if(l.mobileLayout)e.setMobileInPc(!0),e.setInMobile(!0);else{O().emitter.emit("changeCurrentComponent","DashboardEmpty");return}t.canvasDataPreview=r,t.canvasStylePreview=b,t.canvasViewInfoPreview=h,t.dvInfo=l,t.curPreviewGap=y,A(()=>{d.value.restore(),C({resourceId:o.dvId})}),t.initState=!1,e.addOuterParamsFilter(m,r,"outer"),t.initState=!0})}),(s,i)=>{const m=k;return c(),v(Z,null,[t.canvasStylePreview&&t.initState?(c(),v("div",{key:0,class:J(n.value?"dashboard-preview":"dv-common-layout-mobile_embedded")},[L(m,{ref_key:"dashboardPreview",ref:d,"dv-info":t.dvInfo,"cur-gap":t.curPreviewGap,"component-data":t.canvasDataPreview,"canvas-style-data":t.canvasStylePreview,"canvas-view-info":t.canvasViewInfoPreview,"show-position":"preview"},null,8,["dv-info","cur-gap","component-data","canvas-style-data","canvas-view-info"])],2)):f("",!0),t.initState?f("",!0):(c(),Y(N,{key:1,description:"参数不能为空","img-type":"noneWhite"}))],64)}}});const Rm=H(K,[["__scopeId","data-v-f298a182"]]);export{Rm as default};

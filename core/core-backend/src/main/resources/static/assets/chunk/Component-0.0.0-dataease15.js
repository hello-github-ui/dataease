import{az as at,u as ka,a as Tn,M as kn}from"./index-0.0.0-dataease.js";import{n as wa,j as Ct,y as Ia,o as ia,D as Re,G as Mt,F as Cn,i as ht,aw as Mn}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{f as d,L as F,M as _,d as Ae,r as ne,g as Y,i as o,k as u,a5 as le,a6 as S,j as a,s as xa,G as L,a9 as ve,Y as oe,T as $a,ab as Ie,W as St,t as Qe,w as pe,ak as ga,a0 as Z,U as Ve,m as Ue,E as Sn,an as Fn,n as Se,a4 as Ft,Q as xe,V as Ne,af as cl,aj as wn,o as wt,aa as ml,ah as tt,Z as vl,R as sa,aw as Ma,p as $n,ac as Jt,ay as pl,a as qn}from"./vue-0.0.0-dataease.js";import{i as Sa}from"./icon_edit_outlined-0.0.0-dataease.js";import{i as $t}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{e as On}from"./eventBus-0.0.0-dataease.js";import{s as fl}from"./snapshot-0.0.0-dataease.js";import{a as Dn}from"./library-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import{a as Nn,E as En}from"./el-form-item-0.0.0-dataease.js";import{E as qt}from"./el-dialog-0.0.0-dataease.js";import{E as yl}from"./el-popover-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{E as qa,a as De}from"./el-select-0.0.0-dataease.js";import"./el-tree-0.0.0-dataease.js";import{E as Ot,a as An}from"./el-checkbox-0.0.0-dataease.js";import{E as _l}from"./el-tree-select-0.0.0-dataease.js";import"./el-checkbox-group-0.0.0-dataease.js";import{E as In,a as xn}from"./el-tabs-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import{E as Ra,a as La}from"./el-radio-0.0.0-dataease.js";import{_ as Rn}from"./HandleMore.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{m as Ln}from"./more_v-0.0.0-dataease.js";import{i as Ja}from"./icon_add_outlined-0.0.0-dataease.js";import{i as Un}from"./icon_drag_outlined-0.0.0-dataease.js";import{i as Yn}from"./icon_visible_outlined-0.0.0-dataease.js";import{d as Bn}from"./dv-folder-0.0.0-dataease.js";import{i as Gn}from"./icon_dataset-0.0.0-dataease.js";import{i as Pn}from"./icon_warning_filled-0.0.0-dataease.js";import{i as jn}from"./icon_info_outlined-0.0.0-dataease.js";import{B as Wn,y as hl,C as zn,D as Hn,E as Qn,F as Xt,g as Kn}from"./dataset-0.0.0-dataease.js";import{d as gl}from"./vuedraggable-es-0.0.0-dataease.js";import{d as Le,c as Zn,g as Jn,e as bl}from"./lodash-0.0.0-dataease.js";import{g as Vl}from"./util-0.0.0-dataease.js";import{g as Na,a as Xn,b as ei,c as ai,d as ti,e as li,f as ni,h as ii,i as ui,j as ri}from"./time-format-0.0.0-dataease.js";import{d as Ua}from"./dvMain-0.0.0-dataease.js";import{g as na,a as je,b as _a,c as Dt}from"./time-format-dayjs-0.0.0-dataease.js";import{f as be}from"./attr-0.0.0-dataease20.js";import{E as gt}from"./EmptyBackground-0.0.0-dataease.js";import{d as ke}from"./dayjs.min-0.0.0-dataease.js";import{E as oi}from"./el-time-picker-0.0.0-dataease.js";import{E as lt}from"./el-input-number-0.0.0-dataease.js";import{i as si}from"./icon_admin_outlined-0.0.0-dataease.js";import{E as Ya}from"./el-date-picker-0.0.0-dataease.js";import{s as di}from"./index-0.0.0-dataease25.js";import{c as Oa,i as ci,e as ha,a as et,n as bt,m as za,b as Ea,u as Tl,d as kl,p as Cl,f as da,t as Ml,g as Sl,h as mi,j as Aa,k as vi,l as pi,o as Va,q as Fl,w as nt,r as el}from"./index-0.0.0-dataease26.js";import{u as fi,a as it}from"./use-route-0.0.0-dataease.js";import{L as yi}from"./index-0.0.0-dataease28.js";import{H as al,B as _i}from"./index-0.0.0-dataease27.js";import{T as hi,a as gi}from"./index-0.0.0-dataease29.js";import"./index-0.0.0-dataease30.js";import"./el-virtual-list-0.0.0-dataease.js";import{E as bi}from"./el-select-v2-0.0.0-dataease.js";import{_ as Ba}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import{E as Nt}from"./index-0.0.0-dataease3.js";import{a as Vi}from"./chart-list-0.0.0-dataease.js";import{i as Je}from"./field-list-0.0.0-dataease.js";import{t as Ti}from"./treeSortUtils-0.0.0-dataease.js";const ki={width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"};function Ci(s,y){return d(),F("svg",ki,y[0]||(y[0]=[_("path",{d:"M8.00022 9.99975C7.56203 9.99975 7.13323 9.96523 6.71734 9.89921L6.38535 11.1382C6.33771 11.316 6.15493 11.4216 5.9771 11.3739L5.33315 11.2014C5.15533 11.1537 5.0498 10.9709 5.09745 10.7931L5.42255 9.57985C4.88013 9.39561 4.37096 9.15494 3.90491 8.86629L2.8454 9.9258C2.71522 10.056 2.50417 10.056 2.37399 9.9258L1.90259 9.4544C1.77242 9.32422 1.77242 9.11317 1.90259 8.98299L2.83565 8.04994C2.35424 7.59918 1.95209 7.0852 1.64812 6.52421C1.64492 6.51832 1.64162 6.51215 1.63823 6.50575C1.5136 6.27038 1.56023 5.97574 1.75709 5.79635C1.92051 5.64743 2.03596 5.5461 2.13639 5.44567C2.14538 5.43669 2.15521 5.42666 2.16569 5.41583C2.31108 5.2656 2.55902 5.32152 2.64417 5.51246C3.47427 7.37398 5.46211 8.66641 8.00022 8.66641C10.4321 8.66641 12.4664 7.40872 13.2829 5.68239C13.3042 5.63747 13.328 5.5809 13.3519 5.52084C13.4276 5.33064 13.6741 5.27325 13.8188 5.41801C13.9259 5.52508 14.0687 5.66784 14.2471 5.8463C14.4235 6.0227 14.4713 6.29211 14.356 6.51334C14.3279 6.56715 14.3006 6.61785 14.2774 6.65816C13.9638 7.20109 13.5572 7.69751 13.0754 8.1321L13.9263 8.98299C14.0565 9.11317 14.0565 9.32422 13.9263 9.4544L13.4549 9.9258C13.3247 10.056 13.1136 10.056 12.9835 9.9258L11.9888 8.93112C11.5521 9.19111 11.0792 9.40958 10.5779 9.57985L10.903 10.7931C10.9506 10.9709 10.8451 11.1537 10.6673 11.2014L10.0233 11.3739C9.84552 11.4216 9.66274 11.316 9.61509 11.1382L9.2831 9.89921C8.86721 9.96523 8.43842 9.99975 8.00022 9.99975Z"},null,-1)]))}const Mi={render:Ci},Si={t:"1652583161182",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2172",width:"200",height:"200"};function Fi(s,y){return d(),F("svg",Si,y[0]||(y[0]=[_("path",{d:"M362.666667 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"2173"},null,-1),_("path",{d:"M661.333333 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"2174"},null,-1),_("path",{d:"M362.666667 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"2175"},null,-1),_("path",{d:"M661.333333 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"2176"},null,-1),_("path",{d:"M362.666667 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"2177"},null,-1),_("path",{d:"M661.333333 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"2178"},null,-1)]))}const wi={render:Fi},$i=["title"],qi={class:"item-span"},Oi={class:"dialog-footer"},Di=Ae({__name:"CustomSortFilter",emits:["save"],setup(s,{expose:y,emit:i}){const t=ne([]),r=ne(!1),v=x=>{f(x),r.value=!0},f=x=>{t.value=Le(x)},M=i,w=()=>{r.value=!1},V=()=>{M("save",a(t)),w()};return y({sortInit:v}),(x,B)=>{const c=wa,C=Ct,D=Ia,T=qt;return d(),Y(T,{"destroy-on-close":"","append-to-body":"",title:x.$t("v_query.custom_sort"),modelValue:r.value,"onUpdate:modelValue":B[0]||(B[0]=J=>r.value=J),class:"custom-sort_filter",width:"300px"},{footer:o(()=>[_("div",Oi,[u(D,{onClick:w},{default:o(()=>[le(S(x.$t("common.cancel")),1)]),_:1}),u(D,{type:"primary",onClick:V},{default:o(()=>[le(S(x.$t("chart.confirm")),1)]),_:1})])]),default:o(()=>[_("div",null,[u(a(gl),{list:t.value,animation:"300",class:"drag-list"},{item:o(({element:J})=>[(d(),F("span",{key:J.name,class:"item-dimension",title:J},[u(C,{size:"20px"},{default:o(()=>[u(c,{name:"drag"},{default:o(()=>[u(a(wi),{class:"svg-icon"})]),_:1})]),_:1}),_("span",qi,S(J),1)],8,$i))]),_:1},8,["list"])])]),_:1},8,["title","modelValue"])}}});const{t:Ni}=ia(),wl=s=>{const{id:y,name:i,deType:t,type:r,datasetId:v}=s;return{id:Vl(),name:i,showError:!0,timeGranularity:"date",timeGranularityMultiple:"datetimerange",field:{id:y,type:r,name:i,deType:t},displayId:y,sortId:"",sort:"asc",defaultMapValue:[],mapValue:[],conditionType:0,conditionValueOperatorF:"eq",conditionValueF:"",conditionValueOperatorS:"like",conditionValueS:"",defaultConditionValueOperatorF:"eq",defaultConditionValueF:"",defaultConditionValueOperatorS:"like",defaultConditionValueS:"",timeType:"fixed",relativeToCurrent:"custom",required:!1,timeNum:0,relativeToCurrentType:"date",around:"f",parametersStart:null,parametersEnd:null,arbitraryTime:new Date,timeNumRange:0,relativeToCurrentTypeRange:"date",aroundRange:"f",arbitraryTimeRange:new Date,auto:!1,defaultValue:void 0,selectValue:void 0,optionValueSource:0,valueSource:[],dataset:{id:v,name:"",fields:[]},visible:!0,defaultValueCheck:!1,multiple:!1,displayType:"0",checkedFields:[],parameters:[],parametersCheck:!1,parametersList:[],checkedFieldsMap:{}}},Ei=()=>{const s={id:"",name:Ni("v_query.unnamed"),deType:0,type:"VARCHAR",datasetId:""};return wl(s)},Ai={class:"cascade-content"},Ii={style:{display:"flex","align-items":"center","justify-content":"space-between"}},xi={class:"cascade-item"},Ri={class:"label"},Li={class:"item-name"},Ui={class:"label"},Yi={class:"item-name"},Bi={class:"dialog-footer"},Gi=Ae({__name:"TreeFieldDialog",emits:["saveTree"],setup(s,{expose:y,emit:i}){const t=ne(!1),r=ne([]),v=xa([]),f=i,{t:M}=ia(),w=()=>{r.value.push({field:{id:""},id:Vl()})},V=()=>{t.value=!1},x=(ee,X)=>{v.value=Le(ee),r.value=Le(X).map(R=>({field:R,id:R.id})),t.value=!0},B=L(()=>r.value.map(ee=>ee.field).map(ee=>ee.id)),c=()=>{V()},C=()=>{let ee=!1;return{arr:Le(r.value).map(R=>(R.field||(ee=!0),R.field)),isError:ee}},D=()=>{const{isError:ee,arr:X}=C();if(ee){Re.error(M("v_query.select_a_field"));return}f("saveTree",X),V()},T=[M("visualization.number1"),M("visualization.number2"),M("visualization.number3"),M("visualization.number4"),M("visualization.number5")],J=ee=>{r.value.splice(ee,1)};return y({init:x}),(ee,X)=>{const R=wa,O=Ia,g=qa,I=De,ue=qt;return d(),Y(ue,{modelValue:t.value,"onUpdate:modelValue":X[0]||(X[0]=e=>t.value=e),width:"600","custom-class":"tree-field_dialog","before-close":V,onMousedown:X[1]||(X[1]=Ie(()=>{},["stop"])),onMousedup:X[2]||(X[2]=Ie(()=>{},["stop"])),title:a(M)("v_query.tree_structure_design")},{footer:o(()=>[_("div",Bi,[u(O,{secondary:"",onClick:c},{default:o(()=>[le(S(a(M)("common.cancel")),1)]),_:1}),u(O,{type:"primary",onClick:D},{default:o(()=>[le(S(a(M)("pblink.sure_bt")),1)]),_:1})])]),default:o(()=>[_("div",Ai,[_("div",Ii,[u(O,{disabled:r.value.length===5,text:"",onClick:w},{icon:o(()=>[u(R,{name:"icon_add_outlined"},{default:o(()=>[u(a(Ja),{class:"svg-icon"})]),_:1})]),default:o(()=>[le(" "+S(a(M)("v_query.add_level")),1)]),_:1},8,["disabled"])]),_("div",xi,[_("div",Ri,S(a(M)("visualization.level")),1),_("div",Li,S(a(M)("v_query.tree_query_field")),1)]),(d(!0),F(oe,null,ve(r.value,(e,fe)=>(d(),F("div",{class:"cascade-item",key:e.id},[_("div",Ui,S(a(M)("visualization.level"))+S(T[fe]),1),_("div",Yi,[u(I,{disabled:fe===0&&e.field,"value-key":"id",modelValue:e.field,"onUpdate:modelValue":E=>e.field=E,style:{width:"300px"}},{default:o(()=>[(d(!0),F(oe,null,ve(v.value,E=>(d(),Y(g,{disabled:B.value.includes(E.id),key:E.id,label:E.name,value:E},null,8,["disabled","label","value"]))),128))]),_:2},1032,["disabled","modelValue","onUpdate:modelValue"])]),$a(u(O,{onClick:E=>J(fe),class:"cascade-delete",text:""},{icon:o(()=>[u(R,{name:"icon_delete-trash_outlined"},{default:o(()=>[u(a($t),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"]),[[St,fe!==0]])]))),128))])]),_:1},8,["modelValue","title"])}}});const $l=Ae({__name:"DynamicTimeFiltering",props:{config:{type:Object,default:()=>({regularOrTrendsValue:"",intervalType:"none",regularOrTrends:"fixed",relativeToCurrent:"custom",timeNum:0,relativeToCurrentType:"year",around:"f"})},timeGranularityMultiple:{type:String,default:()=>"yearrange"}},setup(s){const y=s,{config:i}=Qe(y),t=L(()=>{const{relativeToCurrent:f,regularOrTrends:M,intervalType:w,timeNum:V,relativeToCurrentType:x,around:B}=i.value;return{relativeToCurrent:f,timeNum:V,regularOrTrends:M,intervalType:w,relativeToCurrentType:x,around:B,timeGranularityMultiple:y.timeGranularityMultiple}});pe(()=>t.value,()=>{v()},{deep:!0});const r=L(()=>{const f=y.timeGranularityMultiple.split("time").join("");return i.value.intervalType==="timeInterval"?f:f.split("range")[0]}),v=()=>{const{relativeToCurrent:f,regularOrTrends:M,timeNum:w,relativeToCurrentType:V,around:x}=t.value;if(M==="fixed"){if(i.value.regularOrTrendsValue&&!Array.isArray(i.value.regularOrTrendsValue))return;i.value.regularOrTrendsValue=new Date;return}if(f==="custom")i.value.regularOrTrendsValue=na(V,x==="f"?"subtract":"add",w);else switch(f){case"thisYear":i.value.regularOrTrendsValue=je("year");break;case"lastYear":i.value.regularOrTrendsValue=_a("year");break;case"thisMonth":i.value.regularOrTrendsValue=je("month");break;case"lastMonth":i.value.regularOrTrendsValue=_a("month");break;case"today":i.value.regularOrTrendsValue=je("day");break;case"yesterday":i.value.regularOrTrendsValue=_a("day");break;case"monthBeginning":i.value.regularOrTrendsValue=je("month");break;case"yearBeginning":i.value.regularOrTrendsValue=je("year");break}};return ga(()=>{v()}),(f,M)=>{const w=Ya;return d(),Y(w,{disabled:a(i).regularOrTrends!=="fixed",key:r.value,modelValue:a(i).regularOrTrendsValue,"onUpdate:modelValue":M[0]||(M[0]=V=>a(i).regularOrTrendsValue=V),type:r.value,"prefix-icon":a(at),placeholder:f.$t("commons.date.select_date_time")},null,8,["disabled","modelValue","type","prefix-icon","placeholder"])}}}),ql=Ae({__name:"DynamicTimeRangeFiltering",props:{config:{type:Object,default:()=>({timeGranularityMultiple:"daterange",regularOrTrendsValue:[],regularOrTrends:"fixed",timeNum:0,intervalType:"none",relativeToCurrentRange:"custom",relativeToCurrentType:"year",around:"f",timeGranularity:"date",timeNumRange:0,relativeToCurrentTypeRange:"year",aroundRange:"f"})},timeGranularityMultiple:{type:String,default:()=>"yearrange"}},setup(s){const y=s,{config:i}=Qe(y),t=L(()=>{const{timeNum:M,relativeToCurrentType:w,around:V,relativeToCurrentRange:x,intervalType:B,regularOrTrends:c,timeGranularity:C,timeNumRange:D,relativeToCurrentTypeRange:T,aroundRange:J}=i.value;return{timeNum:M,relativeToCurrentType:w,around:V,intervalType:B,relativeToCurrentRange:x,regularOrTrends:c,timeGranularity:C,timeNumRange:D,relativeToCurrentTypeRange:T,aroundRange:J,timeGranularityMultiple:y.timeGranularityMultiple}}),r=L(()=>{const M=y.timeGranularityMultiple.split("time").join("");return i.value.intervalType==="timeInterval"?M:M.split("range")[0]});pe(()=>t.value,()=>{v()},{deep:!0});const v=()=>{const{timeNum:M,relativeToCurrentType:w,around:V,relativeToCurrentRange:x,regularOrTrends:B,timeNumRange:c,relativeToCurrentTypeRange:C,aroundRange:D}=t.value;if(B==="fixed"){if(Array.isArray(i.value.regularOrTrendsValue)&&i.value.regularOrTrendsValue.length)return;i.value.regularOrTrendsValue=[na(C,"add",0),na(C,"add",1)];return}const T=na(w,V==="f"?"subtract":"add",M),J=na(C,D==="f"?"subtract":"add",c);if(x&&x!=="custom"){i.value.regularOrTrendsValue=Dt(x);return}i.value.regularOrTrendsValue=[T,J]};ga(()=>{v()});const f=L(()=>y.timeGranularityMultiple==="yearrange"?"YYYY":void 0);return(M,w)=>{const V=Ya;return d(),Y(V,{disabled:a(i).regularOrTrends!=="fixed",modelValue:a(i).regularOrTrendsValue,"onUpdate:modelValue":w[0]||(w[0]=x=>a(i).regularOrTrendsValue=x),key:r.value,type:r.value,"prefix-icon":a(at),format:f.value,"popper-class":"custom-dynamic-time-range-filter-popper_class","range-separator":M.$t("cron.to"),"start-placeholder":M.$t("datasource.start_time"),"end-placeholder":M.$t("datasource.end_time")},null,8,["disabled","modelValue","type","prefix-icon","format","range-separator","start-placeholder","end-placeholder"])}}});const Pi={class:"set-time-filtering-range"},ji={class:"title"},Wi={class:"list-item"},zi={class:"label"},Hi={class:"setting-content"},Qi={class:"setting"},Ki={key:0,class:"list-item"},Zi={class:"label"},Ji={class:"setting-content"},Xi={class:"setting"},eu={key:0,class:"setting"},au={class:"setting-label"},tu={class:"setting-value select"},lu={key:1,class:"setting"},nu={class:"setting-input"},iu={class:"setting"},uu={class:"setting-label"},ru={class:"setting-value select"},ou={class:"setting-label"},su={class:"setting-input range"},du={class:"setting-label"},cu={class:"setting-input range"},mu={key:0,class:"setting-label"},vu={class:"list-item"},pu={class:"label"},fu={key:0,class:"setting-content maximum-single-query"},yu=Ae({__name:"RangeFilterTime",props:{timeRange:{type:Object,default:()=>({intervalType:"none",dynamicWindow:!1,maximumSingleQuery:0,regularOrTrends:"fixed",relativeToCurrentRange:"custom",regularOrTrendsValue:"",relativeToCurrent:"custom",timeNum:0,relativeToCurrentType:"year",around:"f",timeNumRange:0,relativeToCurrentTypeRange:"year",aroundRange:"f"})},timeGranularityMultiple:{type:String,default:"yearrange"}},setup(s){const y=s,{t:i}=ia(),t=[{label:i("chart.line_symbol_none"),value:"none"},{label:i("v_query.start_at"),value:"start"},{label:i("v_query.end_at"),value:"end"},{label:i("v_query.time_interval"),value:"timeInterval"}],r=L(()=>t.find(C=>C.value===v.value.intervalType).label),{timeRange:v}=Qe(y),f=L(()=>v.value.regularOrTrends!=="fixed"),M=L(()=>{const{intervalType:C}=v.value;return C==="timeInterval"?ql:$l}),w=[{label:i("dynamic_time.before"),value:"f"},{label:i("dynamic_time.after"),value:"b"}],V=L(()=>{if(!v.value)return[];let C=["yearrange","monthrange","daterange","datetimerange"].indexOf(y.timeGranularityMultiple)+1;return[{label:i("dynamic_time.year"),value:"year"},{label:i("dynamic_time.month"),value:"month"},{label:i("dynamic_time.date"),value:"day"}].slice(0,C)}),x=L(()=>(V.value[V.value.length-1]||{}).label),B=L(()=>{let C=[];if(!v.value)return C;switch(y.timeGranularityMultiple){case"yearrange":C=[{label:i("dynamic_year.current"),value:"thisYear"},{label:i("dynamic_year.last"),value:"lastYear"}];break;case"monthrange":C=[{label:i("cron.this_month"),value:"thisMonth"},{label:i("dynamic_month.last"),value:"lastMonth"}];break;case"daterange":C=[{label:i("dynamic_time.today"),value:"today"},{label:i("dynamic_time.yesterday"),value:"yesterday"},{label:i("dynamic_time.firstOfMonth"),value:"monthBeginning"},{label:i("dynamic_time.endOfMonth"),value:"monthEnd"},{label:i("dynamic_time.firstOfYear"),value:"yearBeginning"}];break;case"datetimerange":C=[{label:i("dynamic_time.today"),value:"today"},{label:i("dynamic_time.yesterday"),value:"yesterday"},{label:i("dynamic_time.firstOfMonth"),value:"monthBeginning"},{label:i("dynamic_time.endOfMonth"),value:"monthEnd"},{label:i("dynamic_time.firstOfYear"),value:"yearBeginning"}];break}return[...C,{label:i("dynamic_time.custom"),value:"custom"}]}),c=L(()=>{let C=[];if(!v.value)return C;switch(y.timeGranularityMultiple){case"yearrange":C=[{label:i("dynamic_year.current"),value:"thisYear"},{label:i("dynamic_year.last"),value:"lastYear"}];break;case"monthrange":C=[{label:i("cron.this_month"),value:"thisMonth"},{label:i("dynamic_month.last"),value:"lastMonth"},{label:i("v_query.last_3_months"),value:"LastThreeMonths"},{label:i("v_query.last_6_months"),value:"LastSixMonths"},{label:i("v_query.last_12_months"),value:"LastTwelveMonths"}];break;case"daterange":case"datetimerange":C=[{label:i("dynamic_time.today"),value:"today"},{label:i("dynamic_time.yesterday"),value:"yesterday"},{label:i("v_query.last_3_days"),value:"LastThreeDays"},{label:i("v_query.month_to_date"),value:"monthBeginning"},{label:i("v_query.year_to_date"),value:"yearBeginning"}];break}return[...C,{label:i("dynamic_time.custom"),value:"custom"}]});return(C,D)=>{const T=Ra,J=La,ee=qa,X=De,R=lt,O=Ot;return d(),F("div",Pi,[_("div",ji,S(a(i)("v_query.time_filter_range")),1),_("div",Wi,[_("div",zi,S(a(i)("v_query.interval_type")),1),_("div",Hi,[_("div",Qi,[u(J,{modelValue:a(v).intervalType,"onUpdate:modelValue":D[0]||(D[0]=g=>a(v).intervalType=g)},{default:o(()=>[(d(),F(oe,null,ve(t,g=>u(T,{key:g.value,label:g.value},{default:o(()=>[le(S(g.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])])])]),a(v).intervalType!=="none"?(d(),F("div",Ki,[_("div",Zi,S(r.value),1),_("div",Ji,[_("div",Xi,[u(J,{modelValue:a(v).regularOrTrends,"onUpdate:modelValue":D[1]||(D[1]=g=>a(v).regularOrTrends=g)},{default:o(()=>[u(T,{label:"fixed"},{default:o(()=>[le(S(a(i)("dynamic_time.fix")),1)]),_:1}),u(T,{label:"dynamic"},{default:o(()=>[le(S(a(i)("dynamic_time.dynamic")),1)]),_:1})]),_:1},8,["modelValue"])]),f.value&&a(v).intervalType!=="timeInterval"?(d(),F(oe,{key:0},[a(v).intervalType!=="timeInterval"?(d(),F("div",eu,[_("div",au,S(a(i)("dynamic_time.relative")),1),_("div",tu,[u(X,{teleported:!1,modelValue:a(v).relativeToCurrent,"onUpdate:modelValue":D[2]||(D[2]=g=>a(v).relativeToCurrent=g)},{default:o(()=>[(d(!0),F(oe,null,ve(B.value,g=>(d(),Y(ee,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])):Z("",!0),a(v).relativeToCurrent==="custom"?(d(),F("div",lu,[_("div",nu,[u(R,{modelValue:a(v).timeNum,"onUpdate:modelValue":D[3]||(D[3]=g=>a(v).timeNum=g),min:0,"controls-position":"right"},null,8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).relativeToCurrentType,"onUpdate:modelValue":D[4]||(D[4]=g=>a(v).relativeToCurrentType=g)},{default:o(()=>[(d(!0),F(oe,null,ve(V.value,g=>(d(),Y(ee,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).around,"onUpdate:modelValue":D[5]||(D[5]=g=>a(v).around=g)},{default:o(()=>[(d(),F(oe,null,ve(w,g=>u(ee,{key:g.value,label:g.label,value:g.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])])):Z("",!0)],64)):f.value&&a(v).intervalType==="timeInterval"?(d(),F(oe,{key:1},[_("div",iu,[_("div",uu,S(a(i)("dynamic_time.relative")),1),_("div",ru,[u(X,{teleported:!1,modelValue:a(v).relativeToCurrentRange,"onUpdate:modelValue":D[6]||(D[6]=g=>a(v).relativeToCurrentRange=g)},{default:o(()=>[(d(!0),F(oe,null,ve(c.value,g=>(d(),Y(ee,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),a(v).relativeToCurrentRange==="custom"?(d(),F(oe,{key:0},[_("div",{class:Ve(["setting",["yearrange","monthrange"].includes(s.timeGranularityMultiple)&&"is-year-month-range"])},[_("div",ou,S(a(i)("datasource.start_time")),1),_("div",su,[u(R,{"step-strictly":"",modelValue:a(v).timeNum,"onUpdate:modelValue":D[7]||(D[7]=g=>a(v).timeNum=g),min:0,"controls-position":"right"},null,8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).relativeToCurrentType,"onUpdate:modelValue":D[8]||(D[8]=g=>a(v).relativeToCurrentType=g)},{default:o(()=>[(d(!0),F(oe,null,ve(V.value,g=>(d(),Y(ee,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).around,"onUpdate:modelValue":D[9]||(D[9]=g=>a(v).around=g)},{default:o(()=>[(d(),F(oe,null,ve(w,g=>u(ee,{key:g.value,label:g.label,value:g.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])],2),_("div",{class:Ve(["setting",["yearrange","monthrange"].includes(s.timeGranularityMultiple)&&"is-year-month-range"])},[_("div",du,S(a(i)("datasource.end_time")),1),_("div",cu,[u(R,{modelValue:a(v).timeNumRange,"onUpdate:modelValue":D[10]||(D[10]=g=>a(v).timeNumRange=g),min:0,"step-strictly":"","controls-position":"right"},null,8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).relativeToCurrentTypeRange,"onUpdate:modelValue":D[11]||(D[11]=g=>a(v).relativeToCurrentTypeRange=g)},{default:o(()=>[(d(!0),F(oe,null,ve(V.value,g=>(d(),Y(ee,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).aroundRange,"onUpdate:modelValue":D[12]||(D[12]=g=>a(v).aroundRange=g)},{default:o(()=>[(d(),F(oe,null,ve(w,g=>u(ee,{key:g.value,label:g.label,value:g.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])],2)],64)):Z("",!0)],64)):Z("",!0)]),_("div",{class:Ve(["parameters",f.value&&"setting"])},[f.value?(d(),F("div",mu,S(a(i)("template_manage.preview")),1)):Z("",!0),_("div",{class:Ve(f.value?"setting-value":"w100")},[(d(),Y(Ue(M.value),{config:a(v),timeGranularityMultiple:s.timeGranularityMultiple,ref:"inputCom"},null,8,["config","timeGranularityMultiple"]))],2)],2)])):Z("",!0),_("div",vu,[_("div",pu,[u(O,{modelValue:a(v).dynamicWindow,"onUpdate:modelValue":D[13]||(D[13]=g=>a(v).dynamicWindow=g),label:a(i)("v_query.query_time_window")},null,8,["modelValue","label"])]),a(v).dynamicWindow?(d(),F("div",fu,[le(S(a(i)("v_query.maximum_single_query"))+" ",1),u(R,{modelValue:a(v).maximumSingleQuery,"onUpdate:modelValue":D[14]||(D[14]=g=>a(v).maximumSingleQuery=g),min:1,"controls-position":"right"},null,8,["modelValue"]),le(" "+S(x.value),1)])):Z("",!0)])])}}});const _u={class:"set-time-filtering-range"},hu={class:"title"},gu={class:"list-item"},bu={class:"label"},Vu={class:"setting-content"},Tu={class:"setting"},ku={key:0,class:"list-item"},Cu={class:"label"},Mu={class:"setting-content"},Su={class:"setting"},Fu={key:0,class:"setting"},wu={class:"setting-label"},$u={class:"setting-value select"},qu={key:1,class:"setting"},Ou={class:"setting-input"},Du={class:"setting"},Nu={class:"setting-label"},Eu={class:"setting-value select"},Au={class:"setting-label"},Iu={class:"setting-input range"},xu={class:"setting-label"},Ru={class:"setting-input range"},Lu={key:0,class:"setting-label"},Uu=Ae({__name:"FilterTime",props:{timeRange:{default:()=>({intervalType:"none",dynamicWindow:!1,maximumSingleQuery:0,regularOrTrends:"fixed",relativeToCurrentRange:"custom",regularOrTrendsValue:"",relativeToCurrent:"custom",timeNum:0,relativeToCurrentType:"year",around:"f",timeNumRange:0,relativeToCurrentTypeRange:"year",aroundRange:"f"})},timeGranularity:{default:"year"}},setup(s){const y=s,{t:i}=ia(),t=[{label:i("chart.line_symbol_none"),value:"none"},{label:i("v_query.start_at"),value:"start"},{label:i("v_query.end_at"),value:"end"},{label:i("v_query.time_interval"),value:"timeInterval"}],r=L(()=>t.find(C=>C.value===v.value.intervalType).label),{timeRange:v}=Qe(y),f=L(()=>v.value.regularOrTrends!=="fixed"),M=L(()=>{const{intervalType:C}=v.value;return C==="timeInterval"?ql:$l}),w=L(()=>y.timeGranularity+"range"),V=[{label:i("dynamic_time.before"),value:"f"},{label:i("dynamic_time.after"),value:"b"}],x=L(()=>{if(!v.value)return[];let C=["year","month","date","datetime"].indexOf(y.timeGranularity)+1;return[{label:i("dynamic_time.year"),value:"year"},{label:i("dynamic_time.month"),value:"month"},{label:i("dynamic_time.date"),value:"day"}].slice(0,C)}),B=L(()=>{let C=[];if(!v.value)return C;switch(y.timeGranularity){case"year":C=[{label:i("dynamic_year.current"),value:"thisYear"},{label:i("dynamic_year.last"),value:"lastYear"}];break;case"month":C=[{label:i("cron.this_month"),value:"thisMonth"},{label:i("dynamic_month.last"),value:"lastMonth"}];break;case"date":C=[{label:i("dynamic_time.today"),value:"today"},{label:i("dynamic_time.yesterday"),value:"yesterday"},{label:i("dynamic_time.firstOfMonth"),value:"monthBeginning"},{label:i("dynamic_time.firstOfYear"),value:"yearBeginning"}];break;case"datetime":C=[{label:i("dynamic_time.today"),value:"today"},{label:i("dynamic_time.yesterday"),value:"yesterday"},{label:i("dynamic_time.firstOfMonth"),value:"monthBeginning"},{label:i("dynamic_time.firstOfYear"),value:"yearBeginning"}];break}return[...C,{label:i("dynamic_time.custom"),value:"custom"}]}),c=L(()=>{let C=[];if(!v.value)return C;switch(y.timeGranularity){case"year":C=[{label:i("dynamic_year.current"),value:"thisYear"},{label:i("dynamic_year.last"),value:"lastYear"}];break;case"month":C=[{label:i("cron.this_month"),value:"thisMonth"},{label:i("dynamic_month.last"),value:"lastMonth"},{label:i("v_query.last_3_months"),value:"LastThreeMonths"},{label:i("v_query.last_6_months"),value:"LastSixMonths"},{label:i("v_query.last_12_months"),value:"LastTwelveMonths"}];break;case"date":case"datetime":C=[{label:i("dynamic_time.today"),value:"today"},{label:i("dynamic_time.yesterday"),value:"yesterday"},{label:i("v_query.last_3_days"),value:"LastThreeDays"},{label:i("v_query.month_to_date"),value:"monthBeginning"},{label:i("v_query.year_to_date"),value:"yearBeginning"}];break}return[...C,{label:i("dynamic_time.custom"),value:"custom"}]});return(C,D)=>{const T=Ra,J=La,ee=qa,X=De,R=lt;return d(),F("div",_u,[_("div",hu,S(a(i)("v_query.time_filter_range")),1),_("div",gu,[_("div",bu,S(a(i)("v_query.interval_type")),1),_("div",Vu,[_("div",Tu,[u(J,{modelValue:a(v).intervalType,"onUpdate:modelValue":D[0]||(D[0]=O=>a(v).intervalType=O)},{default:o(()=>[(d(),F(oe,null,ve(t,O=>u(T,{key:O.value,label:O.value},{default:o(()=>[le(S(O.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])])])]),a(v).intervalType!=="none"?(d(),F("div",ku,[_("div",Cu,S(r.value),1),_("div",Mu,[_("div",Su,[u(J,{modelValue:a(v).regularOrTrends,"onUpdate:modelValue":D[1]||(D[1]=O=>a(v).regularOrTrends=O)},{default:o(()=>[u(T,{label:"fixed"},{default:o(()=>[le(S(a(i)("dynamic_time.fix")),1)]),_:1}),u(T,{label:"dynamic"},{default:o(()=>[le(S(a(i)("dynamic_time.dynamic")),1)]),_:1})]),_:1},8,["modelValue"])]),f.value&&a(v).intervalType!=="timeInterval"?(d(),F(oe,{key:0},[a(v).intervalType!=="timeInterval"?(d(),F("div",Fu,[_("div",wu,S(a(i)("dynamic_time.relative")),1),_("div",$u,[u(X,{teleported:!1,modelValue:a(v).relativeToCurrent,"onUpdate:modelValue":D[2]||(D[2]=O=>a(v).relativeToCurrent=O)},{default:o(()=>[(d(!0),F(oe,null,ve(B.value,O=>(d(),Y(ee,{key:O.value,label:O.label,value:O.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])):Z("",!0),a(v).relativeToCurrent==="custom"?(d(),F("div",qu,[_("div",Ou,[u(R,{modelValue:a(v).timeNum,"onUpdate:modelValue":D[3]||(D[3]=O=>a(v).timeNum=O),min:0,"controls-position":"right"},null,8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).relativeToCurrentType,"onUpdate:modelValue":D[4]||(D[4]=O=>a(v).relativeToCurrentType=O)},{default:o(()=>[(d(!0),F(oe,null,ve(x.value,O=>(d(),Y(ee,{key:O.value,label:O.label,value:O.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).around,"onUpdate:modelValue":D[5]||(D[5]=O=>a(v).around=O)},{default:o(()=>[(d(),F(oe,null,ve(V,O=>u(ee,{key:O.value,label:O.label,value:O.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])])):Z("",!0)],64)):f.value&&a(v).intervalType==="timeInterval"?(d(),F(oe,{key:1},[_("div",Du,[_("div",Nu,S(a(i)("dynamic_time.relative")),1),_("div",Eu,[u(X,{teleported:!1,modelValue:a(v).relativeToCurrentRange,"onUpdate:modelValue":D[6]||(D[6]=O=>a(v).relativeToCurrentRange=O)},{default:o(()=>[(d(!0),F(oe,null,ve(c.value,O=>(d(),Y(ee,{key:O.value,label:O.label,value:O.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),a(v).relativeToCurrentRange==="custom"?(d(),F(oe,{key:0},[_("div",{class:Ve(["setting",["year","month"].includes(C.timeGranularity)&&"is-year-month-range"])},[_("div",Au,S(a(i)("datasource.start_time")),1),_("div",Iu,[u(R,{"step-strictly":"",modelValue:a(v).timeNum,"onUpdate:modelValue":D[7]||(D[7]=O=>a(v).timeNum=O),min:0,"controls-position":"right"},null,8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).relativeToCurrentType,"onUpdate:modelValue":D[8]||(D[8]=O=>a(v).relativeToCurrentType=O)},{default:o(()=>[(d(!0),F(oe,null,ve(x.value,O=>(d(),Y(ee,{key:O.value,label:O.label,value:O.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).around,"onUpdate:modelValue":D[9]||(D[9]=O=>a(v).around=O)},{default:o(()=>[(d(),F(oe,null,ve(V,O=>u(ee,{key:O.value,label:O.label,value:O.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])],2),_("div",{class:Ve(["setting",["year","month"].includes(C.timeGranularity)&&"is-year-month-range"])},[_("div",xu,S(a(i)("datasource.end_time")),1),_("div",Ru,[u(R,{modelValue:a(v).timeNumRange,"onUpdate:modelValue":D[10]||(D[10]=O=>a(v).timeNumRange=O),min:0,"step-strictly":"","controls-position":"right"},null,8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).relativeToCurrentTypeRange,"onUpdate:modelValue":D[11]||(D[11]=O=>a(v).relativeToCurrentTypeRange=O)},{default:o(()=>[(d(!0),F(oe,null,ve(x.value,O=>(d(),Y(ee,{key:O.value,label:O.label,value:O.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(X,{teleported:!1,modelValue:a(v).aroundRange,"onUpdate:modelValue":D[12]||(D[12]=O=>a(v).aroundRange=O)},{default:o(()=>[(d(),F(oe,null,ve(V,O=>u(ee,{key:O.value,label:O.label,value:O.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])],2)],64)):Z("",!0)],64)):Z("",!0)]),_("div",{class:Ve(["parameters",f.value&&"setting"])},[f.value?(d(),F("div",Lu,S(a(i)("template_manage.preview")),1)):Z("",!0),_("div",{class:Ve(f.value?"setting-value":"w100")},[(d(),Y(Ue(M.value),{config:a(v),timeGranularityMultiple:w.value,ref:"inputCom"},null,8,["config","timeGranularityMultiple"]))],2)],2)])):Z("",!0)])}}});const Yu=Ae({__name:"DynamicTime",props:{config:{type:Object,default:()=>({defaultValue:"",selectValue:"",timeType:"fixed",relativeToCurrent:"custom",timeNum:0,relativeToCurrentType:"year",around:"f",arbitraryTime:new Date,defaultValueCheck:!1,timeGranularity:"date"})}},setup(s){const y=s,i=ne(),{config:t}=Qe(y),r=L(()=>{const{relativeToCurrent:f,timeNum:M,relativeToCurrentType:w,around:V,defaultValueCheck:x,arbitraryTime:B,timeGranularity:c}=t.value;return{relativeToCurrent:f,timeNum:M,relativeToCurrentType:w,around:V,defaultValueCheck:x,arbitraryTime:B,timeGranularity:c}});pe(()=>r.value,()=>{v()},{deep:!0}),pe(()=>i.value,f=>{t.value.defaultValue=f,t.value.selectValue=f}),pe(()=>t.value.id,()=>{v()});const v=()=>{const{relativeToCurrent:f,timeNum:M,relativeToCurrentType:w,around:V,defaultValueCheck:x,arbitraryTime:B,timeGranularity:c}=r.value;if(!x){i.value=null;return}if(f==="custom")i.value=Na(M,w,c,V,c==="datetime"?B:null);else switch(f){case"thisYear":i.value=ri();break;case"lastYear":i.value=ui();break;case"thisMonth":i.value=ii();break;case"lastMonth":i.value=ni();break;case"today":i.value=li();break;case"yesterday":i.value=ti();break;case"monthBeginning":i.value=ai();break;case"monthEnd":i.value=ei();break;case"yearBeginning":i.value=Xn();break}};return ga(()=>{v()}),(f,M)=>{const w=Ya;return d(),Y(w,{disabled:"",key:a(t).timeGranularity,modelValue:i.value,"onUpdate:modelValue":M[0]||(M[0]=V=>i.value=V),type:a(t).timeGranularity,"prefix-icon":a(at),"popper-class":"custom-dynamic-time-popper_class",placeholder:f.$t("commons.date.select_date_time")},null,8,["modelValue","type","prefix-icon","placeholder"])}}});const Bu=Ae({__name:"DynamicTimeRange",props:{config:{type:Object,default:()=>({timeGranularityMultiple:"datetimerange",defaultValue:[],selectValue:[],timeType:"fixed",timeNum:0,relativeToCurrentType:"year",around:"f",arbitraryTime:new Date,defaultValueCheck:!1,timeGranularity:"date",timeNumRange:0,relativeToCurrentRange:"custom",relativeToCurrentTypeRange:"year",aroundRange:"f",arbitraryTimeRange:new Date})}},setup(s){const y=s,i=ne([new Date,new Date]),{config:t}=Qe(y),r=L(()=>{const{timeNum:M,relativeToCurrentType:w,timeGranularityMultiple:V,around:x,relativeToCurrentRange:B,defaultValueCheck:c,arbitraryTime:C,timeGranularity:D,timeNumRange:T,relativeToCurrentTypeRange:J,aroundRange:ee,arbitraryTimeRange:X}=t.value;return{timeNum:M,relativeToCurrentType:w,around:x,relativeToCurrentRange:B,timeGranularityMultiple:V,defaultValueCheck:c,arbitraryTime:C,timeGranularity:D,timeNumRange:T,relativeToCurrentTypeRange:J,aroundRange:ee,arbitraryTimeRange:X}});pe(()=>r.value,()=>{v()},{deep:!0}),pe(()=>i.value,M=>{t.value.defaultValue=M,t.value.selectValue=M}),pe(()=>t.value.id,()=>{v()});const v=()=>{const{timeNum:M,relativeToCurrentType:w,around:V,defaultValueCheck:x,arbitraryTime:B,timeGranularity:c,timeGranularityMultiple:C,timeNumRange:D,relativeToCurrentTypeRange:T,aroundRange:J,relativeToCurrentRange:ee,arbitraryTimeRange:X}=r.value;if(!x){i.value=[new Date,new Date];return}if(ee!=="custom"){i.value=Dt(ee);return}const R=Na(M,w,c,V,B,C,"start-config"),O=Na(D,T,c,J,X,C,"end-config");i.value=[R,O]};ga(()=>{v()});const f=L(()=>t.value.timeGranularityMultiple==="yearrange"?"YYYY":void 0);return(M,w)=>{const V=Ya;return d(),Y(V,{disabled:"",modelValue:i.value,"onUpdate:modelValue":w[0]||(w[0]=x=>i.value=x),key:a(t).timeGranularityMultiple,type:a(t).timeGranularityMultiple,"prefix-icon":a(at),format:f.value,"popper-class":"custom-dynamic-time-range-popper_class","range-separator":M.$t("cron.to"),"start-placeholder":M.$t("datasource.start_time"),"end-placeholder":M.$t("datasource.end_time")},null,8,["modelValue","type","prefix-icon","format","range-separator","start-placeholder","end-placeholder"])}}});var Ol={exports:{}};(function(s,y){(function(i,t){s.exports=t()})(Zn,function(){var i="month",t="quarter";return function(r,v){var f=v.prototype;f.quarter=function(V){return this.$utils().u(V)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(V-1))};var M=f.add;f.add=function(V,x){return V=Number(V),this.$utils().p(x)===t?this.add(3*V,i):M.bind(this)(V,x)};var w=f.startOf;f.startOf=function(V,x){var B=this.$utils(),c=!!B.u(x)||x;if(B.p(V)===t){var C=this.quarter()-1;return c?this.month(3*C).startOf(i).startOf("day"):this.month(3*C+2).endOf(i).endOf("day")}return w.bind(this)(V,x)}}})})(Ol);var Gu=Ol.exports;const Pu=Jn(Gu),{t:ju}=ia();ke.extend(Pu);function Ha(s="month"){return new Date(ke().startOf(s).format("YYYY/MM/DD HH:mm:ss"))}function Qa(s="month"){return new Date(ke().endOf(s).format("YYYY/MM/DD HH:mm:ss"))}function Ka(s="month"){return new Date(ke().subtract(1,s).startOf(s).format("YYYY/MM/DD HH:mm:ss"))}function Za(s="month"){return new Date(ke().subtract(1,s).endOf(s).format("YYYY/MM/DD HH:mm:ss"))}let fa=()=>{};const Dl=[{text:"dynamic_time.cweek",onClick:({emit:s})=>{const y=new Date(+new Date(Ha("week"))+864e5),i=new Date(+new Date(Qa("week"))+24*1e3*3600);fa([y,i])||s("pick",[ke(y),ke(i)])}},{text:"dynamic_month.current",onClick:({emit:s})=>{const y=Ha("month"),i=Qa("month");fa([y,i])||s("pick",[ke(y),ke(i)])}},{text:"dynamic_time.cquarter",onClick:({emit:s})=>{const y=Ha("quarter"),i=Qa("quarter");fa([y,i])||s("pick",[ke(y),ke(i)])}},{text:"dynamic_year.current",onClick:({emit:s})=>{const y=Ha("year"),i=Qa("year");fa([y,i])||s("pick",[ke(y),ke(i)])}},{text:"dynamic_time.lweek",onClick:({emit:s})=>{const y=new Date(+new Date(Ka("week"))+864e5),i=new Date(+new Date(Za("week"))+24*1e3*3600);fa([y,i])||s("pick",[ke(y),ke(i)])}},{text:"dynamic_month.last",onClick:({emit:s})=>{const y=Ka("month"),i=Za("month");fa([y,i])||s("pick",[ke(y),ke(i)])}},{text:"dynamic_time.lquarter",onClick:({emit:s})=>{const y=Ka("quarter"),i=Za("quarter");fa([y,i])||s("pick",[ke(y),ke(i)])}},{text:"dynamic_year.last",onClick:({emit:s})=>{const y=Ka("year"),i=Za("year");fa([y,i])||s("pick",[ke(y),ke(i)])}}];Dl.forEach(s=>{s.text=ju(s.text)});const Wu=s=>(fa=s,{shortcuts:Dl}),[zu,ya,tl]=Oa("picker"),Nl=s=>s.find(y=>!y.disabled)||s[0];function Hu(s,y){const i=s[0];if(i){if(Array.isArray(i))return"multiple";if(y.children in i)return"cascade"}return"default"}function Xa(s,y){y=et(y,0,s.length);for(let i=y;i<s.length;i++)if(!s[i].disabled)return i;for(let i=y-1;i>=0;i--)if(!s[i].disabled)return i;return 0}const ll=(s,y,i)=>y!==void 0&&s.some(t=>t[i.value]===y);function kt(s,y,i){const t=s.findIndex(v=>v[i.value]===y),r=Xa(s,t);return s[r]}function Qu(s,y,i){const t=[];let r={[y.children]:s},v=0;for(;r&&r[y.children];){const f=r[y.children],M=i.value[v];if(r=ci(M)?kt(f,M,y):void 0,!r&&f.length){const w=Nl(f)[y.value];r=kt(f,w,y)}v++,t.push(f)}return t}function Ku(s){const{transform:y}=window.getComputedStyle(s),i=y.slice(7,y.length-1).split(", ")[5];return Number(i)}function Zu(s){return ha({text:"text",value:"value",children:"children"},s)}const nl=200,il=300,Ju=15,[El,Vt]=Oa("picker-column"),Al=Symbol(El);var Xu=Ae({name:El,props:{value:bt,fields:za(Object),options:Ea(),readonly:Boolean,allowHtml:Boolean,optionHeight:za(Number),swipeDuration:za(bt),visibleOptionNum:za(bt)},emits:["change","clickOption","scrollInto"],setup(s,{emit:y,slots:i}){let t,r,v,f,M;const w=ne(),V=ne(),x=ne(0),B=ne(0),c=fi(),C=()=>s.options.length,D=()=>s.optionHeight*(+s.visibleOptionNum-1)/2,T=E=>{let h=Xa(s.options,E);const P=-h*s.optionHeight,j=()=>{h>C()-1&&(h=Xa(s.options,E));const $e=s.options[h][s.fields.value];$e!==s.value&&y("change",$e)};t&&P!==x.value?M=j:j(),x.value=P},J=()=>s.readonly||!s.options.length,ee=E=>{t||J()||(M=null,B.value=nl,T(E),y("clickOption",s.options[E]))},X=E=>et(Math.round(-E/s.optionHeight),0,C()-1),R=L(()=>X(x.value)),O=(E,h)=>{const P=Math.abs(E/h);E=x.value+P/.003*(E<0?-1:1);const j=X(E);B.value=+s.swipeDuration,T(j)},g=()=>{t=!1,B.value=0,M&&(M(),M=null)},I=E=>{if(!J()){if(c.start(E),t){const h=Ku(V.value);x.value=Math.min(0,h-D())}B.value=0,r=x.value,v=Date.now(),f=r,M=null}},ue=E=>{if(J())return;c.move(E),c.isVertical()&&(t=!0,Cl(E,!0));const h=et(r+c.deltaY.value,-(C()*s.optionHeight),s.optionHeight),P=X(h);P!==R.value&&y("scrollInto",s.options[P]),x.value=h;const j=Date.now();j-v>il&&(v=j,f=h)},e=()=>{if(J())return;const E=x.value-f,h=Date.now()-v;if(h<il&&Math.abs(E)>Ju){O(E,h);return}const j=X(x.value);B.value=nl,T(j),setTimeout(()=>{t=!1},0)},fe=()=>{const E={height:`${s.optionHeight}px`};return s.options.map((h,P)=>{const j=h[s.fields.text],{disabled:$e}=h,Te=h[s.fields.value],we={role:"button",style:E,tabindex:$e?-1:0,class:[Vt("item",{disabled:$e,selected:Te===s.value}),h.className],onClick:()=>ee(P)},Ge={class:"van-ellipsis",[s.allowHtml?"innerHTML":"textContent"]:j};return u("li",we,[i.option?i.option(h,P):u("div",Ge,null)])})};return Tl(Al),it({stopMomentum:g}),Sn(()=>{const E=t?Math.floor(-x.value/s.optionHeight):s.options.findIndex(j=>j[s.fields.value]===s.value),h=Xa(s.options,E),P=-h*s.optionHeight;t&&h<E&&g(),x.value=P}),kl("touchmove",ue,{target:w}),()=>u("div",{ref:w,class:Vt(),onTouchstartPassive:I,onTouchend:e,onTouchcancel:e},[u("ul",{ref:V,style:{transform:`translate3d(0, ${x.value+D()}px, 0)`,transitionDuration:`${B.value}ms`,transitionProperty:B.value?"all":"none"},class:Vt("wrapper"),onTransitionend:g},[fe()])])}});const[er]=Oa("picker-toolbar"),ut={title:String,cancelButtonText:String,confirmButtonText:String},Il=["cancel","confirm","title","toolbar"],ar=Object.keys(ut);var xl=Ae({name:er,props:ut,emits:["confirm","cancel"],setup(s,{emit:y,slots:i}){const t=()=>{if(i.title)return i.title();if(s.title)return u("div",{class:[ya("title"),"van-ellipsis"]},[s.title])},r=()=>y("cancel"),v=()=>y("confirm"),f=()=>{var w;const V=(w=s.cancelButtonText)!=null?w:tl("cancel");if(!(!i.cancel&&!V))return u("button",{type:"button",class:[ya("cancel"),al],onClick:r},[i.cancel?i.cancel():V])},M=()=>{var w;const V=(w=s.confirmButtonText)!=null?w:tl("confirm");if(!(!i.confirm&&!V))return u("button",{type:"button",class:[ya("confirm"),al],onClick:v},[i.confirm?i.confirm():V])};return()=>u("div",{class:ya("toolbar")},[i.toolbar?i.toolbar():[f(),t(),M()]])}});const tr=(s,y)=>{const i=ne(s());return pe(s,t=>{t!==i.value&&(i.value=t)}),pe(i,t=>{t!==s()&&y(t)}),i},[Rl,Tt]=Oa("picker-group"),Ll=Symbol(Rl),lr=ha({tabs:Ea(),activeTab:da(0),nextStepText:String,showToolbar:Ml},ut);var nr=Ae({name:Rl,props:lr,emits:["confirm","cancel","update:activeTab"],setup(s,{emit:y,slots:i}){const t=tr(()=>s.activeTab,V=>y("update:activeTab",V)),{children:r,linkChildren:v}=Sl(Ll);v();const f=()=>+t.value<s.tabs.length-1&&s.nextStepText,M=()=>{f()?t.value=+t.value+1:y("confirm",r.map(V=>V.confirm()))},w=()=>y("cancel");return()=>{var V,x;let B=(x=(V=i.default)==null?void 0:V.call(i))==null?void 0:x.filter(C=>C.type!==Fn).map(C=>C.type===oe?C.children:C);B&&(B=mi(B));const c=f()?s.nextStepText:s.confirmButtonText;return u("div",{class:Tt()},[s.showToolbar?u(xl,{title:s.title,cancelButtonText:s.cancelButtonText,confirmButtonText:c,onConfirm:M,onCancel:w},Aa(i,Il)):null,u(hi,{active:t.value,"onUpdate:active":C=>t.value=C,class:Tt("tabs"),shrink:!0,animated:!0,lazyRender:!1},{default:()=>[s.tabs.map((C,D)=>u(gi,{title:C,titleClass:Tt("tab-title")},{default:()=>[B==null?void 0:B[D]]}))]})])}}});const Et=ha({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:da(44),showToolbar:Ml,swipeDuration:da(1e3),visibleOptionNum:da(6)},ut),ir=ha({},Et,{columns:Ea(),modelValue:Ea(),toolbarPosition:vi("top"),columnsFieldNames:Object});var ur=Ae({name:zu,props:ir,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(s,{emit:y,slots:i}){const t=ne(),r=ne(s.modelValue.slice(0)),{parent:v}=Tl(Ll),{children:f,linkChildren:M}=Sl(Al);M();const w=L(()=>Zu(s.columnsFieldNames)),V=L(()=>pi(s.optionHeight)),x=L(()=>Hu(s.columns,w.value)),B=L(()=>{const{columns:h}=s;switch(x.value){case"multiple":return h;case"cascade":return Qu(h,w.value,r);default:return[h]}}),c=L(()=>B.value.some(h=>h.length)),C=L(()=>B.value.map((h,P)=>kt(h,r.value[P],w.value))),D=L(()=>B.value.map((h,P)=>h.findIndex(j=>j[w.value.value]===r.value[P]))),T=(h,P)=>{if(r.value[h]!==P){const j=r.value.slice(0);j[h]=P,r.value=j}},J=()=>({selectedValues:r.value.slice(0),selectedOptions:C.value,selectedIndexes:D.value}),ee=(h,P)=>{T(P,h),x.value==="cascade"&&r.value.forEach((j,$e)=>{const Te=B.value[$e];ll(Te,j,w.value)||T($e,Te.length?Te[0][w.value.value]:void 0)}),Se(()=>{y("change",ha({columnIndex:P},J()))})},X=(h,P)=>{const j={columnIndex:P,currentOption:h};y("clickOption",ha(J(),j)),y("scrollInto",j)},R=()=>{f.forEach(P=>P.stopMomentum());const h=J();return Se(()=>{const P=J();y("confirm",P)}),h},O=()=>y("cancel",J()),g=()=>B.value.map((h,P)=>u(Xu,{value:r.value[P],fields:w.value,options:h,readonly:s.readonly,allowHtml:s.allowHtml,optionHeight:V.value,swipeDuration:s.swipeDuration,visibleOptionNum:s.visibleOptionNum,onChange:j=>ee(j,P),onClickOption:j=>X(j,P),onScrollInto:j=>{y("scrollInto",{currentOption:j,columnIndex:P})}},{option:i.option})),I=h=>{if(c.value){const P={height:`${V.value}px`},j={backgroundSize:`100% ${(h-V.value)/2}px`};return[u("div",{class:ya("mask"),style:j},null),u("div",{class:[_i,ya("frame")],style:P},null)]}},ue=()=>{const h=V.value*+s.visibleOptionNum,P={height:`${h}px`};return!s.loading&&!c.value&&i.empty?i.empty():u("div",{ref:t,class:ya("columns"),style:P},[g(),I(h)])},e=()=>{if(s.showToolbar&&!v)return u(xl,Ft(Aa(s,ar),{onConfirm:R,onCancel:O}),Aa(i,Il))};pe(B,h=>{h.forEach((P,j)=>{P.length&&!ll(P,r.value[j],w.value)&&T(j,Nl(P)[w.value.value])})},{immediate:!0});let fe;return pe(()=>s.modelValue,h=>{!Va(h,r.value)&&!Va(h,fe)&&(r.value=h.slice(0),fe=h.slice(0))},{deep:!0}),pe(r,h=>{Va(h,s.modelValue)||(fe=h.slice(0),y("update:modelValue",fe))},{immediate:!0}),kl("touchmove",Cl,{target:t}),it({confirm:R,getSelectedOptions:()=>C.value}),()=>{var h,P;return u("div",{class:ya()},[s.toolbarPosition==="top"?e():null,s.loading?u(yi,{class:ya("loading")},null):null,(h=i["columns-top"])==null?void 0:h.call(i),ue(),(P=i["columns-bottom"])==null?void 0:P.call(i),s.toolbarPosition==="bottom"?e():null])}}});const Ul=ha({},Et,{modelValue:Ea(),filter:Function,formatter:{type:Function,default:(s,y)=>y}}),Yl=Object.keys(Et);function rr(s,y){if(s<0)return[];const i=Array(s);let t=-1;for(;++t<s;)i[t]=y(t);return i}const or=(s,y)=>32-new Date(s,y-1,32).getDate(),Fa=(s,y,i,t,r,v)=>{const f=rr(y-s+1,M=>{const w=Fl(s+M);return t(i,{text:w,value:w})});return r?r(i,f,v):f},Bl=(s,y)=>s.map((i,t)=>{const r=y[t];if(r.length){const v=+r[0].value,f=+r[r.length-1].value;return Fl(et(+i,v,f))}return i}),Gl=nt(ur),ul=new Date().getFullYear(),[sr]=Oa("date-picker"),dr=ha({},Ul,{columnsType:{type:Array,default:()=>["year","month","day"]},minDate:{type:Date,default:()=>new Date(ul-10,0,1),validator:el},maxDate:{type:Date,default:()=>new Date(ul+10,11,31),validator:el}});var cr=Ae({name:sr,props:dr,emits:["confirm","cancel","change","update:modelValue"],setup(s,{emit:y,slots:i}){const t=ne(s.modelValue),r=ne(!1),v=ne(),f=L(()=>r.value?s.modelValue:t.value),M=g=>g===s.minDate.getFullYear(),w=g=>g===s.maxDate.getFullYear(),V=g=>g===s.minDate.getMonth()+1,x=g=>g===s.maxDate.getMonth()+1,B=g=>{const{minDate:I,columnsType:ue}=s,e=ue.indexOf(g),fe=f.value[e];if(fe)return+fe;switch(g){case"year":return I.getFullYear();case"month":return I.getMonth()+1;case"day":return I.getDate()}},c=()=>{const g=s.minDate.getFullYear(),I=s.maxDate.getFullYear();return Fa(g,I,"year",s.formatter,s.filter,f.value)},C=()=>{const g=B("year"),I=M(g)?s.minDate.getMonth()+1:1,ue=w(g)?s.maxDate.getMonth()+1:12;return Fa(I,ue,"month",s.formatter,s.filter,f.value)},D=()=>{const g=B("year"),I=B("month"),ue=M(g)&&V(I)?s.minDate.getDate():1,e=w(g)&&x(I)?s.maxDate.getDate():or(g,I);return Fa(ue,e,"day",s.formatter,s.filter,f.value)},T=()=>{var g;return(g=v.value)==null?void 0:g.confirm()},J=()=>t.value,ee=L(()=>s.columnsType.map(g=>{switch(g){case"year":return c();case"month":return C();case"day":return D();default:return[]}}));pe(t,g=>{Va(g,s.modelValue)||y("update:modelValue",g)}),pe(()=>s.modelValue,(g,I)=>{r.value=Va(I,t.value),g=Bl(g,ee.value),Va(g,t.value)||(t.value=g),r.value=!1},{immediate:!0});const X=(...g)=>y("change",...g),R=(...g)=>y("cancel",...g),O=(...g)=>y("confirm",...g);return it({confirm:T,getSelectedDate:J}),()=>u(Gl,Ft({ref:v,modelValue:t.value,"onUpdate:modelValue":g=>t.value=g,columns:ee.value,onChange:X,onCancel:R,onConfirm:O},Aa(s,Yl)),i)}});const mr=nt(cr);var rl=mr;const[vr]=Oa("time-picker"),ol=s=>/^([01]\d|2[0-3]):([0-5]\d):([0-5]\d)$/.test(s),pr=["hour","minute","second"],fr=ha({},Ul,{minHour:da(0),maxHour:da(23),minMinute:da(0),maxMinute:da(59),minSecond:da(0),maxSecond:da(59),minTime:{type:String,validator:ol},maxTime:{type:String,validator:ol},columnsType:{type:Array,default:()=>["hour","minute"]}});var yr=Ae({name:vr,props:fr,emits:["confirm","cancel","change","update:modelValue"],setup(s,{emit:y,slots:i}){const t=ne(s.modelValue),r=ne(),v=c=>{const C=c.split(":");return pr.map((D,T)=>s.columnsType.includes(D)?C[T]:"00")},f=()=>{var c;return(c=r.value)==null?void 0:c.confirm()},M=()=>t.value,w=L(()=>{let{minHour:c,maxHour:C,minMinute:D,maxMinute:T,minSecond:J,maxSecond:ee}=s;if(s.minTime||s.maxTime){const X={hour:0,minute:0,second:0};s.columnsType.forEach((g,I)=>{var ue;X[g]=(ue=t.value[I])!=null?ue:0});const{hour:R,minute:O}=X;if(s.minTime){const[g,I,ue]=v(s.minTime);c=g,D=+R<=+c?I:"00",J=+R<=+c&&+O<=+D?ue:"00"}if(s.maxTime){const[g,I,ue]=v(s.maxTime);C=g,T=+R>=+C?I:"59",ee=+R>=+C&&+O>=+T?ue:"59"}}return s.columnsType.map(X=>{const{filter:R,formatter:O}=s;switch(X){case"hour":return Fa(+c,+C,X,O,R,t.value);case"minute":return Fa(+D,+T,X,O,R,t.value);case"second":return Fa(+J,+ee,X,O,R,t.value);default:return[]}})});pe(t,c=>{Va(c,s.modelValue)||y("update:modelValue",c)}),pe(()=>s.modelValue,c=>{c=Bl(c,w.value),Va(c,t.value)||(t.value=c)},{immediate:!0});const V=(...c)=>y("change",...c),x=(...c)=>y("cancel",...c),B=(...c)=>y("confirm",...c);return it({confirm:f,getSelectedTime:M}),()=>u(Gl,Ft({ref:r,modelValue:t.value,"onUpdate:modelValue":c=>t.value=c,columns:w.value,onChange:V,onCancel:x,onConfirm:B},Aa(s,Yl)),i)}});const _r=nt(yr);var hr=_r;const gr=nt(nr);var br=gr;const Pl=Ae({__name:"Time",props:{config:{type:Object,default:()=>({selectValue:"",defaultValue:"",queryConditionWidth:0,defaultValueCheck:!1,displayType:"1",timeGranularity:"date",setTimeRange:!1,timeGranularityMultiple:"daterange",timeRange:{intervalType:"none",dynamicWindow:!1,maximumSingleQuery:0,regularOrTrends:"fixed",regularOrTrendsValue:"",relativeToCurrent:"custom",timeNum:0,relativeToCurrentType:"year",around:"f",timeNumRange:0,relativeToCurrentTypeRange:"year",aroundRange:"f"}})},isConfig:{type:Boolean,default:!1}},setup(s,{expose:y}){const{t:i}=ia(),t=s,r=xe("placeholder"),v=L(()=>{var te;return(te=r==null?void 0:r.value)!=null&&te.placeholderShow?t.config.placeholder:" "}),f=ne(),M=ne(!1),w=Ua(),{config:V}=Qe(t),x=new Date("1970/1/1"),B=new Date("2100/1/1");pe(()=>V.value.defaultValue,te=>{if(t.isConfig)return;const se=V.value.displayType==="7";se&&(M.value=se),f.value=Array.isArray(te)?[...te]:te,Se(()=>{M.value=se})});const c=te=>{j.value=te[0];const se=te.some(ye=>Ge(ye));return j.value=0,se},{shortcuts:C}=Wu(c);pe(()=>V.value.id,()=>{J()});const D=()=>{t.isConfig&&(M.value&&V.value.displayType==="7"||(f.value=V.value.displayType==="7"?[]:void 0,M.value=V.value.displayType==="7",V.value.defaultValue=M.value?[]:void 0,f.value=M.value?[]:void 0))};pe(()=>V.value.selectValue,te=>{t.isConfig||(V.value.displayType==="7"&&(f.value=Array.isArray(te)?[...te]:te),Se(()=>{M.value=V.value.displayType==="7",M.value||(f.value=Array.isArray(V.value.selectValue)?[...V.value.selectValue]:V.value.selectValue)}))});const T=()=>{const te=Array.isArray(f.value)?[...f.value]:f.value;if(!t.isConfig){V.value.selectValue=Array.isArray(f.value)?[...f.value]:f.value,Se(()=>{R(V.value.id)});return}V.value.defaultValue=Array.isArray(te)?te.map(se=>new Date(se).toLocaleString()):new Date(te).toLocaleString()},J=()=>{const{defaultValueCheck:te,displayType:se,defaultValue:ye}=V.value,W=se==="7";te?(V.value.selectValue=Array.isArray(ye)?[...ye]:ye,f.value=Array.isArray(ye)?[...ye]:ye):(V.value.selectValue=W?[]:void 0,f.value=W?[]:void 0),M.value=V.value.displayType==="7",e.value=e.value.slice(0,P()+1)},ee=xe("com-width",Function,!0),X=()=>{var te;return(te=r==null?void 0:r.value)!=null&&te.placeholderShow?t.config.queryConditionWidth===void 0?ee():t.config.queryConditionWidth:227},R=xe("is-confirm-search",Function,!0),O=L(()=>t.isConfig?{}:{width:(M.value?X()*2:X())+"px !important"}),g=L(()=>w.mobileInPc?["year","month","day"].slice(0,P()+1):[]),I=L(()=>w.mobileInPc?(M.value?V.value.timeGranularityMultiple:V.value.timeGranularity).includes("datetime"):!1),ue=ne([]),e=ne(["2021","01","01"]),fe=ne(!1),E=L(()=>w.mobileInPc?+V.value.displayType==7:!1),h=()=>{var se;const te=((se=f.value)==null?void 0:se.length)>1?f.value[1]:null;if(te){const ye=new Date(te);e.value=[`${ye.getFullYear()}`,`${ye.getMonth()+1}`,`${ye.getDate()}`].slice(0,P()+1),I.value&&(ue.value=[`${ye.getHours()}`,`${ye.getMinutes()}`,`${ye.getSeconds()}`])}Ye.value=!0,fe.value=!0},P=()=>{const te=M.value?V.value.timeGranularityMultiple:V.value.timeGranularity;return["year","month","date"].findIndex(ye=>te.includes(ye))},j=ne(0),$e=te=>{j.value=+new Date(te[0])},Te=()=>{j.value=0},we=L(()=>{const te=V.value.timeGranularityMultiple.split("time").join("").split("range")[0];return te==="date"?"day":te}),Ge=te=>{const se=+new Date(te);if(!V.value.setTimeRange)return!1;const{intervalType:ye,regularOrTrends:W,regularOrTrendsValue:Ce,relativeToCurrent:Ke,timeNum:G,relativeToCurrentType:re,around:H,dynamicWindow:k,maximumSingleQuery:$,timeNumRange:ie,relativeToCurrentTypeRange:ce,aroundRange:z}=V.value.timeRange||{};let de=!1;if(j.value&&k&&(de=ke(j.value).add($,we.value).startOf(we.value).valueOf()-1e3<se||ke(j.value).subtract($,we.value).startOf(we.value).valueOf()+1e3>se),ye==="none")return k?de:!1;let me;if(Ke==="custom")me=na(re,H==="f"?"subtract":"add",G);else switch(Ke){case"thisYear":me=je("year");break;case"lastYear":me=_a("year");break;case"thisMonth":me=je("month");break;case"lastMonth":me=_a("month");break;case"today":me=je("day");break;case"yesterday":me=_a("day");break;case"monthBeginning":me=je("month");break;case"yearBeginning":me=je("year");break}const _e=W==="fixed"?Ce:me;if(ye==="start")return se<+new Date(_e)||de;if(ye==="end")return se>+new Date(_e)||de;if(ye==="timeInterval"){const Pe=W==="fixed"?new Date(ke(new Date(Ce[0])).startOf(we.value).format("YYYY/MM/DD HH:mm:ss")):na(re,H==="f"?"subtract":"add",G),ma=W==="fixed"?new Date(ke(new Date(Ce[1])).endOf(we.value).format("YYYY/MM/DD HH:mm:ss")):na(ce,z==="f"?"subtract":"add",ie);return se<+new Date(Pe)-1e3||se>+new Date(ma)||de}},Xe=()=>{if(E.value){const[te]=f.value||[];if(te){const se=new Date(te);e.value=[`${se.getFullYear()}`,`${se.getMonth()+1}`,`${se.getDate()}`].slice(0,P()+1),I.value&&(ue.value=[`${se.getHours()}`,`${se.getMinutes()}`,`${se.getSeconds()}`])}}else{const te=f.value?new Date(f.value):new Date;e.value=[`${te.getFullYear()}`,`${te.getMonth()+1}`,`${te.getDate()}`].slice(0,P()+1),I.value&&(ue.value=[`${te.getHours()}`,`${te.getMinutes()}`,`${te.getSeconds()}`])}Ye.value=!1,fe.value=!0},ua=()=>{fe.value=!1},Ye=ne(!1),We=()=>{e.value=e.value.slice(0,P()+1);const te=e.value.length===2?e.value.concat(["01"]):e.value;if(E.value){const[se,ye]=f.value||[];Ye.value?f.value=[se||new Date(`${te.join("/")} ${ue.value.join(":")}`),new Date(`${te.join("/")} ${ue.value.join(":")}`)]:f.value=[new Date(`${te.join("/")} ${ue.value.join(":")}`),ye||new Date(`${te.join("/")} ${ue.value.join(":")}`)]}else f.value=new Date(`${te.join("/")} ${ue.value.join(":")}`)},ea=()=>{fe.value=!1;const{displayType:te}=V.value,se=te==="7";V.value.selectValue=se?[]:void 0,f.value=se?[]:void 0,T()},N=()=>{We(),T(),fe.value=!1};ga(()=>{J()}),y({displayTypeChange:D});const ca=L(()=>V.value.timeGranularityMultiple==="yearrange"?"YYYY":void 0);return(te,se)=>{const ye=Ya;return d(),F(oe,null,[M.value?(d(),Y(ye,{modelValue:f.value,"onUpdate:modelValue":se[0]||(se[0]=W=>f.value=W),key:a(V).timeGranularityMultiple,type:a(V).timeGranularityMultiple,style:Ne(O.value),onVisibleChange:Te,"disabled-date":Ge,onCalendarChange:$e,format:ca.value,shortcuts:["datetimerange","daterange"].includes(a(V).timeGranularityMultiple)?a(C):[],onChange:T,editable:!1,"range-separator":te.$t("cron.to"),"start-placeholder":v.value,"end-placeholder":v.value},null,8,["modelValue","type","style","format","shortcuts","range-separator","start-placeholder","end-placeholder"])):(d(),Y(ye,{key:a(V).timeGranularity+1,modelValue:f.value,"onUpdate:modelValue":se[1]||(se[1]=W=>f.value=W),onVisibleChange:Te,"disabled-date":Ge,type:a(V).timeGranularity,onChange:T,style:Ne(O.value),placeholder:v.value},null,8,["modelValue","type","style","placeholder"])),a(w).mobileInPc?(d(),F("div",{key:2,class:Ve(["vant-mobile",E.value&&"wl50"]),onClick:Xe},null,2)):Z("",!0),a(w).mobileInPc&&E.value?(d(),F("div",{key:3,class:"vant-mobile wr50",onClick:h})):Z("",!0),a(w).mobileInPc?(d(),Y(a(di),{key:4,teleport:"body",position:"bottom",show:fe.value,"onUpdate:show":se[5]||(se[5]=W=>fe.value=W)},{default:o(()=>[I.value?(d(),Y(a(br),{key:0,onConfirm:N,onCancel:ua,title:a(i)("v_query.time_selection"),tabs:[a(i)("dataset.select_date"),a(i)("dataset.select_time")],"next-step-text":a(i)("sync_datasource.next")},{default:o(()=>[u(a(rl),{"min-date":a(x),"max-date":a(B),"columns-type":g.value,modelValue:e.value,"onUpdate:modelValue":se[2]||(se[2]=W=>e.value=W)},null,8,["min-date","max-date","columns-type","modelValue"]),u(a(hr),{"columns-type":["hour","minute","second"],modelValue:ue.value,"onUpdate:modelValue":se[3]||(se[3]=W=>ue.value=W)},null,8,["modelValue"])]),_:1},8,["title","tabs","next-step-text"])):Z("",!0),I.value?Z("",!0):(d(),Y(a(rl),{key:1,title:a(i)("dataset.select_date"),"columns-type":g.value,onConfirm:N,onCancel:ua,"min-date":a(x),"max-date":a(B),modelValue:e.value,"onUpdate:modelValue":se[4]||(se[4]=W=>e.value=W)},null,8,["title","columns-type","min-date","max-date","modelValue"]))]),_:1},8,["show"])):Z("",!0),fe.value?(d(),Y(cl,{key:5,to:".van-picker__toolbar"},[_("button",{style:{position:"absolute",top:"0",right:"60px"},onClick:ea,class:"van-picker__confirm van-haptics-feedback oooo"},S(a(i)("commons.clear")),1)])):Z("",!0)],64)}}});const jl=Ae({__name:"Select",props:{config:{type:Object,default:()=>({selectValue:"",queryConditionWidth:0,resultMode:0,defaultValue:"",displayType:"",defaultValueCheck:!1,optionValueSource:0,multiple:!1,checkedFieldsMap:{}})},isConfig:{type:Boolean,default:!1}},setup(s,{expose:y}){const{t:i}=ia(),t=s,{config:r}=Qe(t);let v=[];const f=ne(),M=ne(!1),w=ne(!1),V=xa([]),x=xe("unmount-select"),B=xe("placeholder"),c=xe("release-unmount-select",Function,!0),C=xe("query-data-for-id",Function,!0),D=xe("is-confirm-search",Function,!0),T=xe("com-width",Function,!0),J=xe("cascade-list",Function,!0),ee=xe("set-cascade-default",Function,!0),X=L(()=>{var G;return(G=B==null?void 0:B.value)!=null&&G.placeholderShow?["",void 0].includes(t.config.placeholder)?" ":t.config.placeholder:" "}),R=L(()=>J()||[]),O=G=>{const{displayId:re,field:H}=r.value;if(r.value.optionValueSource!==1)return[];let k={},$=[];return G.forEach(ie=>{k[ie]=[]}),v.forEach(ie=>{k[ie[re||(H==null?void 0:H.id)]]&&k[ie[re||(H==null?void 0:H.id)]].push(ie[H==null?void 0:H.id])}),Object.values(k).forEach(ie=>{$=[...new Set([...$,...ie])]}),$};wn(()=>{v=[]});const g=G=>{R.value.forEach(re=>{re.forEach(H=>{H.datasetId.split("--")[1]===r.value.id&&(t.isConfig&&(H.selectValue=Array.isArray(G)?[...G]:G),H.currentSelectValue=Array.isArray(G)?[...G]:G)})})},I=()=>{R.value.forEach(G=>{let re=!1;G.forEach(H=>{H.datasetId.split("--")[1]===r.value.id?re=!0:re&&(ka().emitter.emit(`${H.datasetId.split("--")[1]}-select`),re=!1)})})},ue=()=>{const G=[];return R.value.forEach(re=>{let H=!1;re.forEach(k=>{k.datasetId.split("--")[1]===r.value.id?H=!0:H&&(G.push(k.datasetId.split("--")[1]),H=!1)})}),G},e=()=>{const G=[];return R.value.forEach(re=>{let H=null;re.forEach(k=>{var z,de;const[$,ie,ce]=k.datasetId.split("--");ie===r.value.id&&H?(k.fieldId&&(H.fieldId=k.fieldId),G.push(H)):t.isConfig?(z=k.selectValue)!=null&&z.length&&(H={fieldId:ce,operator:"in",value:[...k.selectValue]}):(de=k.currentSelectValue)!=null&&de.length&&(H={fieldId:ce,operator:"in",value:[...k.currentSelectValue]})})}),G},fe=()=>{const G=Array.isArray(f.value)?[...f.value]:f.value;if(!t.isConfig){r.value.selectValue=Array.isArray(f.value)?[...f.value]:f.value,r.value.mapValue=O(Array.isArray(f.value)?[...f.value]:[f.value]),g(r.value.mapValue),I(),Se(()=>{D(r.value.id)});return}ee(ue()),r.value.defaultValue=G,r.value.mapValue=O(Array.isArray(f.value)?[...f.value]:[f.value]),r.value.defaultMapValue=O(Array.isArray(f.value)?[...f.value]:[f.value]),g(r.value.mapValue)},E=()=>{t.isConfig&&(r.value.defaultValue=r.value.multiple?[]:void 0,f.value=r.value.multiple?[]:void 0)},h=G=>{M.value=!0,Wn({fieldIds:G,resultMode:r.value.resultMode||0}).then(re=>{V.value=(re||[]).filter(H=>H!==null).map(H=>({label:`${H}`,value:`${H}`}))}).finally(()=>{M.value=!1,r.value.defaultValueCheck?f.value=Array.isArray(r.value.defaultValue)?[...r.value.defaultValue]:r.value.defaultValue:f.value=Array.isArray(f.value)?[...f.value]:f.value,we()})},P=G=>{const{displayId:re}=r.value;if(!re)return[];let H={},k=[];return G.forEach($=>{H[$]=[]}),v.forEach($=>{H[$[re]]&&H[$[re]].push($)}),Object.values(H).forEach($=>{k=[...k,...$]}),k},j=()=>{var G;(G=r.value.sortList)!=null&&G.length&&r.value.sort==="customSort"&&(V.value=[...V.value.sort(re=>{if(r.value.sortList.indexOf(re.value)!==-1)return-1}).sort((re,H)=>r.value.sortList.indexOf(re.value)===-1?0:r.value.sortList.indexOf(re.value)-r.value.sortList.indexOf(H.value))])},$e=G=>{M.value=!0,hl(G).then(re=>{var $;let H=[],k=[];($=f.value)!=null&&$.length&&r.value.multiple&&(H=[...f.value],k=P(H)),v=[...re||[],...k],V.value=[...new Set((re||[]).map(ie=>`${ie[G.displayId||G.queryId]}`).concat(H))].map(ie=>({label:`${ie}`,value:`${ie}`,checked:H.includes(ie)})),j()}).finally(()=>{var re;if(M.value=!1,r.value.defaultValueCheck&&!Xe.value){f.value=Array.isArray(r.value.defaultValue)?[...r.value.defaultValue]:r.value.defaultValue;let H=!1;if(x.value.includes(r.value.id)){const k=O(Array.isArray(f.value)?[...f.value]:[f.value]);(k==null?void 0:k.length)!==((re=r.value.defaultMapValue)==null?void 0:re.length)?H=!0:k.every($=>r.value.defaultMapValue.includes($))||(H=!0),c(r.value.id)}r.value.mapValue=O(Array.isArray(f.value)?[...f.value]:[f.value]),H&&C(r.value.id)}else f.value=Array.isArray(f.value)?[...f.value]:f.value;Xe.value=!1})},Te=ne(!1);pe(()=>r.value.showEmpty,()=>{we()});const we=()=>{const{showEmpty:G,displayType:re,optionValueSource:H}=r.value;if(+re!=0||H===1)return;const[k]=V.value;G?(k==null?void 0:k.value)!=="_empty_$"&&(V.value=[{label:i("v_query.empty_data"),value:"_empty_$"},...V.value]):(k==null?void 0:k.value)==="_empty_$"&&(V.value=V.value.slice(1))};pe(()=>r.value.defaultValue,G=>{r.value.multiple&&(f.value=Array.isArray(G)?[...G]:G),Se(()=>{w.value=r.value.multiple})}),pe(()=>r.value.id,()=>{We()}),pe(()=>r.value.selectValue,G=>{t.isConfig||(r.value.multiple&&(f.value=Array.isArray(G)?[...G]:G),Se(()=>{w.value=r.value.multiple,r.value.multiple||(f.value=Array.isArray(r.value.selectValue)?[...r.value.selectValue]:r.value.selectValue)}))}),pe(()=>r.value.multiple,G=>{t.isConfig&&(G&&(f.value=[]),Se(()=>{w.value=G,G||Se(()=>{f.value=void 0})}))}),pe([()=>r.value.field.id,()=>r.value.displayId,()=>r.value.sort,()=>r.value.sortId],G=>{G&&Ye(1)}),pe([()=>r.value.sortList],G=>{!(G!=null&&G.length)||r.value.sort!=="customSort"||j()}),pe(()=>r.value.optionValueSource,(G,re)=>{t.isConfig&&([G,re].includes(2)&&(f.value=Array.isArray(f.value)?[]:void 0,r.value.selectValue=Le(f.value),r.value.defaultValue=Le(f.value)),Ye(G))}),pe([()=>r.value.checkedFields,()=>r.value.checkedFieldsMap],()=>{Ye(r.value.optionValueSource)},{deep:!0});const Ge=ne(""),Xe=ne(!1);pe(()=>r.value.valueSource,()=>{r.value.optionValueSource===2&&Ye(2)});const Ye=bl(G=>{if(G!==r.value.optionValueSource)return;const{optionValueSource:re,checkedFieldsMap:H,checkedFields:k,field:$,valueSource:ie,displayId:ce,sort:z,sortId:de}=r.value;switch(re){case 0:const me=Object.values(H).filter(_e=>!!_e);k.length&&me.length?h(k.map(_e=>H[_e]).filter(_e=>!!_e)):V.value=[];break;case 1:$.id?$e({queryId:$.id,displayId:ce||$.id,sort:z==="customSort"?"asc":z,sortId:z==="customSort"?"":de,resultMode:r.value.resultMode||0,searchText:Ge.value,filter:e()}):V.value=[];break;case 2:V.value=Le((ie||[]).map(_e=>({label:`${_e}`,value:`${_e}`}))),we();break}},300),We=()=>{const{defaultValueCheck:G,multiple:re,defaultValue:H,optionValueSource:k}=r.value;G?(r.value.selectValue=Array.isArray(H)?[...H]:H,f.value=Array.isArray(H)?[...H]:H):(r.value.selectValue=re?[]:void 0,f.value=re?[]:void 0),Se(()=>{w.value=r.value.multiple}),Ye(k)},ea=()=>{var G;return(G=B==null?void 0:B.value)!=null&&G.placeholderShow?t.config.queryConditionWidth===void 0?T():t.config.queryConditionWidth:227},N=L(()=>t.isConfig?{}:{width:ea()+"px"}),ca=ne(),te=ne(),se=()=>{r.value.optionValueSource!==1||![0,2,5].includes(+r.value.displayType)||(r.value.selectValue=r.value.multiple?[]:void 0,f.value=r.value.multiple?[]:void 0,Xe.value=!0,Ye(1))},ye=()=>{ka().emitter.emit("select-hide_lick",r.value.id)},W=G=>{var H;if(G===r.value.id)return;const re=te.value||ca.value;(H=re==null?void 0:re.handleClickOutside)==null||H.call(re)};ga(()=>{We(),ka({name:`${r.value.id}-select`,callback:se}),ka({name:"select-hide_lick",callback:W})});const Ce=ne(!1),Ke=L(()=>{let G="filter-select-popper_class";return Te.value&&(G="load-select "+G),Ce.value&&(G=G+" color-scrollbar__thumb"),G});return wt(()=>{Ce.value=!!document.querySelector("#canvas-dv-outer")||!!document.querySelector(".datav-preview")}),y({displayTypeChange:E,mult:ca,single:te}),(G,re)=>{const H=bi,k=Ra,$=La,ie=ml("loading");return w.value?$a((d(),Y(H,{key:"multiple",ref_key:"mult",ref:ca,modelValue:f.value,"onUpdate:modelValue":re[0]||(re[0]=ce=>f.value=ce),placeholder:X.value,filterable:"",onClick:ye,onChange:fe,"popper-class":Ke.value,multiple:"","show-checked":"","scrollbar-always-on":"",clearable:"",style:Ne(N.value),"collapse-tags":"",options:V.value,"collapse-tags-tooltip":""},null,8,["modelValue","placeholder","popper-class","style","options"])),[[ie,M.value]]):$a((d(),Y(H,{modelValue:f.value,"onUpdate:modelValue":re[2]||(re[2]=ce=>f.value=ce),key:"single",onClick:ye,placeholder:X.value,"scrollbar-always-on":"",onChange:fe,clearable:"",ref_key:"single",ref:te,style:Ne(N.value),filterable:"",radio:"","popper-class":Ke.value,options:V.value},{default:o(({item:ce})=>[u($,{modelValue:f.value,"onUpdate:modelValue":re[1]||(re[1]=z=>f.value=z)},{default:o(()=>[u(k,{title:ce.label,label:ce.value},{default:o(()=>[le(S(ce.label),1)]),_:2},1032,["title","label"])]),_:2},1032,["modelValue"])]),_:1},8,["modelValue","placeholder","style","popper-class","options"])),[[ie,M.value]])}}});const sl="",Vr=Ae({__name:"Tree",props:{config:{type:Object,default:()=>({selectValue:"",defaultValue:"",queryConditionWidth:0,displayType:"",resultMode:0,defaultValueCheck:!1,multiple:!1,checkedFieldsMap:{},treeFieldList:[]})},isConfig:{type:Boolean,default:!1}},setup(s){const y=s,i=xe("placeholder"),t=L(()=>{var I;return(I=i==null?void 0:i.value)!=null&&I.placeholderShow?["",void 0].includes(y.config.placeholder)?" ":y.config.placeholder:" "}),{config:r}=Qe(y),v=ne(!1),f=I=>{R.value=I,M()},M=()=>{const I=Array.isArray(R.value)?[...R.value]:R.value;if(!y.isConfig){r.value.selectValue=Array.isArray(R.value)?[...R.value]:R.value,Se(()=>{B(r.value.id)});return}r.value.defaultValue=I};pe(()=>r.value.defaultValue,I=>{r.value.multiple&&(R.value=Array.isArray(I)?[...I]:I),Se(()=>{v.value=r.value.multiple})}),pe(()=>r.value.treeFieldList,()=>{R.value=r.value.multiple?[]:void 0,V.value=!1,X()});const w=()=>{const{defaultValueCheck:I,multiple:ue,defaultValue:e}=r.value;I?(r.value.selectValue=Array.isArray(e)?Le([...e]):e,R.value=Array.isArray(e)?Le([...e]):e):(r.value.selectValue=ue?[]:void 0,R.value=ue?[]:void 0),Se(()=>{v.value=r.value.multiple}),X()};pe(()=>r.value.id,()=>{w()});const V=ne(!0),x=xe("com-width",Function,!0),B=xe("is-confirm-search",Function,!0);pe(()=>r.value.id,()=>{X()}),wt(()=>{setTimeout(()=>{w()},0)}),pe(()=>r.value.selectValue,I=>{y.isConfig||(r.value.multiple&&(R.value=Array.isArray(I)?[...I]:I),Se(()=>{v.value=r.value.multiple,r.value.multiple||(R.value=Array.isArray(r.value.selectValue)?[...r.value.selectValue]:r.value.selectValue)}))});const c=ne(!1);pe(()=>r.value.multiple,I=>{y.isConfig&&(c.value=!1,I&&(R.value=[]),Se(()=>{v.value=I,I||Se(()=>{R.value=void 0}),Se(()=>{c.value=!0})}))});let C="",D=xa([]);const T=(I,ue)=>(ue.label??"").toLowerCase().includes((I??"").toLowerCase()),J=I=>(I||[]).map(ue=>{var fe;let e=[];return(fe=ue.children)!=null&&fe.length&&(e=J(ue.children)),{...ue,value:ue.id,label:ue.text,children:e}}),ee=ne(!1),X=bl(()=>{ee.value=!0,zn({fieldIds:y.config.treeFieldList.map(I=>I.id),resultMode:r.value.resultMode||0}).then(I=>{D.value=J(I)}).finally(()=>{ee.value=!1,c.value=!0})},300);pe(()=>y.config.treeFieldList,I=>{if(!y.isConfig)return;const ue=I.map(e=>e.id).join("");C!==I.map(e=>e.id).join("")&&(C=ue,X())});const R=ne(),O=()=>{var I;return(I=i==null?void 0:i.value)!=null&&I.placeholderShow?y.config.queryConditionWidth!==void 0?y.config.queryConditionWidth:x():227},g=L(()=>y.isConfig?{}:{width:O()+"px"});return(I,ue)=>{const e=_l,fe=ml("loading");return v.value&&!ee.value?(d(),Y(e,{modelValue:R.value,"onUpdate:modelValue":ue[0]||(ue[0]=E=>R.value=E),data:a(D),clearable:"",onTreeSelectConfirm:f,"render-after-expand":!1,"show-checkbox":"",showBtn:"",placeholder:t.value,"collapse-tags":"","filter-node-method":T,showWholePath:c.value,"collapse-tags-tooltip":"",key:"multipleTree"+O(),filterable:"",style:Ne(g.value),multiple:""},null,8,["modelValue","data","placeholder","showWholePath","style"])):!v.value&&!ee.value?(d(),Y(e,{modelValue:R.value,"onUpdate:modelValue":ue[1]||(ue[1]=E=>R.value=E),onChange:M,data:a(D),"check-strictly":"",clearable:"","filter-node-method":T,placeholder:t.value,"render-after-expand":!1,key:"singleTree"+O(),showWholePath:c.value,style:Ne(g.value),filterable:""},null,8,["modelValue","data","placeholder","showWholePath","style"])):$a((d(),Y(e,{modelValue:sl,"onUpdate:modelValue":ue[2]||(ue[2]=E=>sl=E),data:[],placeholder:t.value,"render-after-expand":!1,key:"fakeTree",style:Ne(g.value)},null,8,["placeholder","style"])),[[fe,ee.value]])}}});const Wl=Ba(Vr,[["__scopeId","data-v-968a3a40"]]),Tr={class:"label"},kr={class:"condition-type"},Cr={key:0,class:"condition-type"},Mr={class:"condition-type-tip"},Sr={class:"label"},Fr={class:"setting-content",style:{display:"flex","align-items":"center"}},wr={key:2,class:"list-item"},$r={class:"label"},qr={class:"value"},Or={key:3,class:"list-item"},Dr={class:"label"},Nr={class:"setting-content"},Er={key:0,class:"config-flag range-filter-time-flag"},Ar={key:4,class:"list-item"},Ir={class:"label"},xr={key:5,class:"list-item"},Rr={class:"label"},Lr={key:0,class:"setting-content"},Ur={class:"setting"},Yr={class:"setting"},Br=["title"],Gr={class:"setting-value select"},Pr={key:0,class:"setting"},jr={class:"setting"},Wr={class:"setting-label"},zr={class:"setting-value select"},Hr={class:"setting-label"},Qr={class:"setting-input with-date range"},Kr={class:"setting-label"},Zr={class:"setting-input with-date range"},Jr={key:0,class:"setting-label"},Xr=Ae({__name:"ConditionDefaultConfiguration",props:{curComponent:{type:Object,required:!0},showPosition:{type:String,default:"main"}},emits:["handleTimeTypeChange"],setup(s,{expose:y,emit:i}){const{t}=ia(),r=ne(!1),v=()=>{r.value=!1},f=E=>{E.stopPropagation(),r.value=!r.value},M=L(()=>{const{displayType:E,timeType:h="fixed"}=c.value;return["1","7"].includes(E)?h==="dynamic"?E==="1"?Yu:Bu:Pl:E==="9"?Wl:jl}),w=i,V=E=>{E==="dynamic"&&w("handleTimeTypeChange")},x=s,B=L(()=>x.showPosition==="main"),{curComponent:c}=Qe(x),C=L(()=>{if(!c.value)return[];let E=["year","month","date","datetime"].indexOf(c.value.timeGranularity)+1;return+c.value.displayType==7&&(E=["yearrange","monthrange","daterange","datetimerange"].indexOf(c.value.timeGranularityMultiple)+1),[{label:t("dynamic_time.year"),value:"year"},{label:t("dynamic_time.month"),value:"month"},{label:t("dynamic_time.date"),value:"date"}].slice(0,E)}),D=L(()=>{let E=[];if(!c.value)return E;switch(c.value.timeGranularity){case"year":E=[{label:t("dynamic_year.current"),value:"thisYear"},{label:t("dynamic_year.last"),value:"lastYear"}];break;case"month":E=[{label:t("cron.this_month"),value:"thisMonth"},{label:t("dynamic_month.last"),value:"lastMonth"}];break;case"date":E=[{label:t("dynamic_time.today"),value:"today"},{label:t("dynamic_time.yesterday"),value:"yesterday"},{label:t("dynamic_time.firstOfMonth"),value:"monthBeginning"},{label:t("dynamic_time.endOfMonth"),value:"monthEnd"},{label:t("dynamic_time.firstOfYear"),value:"yearBeginning"}];break;case"datetime":E=[{label:t("dynamic_time.today"),value:"today"},{label:t("dynamic_time.yesterday"),value:"yesterday"},{label:t("dynamic_time.firstOfMonth"),value:"monthBeginning"},{label:t("dynamic_time.endOfMonth"),value:"monthEnd"},{label:t("dynamic_time.firstOfYear"),value:"yearBeginning"}];break}return[...E,{label:t("dynamic_time.custom"),value:"custom"}]}),T=L(()=>{let E=[];if(!c.value)return E;switch(c.value.timeGranularityMultiple){case"yearrange":E=[{label:t("dynamic_year.current"),value:"thisYear"},{label:t("dynamic_year.last"),value:"lastYear"}];break;case"monthrange":E=[{label:t("cron.this_month"),value:"thisMonth"},{label:t("dynamic_month.last"),value:"lastMonth"},{label:t("v_query.last_3_months"),value:"LastThreeMonths"},{label:t("v_query.last_6_months"),value:"LastSixMonths"},{label:t("v_query.last_12_months"),value:"LastTwelveMonths"}];break;case"daterange":case"datetimerange":E=[{label:t("dynamic_time.today"),value:"today"},{label:t("dynamic_time.yesterday"),value:"yesterday"},{label:t("v_query.last_3_days"),value:"LastThreeDays"},{label:t("v_query.month_to_date"),value:"monthBeginning"},{label:t("v_query.year_to_date"),value:"yearBeginning"}];break}return[...E,{label:t("dynamic_time.custom"),value:"custom"}]}),J=[{label:t("dynamic_time.before"),value:"f"},{label:t("dynamic_time.after"),value:"b"}],ee=L(()=>{const{displayType:E,timeType:h}=c.value;return h==="dynamic"&&[1,7].includes(+E)}),X=[{label:t("v_query.exact_match"),value:"eq"},{label:t("v_query.fuzzy_match"),value:"like"}],R=ne(!1),O=(E,h=!1)=>{h&&(c.value.defaultValue=E?[]:void 0);const{defaultValue:P}=c.value;if(Array.isArray(P)?c.value.selectValue=E?P:void 0:c.value.selectValue=E?P!==void 0?[P]:[]:P,c.value.field.deType===1){c.value.multiple=E;return}c.value.multiple=E},g=E=>{R.value=E},I=ne();return y({multipleChange:O,handleDialogClick:v,changeMultiple:g,displayTypeChange:()=>{var E,h;(h=(E=I.value)==null?void 0:E.displayTypeChange)==null||h.call(E)},mult:()=>{var E,h,P;(P=(h=(E=I.value)==null?void 0:E.mult)==null?void 0:h.handleClickOutside)==null||P.call(h)},single:()=>{var E,h,P;(P=(h=(E=I.value)==null?void 0:E.single)==null?void 0:h.handleClickOutside)==null||P.call(h)}}),(E,h)=>{const P=qa,j=Mt,$e=Ot,Te=lt,we=Ra,Ge=La,Xe=wa,ua=Ia,Ye=yl,We=Nt,ea=oi;return d(),F(oe,null,[a(c).displayType==="8"?(d(),F("div",{key:0,class:"list-item top-item",onClick:h[4]||(h[4]=Ie(()=>{},["stop"]))},[_("div",Tr,S(a(t)("dynamic_time.set_default")),1),_("div",{class:Ve(["value",a(c).hideConditionSwitching&&"hide-condition_switching"])},[_("div",kr,[a(c).hideConditionSwitching?Z("",!0):(d(),Y(a(De),{key:0,class:"condition-value-select","popper-class":"condition-value-select-popper",modelValue:a(c).defaultConditionValueOperatorF,"onUpdate:modelValue":h[0]||(h[0]=N=>a(c).defaultConditionValueOperatorF=N)},{default:o(()=>[(d(),F(oe,null,ve(X,N=>u(P,{key:N.value,label:N.label,value:N.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])),u(j,{class:"condition-value-input",modelValue:a(c).defaultConditionValueF,"onUpdate:modelValue":h[1]||(h[1]=N=>a(c).defaultConditionValueF=N)},null,8,["modelValue"]),h[30]||(h[30]=_("div",{class:"bottom-line"},null,-1))]),[1,2].includes(a(c).conditionType)?(d(),F("div",Cr,[_("span",Mr,S(a(c).conditionType===1?a(t)("chart.and"):a(t)("chart.or")),1),a(c).hideConditionSwitching?Z("",!0):(d(),Y(a(De),{key:0,class:"condition-value-select","popper-class":"condition-value-select-popper",modelValue:a(c).defaultConditionValueOperatorS,"onUpdate:modelValue":h[2]||(h[2]=N=>a(c).defaultConditionValueOperatorS=N)},{default:o(()=>[(d(),F(oe,null,ve(X,N=>u(P,{key:N.value,label:N.label,value:N.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])),u(j,{class:"condition-value-input",modelValue:a(c).defaultConditionValueS,"onUpdate:modelValue":h[3]||(h[3]=N=>a(c).defaultConditionValueS=N)},null,8,["modelValue"]),h[31]||(h[31]=_("div",{class:"bottom-line next-line"},null,-1))])):Z("",!0)],2)])):Z("",!0),a(c).displayType==="22"?(d(),F("div",{key:1,class:"list-item top-item",onClick:h[8]||(h[8]=Ie(()=>{},["stop"]))},[_("div",Sr,[u($e,{modelValue:a(c).defaultValueCheck,"onUpdate:modelValue":h[5]||(h[5]=N=>a(c).defaultValueCheck=N),label:a(t)("dynamic_time.set_default")},null,8,["modelValue","label"])]),_("div",Fr,[u(Te,{disabled:!a(c).defaultValueCheck,placeholder:a(t)("system.the_minimum_value"),style:{width:"192.5px"},"controls-position":"right",modelValue:a(c).defaultNumValueStart,"onUpdate:modelValue":h[6]||(h[6]=N=>a(c).defaultNumValueStart=N)},null,8,["disabled","placeholder","modelValue"]),h[32]||(h[32]=_("div",{class:"num-value_line"},null,-1)),u(Te,{placeholder:a(t)("system.the_maximum_value"),style:{width:"192.5px"},"controls-position":"right",disabled:!a(c).defaultValueCheck,modelValue:a(c).defaultNumValueEnd,"onUpdate:modelValue":h[7]||(h[7]=N=>a(c).defaultNumValueEnd=N)},null,8,["placeholder","disabled","modelValue"])])])):Z("",!0),!["1","7","8","22"].includes(a(c).displayType)&&B.value?(d(),F("div",wr,[_("div",$r,S(a(t)("v_query.option_type")),1),_("div",qr,[u(Ge,{class:"larger-radio",onChange:h[9]||(h[9]=N=>O(N,!0)),modelValue:R.value,"onUpdate:modelValue":h[10]||(h[10]=N=>R.value=N)},{default:o(()=>[u(we,{label:!1},{default:o(()=>[le(S(a(t)("visualization.single_choice")),1)]),_:1}),u(we,{label:!0},{default:o(()=>[le(S(a(t)("visualization.multiple_choice")),1)]),_:1})]),_:1},8,["modelValue"])])])):Z("",!0),["7","1"].includes(a(c).displayType)&&B.value?(d(),F("div",Or,[_("div",Dr,[u($e,{modelValue:a(c).setTimeRange,"onUpdate:modelValue":h[11]||(h[11]=N=>a(c).setTimeRange=N),label:a(t)("v_query.time_filter_range")},null,8,["modelValue","label"])]),_("div",Nr,[u(Ye,{"show-arrow":!1,"popper-class":"range-filter-time",placement:"bottom-start",width:452,visible:r.value,offset:4},{reference:o(()=>[u(ua,{disabled:!a(c).setTimeRange,onClick:h[12]||(h[12]=N=>f(N)),text:"",style:{"margin-left":"-4px"}},{icon:o(()=>[u(Xe,{name:"icon_admin_outlined"},{default:o(()=>[u(a(si),{class:"svg-icon"})]),_:1})]),default:o(()=>[le(" "+S(a(t)("dynamic_time.set")),1)]),_:1},8,["disabled"])]),default:o(()=>[a(c).displayType==="7"?(d(),Y(yu,{key:0,timeRange:a(c).timeRange,timeGranularityMultiple:a(c).timeGranularityMultiple},null,8,["timeRange","timeGranularityMultiple"])):(d(),Y(Uu,{key:1,timeRange:a(c).timeRange,timeGranularity:a(c).timeGranularity},null,8,["timeRange","timeGranularity"]))]),_:1},8,["visible"]),a(c).timeRange&&(a(c).timeRange.intervalType!=="none"||a(c).timeRange.dynamicWindow)?(d(),F("span",Er,S(a(t)("v_query.configured")),1)):Z("",!0)])])):Z("",!0),+a(c).displayType==0&&a(c).optionValueSource!==1&&B.value?(d(),F("div",Ar,[_("div",Ir,[u(We,{effect:"dark",content:a(t)("v_query.is_not_supported"),disabled:!a(c).parametersCheck,placement:"top"},{default:o(()=>[u($e,{disabled:a(c).parametersCheck,modelValue:a(c).showEmpty,"onUpdate:modelValue":h[13]||(h[13]=N=>a(c).showEmpty=N),label:a(t)("v_query.contains_empty_data")},null,8,["disabled","modelValue","label"])]),_:1},8,["content","disabled"])])])):Z("",!0),["8","22"].includes(a(c).displayType)?Z("",!0):(d(),F("div",xr,[_("div",Rr,[u($e,{modelValue:a(c).defaultValueCheck,"onUpdate:modelValue":h[14]||(h[14]=N=>a(c).defaultValueCheck=N),label:a(t)("dynamic_time.set_default")},null,8,["modelValue","label"])]),a(c).defaultValueCheck&&["1","7"].includes(a(c).displayType)?(d(),F("div",Lr,[_("div",Ur,[u(Ge,{onChange:V,modelValue:a(c).timeType,"onUpdate:modelValue":h[15]||(h[15]=N=>a(c).timeType=N)},{default:o(()=>[u(we,{label:"fixed"},{default:o(()=>[le(S(a(t)("dynamic_time.fix")),1)]),_:1}),u(we,{label:"dynamic"},{default:o(()=>[le(S(a(t)("dynamic_time.dynamic")),1)]),_:1})]),_:1},8,["modelValue"])]),ee.value&&a(c).displayType==="1"?(d(),F(oe,{key:0},[_("div",Yr,[_("div",{title:a(t)("dynamic_time.relative"),class:"setting-label ellipsis"},S(a(t)("dynamic_time.relative")),9,Br),_("div",Gr,[u(a(De),{onFocus:v,modelValue:a(c).relativeToCurrent,"onUpdate:modelValue":h[16]||(h[16]=N=>a(c).relativeToCurrent=N)},{default:o(()=>[(d(!0),F(oe,null,ve(D.value,N=>(d(),Y(P,{key:N.value,label:N.label,value:N.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),a(c).relativeToCurrent==="custom"?(d(),F("div",Pr,[_("div",{class:Ve(["setting-input",a(c).timeGranularity==="datetime"&&"with-date"])},[u(Te,{"step-strictly":"",modelValue:a(c).timeNum,"onUpdate:modelValue":h[17]||(h[17]=N=>a(c).timeNum=N),min:0,"controls-position":"right"},null,8,["modelValue"]),u(a(De),{onFocus:v,modelValue:a(c).relativeToCurrentType,"onUpdate:modelValue":h[18]||(h[18]=N=>a(c).relativeToCurrentType=N)},{default:o(()=>[(d(!0),F(oe,null,ve(C.value,N=>(d(),Y(P,{key:N.value,label:N.label,value:N.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(a(De),{onFocus:v,modelValue:a(c).around,"onUpdate:modelValue":h[19]||(h[19]=N=>a(c).around=N)},{default:o(()=>[(d(),F(oe,null,ve(J,N=>u(P,{key:N.value,label:N.label,value:N.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),a(c).timeGranularity==="datetime"?(d(),Y(ea,{key:0,modelValue:a(c).arbitraryTime,"onUpdate:modelValue":h[20]||(h[20]=N=>a(c).arbitraryTime=N)},null,8,["modelValue"])):Z("",!0)],2)])):Z("",!0)],64)):ee.value&&a(c).displayType==="7"?(d(),F(oe,{key:1},[_("div",jr,[_("div",Wr,S(a(t)("dynamic_time.relative")),1),_("div",zr,[u(a(De),{onFocus:v,modelValue:a(c).relativeToCurrentRange,"onUpdate:modelValue":h[21]||(h[21]=N=>a(c).relativeToCurrentRange=N)},{default:o(()=>[(d(!0),F(oe,null,ve(T.value,N=>(d(),Y(P,{key:N.value,label:N.label,value:N.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),a(c).relativeToCurrentRange==="custom"?(d(),F("div",{key:0,class:Ve(["setting",["yearrange","monthrange","daterange"].includes(a(c).timeGranularityMultiple)&&"is-year-month-range"])},[_("div",Hr,S(a(t)("datasource.start_time")),1),_("div",Qr,[u(Te,{"step-strictly":"",modelValue:a(c).timeNum,"onUpdate:modelValue":h[22]||(h[22]=N=>a(c).timeNum=N),min:0,"controls-position":"right"},null,8,["modelValue"]),u(a(De),{onFocus:v,modelValue:a(c).relativeToCurrentType,"onUpdate:modelValue":h[23]||(h[23]=N=>a(c).relativeToCurrentType=N)},{default:o(()=>[(d(!0),F(oe,null,ve(C.value,N=>(d(),Y(P,{key:N.value,label:N.label,value:N.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(a(De),{onFocus:v,modelValue:a(c).around,"onUpdate:modelValue":h[24]||(h[24]=N=>a(c).around=N)},{default:o(()=>[(d(),F(oe,null,ve(J,N=>u(P,{key:N.value,label:N.label,value:N.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),u(ea,{modelValue:a(c).arbitraryTime,"onUpdate:modelValue":h[25]||(h[25]=N=>a(c).arbitraryTime=N)},null,8,["modelValue"])])],2)):Z("",!0),a(c).relativeToCurrentRange==="custom"?(d(),F("div",{key:1,class:Ve(["setting",["yearrange","monthrange","daterange"].includes(a(c).timeGranularityMultiple)&&"is-year-month-range"])},[_("div",Kr,S(a(t)("datasource.end_time")),1),_("div",Zr,[u(Te,{modelValue:a(c).timeNumRange,"onUpdate:modelValue":h[26]||(h[26]=N=>a(c).timeNumRange=N),min:0,"step-strictly":"","controls-position":"right"},null,8,["modelValue"]),u(a(De),{onFocus:v,modelValue:a(c).relativeToCurrentTypeRange,"onUpdate:modelValue":h[27]||(h[27]=N=>a(c).relativeToCurrentTypeRange=N)},{default:o(()=>[(d(!0),F(oe,null,ve(C.value,N=>(d(),Y(P,{key:N.value,label:N.label,value:N.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(a(De),{onFocus:v,modelValue:a(c).aroundRange,"onUpdate:modelValue":h[28]||(h[28]=N=>a(c).aroundRange=N)},{default:o(()=>[(d(),F(oe,null,ve(J,N=>u(P,{key:N.value,label:N.label,value:N.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),u(ea,{modelValue:a(c).arbitraryTimeRange,"onUpdate:modelValue":h[29]||(h[29]=N=>a(c).arbitraryTimeRange=N)},null,8,["modelValue"])])],2)):Z("",!0)],64)):Z("",!0)])):Z("",!0),a(c).defaultValueCheck?(d(),F("div",{key:1,class:Ve(["parameters",ee.value&&"setting"])},[ee.value?(d(),F("div",Jr,S(a(t)("template_manage.preview")),1)):Z("",!0),_("div",{class:Ve(ee.value?"setting-value":"w100")},[(d(),Y(Ue(M.value),{config:a(c),isConfig:"",ref_key:"inputCom",ref:I},null,8,["config"]))],2)],2)):Z("",!0)]))],64)}}});const eo=Ba(Xr,[["__scopeId","data-v-c27132bd"]]),ao={class:"query-condition-list"},to={class:"title"},lo=["onDblclick","onClick"],no=["title"],io={class:"condition-icon flex-align-center"},uo={key:0,class:"mask"},ro={class:"title flex-align-center"},oo={class:"flex-align-center"},so={class:"select-all"},co={class:"field-list"},mo=["title"],vo=["title"],po={class:"flex-align-center icon"},fo=["title"],yo=["onClick"],_o={class:"flex-align-center icon"},ho=["title"],go=["onClick"],bo=["title"],Vo=["title"],To=["onClick"],ko={key:3,style:{width:"172px","margin-left":"12px"}},Co={key:0,class:"mask condition"},Mo={class:"title flex-align-center"},So={class:"configuration-list"},Fo={class:"list-item"},wo={class:"label"},$o={class:"value"},qo={key:0,class:"list-item"},Oo=["title"],Do={class:"value"},No={key:1,class:"list-item"},Eo={class:"label",style:{width:"135px",height:"26px","line-height":"26px"}},Ao={class:"search-tree"},Io={class:"level-index"},xo={class:"field-type"},Ro={class:"field-tree_name"},Lo={key:2,class:"list-item"},Uo=["title"],Yo={class:"value"},Bo={key:3,class:"list-item top-item"},Go=["title"],Po={class:"value"},jo={class:"value"},Wo={class:"value"},zo={class:"content"},Ho=["title"],Qo={style:{display:"flex","align-items":"center"},class:"value ellipsis"},Ko=["title"],Zo=["title"],Jo={style:{display:"flex","align-items":"center"},class:"value"},Xo=["title"],es=["title"],as={class:"value"},ts={class:"label"},ls=["title"],ns={key:1,class:"value flex-align-center"},is={class:"manual-input-container"},us={class:"title"},rs={class:"select-value"},os={class:"add-btn"},ss={class:"manual-footer flex-align-center"},ds={key:0,class:"config-flag flex-align-center"},cs=["title"],ms={class:"value",style:{"margin-top":"10.5px"}},vs={key:4,class:"list-item top-item"},ps=["title"],fs={class:"value"},ys={class:"value"},_s={key:5,style:{"margin-bottom":"10.5px"}},hs={key:1,class:"empty"},gs={key:2,class:"empty"},bs={key:3,class:"empty"},Vs={class:"dialog-footer"},Ts=Ae({__name:"QueryConditionConfiguration",props:{queryElement:{type:Object,default(){return{id:null,propValue:[]}}}},emits:["queryData"],setup(s,{expose:y,emit:i}){const{t}=ia(),{wsCache:r}=Tn(),v=Ua(),{componentData:f,canvasViewInfo:M}=tt(v),w=ne(null),V=s,x=ne(!1),B=ne([]),c=ne([]),C=ne([]),D=ne(!1),T=vl({id:"",name:"",visible:!1}),J={},ee=fl(),X=()=>{let n=f.value.filter(l=>!["VQuery","DeTabs"].includes(l.innerType)&&l.component!=="Group");return f.value.forEach(l=>{l.innerType==="DeTabs"?l.propValue.forEach(m=>{n=[...n,...m.componentData.filter(b=>!["VQuery","DeTabs"].includes(b.innerType)&&b.component!=="Group")],m.componentData.forEach(b=>{b.component==="Group"&&(n=[...n,b.propValue.filter(q=>!["VQuery","DeTabs"].includes(q.innerType)&&q.component!=="Group")])})}):l.component==="Group"&&(n=[...n,l.propValue.filter(m=>!["VQuery","DeTabs"].includes(m.innerType)&&m.component!=="Group")],l.propValue.forEach(m=>{m.innerType==="DeTabs"&&m.propValue.forEach(b=>{n=[...n,...b.componentData.filter(q=>!["VQuery","DeTabs"].includes(q.innerType)&&q.component!=="Group")]})}))}),n.flat()},R=L(()=>X().map(n=>{const l=M.value[n.id];if(!l)return null;const{id:m,title:b,tableId:q,type:A}=l;return m&&q?{id:m,type:A,title:b,tableId:q}:null}).filter(n=>!!n)),O=n=>{C.value.forEach(l=>{l.optionValueSource===1&&[0,2,5].includes(+l.displayType)&&n.includes(l.id)&&(l.selectValue=Array.isArray(l.selectValue)?[]:void 0,l.defaultValue=Array.isArray(l.defaultValue)?[]:void 0,l.mapValue=Array.isArray(l.mapValue)?[]:void 0,l.defaultMapValue=Array.isArray(l.defaultMapValue)?[]:void 0)})};let g=[];const I=n=>{g=n},ue=()=>g;sa("set-cascade-default",O),sa("cascade-list",ue);const e=ne(),fe=ne(),E=ne(""),h=ne(!1),P=xa([]),j=ne(),{queryElement:$e}=Qe(V),Te=(n,l)=>{var m;return(m=l.flat().find(b=>b.id===n))==null?void 0:m.deType},we=L(()=>{var n;return!e.value||!((n=e.value.checkedFields)!=null&&n.length)?!1:e.value.checkedFields.some(l=>!!e.value.checkedFieldsMap[l])}),Ge=L(()=>{var b,q;if(!e.value||!((b=e.value.checkedFields)!=null&&b.length)||!((q=j.value)!=null&&q.length))return!1;if(e.value.parameters.length&&ra.value){const A=e.value.parameters.map(ae=>ae.type[1]),[K]=A;if(A.some(ae=>ae!==K))return!0}let n=null,l=0,m=e.value.checkedFields.every(A=>{var K,ae;return(ae=(K=e.value.checkedFieldsMapArrNum)==null?void 0:K[A])==null?void 0:ae.length})&&["22"].includes(e.value.displayType);return e.value.checkedFields.some(A=>{var Me,he,qe,Ze,ge,la,Be,Fe,aa;if(m)return!1;if((he=(Me=e.value.checkedFieldsMapArrNum)==null?void 0:Me[A])!=null&&he.length&&["22","2"].includes(e.value.displayType)&&(l===0&&(l=1),l===2)||!((Ze=(qe=e.value.checkedFieldsMapArrNum)==null?void 0:qe[A])!=null&&Ze.length)&&["22","2"].includes(e.value.displayType)&&e.value.parameters.some(Oe=>[2,3].includes(Oe.deType))&&e.value.checkedFieldsMap[A]&&(l===0&&(l=2),l===1))return!0;const K=j.value.find(Oe=>Oe.componentId===A),ae=(ge=e.value.checkedFieldsMap)==null?void 0:ge[A],Q=Pe(Object.values((K==null?void 0:K.fields)||{}).flat()).find(Oe=>ae===Oe.id);if(!Q)return!1;if(n===null)return n=Q,!1;if((n==null?void 0:n.deType)===(Q==null?void 0:Q.deType)&&(n==null?void 0:n.deType)===1){if(!Array.isArray(Q.type)||!Array.isArray(n.type)||!((la=n.type)!=null&&la.length)&&!((Be=Q.type)!=null&&Be.length))return!1;if(((Fe=n.type)==null?void 0:Fe.length)!==((aa=Q.type)==null?void 0:aa.length))return!0}return[2,3].includes(Q==null?void 0:Q.deType)&&[2,3].includes(n.deType)?!1:n.deType!==(Q==null?void 0:Q.deType)})}),Xe=L(()=>{var l,m;if(!e.value||e.value.displayType!=="9"||!((l=e.value.checkedFields)!=null&&l.length)||!((m=j.value)!=null&&m.length))return!1;let n=null;return e.value.checkedFields.some(b=>{const A=j.value.find(K=>K.componentId===b).id;return A?n===null?(n=A,!1):n!==A:!1})}),ua=[{label:t("data_fill.rename"),command:"rename"},{label:t("data_fill.delete"),command:"del"}],Ye=n=>{e.value.checkedFields=n?j.value.map(l=>l.componentId):[],h.value=!1,n&&N()},We=()=>{var n,l;if(e.value.checkedFields.length){let m="",b="",q="";if(j.value.forEach(A=>{var K;e.value.checkedFields.includes(A.componentId)&&e.value.checkedFieldsMap[A.componentId]&&!m&&(m=e.value.checkedFieldsMap[A.componentId],q=A.componentId,b=(K=R.value.find(ae=>ae.id===A.componentId))==null?void 0:K.tableId)}),m&&b){const A=j.value.find(Q=>Q.componentId===q),K=e.value.optionValueSource===0?(n=A==null?void 0:A.fields)==null?void 0:n.dimensionList:(l=(j.value.find(Q=>Q.id===b)||{}).fields)==null?void 0:l.dimensionList;j.value.forEach(Q=>{var Me;e.value.checkedFields.includes(Q.componentId)&&((Me=R.value.find(he=>he.id===Q.componentId))==null?void 0:Me.tableId)===b&&(e.value.checkedFieldsMap[Q.componentId]=m)});const ae=K.find(Q=>Q.id===m);if(e.value.treeFieldList.length){const[Q]=e.value.treeFieldList;if(Q&&Q.field!==m){const[Me]=e.value.treeFieldList||[];if((Me==null?void 0:Me.id)===ae.id)return;e.value.treeFieldList=[ae]}}else if(ae){const[Q]=e.value.treeFieldList||[];if((Q==null?void 0:Q.id)===ae.id)return;e.value.treeFieldList=[ae]}}}},ea=n=>{ze();const l=n.length;D.value=l===j.value.length,h.value=l>0&&l<j.value.length,e.value.displayType!=="8"&&Ta()},N=()=>{const n={};Object.keys(e.value.checkedFieldsMap).forEach(l=>{e.value.checkedFieldsMap[l]&&j.value.forEach(m=>{var b;m.componentId===l&&((b=e.value.checkedFields)!=null&&b.includes(m.componentId))&&(n[m.id]=e.value.checkedFieldsMap[m.componentId],n[`active-${m.id}`]=m.activelist)})}),Object.keys(e.value.checkedFieldsMap).forEach(l=>{e.value.checkedFieldsMap[l]||j.value.forEach(m=>{var b;m.componentId===l&&((b=e.value.checkedFields)!=null&&b.includes(m.componentId))&&n[m.id]&&(e.value.checkedFieldsMap[m.componentId]=n[m.id],m.activelist=n[`active-${m.id}`])})})},ca=n=>{ze();const l=n.length;if(D.value=l===j.value.length,h.value=l>0&&l<j.value.length,N(),e.value.displayType!=="8"){if(e.value.displayType==="9"){We();return}Ta()}},te=n=>{let l=!1;return!Ca.value&&ra.value&&st.value.length&&n.deType!==1&&(l=!0),l},se=(n,l)=>{var q,A;(A=(q=e.value.checkedFieldsMapArr)==null?void 0:q[l])!=null&&A.length&&(e.value.checkedFieldsMapArr[l]=[],e.value.checkedFieldsMapEnd[l]="",e.value.checkedFieldsMapStart[l]="");const m=e.value.checkedFieldsMapStartNum[l],b=e.value.checkedFieldsMapEndNum[l];m&&(e.value.checkedFieldsMapEndNum[l]=n.find(K=>K!==m)),b&&(e.value.checkedFieldsMapStartNum[l]=n.find(K=>K!==b)),n.length||(e.value.checkedFieldsMap[l]="",e.value.checkedFieldsMapEndNum[l]="",e.value.checkedFieldsMapStartNum[l]="",e.value.parametersArr[l]=[]),e.value.checkedFieldsMapArrNum[l].length&&z(l),va()},ye=(n,l)=>{var q,A;(A=(q=e.value.checkedFieldsMapArrNum)==null?void 0:q[l])!=null&&A.length&&(e.value.checkedFieldsMapArrNum[l]=[],e.value.checkedFieldsMapEndNum[l]="",e.value.checkedFieldsMapStartNum[l]="");const m=e.value.checkedFieldsMapStart[l],b=e.value.checkedFieldsMapEnd[l];m&&(e.value.checkedFieldsMapEnd[l]=n.find(K=>K!==m)),b&&(e.value.checkedFieldsMapStart[l]=n.find(K=>K!==b)),n.length||(e.value.checkedFieldsMap[l]="",e.value.checkedFieldsMapEnd[l]="",e.value.checkedFieldsMapStart[l]="",e.value.displayType="1",e.value.parametersArr[l]=[],e.value.timeGranularity="",e.value.timeGranularityMultiple=""),e.value.checkedFieldsMapArr[l].length&&de(l),va()};let W="",Ce="";const Ke=ne(!1),G=ne(0),re=ne(""),H=ne(!1),k=ne(0),$=ne(""),ie=()=>{e.value.checkedFieldsMapArr[W]||(e.value.checkedFieldsMapArr[W]=[]),G.value===0&&(e.value.checkedFieldsMap[W]=Ce,e.value.checkedFieldsMapArr[W]=[],e.value.checkedFieldsMapStart[W]="",e.value.checkedFieldsMapEnd[W]=""),G.value===1&&(e.value.checkedFieldsMapStart[W]=Ce,e.value.checkedFieldsMapArr[W]=[...new Set([...e.value.checkedFieldsMapArr[W],Ce])],e.value.checkedFieldsMapArr[W].length===1?e.value.checkedFieldsMapEnd[W]="":e.value.checkedFieldsMapEnd[W]=e.value.checkedFieldsMapArr[W].length===2?e.value.checkedFieldsMapArr[W].find(n=>n!==Ce):Ce),G.value===2&&(e.value.checkedFieldsMapArr[W]=[...new Set([...e.value.checkedFieldsMapArr[W],Ce])],e.value.checkedFieldsMapEnd[W]=Ce,e.value.checkedFieldsMapArr[W].length===1?e.value.checkedFieldsMapStart[W]="":e.value.checkedFieldsMapStart[W]=e.value.checkedFieldsMapArr[W].length===2?e.value.checkedFieldsMapArr[W].find(n=>n!==Ce):Ce),e.value.displayType=e.value.checkedFieldsMapArr[W].length?"7":"1",de(W),va(),Ke.value=!1},ce=()=>{e.value.checkedFieldsMapArrNum[W]||(e.value.checkedFieldsMapArrNum[W]=[]),k.value===0&&(e.value.checkedFieldsMap[W]=Ce,e.value.checkedFieldsMapArrNum[W]=[],e.value.checkedFieldsMapStartNum[W]="",e.value.checkedFieldsMapEndNum[W]=""),k.value===1&&(e.value.checkedFieldsMapStartNum[W]=Ce,e.value.checkedFieldsMapArrNum[W]=[...new Set([...e.value.checkedFieldsMapArrNum[W],Ce])],e.value.checkedFieldsMapArrNum[W].length===1?e.value.checkedFieldsMapEndNum[W]="":e.value.checkedFieldsMapEndNum[W]=e.value.checkedFieldsMapArrNum[W].length===2?e.value.checkedFieldsMapArrNum[W].find(n=>n!==Ce):Ce),k.value===2&&(e.value.checkedFieldsMapArrNum[W]=[...new Set([...e.value.checkedFieldsMapArrNum[W],Ce])],e.value.checkedFieldsMapEndNum[W]=Ce,e.value.checkedFieldsMapArrNum[W].length===1?e.value.checkedFieldsMapStartNum[W]="":e.value.checkedFieldsMapStartNum[W]=e.value.checkedFieldsMapArrNum[W].length===2?e.value.checkedFieldsMapArrNum[W].find(n=>n!==Ce):Ce),e.value.displayType=e.value.checkedFieldsMapArrNum[W].length?"22":"2",z(W),va(),H.value=!1},z=n=>{e.value.parametersArr[n]=Pe(a(j).filter(l=>l.componentId===n).map(l=>Object.values((l==null?void 0:l.fields)||{}).flat()).flat().filter(l=>[e.value.checkedFieldsMapEndNum[n],e.value.checkedFieldsMapStartNum[n]].filter(m=>!!m).includes(l.id)&&!!l.variableName))},de=n=>{if(e.value.parametersArr[n]=Pe(a(j).filter(b=>b.componentId===n).map(b=>Object.values((b==null?void 0:b.fields)||{}).flat()).flat().filter(b=>[e.value.checkedFieldsMapEnd[n],e.value.checkedFieldsMapStart[n]].filter(q=>!!q).includes(b.id)&&!!b.variableName)),!e.value.parametersArr[n].length)return;const[l,m]=e.value.parametersArr[n][0].type;e.value.timeGranularityMultiple=ba[m||l]?`${ba[m||l]}range`:"",e.value.timeGranularity=ba[m||l]},me=(n,l)=>{k.value=l.id===e.value.checkedFieldsMapStartNum[n]?1:l.id===e.value.checkedFieldsMapEndNum[n]?2:0,W=n,Ce=l.id,$.value=l.variableName,H.value=!0},_e=(n,l)=>{G.value=l.id===e.value.checkedFieldsMapStart[n]?1:l.id===e.value.checkedFieldsMapEnd[n]?2:0,W=n,Ce=l.id,re.value=l.variableName,Ke.value=!0},Pe=n=>{const l=[];let m=n.map(b=>b.id);for(let b=0;b<n.length;b++){const q=n[b];m.includes(q.id)&&(l.push(q),m=m.filter(A=>A!==q.id))}return l},ma=n=>{const l=Object.values(e.value.checkedFieldsMap).filter(b=>!!b);e.value.parameters=Pe(Object.values((n==null?void 0:n.fields)||{}).flat().filter(b=>l.includes(b.id)&&!!b.variableName).concat(e.value.parameters.filter(b=>l.includes(b.id)))),j.value.forEach(b=>{var q;b.id===n.id&&((q=e.value.checkedFields)!=null&&q.includes(b.componentId))&&!e.value.checkedFieldsMap[b.componentId]&&(b.activelist=n.activelist,e.value.checkedFieldsMap[b.componentId]=e.value.checkedFieldsMap[n.componentId])});const m=e.value.checkedFields.some(b=>e.value.checkedFieldsMapStart[b]||e.value.checkedFieldsMapEnd[b])&&+e.value.displayType==7;Se(()=>{if(ra.value&&!m){const b=e.value.parameters.find(q=>q.deType===1);e.value.timeGranularity=ba[b.type[1]||b.type[0]],e.value.displayType="1"}if(e.value.parameters.length&&(e.value.conditionType=0,e.value.optionValueSource===0&&(e.value.optionValueSource=1)),e.value.displayType==="22"){const b=e.value.checkedFields.some(A=>{var K;return(K=e.value.parameters)==null?void 0:K.some(ae=>[2,3].includes(ae.deType)&&e.value.checkedFieldsMap[A]===ae.id)});e.value.checkedFields.every(A=>{var K,ae;return!((ae=(K=e.value.checkedFieldsMapArr)==null?void 0:K[A])!=null&&ae.length)})&&b&&(e.value.displayType="2")}va()}),!m&&(Ta(),e.value.displayType==="9"&&We())},Ta=()=>{var n,l;if((n=e.value.checkedFields)!=null&&n.length){const[m]=e.value.checkedFields,b=j.value.find(K=>K.componentId===m),q=(l=e.value.checkedFieldsMap)==null?void 0:l[m],A=Object.values((b==null?void 0:b.fields)||{}).flat().find(K=>q===K.id);if((A==null?void 0:A.deType)!==void 0){let K=e.value.displayType;if(["22"].includes(e.value.displayType)&&[2,3].includes(A==null?void 0:A.deType)||["9"].includes(e.value.displayType))return;(A==null?void 0:A.deType)===1&&e.value.displayType==="7"||(e.value.displayType=`${[3,4].includes(A==null?void 0:A.deType)?2:A==null?void 0:A.deType}`),(A==null?void 0:A.deType)===7&&(e.value.displayType="0"),+K!=+e.value.displayType&&!([3,4].includes(+K)&&+e.value.displayType==2)&&va()}}e.value.checkedFields.some(m=>e.value.checkedFieldsMapStart[m]||e.value.checkedFieldsMapEnd[m])&&+e.value.displayType==1&&(e.value.displayType="7")},va=()=>{ze(),Se(()=>{var n,l;e.value.field.id="",(l=(n=w.value)==null?void 0:n.displayTypeChange)==null||l.call(n),+e.value.displayType==7&&["yearrange","monthrange","daterange","datetimerange"].includes(e.value.timeGranularity)&&(e.value.timeGranularityMultiple=e.value.timeGranularity),e.value.displayType==="9"&&We()})},ra=L(()=>e.value.checkedFields.some(n=>{var l;return(l=e.value.parameters)==null?void 0:l.some(m=>m.deType===1&&!!m.variableName&&e.value.checkedFieldsMap[n]===m.id)})),Ca=L(()=>{var n;return(n=e.value.parameters)==null?void 0:n.some(l=>[2,3].includes(l.deType)&&!!l.variableName)}),rt=L(()=>e.value.checkedFields.some(n=>{var l;return((l=e.value.checkedFieldsMapArrNum[n])==null?void 0:l.length)>0})),ot=L(()=>e.value.checkedFields.every(n=>{var l,m;return((m=(l=e.value.checkedFieldsMapArrNum)==null?void 0:l[n])==null?void 0:m.length)>0})?!1:e.value.checkedFields.some(n=>{var l;return(l=e.value.parameters)==null?void 0:l.some(m=>[2,3].includes(m.deType)&&e.value.checkedFieldsMap[n]===m.id)})),Ga=L(()=>e.value.checkedFields.some(n=>{var l;return((l=e.value.checkedFieldsMapArr[n])==null?void 0:l.length)>0})),st=L(()=>{const n=a(j).map(b=>Object.values((b==null?void 0:b.fields)||{}).flat()).flat(),l=Object.values(e.value.checkedFieldsMapArr||{}).flat(),m=n.find(b=>b.id===l[0]);return(m==null?void 0:m.type)||[]}),Pa=[{label:t("dynamic_time.year"),value:"year"},{label:t("chart.y_M"),value:"month"},{label:t("chart.y_M_d"),value:"date"},{label:t("chart.y_M_d_H_m_s"),value:"datetime"}],ba={"DATETIME-YEAR":"year","YYYY-MM":"month","YYYY/MM":"month","YYYY-MM-DD":"date","YYYY/MM/DD":"date","YYYY-MM-DD HH:mm:ss":"datetime","YYYY/MM/DD HH:mm:ss":"datetime"},dt=L(()=>{var b;if(!ra.value)return Pa;const[n,l]=(b=e.value.parameters)==null?void 0:b.filter(q=>q.deType===1&&!!q.variableName)[0].type;let m=!1;return Pa.reduce((q,A)=>(A.value===(ba[l]||ba[n])?(m=!0,q.push(A)):m||q.push(A),q),[])}),ct=()=>{ze(),x.value=!1},mt=()=>{Kn({}).then(n=>{var m;const l=n||[];((m=l[0])==null?void 0:m.id)==="0"?ja(yt(l[0].children)):ja(yt(l))})},ja=n=>{const l=r.get("TreeSort-dataset")||"time_desc";P.value=Ti(n,l)};let oa="",Da="";const zl=n=>{var b,q,A;if(!((b=e.value.dataset)!=null&&b.id))return;let l=`${(q=e.value.dataset)==null?void 0:q.id}--${e.value.id}`,m=!1;for(let K in g){const[ae,Q]=g[K];(ae!=null&&ae.datasetId.includes(l)||Q!=null&&Q.datasetId.includes(l))&&(m=!0)}m&&(Da=(A=e.value.dataset)==null?void 0:A.id,oa=n.id)},Hl=()=>{e.value.dataset.id=oa,Jl(`${Da}--${e.value.id}`),oa="",Da="",At()},At=()=>{if(oa&&Da){e.value.dataset.id=Da,Cn.confirm(t("v_query.to_modify_it"),{confirmButtonType:"primary",type:"warning",confirmButtonText:t("commons.confirm"),cancelButtonText:t("commons.cancel"),autofocus:!1,showClose:!1}).then(()=>{Hl()});return}e.value.field.id="",e.value.displayId="",e.value.sortId="",Gt(e.value.dataset.id,e.value)},vt=()=>{e.value.defaultValueCheck&&(e.value.defaultValue=e.value.multiple?[]:void 0,e.value.displayId||(e.value.displayId=e.value.field.id))},It=()=>{if(e.value.defaultValue=e.value.multiple?[]:void 0,pt(e.value.multiple),e.value.optionValueSource===1&&!e.value.dataset.id){let n="",l="";Object.keys(e.value.checkedFieldsMap).forEach(m=>{e.value.checkedFieldsMap[m]&&(l=m,n=e.value.checkedFieldsMap[m])}),j.value.forEach(m=>{m.componentId===l&&(e.value.dataset.id=m.id)}),e.value.displayId=n,e.value.sortId=n,e.value.field.id=n,Gt(e.value.dataset.id,e.value)}},pt=(n,l=!1)=>{l&&(e.value.defaultValue=n?[]:void 0);const{defaultValue:m}=e.value;Array.isArray(m)?e.value.selectValue=n?m:void 0:e.value.selectValue=n?m!==void 0?[m]:[]:m,e.value.multiple=n},Ql=(n,l,m)=>{const{intervalType:b,regularOrTrends:q,regularOrTrendsValue:A,relativeToCurrent:K,timeNum:ae,relativeToCurrentType:Q,around:Me,dynamicWindow:he,maximumSingleQuery:qe,timeNumRange:Ze,relativeToCurrentTypeRange:ge,aroundRange:la}=n.timeRange||{};let Be=!1;const Fe=n.timeGranularityMultiple.split("time").join("").split("range")[0],aa=Fe==="date"?"day":Fe;if(l&&he&&(Be=ke(l).add(qe,aa).startOf(aa).valueOf()-1e3<m),b==="none")return he?Be:!1;let Oe;if(K==="custom")Oe=na(Q,Me==="f"?"subtract":"add",ae);else switch(K){case"thisYear":Oe=je("year");break;case"lastYear":Oe=_a("year");break;case"thisMonth":Oe=je("month");break;case"lastMonth":Oe=_a("month");break;case"today":Oe=je("day");break;case"yesterday":Oe=_a("day");break;case"monthBeginning":Oe=je("month");break;case"yearBeginning":Oe=je("year");break}const He=q==="fixed"?A:Oe;if(b==="start")return l<+new Date(He)||Be;if(b==="end")return m>+new Date(He)||Be;if(b==="timeInterval"){const ta=q==="fixed"?new Date(ke(new Date(A[0])).startOf(Fe).format("YYYY/MM/DD HH:mm:ss")):na(Q,Me==="f"?"subtract":"add",ae),pa=q==="fixed"?new Date(ke(new Date(A[1])).endOf(Fe).format("YYYY/MM/DD HH:mm:ss")):na(ge,la==="f"?"subtract":"add",Ze);return l<+new Date(ta)-1e3||m>+new Date(pa)||Be}},Kl=$n(()=>Dn(()=>import("./QueryCascade-0.0.0-dataease.js"),[],import.meta.url)),xt=ne(),Zl=()=>{const n=C.value.filter(l=>{var m;return[0,2,5].includes(+l.displayType)&&l.optionValueSource===1&&!!((m=l.checkedFields)!=null&&m.length)&&!!Object.values(l.checkedFieldsMap).filter(b=>!!b).length}).reduce((l,m)=>{var b,q,A;return l[m.id]={datasetId:m.dataset.id,name:m.name,queryId:m.id,fieldId:m.field.id,deType:(A=(((q=(b=J[m.dataset.id])==null?void 0:b.fields)==null?void 0:q.dimensionList)||m.dataset.fields).find(K=>K.id===m.field.id))==null?void 0:A.deType},l},{});xt.value.init(n,g)},Jl=n=>{for(let l in g){const[m,b]=g[l];m!=null&&m.datasetId.includes(n)?g[l]=[]:b!=null&&b.datasetId.includes(n)&&(g[l]=[m])}g=g.filter(l=>!!l.length)},Xl=[t("visualization.number1"),t("visualization.number2"),t("visualization.number3"),t("visualization.number4"),t("visualization.number5")],en=({defaultConditionValueF:n,defaultConditionValueS:l,conditionType:m})=>m===0?n==="":n===""||l==="",Rt=n=>{const{defaultConditionValueOperatorF:l,defaultConditionValueF:m,defaultConditionValueOperatorS:b,defaultConditionValueS:q}=n;n.conditionValueOperatorF=l,n.conditionValueF=m,n.conditionValueOperatorS=b,n.conditionValueS=q},an=()=>C.value.some(n=>{var q,A,K;if(n.auto)return!1;if(!((q=n.checkedFields)!=null&&q.length)||n.checkedFields.some(ae=>!n.checkedFieldsMap[ae]))return Re.error(t("v_query.be_linked_first")),!0;if(n.displayType==="22"&&n.defaultValueCheck){if(n.numValueEnd=n.defaultNumValueEnd,n.numValueStart=n.defaultNumValueStart,n.defaultNumValueEnd!==0&&!n.defaultNumValueEnd||n.defaultNumValueStart!==0&&!n.defaultNumValueStart)return Re.error(t("v_query.cannot_be_empty_de")),!0;if(!isNaN(n.defaultNumValueEnd)&&!isNaN(n.defaultNumValueStart)&&n.defaultNumValueEnd<n.defaultNumValueStart)return Re.error(t("v_query.the_minimum_value")),!0}let l=null,m=t("v_query.cannot_be_performed"),b=0;if(n.checkedFields.some(ae=>{var qe,Ze,ge,la,Be,Fe,aa,Oe,He,ta,pa,p,U;if((Ze=(qe=n.checkedFieldsMapArrNum)==null?void 0:qe[ae])!=null&&Ze.length&&(b===0&&(b=1),b===2)||!((la=(ge=n.checkedFieldsMapArrNum)==null?void 0:ge[ae])!=null&&la.length)&&["22"].includes(n.displayType)&&n.parameters.length&&(b===0&&(b=2),b===1))return!0;if(((Fe=(Be=n.checkedFieldsMapArrNum)==null?void 0:Be[ae])==null?void 0:Fe.length)===1&&n.displayType==="22")return m=t("v_query.numerical_parameter_configuration"),!0;if(((Oe=(aa=n.checkedFieldsMapArr)==null?void 0:aa[ae])==null?void 0:Oe.length)===1&&n.displayType==="7")return m=t("v_query.and_end_time"),!0;const Q=j.value.find(Ee=>Ee.componentId===ae),Me=(He=n.checkedFieldsMap)==null?void 0:He[ae],he=Pe(Object.values((Q==null?void 0:Q.fields)||{}).flat()).find(Ee=>Me===Ee.id);if(!he)return!1;if(l===null)return l=he,!1;if((l==null?void 0:l.deType)===(he==null?void 0:he.deType)&&(l==null?void 0:l.deType)===1){if(!Array.isArray(he.type)||!Array.isArray(l.type)||!((ta=l.type)!=null&&ta.length)&&!((pa=he.type)!=null&&pa.length))return!1;if(((p=l.type)==null?void 0:p.length)!==((U=he.type)==null?void 0:U.length))return m=t("v_query.format_is_inconsistent"),!0;for(let Ee=0;Ee<l.type.length;Ee++)if(l.type[Ee]!==he.type[Ee])return m=t("v_query.format_is_inconsistent"),!0}return l.deType!==(he==null?void 0:he.deType)}))return Re.error(m),!0;if(n.required){if(n.displayType==="8"){Rt(n);const ae=en(n);return ae&&Re.error(t("v_query.cannot_be_empty_de")),ae}if(!n.defaultValueCheck)return Re.error(t("v_query.cannot_be_empty_de")),!0;if(n.displayType==="22")return n.defaultNumValueEnd!==0&&!n.defaultNumValueEnd||n.defaultNumValueStart!==0&&!n.defaultNumValueStart?(Re.error(t("v_query.cannot_be_empty_de")),!0):!1;if(Array.isArray(n.defaultValue)&&!n.defaultValue.length||n.defaultValue!==0&&!n.defaultValue)return Re.error(t("v_query.cannot_be_empty_de")),!0}if(n.displayType==="8")return Rt(n),!1;if(!n.defaultValueCheck){const ae=+n.displayType==7||n.multiple;n.selectValue=ae?[]:void 0,n.defaultValue=ae?[]:void 0}if(n.displayType==="1"){if(!n.defaultValueCheck)return!1;if(n.timeType==="fixed"&&!n.defaultValue)return Re.error(t("v_query.cannot_be_empty_time")),!0}if(+n.displayType==7){if(!n.defaultValueCheck)return!1;if(n.timeType==="fixed"){const[pa,p]=n.defaultValue||[];if(!pa||!p)return Re.error(t("v_query.cannot_be_empty_time")),!0}const{timeNum:ae,relativeToCurrentType:Q,around:Me,relativeToCurrentRange:he,timeGranularityMultiple:qe,arbitraryTime:Ze,timeGranularity:ge,timeNumRange:la,relativeToCurrentTypeRange:Be,aroundRange:Fe,arbitraryTimeRange:aa,timeType:Oe}=n;let He=Oe==="dynamic"?Na(ae,Q,ge,Me,Ze,qe,"start-config"):new Date(n.defaultValue[0]),ta=Oe==="dynamic"?Na(la,Be,ge,Fe,aa,qe,"end-config"):new Date(n.defaultValue[1]);return he&&he!=="custom"&&([He,ta]=Dt(he)),+He>+ta?(Re.error(t("v_query.the_start_time")),!0):n.setTimeRange&&Ql(n,qe.includes("time")?ke(+He).startOf("day").valueOf():+He,qe.includes("time")?ke(+ta).startOf("day").valueOf():+ta)?(Re.error(t("v_query.range_please_reset")),!0):!1}if([1].includes(+n.displayType))return!1;if(n.displayType!=="9"&&n.optionValueSource===2&&!((A=n.valueSource)!=null&&A.filter(ae=>!!ae).length))return Re.error(t("v_query.cannot_be_empty_input")),!0;if(!["9","22"].includes(n.displayType)&&n.optionValueSource===1&&!n.field.id)return Re.error((K=n.dataset)!=null&&K.id?t("v_query.the_data_set"):t("v_query.option_value_field")),!0}),tn=()=>{var n,l;(n=w.value)==null||n.mult(),(l=w.value)==null||l.single(),ze(),x.value=!1},ln=i,nn=()=>{var n,l;an()||((n=w.value)==null||n.mult(),(l=w.value)==null||l.single(),ze(),x.value=!1,C.value.forEach(m=>{e.value=m,pt(["1","7"].includes(e.value.displayType)?e.value.displayType==="7":e.value.multiple)}),$e.value.propValue=[],Se(()=>{C.value.forEach(m=>{g.forEach(b=>{b.forEach(q=>{if(q.datasetId.split("--")[1]===m.id&&m.defaultValueCheck){const A=m.mapValue;q.selectValue=Array.isArray(A)?[...A]:A,q.currentSelectValue=Array.isArray(A)?[...A]:A}})})}),$e.value.cascade=Le(g),g=[],$e.value.propValue=Le(C.value),ee.recordSnapshotCache("confirmClick"),Se(()=>{ln("queryData")})}))},un=L(()=>e.value.dataset.fields.filter(n=>n.deType===+e.value.displayType||[0,2,3,4].includes(n.deType)&&[0,2].includes(+e.value.displayType)||n.deType===7&&+e.value.displayType==0)),Lt=()=>{c.value=Le(e.value.valueSource),c.value.length||c.value.push(""),fe.value.hide()},rn=()=>{if(c.value.some(n=>typeof n=="string"?!n.trim():!1)){Re.error(t("v_query.cannot_be_empty_input"));return}e.value.valueSource=Le(c.value.filter(n=>typeof n=="string"?n.trim():!0)),It(),Lt()},on=n=>{C.value=Le(V.queryElement.propValue)||[],Yt(n)},sn=()=>{C.value=Le(V.queryElement.propValue)||[],_t(),Yt(C.value[C.value.length-1].id)},Ut=(n,l)=>{let m="dimensionList";return n.some((b,q)=>(b||[]).some(A=>A.id===l)?(m=["dimensionList","quotaList","parameterList"][q],!0):!1),m},Yt=n=>{mt(),B.value=[],ft({id:n}),g=Le($e.value.cascade||[]),x.value=!0;const l=R.value.map(q=>q.tableId);for(const q in J)l.includes(q)||delete J[q];const m=Object.keys(J);l.every(q=>m.includes(q))&&(j.value=R.value.map(q=>J[q.tableId]?{...J[q.tableId],componentId:q.id}:null).filter(q=>!!q));const b=[...new Set(R.value.map(q=>q.tableId).filter(q=>!!q))];b.length&&Promise.all([Hn(b),Qn(b)]).then(([q,A])=>{q.filter(K=>!!K).forEach(K=>{K.activelist="dimensionList",K.fields.parameterList=A.filter(ae=>{var Q;return ae.datasetGroupId===K.id&&!((Q=ae.params)!=null&&Q.length)}),K.hasParameter=!!K.fields.parameterList.length,K.fields.dimensionList=(K.fields.dimensionList||[]).filter(ae=>{var Q;return!((Q=ae.params)!=null&&Q.length)}),K.fields.quotaList=(K.fields.quotaList||[]).filter(ae=>{var Q;return!((Q=ae.params)!=null&&Q.length)}),J[K.id]=K}),j.value=R.value.map(K=>{if(!J[K.tableId])return null;const ae=J[K.tableId].fields||{},Q=Ut([ae.dimensionList,ae.quotaList,ae.parameterList],e.value.checkedFieldsMap[K.id]);return{...J[K.tableId],componentId:K.id,activelist:Q}}).filter(K=>!!K)}).finally(()=>{ea(e.value.checkedFields)})},Bt=()=>{c.value=Array.from(new Set(c.value))},dn=()=>{Object.entries({timeType:"fixed",hideConditionSwitching:!1,required:!1,defaultMapValue:[],mapValue:[],parametersStart:null,conditionType:0,conditionValueOperatorF:"eq",conditionValueF:"",conditionValueOperatorS:"like",conditionValueS:"",resultMode:0,defaultConditionValueOperatorF:"eq",defaultConditionValueF:"",defaultConditionValueOperatorS:"like",defaultConditionValueS:"",parametersEnd:null,relativeToCurrent:"custom",timeNum:0,relativeToCurrentRange:"custom",relativeToCurrentType:"year",around:"f",arbitraryTime:new Date,timeNumRange:0,relativeToCurrentTypeRange:"year",aroundRange:"f",displayId:"",sortId:"",sort:"asc",arbitraryTimeRange:new Date,setTimeRange:!1,showEmpty:!1,defaultNumValueStart:null,defaultNumValueEnd:null,numValueEnd:null,numValueStart:null,timeRange:{intervalType:"none",dynamicWindow:!1,maximumSingleQuery:0,regularOrTrends:"fixed",regularOrTrendsValue:"",relativeToCurrent:"custom",timeNum:0,relativeToCurrentType:"year",around:"f",timeNumRange:0,relativeToCurrentTypeRange:"year",aroundRange:"f"},treeFieldList:[]}).forEach(([l,m])=>{e.value[l]??(e.value[l]=m)}),e.value.timeRange.relativeToCurrentRange||(e.value.timeRange.relativeToCurrentRange="custom")},ft=n=>{var b;if(ze(),T.id)return;E.value=n.id;const l=C.value.find(q=>q.id===n.id);l.checkedFieldsMapArr||(l.checkedFieldsMapArr={},l.checkedFieldsMapArrNum={},l.checkedFieldsMapStart={},l.checkedFieldsMapStartNum={},l.checkedFieldsMapEnd={},l.checkedFieldsMapEndNum={},l.parametersArr={}),e.value=l,e.value.dataset.fields=[],Se(()=>{w.value.changeMultiple(e.value.multiple)}),e.value.dataset.id&&Xt(e.value.dataset.id).then(q=>{e.value.dataset.fields=q.data}),e.value.checkedFieldsMapStart||(e.value.checkedFieldsMapStart={}),e.value.checkedFieldsMapStartNum||(e.value.checkedFieldsMapStartNum={}),e.value.checkedFieldsMapEnd||(e.value.checkedFieldsMapEnd={}),e.value.checkedFieldsMapEndNum||(e.value.checkedFieldsMapEndNum={}),e.value.checkedFieldsMapArr||(e.value.checkedFieldsMapArr={}),e.value.checkedFieldsMapArrNum||(e.value.checkedFieldsMapArrNum={}),e.value.parametersArr||(e.value.parametersArr={}),R.value.forEach(q=>{e.value.checkedFieldsMap[q.id]||(e.value.checkedFieldsMap[q.id]=""),e.value.checkedFieldsMapStart[q.id]||(e.value.checkedFieldsMapStart[q.id]=""),e.value.checkedFieldsMapStartNum[q.id]||(e.value.checkedFieldsMapStartNum[q.id]=""),e.value.checkedFieldsMapEnd[q.id]||(e.value.checkedFieldsMapEnd[q.id]=""),e.value.checkedFieldsMapEndNum[q.id]||(e.value.checkedFieldsMapEndNum[q.id]=""),e.value.checkedFieldsMapArr[q.id]||(e.value.checkedFieldsMapArr[q.id]=[]),e.value.checkedFieldsMapArrNum[q.id]||(e.value.checkedFieldsMapArrNum[q.id]=[]),e.value.parametersArr[q.id]||(e.value.parametersArr[q.id]=[])});const m=R.value.map(q=>q.id);e.value.checkedFields=e.value.checkedFields.filter(q=>m.includes(q)),(b=j.value)!=null&&b.length&&(j.value.forEach(q=>{const A=q.fields;q.activelist=Ut([A.dimensionList,A.quotaList,A.parameterList],e.value.checkedFieldsMap[q.componentId])}),ea(e.value.checkedFields)),pt(e.value.multiple),c.value=Le(e.value.valueSource),c.value.length||c.value.push(""),dn(),Se(()=>{e.value.showError=Ht.value,e.value.auto&&(document.querySelector(".chart-field").scrollTop=0)})},Gt=(n,l)=>{Xt(n).then(m=>{l.dataset.fields=m.data})},cn=()=>{vt(),e.value.sortList=[],Pt()},Pt=()=>{Wa.value&&(e.value.sort="")},jt=ne(),mn=n=>{e.value.sortList=Le(n)},vn=async()=>{if(Wa.value||e.value.sort!=="customSort")return;let n=Le(e.value.sortList||[]);n.length||(n=(await hl({queryId:e.value.sortId,searchText:""})).map(m=>m[e.value.sortId])),jt.value.sortInit([...new Set(n)])},Wa=L(()=>{const{sortId:n,displayId:l}=e.value;return n&&l&&n!==l}),Wt=ne(),zt=()=>{var m;const[n]=e.value.checkedFields,l=j.value.find(b=>b.componentId===n);Wt.value.init((m=l==null?void 0:l.fields)==null?void 0:m.dimensionList.filter(b=>b.deType===+e.value.field.deType),e.value.treeFieldList)},pn=n=>{e.value.treeFieldList=n},Ht=L(()=>{if(!e.value)return!1;const{optionValueSource:n,checkedFieldsMap:l,checkedFields:m,field:b,valueSource:q,displayType:A}=e.value,K=m.filter(ae=>!!l[ae]);if(!m.length||!K.length)return!0;if([1,7,8,22].includes(+A))return!1;if(A==="9"){let ae=null;return m.some(Q=>{const Me=(j.value||[]).find(qe=>qe.componentId===Q),he=Me==null?void 0:Me.id;return he?ae===null?(ae=he,!1):ae!==he:!1})}return n===1&&!b.id||n===2&&!q.length}),ze=()=>{var n;(n=w.value)==null||n.handleDialogClick()},fn=L(()=>{let n=[];if(!e.value)return n;switch(e.value.timeGranularity){case"year":n=[{label:t("dynamic_year.current"),value:"thisYear"},{label:t("dynamic_year.last"),value:"lastYear"}];break;case"month":n=[{label:t("cron.this_month"),value:"thisMonth"},{label:t("dynamic_month.last"),value:"lastMonth"}];break;case"date":n=[{label:t("dynamic_time.today"),value:"today"},{label:t("dynamic_time.yesterday"),value:"yesterday"},{label:t("dynamic_time.firstOfMonth"),value:"monthBeginning"},{label:t("dynamic_time.endOfMonth"),value:"monthEnd"},{label:t("dynamic_time.firstOfYear"),value:"yearBeginning"}];break;case"datetime":n=[{label:t("dynamic_time.today"),value:"today"},{label:t("dynamic_time.yesterday"),value:"yesterday"},{label:t("dynamic_time.firstOfMonth"),value:"monthBeginning"},{label:t("dynamic_time.endOfMonth"),value:"monthEnd"},{label:t("dynamic_time.firstOfYear"),value:"yearBeginning"}];break}return[...n,{label:t("dynamic_time.custom"),value:"custom"}]}),yn=L(()=>{let n=[];if(!e.value)return n;switch(e.value.timeGranularityMultiple){case"yearrange":n=[{label:t("dynamic_year.current"),value:"thisYear"},{label:t("dynamic_year.last"),value:"lastYear"}];break;case"monthrange":n=[{label:t("cron.this_month"),value:"thisMonth"},{label:t("dynamic_month.last"),value:"lastMonth"},{label:t("v_query.last_3_months"),value:"LastThreeMonths"},{label:t("v_query.last_6_months"),value:"LastSixMonths"},{label:t("v_query.last_12_months"),value:"LastTwelveMonths"}];break;case"daterange":case"datetimerange":n=[{label:t("dynamic_time.today"),value:"today"},{label:t("dynamic_time.yesterday"),value:"yesterday"},{label:t("v_query.last_3_days"),value:"LastThreeDays"},{label:t("v_query.month_to_date"),value:"monthBeginning"},{label:t("v_query.year_to_date"),value:"yearBeginning"}];break}return[...n,{label:t("dynamic_time.custom"),value:"custom"}]}),Qt=n=>{var l;e.value.relativeToCurrentType=["date","datetime"].includes(n)?"date":n,e.value.relativeToCurrent!=="custom"&&(e.value.relativeToCurrent=(l=fn.value[0])==null?void 0:l.value)},_n=()=>{e.value.displayType==="1"?Qt(e.value.timeGranularity):Kt(e.value.timeGranularityMultiple)},Kt=n=>{var l;ze(),e.value.relativeToCurrentType=["daterange","datetimerange"].includes(n)?"date":n.split("range")[0],e.value.relativeToCurrentTypeRange=e.value.relativeToCurrentType,e.value.relativeToCurrentRange!=="custom"&&(e.value.relativeToCurrentRange=(l=yn.value[0])==null?void 0:l.value),e.value.timeRange={intervalType:"none",dynamicWindow:!1,maximumSingleQuery:0,regularOrTrends:"fixed",regularOrTrendsValue:"",relativeToCurrent:"custom",relativeToCurrentRange:"custom",timeNum:0,relativeToCurrentType:e.value.relativeToCurrentRange,around:"f",timeNumRange:0,relativeToCurrentTypeRange:e.value.relativeToCurrentRange,aroundRange:"f"}};pe(()=>Ht.value,n=>{e.value.showError=n});const hn=n=>{B.value.push(n)},Zt=(n,l,m)=>{switch(n){case"del":B.value=[],C.value.splice(m,1),e.value=null;break;case"rename":B.value=[],Object.assign(T,l),setTimeout(()=>{Se(()=>{B.value[0].focus()})},400);break}},gn={label:"name",children:"children",value:"id",isLeaf:n=>{var l;return!((l=n.children)!=null&&l.length)}},yt=n=>n.filter(l=>{var m,b;return(m=l.children)!=null&&m.length&&!l.leaf?(l.children=yt(l.children),!!((b=l.children)!=null&&b.length)):l.leaf}),bn=()=>{var n;if(T.name.trim()===""){Re.error(t("v_query.cannot_be_empty_name")),(n=B.value[0])==null||n.focus();return}C.value.some(l=>T.id===l.id?(l.name=T.name,!0):!1),T.id=""},_t=()=>{C.value.push(Ei())},Vn=()=>{_t(),ft(C.value[C.value.length-1])};return y({setCondition:on,addCriteriaConfig:()=>(_t(),C.value[C.value.length-1].id),setConditionOut:sn}),(n,l)=>{const m=wa,b=Ct,q=wa,A=Rn,K=Mt,ae=Nt,Q=Ra,Me=La,he=Ot,qe=In,Ze=xn,ge=qa,la=An,Be=kn,Fe=Ia,aa=_l,Oe=yl,He=qt,ta=Nn,pa=En;return d(),F(oe,null,[u(He,{class:"query-condition-configuration",modelValue:x.value,"onUpdate:modelValue":l[20]||(l[20]=p=>x.value=p),width:"1200px",title:a(t)("v_query.query_condition_setting"),onClick:l[21]||(l[21]=Ie(()=>{},["stop"])),"before-close":tn,onMousedown:l[22]||(l[22]=Ie(()=>{},["stop"])),onMousedup:l[23]||(l[23]=Ie(()=>{},["stop"]))},{footer:o(()=>[_("div",Vs,[u(Fe,{class:"query-cascade",onClick:Zl},{default:o(()=>[le(S(a(t)("v_query.component_cascade_configuration")),1)]),_:1}),u(Fe,{onClick:ct},{default:o(()=>[le(S(a(t)("chart.cancel")),1)]),_:1}),u(Fe,{onClick:nn,type:"primary"},{default:o(()=>[le(S(a(t)("chart.confirm")),1)]),_:1})])]),default:o(()=>[_("div",{class:"container",onClick:ze},[_("div",ao,[_("div",to,[le(S(a(t)("v_query.query_condition"))+" ",1),u(b,{onClick:Vn},{default:o(()=>[u(m,{name:"icon_add_outlined"},{default:o(()=>[u(a(Ja),{class:"svg-icon"})]),_:1})]),_:1})]),u(a(gl),{tag:"div",list:C.value,handle:".handle"},{item:o(({element:p,index:U})=>[(d(),F("div",{key:p.id,onDblclick:Ie(Ee=>Zt("rename",p,U),["stop"]),onClick:Ie(Ee=>ft(p),["stop"]),class:Ve(["list-item_primary",p.id===E.value&&"active"])},[u(b,{class:"handle"},{default:o(()=>[u(m,{name:"icon_drag_outlined"},{default:o(()=>[u(a(Un),{class:"svg-icon"})]),_:1})]),_:1}),_("div",{class:"label flex-align-center icon",title:p.name},[!p.auto&&p.showError?(d(),Y(b,{key:0,style:{"font-size":"16px",color:"#f54a45"}},{default:o(()=>[u(q,{name:"icon_warning_filled"},{default:o(()=>[u(a(Pn),{class:"svg-icon"})]),_:1})]),_:1})):Z("",!0),le(" "+S(p.name),1)],8,no),_("div",io,[u(A,{onHandleCommand:Ee=>Zt(Ee,p,U),"menu-list":ua,"icon-name":a(Ln),placement:"bottom-end"},null,8,["onHandleCommand","icon-name"]),p.visible?(d(),Y(b,{key:0,class:"hover-icon",onClick:Ie(Ee=>p.visible=!p.visible,["stop"])},{default:o(()=>[u(m,{name:"icon_visible_outlined"},{default:o(()=>[u(a(Yn),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])):(d(),Y(b,{key:1,class:"hover-icon",onClick:Ie(Ee=>p.visible=!p.visible,["stop"])},{default:o(()=>[u(m,{name:"de_pwd_invisible"},{default:o(()=>[u(a(Mi),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"]))]),T.id===p.id?(d(),F("div",{key:0,onClick:l[1]||(l[1]=Ie(()=>{},["stop"])),class:"rename"},[u(K,{onBlur:bn,ref:hn,modelValue:T.name,"onUpdate:modelValue":l[0]||(l[0]=Ee=>T.name=Ee)},null,8,["modelValue"])])):Z("",!0)],42,lo))]),_:1},8,["list"])]),e.value?(d(),F("div",{key:0,class:Ve(["chart-field",e.value.auto&&"hidden"])},[u(Be,null,{default:o(()=>[e.value.auto?(d(),F("div",uo)):Z("",!0),_("div",ro,[le(S(a(t)("v_query.chart_and_field"))+" ",1),u(Me,{class:"ml-4 larger-radio",modelValue:e.value.auto,"onUpdate:modelValue":l[2]||(l[2]=p=>e.value.auto=p)},{default:o(()=>[u(Q,{disabled:!e.value.auto,label:!0},{default:o(()=>[_("div",oo,[le(S(a(t)("chart.margin_model_auto"))+" ",1),u(ae,{effect:"dark",placement:"top"},{content:o(()=>[_("div",null,[le(S(a(t)("v_query.be_switched_to"))+" ",1),l[30]||(l[30]=_("br",null,null,-1)),le(" "+S(a(t)("v_query.to_automatic_again")),1)])]),default:o(()=>[u(b,{style:{"margin-left":"4px",color:"#646a73"}},{default:o(()=>[u(q,{name:"icon_info_outlined"},{default:o(()=>[u(a(jn),{class:"svg-icon"})]),_:1})]),_:1})]),_:1})])]),_:1},8,["disabled"]),u(Q,{label:!1},{default:o(()=>[le(S(a(t)("commons.custom")),1)]),_:1})]),_:1},8,["modelValue"])]),_("div",so,[u(he,{modelValue:D.value,"onUpdate:modelValue":l[3]||(l[3]=p=>D.value=p),indeterminate:h.value,onChange:Ye},{default:o(()=>[le(S(a(t)("dataset.check_all")),1)]),_:1},8,["modelValue","indeterminate"])]),_("div",co,[u(la,{modelValue:e.value.checkedFields,"onUpdate:modelValue":l[4]||(l[4]=p=>e.value.checkedFields=p),onChange:ca},{default:o(()=>[(d(!0),F(oe,null,ve(j.value,p=>(d(),F("div",{key:p.componentId,class:"list-item_field_de"},[u(he,{label:p.componentId},{default:o(()=>[u(b,{class:"component-type"},{default:o(()=>[u(m,null,{default:o(()=>[(d(),Y(Ue(a(Vi)[a(M)[p.componentId].type])))]),_:2},1024)]),_:2},1024),_("span",{title:a(M)[p.componentId].title,class:"checkbox-name ellipsis"},S(a(M)[p.componentId].title),9,mo)]),_:2},1032,["label"]),_("span",{title:p.name,class:"dataset ellipsis"},S(p.name),9,vo),e.value.checkedFields.includes(p.componentId)&&e.value.checkedFieldsMapArr&&e.value.checkedFieldsMapArr[p.componentId]&&e.value.checkedFieldsMapArr[p.componentId].length?(d(),Y(a(De),{onChange:U=>ye(U,p.componentId),onFocus:ze,multiple:"",filterable:"","collapse-tags":"","collapse-tags-tooltip":"",key:"checkedFieldsMapArrTime","multiple-limit":2,class:"field-select--input",style:{"margin-left":"12px"},"popper-class":"field-select--dqp",modelValue:e.value.checkedFieldsMapArr[p.componentId],"onUpdate:modelValue":U=>e.value.checkedFieldsMapArr[p.componentId]=U,clearable:""},Ma({header:o(()=>[u(Ze,{stretch:"",class:"params-select--header",modelValue:p.activelist,"onUpdate:modelValue":U=>p.activelist=U},{default:o(()=>[u(qe,{disabled:"",label:a(t)("chart.dimension"),name:"dimensionList"},null,8,["label"]),u(qe,{disabled:"",label:a(t)("chart.quota"),name:"quotaList"},null,8,["label"]),u(qe,{label:a(t)("dataset.param"),name:"parameterList"},null,8,["label"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),default:o(()=>[(d(!0),F(oe,null,ve(p.fields[p.activelist],U=>(d(),Y(ge,{key:U.id,label:U.name||U.variableName,value:U.id,disabled:te(U)},{default:o(()=>[_("div",po,[u(b,null,{default:o(()=>[u(m,{className:`field-icon-${a(be)[U.deType]}`},{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[U.deType]]),{class:Ve(["svg-icon",`field-icon-${a(be)[U.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024),_("span",{title:U.name||U.variableName,class:"ellipsis"},S(U.name||U.variableName),9,fo),e.value.checkedFieldsMapArr[p.componentId].includes(U.id)&&p.activelist==="parameterList"?(d(),F("span",{key:0,onClick:Ie(Ee=>_e(p.componentId,U),["stop"]),class:"range-time_setting"},[le(S(e.value.checkedFieldsMapStart[p.componentId]===U.id?a(t)("dataset.start_time"):e.value.checkedFieldsMapEnd[p.componentId]===U.id?a(t)("dataset.end_time"):"")+" ",1),u(b,null,{default:o(()=>[u(m,null,{default:o(()=>[u(a(Sa),{class:"svg-icon"})]),_:1})]),_:1})],8,yo)):Z("",!0)])]),_:2},1032,["label","value","disabled"]))),128))]),_:2},[e.value.checkedFieldsMap[p.componentId]?{name:"prefix",fn:o(()=>[u(b,null,{default:o(()=>[u(m,null,{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[Te(e.value.checkedFieldsMap[p.componentId],Object.values(p.fields))]]),{class:Ve(`field-icon-${a(be)[Te(e.value.checkedFieldsMap[p.componentId],Object.values(p.fields))]}`)},null,8,["class"]))]),_:2},1024)]),_:2},1024)]),key:"0"}:void 0]),1032,["onChange","modelValue","onUpdate:modelValue"])):e.value.checkedFields.includes(p.componentId)&&e.value.checkedFieldsMapArrNum&&e.value.checkedFieldsMapArrNum[p.componentId]&&e.value.checkedFieldsMapArrNum[p.componentId].length?(d(),Y(a(De),{onChange:U=>se(U,p.componentId),onFocus:ze,multiple:"",filterable:"","collapse-tags":"","collapse-tags-tooltip":"",key:"checkedFieldsMapArr","multiple-limit":2,class:"field-select--input",style:{"margin-left":"12px"},"popper-class":"field-select--dqp",modelValue:e.value.checkedFieldsMapArrNum[p.componentId],"onUpdate:modelValue":U=>e.value.checkedFieldsMapArrNum[p.componentId]=U,clearable:""},Ma({header:o(()=>[u(Ze,{stretch:"",class:"params-select--header",modelValue:p.activelist,"onUpdate:modelValue":U=>p.activelist=U},{default:o(()=>[u(qe,{disabled:"",label:a(t)("chart.dimension"),name:"dimensionList"},null,8,["label"]),u(qe,{disabled:"",label:a(t)("chart.quota"),name:"quotaList"},null,8,["label"]),u(qe,{label:a(t)("dataset.param"),name:"parameterList"},null,8,["label"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),default:o(()=>[(d(!0),F(oe,null,ve(p.fields[p.activelist],U=>(d(),Y(ge,{key:U.id,label:U.name||U.variableName,value:U.id,disabled:![2,3].includes(U.deType)},{default:o(()=>[_("div",_o,[u(b,null,{default:o(()=>[u(m,{className:`field-icon-${a(be)[U.deType]}`},{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[U.deType]]),{class:Ve(["svg-icon",`field-icon-${a(be)[U.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024),_("span",{title:U.name||U.variableName,class:"ellipsis"},S(U.name||U.variableName),9,ho),e.value.checkedFieldsMapArrNum[p.componentId].includes(U.id)&&p.activelist==="parameterList"?(d(),F("span",{key:0,onClick:Ie(Ee=>me(p.componentId,U),["stop"]),class:"range-time_setting"},[le(S(e.value.checkedFieldsMapStartNum[p.componentId]===U.id?a(t)("chart.min"):e.value.checkedFieldsMapEndNum[p.componentId]===U.id?a(t)("chart.max"):"")+" ",1),u(b,null,{default:o(()=>[u(m,null,{default:o(()=>[u(a(Sa),{class:"svg-icon"})]),_:1})]),_:1})],8,go)):Z("",!0)])]),_:2},1032,["label","value","disabled"]))),128))]),_:2},[e.value.checkedFieldsMap[p.componentId]?{name:"prefix",fn:o(()=>[u(b,null,{default:o(()=>[u(m,null,{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[Te(e.value.checkedFieldsMap[p.componentId],Object.values(p.fields))]]),{class:Ve(`field-icon-${a(be)[Te(e.value.checkedFieldsMap[p.componentId],Object.values(p.fields))]}`)},null,8,["class"]))]),_:2},1024)]),_:2},1024)]),key:"0"}:void 0]),1032,["onChange","modelValue","onUpdate:modelValue"])):e.value.checkedFields.includes(p.componentId)?(d(),Y(a(De),{key:2,onChange:U=>ma(p),onFocus:ze,filterable:"",style:{"margin-left":"12px"},"popper-class":"field-select--dqp",modelValue:e.value.checkedFieldsMap[p.componentId],"onUpdate:modelValue":U=>e.value.checkedFieldsMap[p.componentId]=U,clearable:""},Ma({header:o(()=>[u(Ze,{stretch:"",class:"params-select--header",modelValue:p.activelist,"onUpdate:modelValue":U=>p.activelist=U},{default:o(()=>[u(qe,{label:a(t)("chart.dimension"),name:"dimensionList"},null,8,["label"]),u(qe,{disabled:e.value.displayType==="9",label:a(t)("chart.quota"),name:"quotaList"},null,8,["disabled","label"]),p.hasParameter?(d(),Y(qe,{key:0,label:a(t)("dataset.param"),disabled:e.value.displayType==="9",name:"parameterList"},null,8,["label","disabled"])):Z("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),default:o(()=>[(d(!0),F(oe,null,ve(p.fields[p.activelist],U=>(d(),Y(ge,{key:U.id,label:U.name||U.variableName,value:U.id,disabled:U.desensitized||e.value.displayType==="9"&&U.deType===1||te(U)},{default:o(()=>[_("div",{class:"flex-align-center icon",title:U.desensitized?a(t)("v_query.as_query_conditions"):""},[u(b,null,{default:o(()=>[u(m,{className:`field-icon-${a(be)[U.deType]}`},{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[U.deType]]),{class:Ve(["svg-icon",`field-icon-${a(be)[U.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024),_("span",{title:U.name||U.variableName,class:"ellipsis"},S(U.name||U.variableName),9,Vo),e.value.checkedFieldsMap[p.componentId]===U.id&&p.activelist==="parameterList"&&(ra.value||Ca.value)?(d(),F("span",{key:0,onClick:Ie(()=>Ca.value?me(p.componentId,U):_e(p.componentId,U),["stop"]),class:"range-time_setting"},[le(S(Ca.value?a(t)("chart.value_formatter_value"):a(t)("dataset.time"))+" ",1),u(b,null,{default:o(()=>[u(m,null,{default:o(()=>[u(a(Sa),{class:"svg-icon"})]),_:1})]),_:1})],8,To)):Z("",!0)],8,bo)]),_:2},1032,["label","value","disabled"]))),128))]),_:2},[e.value.checkedFieldsMap[p.componentId]?{name:"prefix",fn:o(()=>[u(b,null,{default:o(()=>[u(m,null,{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[Te(e.value.checkedFieldsMap[p.componentId],Object.values(p.fields))]]),{class:Ve(`field-icon-${a(be)[Te(e.value.checkedFieldsMap[p.componentId],Object.values(p.fields))]}`)},null,8,["class"]))]),_:2},1024)]),_:2},1024)]),key:"0"}:void 0]),1032,["onChange","modelValue","onUpdate:modelValue"])):(d(),F("span",ko))]))),128))]),_:1},8,["modelValue"])])]),_:1})],2)):Z("",!0),e.value?(d(),F("div",{key:1,class:Ve(["condition-configuration",e.value.auto&&"condition-configuration_hide"])},[u(Be,null,{default:o(()=>[e.value.auto?(d(),F("div",Co)):Z("",!0),_("div",Mo,[le(S(a(t)("v_query.query_condition_configuration"))+" ",1),u(he,{disabled:e.value.auto,modelValue:e.value.required,"onUpdate:modelValue":l[5]||(l[5]=p=>e.value.required=p),label:a(t)("v_query.required_items")},null,8,["disabled","modelValue","label"])]),$a(_("div",So,[_("div",Fo,[_("div",wo,S(a(t)("v_query.display_type")),1),_("div",$o,[u(a(De),{onFocus:ze,onChange:va,modelValue:e.value.displayType,"onUpdate:modelValue":l[6]||(l[6]=p=>e.value.displayType=p)},{default:o(()=>[u(ge,{disabled:!["0","8","9"].includes(e.value.displayType),label:a(t)("v_query.text_drop_down"),value:"0"},null,8,["disabled","label"]),u(ge,{disabled:!["0","8","9"].includes(e.value.displayType),label:a(t)("v_query.text_search"),value:"8"},null,8,["disabled","label"]),u(ge,{disabled:!["0","8","9"].includes(e.value.displayType)||!!e.value.parameters.length,label:a(t)("v_query.drop_down_tree"),value:"9"},null,8,["disabled","label"]),["2","22"].includes(e.value.displayType)?(d(),F(oe,{key:0},[u(ge,{disabled:!["2","22"].includes(e.value.displayType)||rt.value,label:a(t)("v_query.number_drop_down"),value:"2"},null,8,["disabled","label"]),u(ge,{disabled:!["2","22"].includes(e.value.displayType)||ot.value,label:a(t)("v_query.number_range"),value:"22"},null,8,["disabled","label"])],64)):(d(),Y(ge,{key:1,disabled:e.value.displayType!=="5",label:a(t)("v_query.number_drop_down"),value:"5"},null,8,["disabled","label"])),u(ge,{disabled:!["1","7"].includes(e.value.displayType)||ra.value&&Ga.value,label:a(t)("dataset.time"),value:"1"},null,8,["disabled","label"]),u(ge,{disabled:!["1","7"].includes(e.value.displayType)||ra.value&&!Ga.value,label:a(t)("common.component.dateRange"),value:"7"},null,8,["disabled","label"])]),_:1},8,["modelValue"])])]),e.value.displayType==="9"?(d(),F("div",qo,[_("div",{title:a(t)("v_query.of_option_values"),class:"label ellipsis"},S(a(t)("v_query.of_option_values")),9,Oo),_("div",Do,[u(Me,{class:"larger-radio",modelValue:e.value.resultMode,"onUpdate:modelValue":l[7]||(l[7]=p=>e.value.resultMode=p)},{default:o(()=>[u(Q,{label:0},{default:o(()=>[le(S(a(t)("login.default_login")),1)]),_:1}),u(Q,{label:1},{default:o(()=>[le(S(a(t)("chart.result_mode_all")),1)]),_:1})]),_:1},8,["modelValue"])])])):Z("",!0),e.value.displayType==="9"?(d(),F("div",No,[_("div",Eo,[le(S(a(t)("v_query.tree_structure_design"))+" ",1),e.value.treeFieldList&&e.value.treeFieldList.length?(d(),Y(Fe,{key:0,text:"",onClick:zt},{icon:o(()=>[u(q,{name:"icon_edit_outlined"},{default:o(()=>[u(a(Sa),{class:"svg-icon"})]),_:1})]),_:1})):Z("",!0)]),_("div",Ao,[e.value.treeFieldList&&e.value.treeFieldList.length?(d(!0),F(oe,{key:0},ve(e.value.treeFieldList,(p,U)=>(d(),F("div",{key:p.id,class:"tree-field"},[_("span",Io,S(a(t)("visualization.level"))+S(Xl[U]),1),_("span",xo,[u(b,null,{default:o(()=>[u(m,{className:`field-icon-${a(be)[p.deType]}`},{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[p.deType]]),{class:Ve([`field-icon-${a(be)[p.deType]}`,"svg-icon"])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024)]),_("span",Ro,S(p.name),1)]))),128)):(d(),Y(Fe,{key:1,onClick:zt,text:""},{icon:o(()=>[u(m,{name:"icon_add_outlined"},{default:o(()=>[u(a(Ja),{class:"svg-icon"})]),_:1})]),default:o(()=>[le(" "+S(a(t)("v_query.the_tree_structure")),1)]),_:1}))]),u(Gi,{ref_key:"treeDialog",ref:Wt,onSaveTree:pn},null,512)])):Z("",!0),["1","7"].includes(e.value.displayType)?(d(),F("div",Lo,[_("div",{title:a(t)("v_query.time_granularity"),class:"label ellipsis"},S(a(t)("v_query.time_granularity")),9,Uo),_("div",Yo,[e.value.displayType==="7"&&!ra.value?(d(),Y(a(De),{key:0,onChange:Kt,placeholder:a(t)("v_query.the_time_granularity"),onFocus:ze,modelValue:e.value.timeGranularityMultiple,"onUpdate:modelValue":l[8]||(l[8]=p=>e.value.timeGranularityMultiple=p)},{default:o(()=>[u(ge,{label:a(t)("chart.y"),value:"yearrange"},null,8,["label"]),u(ge,{label:a(t)("chart.y_M"),value:"monthrange"},null,8,["label"]),u(ge,{label:a(t)("chart.y_M_d"),value:"daterange"},null,8,["label"]),u(ge,{label:a(t)("chart.y_M_d_H_m_s"),value:"datetimerange"},null,8,["label"])]),_:1},8,["placeholder","modelValue"])):(d(),Y(a(De),{key:1,onChange:Qt,placeholder:a(t)("v_query.the_time_granularity"),modelValue:e.value.timeGranularity,"onUpdate:modelValue":l[9]||(l[9]=p=>e.value.timeGranularity=p)},{default:o(()=>[(d(!0),F(oe,null,ve(dt.value,p=>(d(),Y(ge,{key:p.value,label:p.label,value:p.value},null,8,["label","value"]))),128))]),_:1},8,["placeholder","modelValue"]))])])):Z("",!0),["1","7","8","9","22"].includes(e.value.displayType)?Z("",!0):(d(),F("div",Bo,[_("div",{title:a(t)("v_query.option_value_source"),class:"label ellipsis"},S(a(t)("v_query.option_value_source")),9,Go),_("div",Po,[_("div",jo,[u(Me,{class:"larger-radio",onChange:It,modelValue:e.value.optionValueSource,"onUpdate:modelValue":l[10]||(l[10]=p=>e.value.optionValueSource=p)},{default:o(()=>[u(Q,{disabled:!!e.value.parameters.length,label:0},{default:o(()=>[le(S(a(t)("chart.margin_model_auto")),1)]),_:1},8,["disabled"]),u(Q,{label:1},{default:o(()=>[le(S(a(t)("chart.select_dataset")),1)]),_:1}),u(Q,{label:2},{default:o(()=>[le(S(a(t)("v_query.manual_input")),1)]),_:1})]),_:1},8,["modelValue"])]),e.value.optionValueSource===1?(d(),F(oe,{key:0},[_("div",Wo,[u(aa,{teleported:!1,modelValue:e.value.dataset.id,"onUpdate:modelValue":l[11]||(l[11]=p=>e.value.dataset.id=p),data:P.value,placeholder:a(t)("copilot.pls_choose_dataset"),onChange:At,onCurrentChange:zl,props:gn,placement:"bottom","render-after-expand":!1,filterable:"","popper-class":"dataset-tree"},{default:o(({node:p,data:U})=>[_("div",zo,[U.leaf?Z("",!0):(d(),Y(b,{key:0,size:"18px"},{default:o(()=>[u(m,{name:"dv-folder"},{default:o(()=>[u(a(Bn),{class:"svg-icon"})]),_:1})]),_:1})),U.leaf?(d(),Y(b,{key:1,size:"18px"},{default:o(()=>[u(m,{name:"icon_dataset"},{default:o(()=>[u(a(Gn),{class:"svg-icon"})]),_:1})]),_:1})):Z("",!0),_("span",{class:"label-tree ellipsis",style:{"margin-left":"8px"},title:p.label},S(p.label),9,Ho)])]),_:1},8,["modelValue","data","placeholder"])]),_("div",Qo,[_("span",{title:a(t)("v_query.query_field"),class:"label"},S(a(t)("v_query.query_field")),9,Ko),u(a(De),{onChange:vt,placeholder:a(t)("v_query.query_field"),class:"search-field",modelValue:e.value.field.id,"onUpdate:modelValue":l[12]||(l[12]=p=>e.value.field.id=p)},Ma({default:o(()=>[(d(!0),F(oe,null,ve(e.value.dataset.fields.filter(p=>p.deType===+e.value.displayType||[3,4].includes(p.deType)&&+e.value.displayType==2||p.deType===7&&+e.value.displayType==0),p=>(d(),Y(ge,{key:p.id,label:p.name,value:p.id,disabled:p.desensitized},{default:o(()=>[_("div",{class:"flex-align-center icon",title:p.desensitized?a(t)("v_query.as_query_conditions"):""},[u(b,null,{default:o(()=>[u(m,{className:`field-icon-${a(be)[p.deType]}`},{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[p.deType]]),{class:Ve(["svg-icon",`field-icon-${a(be)[p.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024),_("span",null,S(p.name),1)],8,Zo)]),_:2},1032,["label","value","disabled"]))),128))]),_:2},[e.value.field.id?{name:"prefix",fn:o(()=>[u(b,null,{default:o(()=>[u(m,null,{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[Te(e.value.field.id,e.value.dataset.fields)]]),{class:Ve(["svg-icon",`field-icon-${a(be)[Te(e.value.field.id,e.value.dataset.fields)]}`])},null,8,["class"]))]),_:1})]),_:1})]),key:"0"}:void 0]),1032,["placeholder","modelValue"])]),_("div",Jo,[_("span",{title:a(t)("v_query.display_field"),class:"label ellipsis"},S(a(t)("v_query.display_field")),9,Xo),u(a(De),{placeholder:a(t)("v_query.display_field"),class:"search-field",modelValue:e.value.displayId,"onUpdate:modelValue":l[13]||(l[13]=p=>e.value.displayId=p),onChange:Pt},Ma({default:o(()=>[(d(!0),F(oe,null,ve(un.value,p=>(d(),Y(ge,{key:p.id,label:p.name,value:p.id,disabled:p.desensitized},{default:o(()=>[_("div",{class:"flex-align-center icon",title:p.desensitized?a(t)("v_query.as_query_conditions"):""},[u(b,null,{default:o(()=>[u(m,{className:`field-icon-${a(be)[p.deType]}`},{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[p.deType]]),{class:Ve(["svg-icon",`field-icon-${a(be)[p.deType]}`])},null,8,["class"]))]),_:2},1032,["className"])]),_:2},1024),_("span",null,S(p.name),1)],8,es)]),_:2},1032,["label","value","disabled"]))),128))]),_:2},[e.value.displayId?{name:"prefix",fn:o(()=>[u(b,null,{default:o(()=>[u(m,null,{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[Te(e.value.displayId,e.value.dataset.fields)]]),{class:Ve(["svg-icon",`field-icon-${a(be)[Te(e.value.displayId,e.value.dataset.fields)]}`])},null,8,["class"]))]),_:1})]),_:1})]),key:"0"}:void 0]),1032,["placeholder","modelValue"])]),_("div",as,[_("span",ts,S(a(t)("chart.total_sort_field")),1),_("div",null,[u(a(De),{clearable:"",placeholder:a(t)("v_query.the_sorting_field"),modelValue:e.value.sortId,"onUpdate:modelValue":l[14]||(l[14]=p=>e.value.sortId=p),class:"sort-field",style:{width:"240px"},onChange:cn},Ma({default:o(()=>[(d(!0),F(oe,null,ve(e.value.dataset.fields,p=>(d(),Y(ge,{key:p.id,label:p.name,value:p.id,disabled:p.desensitized},{default:o(()=>[_("div",{class:"flex-align-center icon",title:p.desensitized?a(t)("v_query.as_query_conditions"):""},[u(b,null,{default:o(()=>[u(m,null,{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[p.deType]]),{class:Ve([`field-icon-${a(be)[p.deType]}`,"svg-icon"])},null,8,["class"]))]),_:2},1024)]),_:2},1024),_("span",null,S(p.name),1)],8,ls)]),_:2},1032,["label","value","disabled"]))),128))]),_:2},[e.value.sortId?{name:"prefix",fn:o(()=>[u(b,null,{default:o(()=>[u(m,null,{default:o(()=>[(d(),Y(Ue(a(Je)[a(be)[Te(e.value.sortId,e.value.dataset.fields)]]),{class:Ve(["svg-icon",`field-icon-${a(be)[Te(e.value.sortId,e.value.dataset.fields)]}`])},null,8,["class"]))]),_:1})]),_:1})]),key:"0"}:void 0]),1032,["placeholder","modelValue"]),u(a(De),{class:"sort-type",modelValue:e.value.sort,"onUpdate:modelValue":l[15]||(l[15]=p=>e.value.sort=p),onChange:vt},{default:o(()=>[u(ge,{label:a(t)("chart.asc"),value:"asc"},null,8,["label"]),u(ge,{label:a(t)("chart.desc"),value:"desc"},null,8,["label"]),u(ge,{onClick:vn,title:Wa.value?n.$t("v_query.display_sort"):"",disabled:Wa.value,label:a(t)("v_query.custom_sort"),value:"customSort"},null,8,["title","disabled","label"])]),_:1},8,["modelValue"])])])],64)):Z("",!0),e.value.optionValueSource===2?(d(),F("div",ns,[u(Oe,{placement:"bottom-start","popper-class":"manual-input",ref_key:"manual",ref:fe,width:358,trigger:"click"},{reference:o(()=>[u(Fe,{text:""},{icon:o(()=>[u(m,{name:"icon_edit_outlined"},{default:o(()=>[u(a(Sa),{class:"svg-icon"})]),_:1})]),default:o(()=>[le(" "+S(a(t)("common.edit")),1)]),_:1})]),default:o(()=>[_("div",is,[_("div",us,S(a(t)("auth.manual_input")),1),_("div",rs,[_("span",null,S(a(t)("data_fill.form.option_value")),1),(d(!0),F(oe,null,ve(c.value,(p,U)=>(d(),F("div",{key:U,class:"select-item"},[e.value.displayType==="2"?(d(),Y(K,{key:0,maxlength:"64",onBlur:Bt,modelValue:c.value[U],"onUpdate:modelValue":Ee=>c.value[U]=Ee,modelModifiers:{number:!0}},null,8,["modelValue","onUpdate:modelValue"])):(d(),Y(K,{key:1,maxlength:"64",onBlur:Bt,modelValue:c.value[U],"onUpdate:modelValue":Ee=>c.value[U]=Ee},null,8,["modelValue","onUpdate:modelValue"])),c.value.length!==1?(d(),Y(Fe,{key:2,onClick:Ee=>c.value.splice(U,1),class:"value",text:""},{icon:o(()=>[u(m,{name:"icon_delete-trash_outlined"},{default:o(()=>[u(a($t),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])):Z("",!0)]))),128))]),_("div",os,[u(Fe,{onClick:l[16]||(l[16]=p=>c.value.push("")),text:""},{icon:o(()=>[u(m,{name:"icon_add_outlined"},{default:o(()=>[u(a(Ja),{class:"svg-icon"})]),_:1})]),default:o(()=>[le(" "+S(a(t)("data_fill.form.add_option")),1)]),_:1})]),_("div",ss,[u(Fe,{onClick:Lt},{default:o(()=>[le(S(a(t)("chart.cancel")),1)]),_:1}),u(Fe,{onClick:rn,type:"primary"},{default:o(()=>[le(S(a(t)("chart.confirm")),1)]),_:1})])])]),_:1},512),e.value.valueSource.length?(d(),F("div",ds,S(a(t)("v_query.configured")),1)):Z("",!0)])):Z("",!0)]),_("div",{class:"label ellipsis",title:a(t)("v_query.of_option_values"),style:{"margin-top":"10.5px"}},S(a(t)("v_query.of_option_values")),9,cs),_("div",ms,[u(Me,{class:"larger-radio",modelValue:e.value.resultMode,"onUpdate:modelValue":l[17]||(l[17]=p=>e.value.resultMode=p)},{default:o(()=>[u(Q,{label:0},{default:o(()=>[le(S(a(t)("chart.default")),1)]),_:1}),u(Q,{label:1},{default:o(()=>[le(S(a(t)("data_set.all")),1)]),_:1})]),_:1},8,["modelValue"])])])),e.value.displayType==="8"?(d(),F("div",vs,[_("div",{title:a(t)("v_query.condition_type"),class:"label ellipsis"},S(a(t)("v_query.condition_type")),9,ps),_("div",fs,[_("div",ys,[u(Me,{class:"larger-radio",modelValue:e.value.conditionType,"onUpdate:modelValue":l[18]||(l[18]=p=>e.value.conditionType=p)},{default:o(()=>[u(Q,{label:0},{default:o(()=>[le(S(a(t)("v_query.single_condition")),1)]),_:1}),u(Q,{label:1,disabled:!!e.value.parameters.length},{default:o(()=>[le(S(a(t)("v_query.with_condition")),1)]),_:1},8,["disabled"]),u(Q,{label:2,disabled:!!e.value.parameters.length},{default:o(()=>[le(S(a(t)("v_query.or_condition")),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])])])])):Z("",!0),e.value.displayType==="8"?(d(),F("div",_s,[u(he,{modelValue:e.value.hideConditionSwitching,"onUpdate:modelValue":l[19]||(l[19]=p=>e.value.hideConditionSwitching=p),label:a(t)("v_query.hide_condition_switch")},null,8,["modelValue","label"])])):Z("",!0),u(eo,{ref_key:"defaultConfigurationRef",ref:w,onHandleTimeTypeChange:_n,"cur-component":e.value},null,8,["cur-component"])],512),[[St,we.value&&!Ge.value&&!Xe.value]]),Ge.value&&we.value?(d(),F("div",hs,[u(gt,{description:a(t)("v_query.cannot_be_performed"),"img-type":"error"},null,8,["description"])])):Xe.value&&we.value?(d(),F("div",gs,[u(gt,{description:a(t)("v_query.cannot_be_displayed"),"img-type":"error"},null,8,["description"])])):we.value?Z("",!0):(d(),F("div",bs,[u(gt,{description:a(t)("v_query.be_linked_first"),"img-type":"noneWhite"},null,8,["description"])]))]),_:1})],2)):Z("",!0)])]),_:1},8,["modelValue","title"]),u(He,{title:re.value,modelValue:Ke.value,"onUpdate:modelValue":l[26]||(l[26]=p=>Ke.value=p),width:"420px"},{footer:o(()=>[u(Fe,{secondary:"",onClick:l[25]||(l[25]=p=>Ke.value=!1)},{default:o(()=>[le(S(a(t)("chart.cancel")),1)]),_:1}),u(Fe,{type:"primary",onClick:ie},{default:o(()=>[le(S(a(t)("chart.confirm")),1)]),_:1})]),default:o(()=>[u(pa,{"label-position":"top"},{default:o(()=>[u(ta,{label:a(t)("v_query.time_type"),class:"form-item",prop:"name"},{default:o(()=>[u(Me,{modelValue:G.value,"onUpdate:modelValue":l[24]||(l[24]=p=>G.value=p)},{default:o(()=>[u(Q,{label:0},{default:o(()=>[le(S(a(t)("data_set.time")),1)]),_:1}),u(Q,{label:1},{default:o(()=>[le(S(a(t)("datasource.start_time")),1)]),_:1}),u(Q,{label:2},{default:o(()=>[le(S(a(t)("datasource.end_time")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1},8,["title","modelValue"]),u(He,{title:$.value,modelValue:H.value,"onUpdate:modelValue":l[29]||(l[29]=p=>H.value=p),width:"420px"},{footer:o(()=>[u(Fe,{secondary:"",onClick:l[28]||(l[28]=p=>H.value=!1)},{default:o(()=>[le(S(a(t)("dataset.cancel")),1)]),_:1}),u(Fe,{type:"primary",onClick:ce},{default:o(()=>[le(S(a(t)("dataset.confirm")),1)]),_:1})]),default:o(()=>[u(pa,{"label-position":"top"},{default:o(()=>[u(ta,{label:a(t)("chart.map_line_type"),class:"form-item",prop:"name"},{default:o(()=>[u(Me,{modelValue:k.value,"onUpdate:modelValue":l[27]||(l[27]=p=>k.value=p)},{default:o(()=>[u(Q,{label:0},{default:o(()=>[le(S(a(t)("chart.value_formatter_value")),1)]),_:1}),u(Q,{label:1},{default:o(()=>[le(S(a(t)("chart.min")),1)]),_:1}),u(Q,{label:2},{default:o(()=>[le(S(a(t)("chart.max")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1},8,["title","modelValue"]),u(Di,{ref_key:"customSortFilterRef",ref:jt,onSave:mn},null,512),u(a(Kl),{onSaveCascade:I,ref_key:"cascadeDialog",ref:xt},null,512)],64)}}});const ks=Ua(),{componentData:dl,canvasViewInfo:Cs}=tt(ks),Ms=()=>{const s=()=>{let i=dl.value.filter(t=>!["VQuery","DeTabs"].includes(t.innerType)&&t.component!=="Group");return dl.value.forEach(t=>{t.innerType==="DeTabs"?t.propValue.forEach(r=>{i=[...i,...r.componentData.filter(v=>!["VQuery","DeTabs"].includes(v.innerType)&&v.component!=="Group")]}):t.component==="Group"&&(i=[...i,t.propValue.filter(r=>!["VQuery","DeTabs"].includes(r.innerType)&&r.component!=="Group")],t.propValue.forEach(r=>{r.innerType==="DeTabs"&&r.propValue.forEach(v=>{i=[...i,...v.componentData.filter(f=>!["VQuery","DeTabs"].includes(f.innerType)&&f.component!=="Group")]})}))}),i.flat()};return{datasetFieldList:L(()=>s().map(i=>{const t=Cs.value[i.id];if(!t)return null;const{id:r,title:v,tableId:f,type:M}=t;return r&&f?{id:r,type:M,title:v,tableId:f}:null}).filter(i=>!!i))}},Ss={class:"condition-type"},Fs={key:0,class:"condition-type"},ws={class:"condition-type-tip"},$s=Ae({__name:"TextSearch",props:{config:{type:Object,default:()=>({id:"",conditionType:0,queryConditionWidth:0,conditionValueOperatorF:"eq",conditionValueF:"",conditionValueOperatorS:"like",conditionValueS:"",defaultConditionValueOperatorF:"eq",defaultConditionValueF:"",defaultConditionValueOperatorS:"like",defaultConditionValueS:""})},isConfig:{type:Boolean,default:!1}},setup(s){const y=xe("placeholder"),{t:i}=ia(),t=L(()=>{var R;return(R=y==null?void 0:y.value)!=null&&R.placeholderShow?M.config.placeholder:" "}),r=[{label:i("v_query.exact_match"),value:"eq"},{label:i("v_query.fuzzy_match"),value:"like"}],v=Ua(),{dvInfo:f}=tt(v),M=s,{config:w}=Qe(M),V=()=>{const{defaultConditionValueOperatorF:R,defaultConditionValueF:O,defaultConditionValueOperatorS:g,defaultConditionValueS:I}=w.value;w.value.conditionValueOperatorF=R,w.value.conditionValueF=O,w.value.conditionValueOperatorS=g,w.value.conditionValueS=I};ga(()=>{V()});const x=xe("com-width",Function,!0),B=xe("$custom-style-filter"),c=xe("is-confirm-search",Function,!0),C=()=>{var R;return(R=y==null?void 0:y.value)!=null&&R.placeholderShow?M.config.queryConditionWidth===void 0?x():M.config.queryConditionWidth:227},D=L(()=>({width:C()+"px"})),T=()=>{if(!M.isConfig){Se(()=>{c(w.value.id)});return}},J=L(()=>({width:C()-15+"px",background:B.border})),ee=()=>{T()},X=R=>{R.stopPropagation()};return(R,O)=>{const g=qa,I=De,ue=Mt;return d(),F("div",{onMousedown:X,class:"text-search-select",style:Ne({background:a(B).background})},[_("div",Ss,[a(w).hideConditionSwitching?Z("",!0):(d(),Y(I,{key:0,class:"condition-value-select",onChange:T,effect:a(f).type==="dataV"?"dark":"","popper-class":"condition-value-select-popper",modelValue:a(w).conditionValueOperatorF,"onUpdate:modelValue":O[0]||(O[0]=e=>a(w).conditionValueOperatorF=e)},{default:o(()=>[(d(),F(oe,null,ve(r,e=>u(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue"])),u(ue,{style:Ne(D.value),placeholder:t.value,onBlur:T,onKeydown:Jt(ee,["enter"]),class:"condition-value-input",modelValue:a(w).conditionValueF,"onUpdate:modelValue":O[1]||(O[1]=e=>a(w).conditionValueF=e)},null,8,["style","placeholder","modelValue"]),_("div",{style:Ne(J.value),class:"bottom-line"},null,4)]),[1,2].includes(a(w).conditionType)?(d(),F("div",Fs,[_("span",ws,S(a(w).conditionType===1?a(i)("chart.and"):a(i)("chart.or")),1),a(w).hideConditionSwitching?Z("",!0):(d(),Y(I,{key:0,class:"condition-value-select",onChange:T,effect:a(f).type==="dataV"?"dark":"","popper-class":"condition-value-select-popper",modelValue:a(w).conditionValueOperatorS,"onUpdate:modelValue":O[2]||(O[2]=e=>a(w).conditionValueOperatorS=e)},{default:o(()=>[(d(),F(oe,null,ve(r,e=>u(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["effect","modelValue"])),u(ue,{style:Ne(D.value),onBlur:T,placeholder:t.value,onKeydown:Jt(ee,["enter"]),class:"condition-value-input",modelValue:a(w).conditionValueS,"onUpdate:modelValue":O[3]||(O[3]=e=>a(w).conditionValueS=e)},null,8,["style","placeholder","modelValue"]),_("div",{style:Ne(J.value),class:"bottom-line next-line"},null,4)])):Z("",!0)],36)}}});const qs=Ba($s,[["__scopeId","data-v-6ef236ad"]]),Os=Ae({__name:"NumberInput",props:{config:{type:Object,default:()=>({id:"",queryConditionWidth:0,defaultNumValueEnd:"",defaultNumValueStart:"",numValueEnd:"",numValueStart:"",defaultValueCheck:!1})},isConfig:{type:Boolean,default:!1}},setup(s){pl(C=>({"6a632d3b":c.value}));const y=xe("placeholder"),i=L(()=>{var C;return(C=y==null?void 0:y.value)!=null&&C.placeholderShow?t.config.placeholder:" "}),t=s,{config:r}=Qe(t),v=()=>{if(!r.value.defaultValueCheck){r.value.numValueEnd=void 0,r.value.numValueStart=void 0;return}const{defaultNumValueEnd:C,defaultNumValueStart:D}=r.value;r.value.numValueEnd=C,r.value.numValueStart=D};ga(()=>{v()});const f=xe("com-width",Function,!0),M=xe("$custom-style-filter"),w=xe("is-confirm-search",Function,!0),V=()=>{var C;return(C=y==null?void 0:y.value)!=null&&C.placeholderShow?t.config.queryConditionWidth===void 0?f():t.config.queryConditionWidth:227},x=L(()=>({width:V()+"px"})),B=()=>{if(!t.isConfig){Se(()=>{w(r.value.id)});return}},c=L(()=>M.border);return(C,D)=>{const T=lt;return d(),F("div",{class:"num-search-select",style:Ne({background:a(M).background})},[u(T,{placeholder:i.value,onChange:B,style:Ne(x.value),"controls-position":"right",modelValue:a(r).numValueStart,"onUpdate:modelValue":D[0]||(D[0]=J=>a(r).numValueStart=J)},null,8,["placeholder","style","modelValue"]),D[2]||(D[2]=_("div",{class:"num-value_line"},null,-1)),u(T,{placeholder:i.value,style:Ne(x.value),onChange:B,"controls-position":"right",modelValue:a(r).numValueEnd,"onUpdate:modelValue":D[1]||(D[1]=J=>a(r).numValueEnd=J)},null,8,["placeholder","style","modelValue"])],4)}}});const Ds=Ba(Os,[["__scopeId","data-v-074392f9"]]),Ns=Ae({__name:"StyleInject",props:{config:{type:Object,default:()=>({selectValue:"",defaultValue:"",displayType:"",defaultValueCheck:!1,optionValueSource:0,multiple:!1,checkedFieldsMap:{}})},customStyle:{type:Object,default:()=>({border:"",background:"",text:""})}},setup(s){const y=s,i=t=>t==="8"?qs:t==="22"?Ds:["1","7"].includes(t)?Pl:t==="9"?Wl:jl;return sa("$custom-style-filter",y.customStyle),(t,r)=>(d(),Y(Ue(i(s.config.displayType)),{config:s.config,"is-config":!1},null,8,["config"]))}}),Es={key:0,class:"no-list-label flex-align-center"},As={class:"container flex-align-center"},Is={class:"query-fields-container"},xs={class:"label-wrapper"},Rs={key:0,class:"required"},Ls={key:0,class:"label-wrapper-tooltip"},Us={class:"query-select"},Ys={key:0,class:"query-button"},Bs=Ae({__name:"Component",props:{view:{type:Object,default(){return{customStyle:""}}},element:{type:Object,default(){return{id:null,propValue:[]}}},showPosition:{type:String,required:!0,default:""},scale:{type:Number,required:!1,default:1}},setup(s){pl(k=>({"326d1a03":ye.value}));const y=s,{element:i,view:t,scale:r}=Qe(y),{t:v}=ia(),f=ne(),M=Ua(),{curComponent:w,canvasViewInfo:V,mobileInPc:x,firstLoadMap:B}=tt(M),c=ne(!1),C=ne(),T=vl({...{border:"",placeholderSize:14,placeholderShow:!0,background:"",text:"",layout:"horizontal",btnList:["sure"],titleLayout:"left",titleShow:!1,titleColor:"",textColorShow:!1,labelShow:!0,title:"",labelColor:"#1f2329",fontSize:"14",fontWeight:"",fontStyle:"",fontSizeBtn:"14",fontWeightBtn:"",fontStyleBtn:"",queryConditionWidth:227,nameboxSpacing:8,queryConditionSpacing:16,btnColor:"#3370ff",labelColorBtn:"#ffffff"}}),J=fl(),ee=L(()=>{const k={backgroundColor:T.btnColor,borderColor:T.btnColor,color:T.labelColorBtn};return T.fontSizeBtn&&(k.fontSize=T.fontSizeBtn+"px"),T.fontWeightBtn&&(k.fontWeight=T.fontWeightBtn),T.fontStyleBtn&&(k.fontStyle=T.fontStyleBtn),k}),X=L(()=>{const k={backgroundColor:"transparent",borderColor:T.btnColor,color:T.btnColor};return T.fontSizeBtn&&(k.fontSize=T.fontSizeBtn+"px"),T.fontWeightBtn&&(k.fontWeight=T.fontWeightBtn),T.fontStyleBtn&&(k.fontStyle=T.fontStyleBtn),k}),R=L(()=>(V.value[i.value.id]||{}).customStyle),{datasetFieldList:O}=Ms(),g=k=>{const{borderColor:$,btnList:ie,titleLayout:ce,labelColor:z,text:de,bgColor:me,layout:_e,titleShow:Pe,titleColor:ma,title:Ta,fontSize:va,fontWeight:ra,fontStyle:Ca,fontSizeBtn:rt,fontWeightBtn:ot,fontStyleBtn:Ga,queryConditionWidth:st,nameboxSpacing:Pa,queryConditionSpacing:ba,labelColorBtn:dt,btnColor:ct,placeholderSize:mt,placeholderShow:ja,labelShow:oa}=k;T.background=me||"",T.border=$||"",T.btnList=[...ie],T.layout=_e,T.placeholderShow=ja??!0,T.placeholderSize=mt??14,Se(()=>{f.value.style.setProperty("--ed-component-size",`${T.placeholderSize+18}px`)}),T.titleShow=Pe,T.titleColor=ma,T.labelColor=oa&&z||"",T.fontSize=oa&&va||"14",T.fontWeight=oa&&ra||"",T.fontStyle=oa&&Ca||"",T.title=Ta,T.text=T.placeholderShow&&de||"",T.titleLayout=ce,T.fontSizeBtn=rt||"14",T.fontWeightBtn=ot,T.fontStyleBtn=Ga,T.queryConditionWidth=st??227,T.nameboxSpacing=Pa??8,T.queryConditionSpacing=ba??16,T.labelColorBtn=dt||"#ffffff",T.labelShow=oa??!0,T.btnColor=ct||"#3370ff",J.recordSnapshotCache("setCustomStyle")};pe(()=>t.value,k=>{var $,ie;($=k==null?void 0:k.customStyle)!=null&&$.component&&g((ie=k==null?void 0:k.customStyle)==null?void 0:ie.component)},{deep:!0,immediate:!0}),pe(()=>R.value,k=>{k!=null&&k.component&&g(k==null?void 0:k.component)},{deep:!0,immediate:!0});const I=ne([]);pe(()=>y.element.propValue,()=>{I.value=[...y.element.propValue]},{immediate:!0});const ue=()=>{w.value.id!==i.value.id&&(c.value=!1)},{emitter:e}=ka(),fe=xa([]);ga(()=>{fe.value=I.value.map(k=>k.id)});const E=k=>{fe.value=fe.value.filter($=>$!==k)},h=k=>{let $="",ie="";const ce=(i.value.propValue||[]).filter(z=>z.id===k).reduce((z,de)=>{if(de.required)if(de.defaultValueCheck||($=de.name),de.displayType==="8"){const{conditionValueF:_e,conditionValueS:Pe,conditionType:ma}=de;ma===0?$=_e===""?de.name:"":$=[_e||"",Pe||""].filter(Ta=>Ta!=="").length<2?de.name:""}else de.displayType==="22"?(de.numValueStart!==0&&!de.numValueStart||de.numValueEnd!==0&&!de.numValueEnd)&&($=de.name):(Array.isArray(de.selectValue)&&!de.selectValue.length||de.selectValue!==0&&!de.selectValue)&&($=de.name);de.displayType==="22"&&(!isNaN(de.numValueEnd)&&!isNaN(de.numValueStart)&&de.numValueEnd<de.numValueStart&&(ie=de.name),[de.numValueEnd,de.numValueStart].filter(_e=>![null,void 0,""].includes(_e)).length===1&&($=de.name));const me=Object.entries(de.checkedFieldsMap).filter(_e=>de.checkedFields.includes(_e[0])).filter(_e=>!!_e[1]).map(_e=>_e[0]);return z=[...new Set([...me,...z])],z},[]);if($){Re.error(`${$}${v("v_query.before_querying")}`);return}if(ie){Re.error(`${ie}${v("v_query.the_minimum_value")}`);return}ce.length&&ce.forEach(z=>{e.emit(`query-data-${z}`)})},P=()=>T.queryConditionWidth,j=()=>y.element.cascade,$e=L(()=>({placeholderShow:T.placeholderShow}));sa("is-confirm-search",k=>{se.value||h(k)}),sa("unmount-select",fe),sa("release-unmount-select",E),sa("query-data-for-id",h),sa("com-width",P),sa("cascade-list",j),sa("placeholder",$e),qn(()=>{e.off(`addQueryCriteria${i.value.id}`),e.off(`editQueryCriteria${i.value.id}`),e.off(`updateQueryCriteria${i.value.id}`),On.off("componentClick",ue)});const we=()=>{M.mobileInPc&&!ht()||Array.isArray(i.value.propValue)&&i.value.propValue.forEach(k=>{if(k.auto){const $={datasetId:k.dataset.id,id:k.field.id},ie=[],ce={};O.value.forEach(z=>{z.tableId===$.datasetId&&(ie.push(z.id),ce[z.id]=$.id)}),k.checkedFields=ie,k.checkedFieldsMap=ce}else{if(!k.dataset.id||k.parameters.length||k.optionValueSource!==1||![0,2,5].includes(+k.displayType))return;const $=O.value.map(ie=>ie.id);k.checkedFields.forEach(ie=>{$.includes(ie)||(k.checkedFieldsMap[ie]="")}),k.checkedFields=k.checkedFields.filter(ie=>$.includes(ie))}})};wt(()=>{e.on(`addQueryCriteria${i.value.id}`,We),e.on(`editQueryCriteria${i.value.id}`,Ye),e.on(`updateQueryCriteria${i.value.id}`,we),we(),M.mobileInPc&&!ht()&&W()});const Ge=()=>{},Xe=k=>{JSON.parse(k.dataTransfer.getData("dimension")||"{}").forEach(ie=>{const ce=[],z={};O.value.forEach(me=>{me.tableId===ie.datasetId&&(ce.push(me.id),z[me.id]=ie.id)});const de=ie.deType===7?0:`${ie.deType}`;I.value.push({...wl(ie),auto:!0,optionValueSource:1,checkedFields:ce,checkedFieldsMap:z,displayType:de})}),i.value.propValue=[...I.value],J.recordSnapshotCache("drop")},ua=k=>{C.value.setCondition(k)},Ye=()=>{if(!I.value.length){We();return}ua(I.value[0].id)},We=()=>{C.value.setConditionOut()},ea=k=>{I.value.splice(k,1),i.value.propValue=[...I.value],J.recordSnapshotCache("delQueryConfig")},N=()=>{(I.value||[]).reduce((k,$)=>{var ce;$.conditionValueF=$.defaultConditionValueF,$.conditionValueOperatorF=$.defaultConditionValueOperatorF,$.conditionValueS=$.defaultConditionValueS,$.conditionValueOperatorS=$.defaultConditionValueOperatorS,$.displayType==="22"&&($.numValueEnd=$.defaultNumValueEnd,$.numValueStart=$.defaultNumValueStart),$.defaultValueCheck||($.defaultValue=$.multiple||+$.displayType==7?[]:void 0),$.selectValue=Array.isArray($.defaultValue)?[...$.defaultValue]:$.defaultValue,$.optionValueSource===1&&((ce=$.defaultMapValue)!=null&&ce.length)&&($.mapValue=Array.isArray($.defaultMapValue)?[...$.defaultMapValue]:$.defaultMapValue),(y.element.cascade||[]).forEach(z=>{z.forEach(de=>{const me=de.datasetId.split("--")[1];$.id===me&&(de.currentSelectValue=Array.isArray($.selectValue)?$.selectValue:[$.selectValue].filter(_e=>![null,void 0].includes(_e)),ka().emitter.emit(`${de.datasetId.split("--")[1]}-select`))})});const ie=Object.entries($.checkedFieldsMap).filter(z=>$.checkedFields.includes(z[0])).filter(z=>!!z[1]).map(z=>z[0]);return k=[...new Set([...ie,...k])],k},[]),!se.value&&W()},ca=()=>{(y.element.cascade||[]).forEach(k=>{k.forEach($=>{var ie;(ie=$.currentSelectValue)!=null&&ie.length&&(ka().emitter.emit(`${$.datasetId.split("--")[1]}-select`),$.currentSelectValue=[])})}),(I.value||[]).reduce((k,$)=>{var ce;if(!$.visible)return k;$.selectValue=$.multiple||+$.displayType==7?[]:void 0,$.optionValueSource===1&&((ce=$.defaultMapValue)!=null&&ce.length)&&($.mapValue=$.multiple?[]:void 0),$.conditionValueF="",$.conditionValueS="",$.displayType==="22"&&($.numValueEnd=void 0,$.numValueStart=void 0);const ie=Object.entries($.checkedFieldsMap).filter(z=>$.checkedFields.includes(z[0])).filter(z=>!!z[1]).map(z=>z[0]);return k=[...new Set([...ie,...k])],k},[]),!se.value&&W()},te=L(()=>I.value.filter(k=>k.visible)),se=L(()=>T.btnList.includes("sure"));pe(()=>se.value,(k,$)=>{!k&&$&&W()},{immediate:!1});const ye=L(()=>`${T.placeholderSize}px`),W=()=>{let k="",$="";const ie=(i.value.propValue||[]).reduce((ce,z)=>{if(z.required)if(z.defaultValueCheck||(k=z.name),z.displayType==="8"){const{conditionValueF:me,conditionValueS:_e,conditionType:Pe}=z;Pe===0?k=me===""?z.name:"":k=[me||"",_e||""].filter(ma=>ma!=="").length<2?z.name:""}else z.displayType==="22"?(z.numValueEnd!==0&&!z.numValueEnd||z.numValueStart!==0&&!z.numValueStart)&&(k=z.name):(Array.isArray(z.selectValue)&&!z.selectValue.length||z.selectValue!==0&&!z.selectValue)&&(k=z.name);z.displayType==="22"&&(!isNaN(z.numValueEnd)&&!isNaN(z.numValueStart)&&z.numValueEnd<z.numValueStart&&($=z.name),[z.numValueEnd,z.numValueStart].filter(me=>![null,void 0,""].includes(me)).length===1&&(k=z.name));const de=Object.entries(z.checkedFieldsMap).filter(me=>z.checkedFields.includes(me[0])).filter(me=>!!me[1]).map(me=>me[0]);return ce=[...new Set([...de,...ce])],ce},[]);if(k){Re.error(`${k}${v("v_query.before_querying")}`);return}if($){Re.error(`${$}${v("v_query.the_minimum_value")}`);return}ie.length&&(M.mobileInPc&&!ht()||M.setFirstLoadMap([...new Set([...ie,...B.value])]),ie.forEach(ce=>{e.emit(`query-data-${ce}`)}))},Ce=L(()=>({textAlign:T.titleLayout||"left",color:T.titleColor||"#1f2329"})),Ke=L(()=>{const k={fontSize:T.fontSize+"px",lineHeight:+T.fontSize+8+"px"};return T.fontWeight&&(k.fontWeight=T.fontWeight),T.fontStyle&&(k.fontStyle=T.fontStyle),T.labelColor&&(k.color=T.labelColor),k}),G=L(()=>({paddingTop:T.layout!=="horizontal"?T.nameboxSpacing+22+"px":"0"})),re=L(()=>({marginRight:T.layout==="horizontal"?T.nameboxSpacing+"px":"8px"})),H=L(()=>Mn()?{position:"absolute",height:100/r.value+"%!important",width:100/r.value+"%!important",left:50*(1-1/r.value)+"%",top:50*(1-1/r.value)+"%",transform:"scale("+r.value+") translateZ(0)"}:{zoom:r.value});return(k,$)=>{const ie=Ia,ce=Nt,z=wa,de=Ct;return d(),F(oe,null,[_("div",{class:"v-query-container",ref_key:"vQueryRef",ref:f,style:Ne(H.value),onKeydown:$[0]||($[0]=Ie(()=>{},["stop"])),onKeyup:$[1]||($[1]=Ie(()=>{},["stop"]))},[T.titleShow?(d(),F("p",{key:0,class:"title",style:Ne(Ce.value)},S(T.title),5)):Z("",!0),_("div",{class:Ve(["v-query",T.layout,T.titleShow&&!!T.title&&"title-show"]),onDragover:Ie(Ge,["prevent","stop"]),onDrop:Ie(Xe,["prevent","stop"])},[te.value.length?Z("",!0):(d(),F("div",Es,[_("div",As,[le(S(a(v)("v_query.here_or_click"))+" ",1),u(ie,{disabled:s.showPosition==="preview"||a(x),onClick:We,style:{"font-family":"inherit"},text:""},{default:o(()=>[le(S(a(v)("v_query.add_query_condition")),1)]),_:1},8,["disabled"])])])),_("div",Is,[(d(!0),F(oe,null,ve(te.value,(me,_e)=>(d(),F("div",{class:"query-item",style:Ne({marginRight:`${T.queryConditionSpacing}px`}),key:me.id},[_("div",{class:"query-field",style:Ne(G.value)},[_("div",{class:"label",style:Ne(re.value)},[$a(_("div",xs,[_("div",{class:"label-wrapper-text",style:Ne(Ke.value)},[u(ce,{"popper-class":"label-wrapper-text_tooltip",effect:"dark",content:me.name,"show-arrow":!1,placement:"top-start"},{default:o(()=>[le(S(me.name),1)]),_:2},1032,["content"])],4),me.required?(d(),F("span",Rs,"*")):Z("",!0)],512),[[St,T.labelShow]]),s.showPosition!=="preview"&&!a(M).mobileInPc?(d(),F("div",Ls,[u(ce,{effect:"dark",content:a(v)("v_query.set_filter_condition"),placement:"top"},{default:o(()=>[u(de,{onClick:Pe=>ua(me.id)},{default:o(()=>[u(z,{name:"icon_edit_outlined"},{default:o(()=>[u(a(Sa),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["content"]),u(ce,{effect:"dark",content:a(v)("v_query.delete_condition"),placement:"top"},{default:o(()=>[u(de,{style:{"margin-left":"8px"},onClick:Pe=>ea(_e)},{default:o(()=>[u(z,{name:"icon_delete-trash_outlined"},{default:o(()=>[u(a($t),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["content"])])):Z("",!0)],4),_("div",Us,[T.queryConditionWidth!==0?(d(),Y(Ns,{key:0,customStyle:T,config:me},null,8,["customStyle","config"])):Z("",!0)])],4)],4))),128)),te.value.length?(d(),F("div",Ys,[T.btnList.includes("clear")?(d(),Y(ie,{key:0,onClick:Ie(ca,["stop"]),style:Ne(X.value),plain:""},{default:o(()=>[le(S(a(v)("commons.clear")),1)]),_:1},8,["style"])):Z("",!0),T.btnList.includes("reset")?(d(),Y(ie,{key:1,onClick:Ie(N,["stop"]),style:Ne(X.value),plain:""},{default:o(()=>[le(S(a(v)("chart.reset")),1)]),_:1},8,["style"])):Z("",!0),se.value?(d(),Y(ie,{key:2,onClick:Ie(W,["stop"]),style:Ne([{"margin-right":"7px"},ee.value]),type:"primary"},{default:o(()=>[le(S(a(v)("commons.adv_search.search")),1)]),_:1},8,["style"])):Z("",!0)])):Z("",!0)])],34)],36),(d(),Y(cl,{to:"body"},[u(Ts,{"query-element":a(i),onQueryData:W,ref_key:"queryConfig",ref:C},null,8,["query-element"])]))],64)}}});const Gs=Ba(Bs,[["__scopeId","data-v-94513b7c"]]),Zd=Object.freeze(Object.defineProperty({__proto__:null,default:Gs},Symbol.toStringTag,{value:"Module"}));export{Zd as C,Gs as V,wi as d};

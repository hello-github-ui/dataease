import{L as w,p as C,h as F}from"./element-plus-secondary-0.0.0-dataease.js";import E from"./RowAuth-0.0.0-dataease.js";import{s as L}from"./snapshot-0.0.0-dataease.js";import{d as S,r as u,k as B,o as x,Z as A,_ as i,i as D,n as N,q as $,a0 as l,a4 as f,a2 as m,a as p}from"./@vue-0.0.0-dataease.js";const I={class:"tree-cont"},M={class:"content"},Z=S({__name:"FilterTree",emits:["filter-data"],setup(j,{expose:_,emit:h}){const v=h,g=D("filedList",()=>[]),r=u(),a=u(!1),n=B(()=>g().reduce((t,e)=>(e.id!=="-1"&&(t[e.id]=e),t),{}));$("filedList",n);const y=()=>{a.value=!1},T=L(),b=()=>{r.value.submit()},k=t=>{const{logic:e,items:s,errorMessage:o}=t;if(o){C.error({message:o,type:"error",showClose:!0});return}c(s),v("filter-data",{logic:e,items:s}),T.recordSnapshotCache("changeFilter"),a.value=!1},c=t=>{t.forEach(e=>{var s,o;(o=(s=e==null?void 0:e.subTree)==null?void 0:s.items)!=null&&o.length?c(e.subTree.items||[]):e.field&&delete e.field})},d=t=>{t.forEach(e=>{var s,o;(o=(s=e==null?void 0:e.subTree)==null?void 0:s.items)!=null&&o.length?d(e.subTree.items):n.value[e.fieldId]&&(e.field=n.value[e.fieldId])})};return _({init:t=>{a.value=!0,N(()=>{d(t.items||[]),r.value.init(t||{})})}}),(t,e)=>{const s=F,o=w;return x(),A(o,{width:"896px","append-to-body":"",title:t.$t("chart.add_filter"),"destroy-on-close":"",class:"de-dialog-form filter-tree-cont",modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=V=>a.value=V)},{footer:i(()=>[l(s,{secondary:"",onClick:y},{default:i(()=>[f(m(t.$t("chart.cancel")),1)]),_:1}),l(s,{type:"primary",onClick:b},{default:i(()=>[f(m(t.$t("chart.confirm")),1)]),_:1})]),default:i(()=>[p("div",I,[p("div",M,[l(E,{onSave:k,ref_key:"rowAuth",ref:r},null,512)])])]),_:1},8,["title","modelValue"])}}});export{Z as _};

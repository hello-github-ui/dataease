import"./index-0.0.0-dataease.js";import{E as w}from"./el-dialog-0.0.0-dataease.js";import{D as C,y as E}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import F from"./RowAuth-0.0.0-dataease.js";import{s as S}from"./snapshot-0.0.0-dataease.js";import{d as B,r as f,G as D,f as L,g as x,i as r,Q as A,n as M,R as N,k as l,a5 as u,a6 as m,M as p}from"./vue-0.0.0-dataease.js";const $={class:"tree-cont"},I={class:"content"},z=B({__name:"FilterTree",emits:["filter-data"],setup(R,{expose:_,emit:h}){const g=h,v=A("filedList",()=>[]),a=f(),i=f(!1),n=D(()=>v().reduce((t,e)=>(e.id!=="-1"&&(t[e.id]=e),t),{}));N("filedList",n);const y=()=>{i.value=!1},T=S(),b=()=>{a.value.submit()},k=t=>{const{logic:e,items:s,errorMessage:o}=t;if(o){C.error({message:o,type:"error",showClose:!0});return}c(s),g("filter-data",{logic:e,items:s}),T.recordSnapshotCache("changeFilter"),i.value=!1},c=t=>{t.forEach(e=>{var s,o;(o=(s=e==null?void 0:e.subTree)==null?void 0:s.items)!=null&&o.length?c(e.subTree.items||[]):e.field&&delete e.field})},d=t=>{t.forEach(e=>{var s,o;(o=(s=e==null?void 0:e.subTree)==null?void 0:s.items)!=null&&o.length?d(e.subTree.items):n.value[e.fieldId]&&(e.field=n.value[e.fieldId])})};return _({init:t=>{i.value=!0,M(()=>{d(t.items||[]),a.value.init(t||{})})}}),(t,e)=>{const s=E,o=w;return L(),x(o,{width:"896px","append-to-body":"",title:t.$t("chart.add_filter"),"destroy-on-close":"",class:"de-dialog-form filter-tree-cont",modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=V=>i.value=V)},{footer:r(()=>[l(s,{secondary:"",onClick:y},{default:r(()=>[u(m(t.$t("chart.cancel")),1)]),_:1}),l(s,{type:"primary",onClick:b},{default:r(()=>[u(m(t.$t("chart.confirm")),1)]),_:1})]),default:r(()=>[p("div",$,[p("div",I,[l(F,{onSave:k,ref_key:"rowAuth",ref:a},null,512)])])]),_:1},8,["title","modelValue"])}}});export{z as _};

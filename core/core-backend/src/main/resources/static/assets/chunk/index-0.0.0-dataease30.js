import{d as Y}from"./element-plus-secondary-0.0.0-dataease.js";import{a as Z,m as j,h as q}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as B}from"./icon_right_outlined-0.0.0-dataease.js";import{mountedOrg as G,switchOrg as J}from"./user-0.0.0-dataease.js";import I from"./OrgCell-0.0.0-dataease.js";import{b as K}from"./vue-router-0.0.0-dataease.js";import{l as Q}from"./logout-0.0.0-dataease.js";import{l as X,d as ee}from"./vant-0.0.0-dataease.js";import{d as te,r as m,b as oe,k as le,o as s,c as _,M as g,a as c,a0 as d,u as f,a2 as T,z as E,Z as O,_ as k,Y as L,ab as S}from"./@vue-0.0.0-dataease.js";import{_ as ae}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@vueuse-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./lodash-es-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./pinia-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./index-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./interactive-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./dataset-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./app-0.0.0-dataease.js";import"./@vant-0.0.0-dataease.js";const re=""+new URL("../png/user-0.0.0-dataease.png",import.meta.url).href,ie={class:"de-mobile-user"},ne={class:"mobile-user-top"},se={class:"user-name"},ce={class:"cell-org_scroll"},ue={class:"grey"},pe=["onClick"],me=te({__name:"index",setup(de){const v=Z(),{push:V}=K(),$=m("组织"),C=m(""),x=m(!0),z=async()=>{await j(),Q(),V("/login")},H=()=>{x.value=!1},p=m("");let b=null;const M=()=>{var o;const t=[...b];for(;t.length;){const e=t.pop();if((e==null?void 0:e.id)===v.getOid){C.value=e==null?void 0:e.name;break}(o=e==null?void 0:e.children)!=null&&o.length&&e.children.forEach(i=>t.push(i))}};let u=[],h=[];const N=(t,o)=>{t.forEach(e=>{var y;const{name:i,id:a}=e;o<=u.length?(o<u.length&&(u=u.slice(0,o),h=h.slice(0,o)),u.splice(u.length-1,1,a),h.splice(h.length-1,1,i)):(u.push(a),h.push(i));let n=o+1;a===v.getOid&&(l.value=[...h],r.value=[...u],n=999),(y=e==null?void 0:e.children)!=null&&y.length&&n!==999&&N(e==null?void 0:e.children,n)})};oe(()=>{G().then(t=>{b=t.data,w.value=t.data,M(),N(b,1),l.value.pop(),r.value.pop(),p.value=l.value[l.value.length-1]})});const R=t=>{J(t).then(o=>{const e=o.data.token;v.setToken(e),v.setExp(o.data.exp),v.setTime(Date.now()),window.location.reload()})},U=()=>{l.value.pop(),p.value=l.value[l.value.length-1],r.value.pop(),l.value.length||(x.value=!0)},A=()=>{l.value.length&&(l.value=[],p.value="",r.value=[])},F=(t,o)=>{t!=="right"?R(o.id):(l.value.push(o.name),p.value=o.name,r.value.push(o.id))},P=t=>{t!==r.value.length-1&&(r.value=r.value.slice(0,t+1),l.value=l.value.slice(0,t+1),p.value=l.value[l.value.length-1])},w=m([]),l=m([]),r=m([]),D=(t,o)=>{const e=t.shift();return o.reduce((i,a)=>{if(e&&a.id===e){if(!t.length)return a.children||[];i=D([...t],a.children||[])||[]}return i},[])},W=le(()=>r.value.length?D([...r.value],w.value):w.value);return(t,o)=>{const e=q,i=Y;return s(),_("div",ie,[x.value?(s(),_(g,{key:0},[o[0]||(o[0]=c("div",{class:"logout flex-center"},"我的",-1)),c("div",ne,[d(f(X),{round:"",width:"48",height:"48",src:f(re)},null,8,["src"]),c("div",se,T(f(v).name),1)]),d(I,{onClick:H,label:"切换组织","prefix-icon":"icon_switch_outlined",tips:C.value,nextlevel:""},null,8,["tips"]),c("div",{class:"logout flex-center danger",onClick:z},"注销")],64)):(s(),_(g,{key:1},[d(f(ee),{"safe-area-inset-top":"",title:p.value||$.value,"left-arrow":"",onClickLeft:U},null,8,["title"]),c("div",ce,[c("div",ue,[c("div",{onClick:A,class:"flex-align-center"},[c("span",{class:E(["ellipsis",!!l.value.length&&"active"])},"组织",2),l.value.length?(s(),O(i,{key:0},{default:k(()=>[d(e,{name:"icon_right_outlined"},{default:k(()=>[d(f(B),{class:"svg-icon"})]),_:1})]),_:1})):L("",!0)]),(s(!0),_(g,null,S(l.value,(a,n)=>(s(),_("div",{onClick:y=>P(n),class:"flex-align-center",key:a},[c("span",{class:E(["ellipsis",a!==p.value&&"active"])},T(a),3),l.value.length>1&&n!==l.value.length-1?(s(),O(i,{key:0},{default:k(()=>[d(e,{name:"icon_right_outlined"},{default:k(()=>[d(f(B),{class:"svg-icon"})]),_:1})]),_:1})):L("",!0)],8,pe))),128))]),(s(!0),_(g,null,S(W.value,a=>(s(),O(I,{onClick:n=>F(n,a),key:a.id,label:a.name,nextlevel:a.children,active:C.value===a.name},null,8,["onClick","label","nextlevel","active"]))),128))])],64))])}}});const Ot=ae(me,[["__scopeId","data-v-7b1f6c9e"]]);export{Ot as default};

import{a as E,M as b}from"./index-0.0.0-dataease.js";import{n as q,j}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{i as k}from"./icon_drag_outlined-0.0.0-dataease.js";import{d as D}from"./vuedraggable-es-0.0.0-dataease.js";import{e as w,f as L}from"./chart-0.0.0-dataease2.js";import{d as T,r as B,Z as I,w as M,aa as O,f as d,g as f,i as r,T as F,j as h,L as A,k as m,M as N,a6 as R}from"./vue-0.0.0-dataease.js";import{_ as V}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";const U=["title"],Z={class:"item-span"},$=T({__name:"CustomSortEdit",props:{chart:{type:Object,required:!0},field:{type:Object,required:!0},fieldType:{type:String,required:!0}},emits:["onSortChange"],setup(g,{emit:v}){const{wsCache:y}=E(),a=B(!1),o=I({sortList:[]}),e=g,S=v;M(()=>e.chart,()=>{p()},{deep:!0});const p=()=>{a.value=!0;const t=e.chart;t.chartExtRequest||(t.chartExtRequest={user:y.get("user.uid")});const s={fieldId:e.field.id,fieldType:e.fieldType,data:t};(e.fieldType==="drillFields"?w:L)(s).then(i=>{const n=i.data;o.sortList=n.map(c=>x(c)),_(),a.value=!1}).catch(()=>{a.value=!1})},_=()=>{const t=o.sortList.map(s=>C(s));S("onSortChange",t)},x=t=>({name:"name",value:t}),C=t=>t.value;return p(),(t,s)=>{const u=q,i=j,n=b,c=O("loading");return d(),f(n,{height:"100%","max-height":"599px"},{default:r(()=>[F((d(),f(h(D),{list:o.sortList,animation:"300",class:"drag-list","item-key":"name",onUpdate:_},{item:r(({element:l})=>[(d(),A("span",{key:l.value,class:"item-dimension",title:l.value},[m(i,{class:"item-icon"},{default:r(()=>[m(u,{name:"icon_drag_outlined"},{default:r(()=>[m(h(k),{class:"svg-icon"})]),_:1})]),_:1}),N("span",Z,R(l.value),1)],8,U))]),_:1},8,["list"])),[[c,a.value]])]),_:1})}}});const at=V($,[["__scopeId","data-v-28d0d34e"]]);export{at as default};

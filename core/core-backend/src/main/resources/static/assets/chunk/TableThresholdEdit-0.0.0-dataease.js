import"./index-0.0.0-dataease.js";import{E as me}from"./el-radio-button-0.0.0-dataease.js";import{o as ye,n as he,j as be,y as ge,G as ve}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{E as xe}from"./el-input-number-0.0.0-dataease.js";import"./el-radio-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import{E as Ve}from"./el-col-0.0.0-dataease.js";import{E as ke,a as Ce,b as Te}from"./el-select-0.0.0-dataease.js";import{E as Ne}from"./el-row-0.0.0-dataease.js";import{a as Se}from"./el-form-item-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{d as Je,Z as Ue,f as o,g as c,i as a,M as O,k as n,j as i,a6 as S,L as b,a9 as v,Y as x,m as q,U as $,a5 as A,a0 as V,ab as Z}from"./vue-0.0.0-dataease.js";import{i as Ee}from"./icon_info_filled-0.0.0-dataease.js";import{i as H}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as Q}from"./icon_add_outlined-0.0.0-dataease.js";import{a as Me}from"./chart-0.0.0-dataease.js";import{f as J}from"./attr-0.0.0-dataease20.js";import{i as j}from"./field-list-0.0.0-dataease.js";import{d as Oe}from"./lodash-0.0.0-dataease.js";import{_ as Ae}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./index-0.0.0-dataease3.js";import"./position-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./index-0.0.0-dataease17.js";import"./row-0.0.0-dataease.js";import"./index-0.0.0-dataease16.js";import"./strings-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";const Fe={class:"tip"},Ie={style:{"padding-left":"10px"}},we={style:{margin:"0 -5px"}},qe={style:{margin:"0 -5px"}},$e={style:{display:"flex","align-items":"center","justify-content":"center"}},je=Je({__name:"TableThresholdEdit",props:{chart:{type:Object,required:!0},threshold:{type:Array,required:!0}},emits:["onTableThresholdChange"],setup(E,{emit:W}){const{t:d}=ye(),T=E,X=W,ee={term:"",field:"0",value:"0",color:"#ff0000ff",backgroundColor:"#ffffff00",min:"0",max:"1",type:"fixed",dynamicField:{summary:"value"},dynamicMinField:{summary:"value"},dynamicMaxField:{summary:"value"}},le=[{label:"",options:[{value:"eq",label:d("chart.filter_eq")},{value:"not_eq",label:d("chart.filter_not_eq")}]},{label:"",options:[{value:"like",label:d("chart.filter_like")},{value:"not like",label:d("chart.filter_not_like")}]},{label:"",options:[{value:"null",label:d("chart.filter_null")},{value:"not_null",label:d("chart.filter_not_null")}]}],ae=[{label:"",options:[{value:"eq",label:d("chart.filter_eq")},{value:"not_eq",label:d("chart.filter_not_eq")}]},{label:"",options:[{value:"lt",label:d("chart.filter_lt")},{value:"gt",label:d("chart.filter_gt")}]},{label:"",options:[{value:"le",label:d("chart.filter_le")},{value:"ge",label:d("chart.filter_ge")}]}],ne=[{label:"",options:[{value:"eq",label:d("chart.filter_eq")},{value:"not_eq",label:d("chart.filter_not_eq")}]},{label:"",options:[{value:"lt",label:d("chart.filter_lt")},{value:"gt",label:d("chart.filter_gt")}]},{label:"",options:[{value:"le",label:d("chart.filter_le")},{value:"ge",label:d("chart.filter_ge")}]},{label:"",options:[{value:"between",label:d("chart.filter_between")}]}],K=Me,_=Ue({thresholdArr:[],fields:[],thresholdObj:{fieldId:"",field:{},conditions:[]}}),te=()=>{_.thresholdArr=JSON.parse(JSON.stringify(T.threshold)),oe()},I=(t,s)=>{s&&([0,5,7].includes(s.deType)?t.options=JSON.parse(JSON.stringify(le)):s.deType===1?t.options=JSON.parse(JSON.stringify(ae)):t.options=JSON.parse(JSON.stringify(ne)),t.conditions&&t.conditions.forEach(r=>{r.term=""}))},oe=()=>{let t=[];if(T.chart.type==="table-info")t=JSON.parse(JSON.stringify(T.chart.xAxis));else if(T.chart.type==="table-pivot"){const r=JSON.parse(JSON.stringify(T.chart.xAxis)),f=JSON.parse(JSON.stringify(T.chart.xAxisExt)),u=JSON.parse(JSON.stringify(T.chart.yAxis));t=[...r,...f,...u]}else{const r=JSON.parse(JSON.stringify(T.chart.xAxis)),f=JSON.parse(JSON.stringify(T.chart.yAxis));t=[...r,...f]}_.fields.splice(0,_.fields.length,...t);let s=!1;_.thresholdArr.forEach(r=>{_.fields.filter(u=>u.id===r.fieldId).length===0&&(s=!0,r.fieldId=null)}),s&&y()},de=()=>{_.thresholdArr.push(JSON.parse(JSON.stringify(_.thresholdObj))),y()},se=t=>{_.thresholdArr.splice(t,1),y()},y=()=>{X("onTableThresholdChange",_.thresholdArr)},re=t=>{var f,u;const s=JSON.parse(JSON.stringify(ee)),r=(u=(f=T.chart)==null?void 0:f.customAttr)==null?void 0:u.tableCell;r&&(s.backgroundColor=Oe(r.tableItemBgColor)),t.conditions.push(s),y()},ie=(t,s)=>{t.conditions.splice(s,1),y()},F=t=>{_.fields&&_.fields.length>0&&_.fields.forEach(s=>{var r,f,u;t.fieldId===s.id&&(t.field=JSON.parse(JSON.stringify(s)),I(t,t.field)),((r=t.dynamicField)==null?void 0:r.fieldId)===s.id&&(t.dynamicField.field=JSON.parse(JSON.stringify(s)),I(t,t.dynamicField.field)),((f=t.dynamicMinField)==null?void 0:f.fieldId)===s.id&&(t.dynamicMinField.field=JSON.parse(JSON.stringify(s)),I(t,t.dynamicMinField.field)),((u=t.dynamicMaxField)==null?void 0:u.fieldId)===s.id&&(t.dynamicMaxField.field=JSON.parse(JSON.stringify(s)),I(t,t.dynamicMaxField.field))}),y()},ce=[{label:d("chart.field_fixed"),value:"fixed"},{label:d("chart.field_dynamic"),value:"dynamic"}],B=[{id:"value",name:d("chart.field")+d("chart.drag_block_label_value")},{id:"avg",name:d("chart.avg")+d("chart.drag_block_label_value")},{id:"max",name:d("chart.max")},{id:"min",name:d("chart.min")}],D=(t,s,r)=>{var m,U,M,w;const f=_.fields.filter(p=>p.id===t.fieldId);if(f.length===0||((m=f[0])==null?void 0:m.deType)===void 0||((U=f[0])==null?void 0:U.deType)===null)return t.fieldId=null,s.fieldId=null,r.fieldId=null,[];const u=(M=f[0])==null?void 0:M.deType,h=_.fields.filter(p=>[0,1,4,5].includes(u)?p.deType===u:[2,3].includes(u)?p.deType===2||p.deType===3:!1)??[];return h.find(p=>p.id===r.fieldId)||(r.fieldId=(w=h[0])==null?void 0:w.id,F(s)),h},z=t=>{var r,f;const s=(f=(r=_.fields.filter(u=>u.id===t))==null?void 0:r[0])==null?void 0:f.deType;return s===1?B.filter(u=>u.id!=="avg"):s===0||s===5?B.filter(u=>u.id==="value"):B},N=t=>!t.term.includes("null")&&!t.term.includes("empty"),k=t=>t.term==="between",C=t=>t.type==="dynamic",ue=t=>{t.type==="dynamic"&&(t.dynamicField.summary="value",t.dynamicMinField.summary="value",t.dynamicMaxField.summary="value")},fe=t=>ce;return te(),(t,s)=>{const r=he,f=be,u=ke,h=Ce,m=Se,U=ge,M=Ne,w=Te,p=Ve,L=xe,pe=ve,P=me;return o(),c(p,null,{default:a(()=>[O("div",Fe,[n(r,{name:"icon_info_filled",class:"icon-style"},{default:a(()=>[n(i(Ee),{class:"svg-icon icon-style"})]),_:1}),O("span",Ie,S(i(d)("chart.table_threshold_tip")),1)]),O("div",{onKeydown:s[0]||(s[0]=Z(()=>{},["stop"])),onKeyup:s[1]||(s[1]=Z(()=>{},["stop"])),style:{"max-height":"50vh","overflow-y":"auto"}},[(o(!0),b(x,null,v(_.thresholdArr,(g,R)=>(o(),b("div",{key:R,class:"field-item"},[n(M,{style:{"margin-top":"6px","align-items":"center","justify-content":"space-between"}},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[n(h,{modelValue:g.fieldId,"onUpdate:modelValue":e=>g.fieldId=e,onChange:e=>F(g)},{default:a(()=>[(o(!0),b(x,null,v(_.fields,e=>(o(),c(u,{class:"series-select-option",key:e.id,label:e.name,value:e.id,disabled:E.chart.type==="table-info"&&e.deType===7},{default:a(()=>[n(f,{style:{"margin-right":"8px"}},{default:a(()=>[n(r,null,{default:a(()=>[(o(),c(q(i(j)[i(J)[e.deType]]),{class:$([`field-icon-${i(J)[[2,3].includes(e.deType)?2:0]}`,"svg-icon"])},null,8,["class"]))]),_:2},1024)]),_:2},1024),A(" "+S(e.name),1)]),_:2},1032,["label","value","disabled"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024),n(U,{class:"circle-button m-icon-btn",text:"",style:{float:"right"},onClick:e=>se(R)},{default:a(()=>[n(f,{size:"20px",style:{color:"#646a73"}},{default:a(()=>[n(r,{name:"icon_delete-trash_outlined"},{default:a(()=>[n(i(H),{class:"svg-icon"})]),_:1})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),n(M,{style:{marginTop:"16px",borderTop:"1px solid #d5d6d8"}},{default:a(()=>[(o(!0),b(x,null,v(g.conditions,(e,Y)=>(o(),c(M,{key:Y,class:"line-item",gutter:12},{default:a(()=>[n(p,{span:3},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[n(h,{modelValue:e.term,"onUpdate:modelValue":l=>e.term=l,onChange:y},{default:a(()=>[(o(!0),b(x,null,v(g.options,(l,_e)=>(o(),c(w,{key:_e,label:l.label},{default:a(()=>[(o(!0),b(x,null,v(l.options,G=>(o(),c(u,{key:G.value,label:G.label,value:G.value},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),N(e)&&E.chart.type!=="rich-text"?(o(),c(p,{key:0,span:2,style:{"padding-left":"0 !important"}},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[n(h,{modelValue:e.type,"onUpdate:modelValue":l=>e.type=l,class:"select-item",onChange:l=>ue(e),style:{width:"100%"}},{default:a(()=>[(o(!0),b(x,null,v(fe(g),l=>(o(),c(u,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&!k(e)&&!C(e)?(o(),c(p,{key:1,span:12,style:{"text-align":"center"}},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[[2,3].includes(g.field.deType)?(o(),c(L,{key:0,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:i(d)("chart.drag_block_label_value"),"controls-position":"right",class:"value-item",clearable:"",onChange:y},null,8,["modelValue","onUpdate:modelValue","placeholder"])):(o(),c(pe,{key:1,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:i(d)("chart.drag_block_label_value"),"controls-position":"right",clearable:"",onChange:y},null,8,["modelValue","onUpdate:modelValue","placeholder"]))]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&!k(e)&&C(e)?(o(),c(p,{key:2,span:6},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[n(h,{modelValue:e.dynamicField.fieldId,"onUpdate:modelValue":l=>e.dynamicField.fieldId=l,onChange:l=>F(e),style:{width:"100%"}},{default:a(()=>[(o(!0),b(x,null,v(D(g,e,e.dynamicField),l=>(o(),c(u,{class:"series-select-option",key:l.id,label:l.name,value:l.id,disabled:E.chart.type==="table-info"&&l.deType===7},{default:a(()=>[n(f,{style:{"margin-right":"8px"}},{default:a(()=>[n(r,null,{default:a(()=>[(o(),c(q(i(j)[i(J)[l.deType]]),{class:$([`field-icon-${i(J)[[2,3].includes(l.deType)?2:0]}`,"svg-icon"])},null,8,["class"]))]),_:2},1024)]),_:2},1024),A(" "+S(l.name),1)]),_:2},1032,["label","value","disabled"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&!k(e)&&C(e)?(o(),c(p,{key:3,span:6,style:{"text-align":"center"}},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[n(h,{placeholder:i(d)("chart.aggregation"),modelValue:e.dynamicField.summary,"onUpdate:modelValue":l=>e.dynamicField.summary=l,onChange:y,style:{width:"100%"}},{default:a(()=>[(o(!0),b(x,null,v(z(e.dynamicField.fieldId),l=>(o(),c(u,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:2},1032,["placeholder","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&k(e)&&!C(e)?(o(),c(p,{key:4,span:5,style:{"text-align":"center"}},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[n(L,{modelValue:e.min,"onUpdate:modelValue":l=>e.min=l,"controls-position":"right",class:"between-item",placeholder:i(d)("chart.axis_value_min"),clearable:"",onChange:y},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)]),_:2},1024)):V("",!0),k(e)&&!C(e)?(o(),c(p,{key:5,span:2,style:{"margin-top":"4px","text-align":"center"}},{default:a(()=>[O("span",we," ≤ "+S(i(d)("chart.drag_block_label_value"))+" ≤ ",1)]),_:1})):V("",!0),N(e)&&k(e)&&!C(e)?(o(),c(p,{key:6,span:5,style:{"text-align":"center"}},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[n(L,{modelValue:e.max,"onUpdate:modelValue":l=>e.max=l,"controls-position":"right",class:"between-item",placeholder:i(d)("chart.axis_value_max"),clearable:"",onChange:y},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&k(e)&&C(e)?(o(),c(p,{key:7,class:"minField",span:3},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[n(h,{modelValue:e.dynamicMinField.fieldId,"onUpdate:modelValue":l=>e.dynamicMinField.fieldId=l,onChange:l=>F(e)},{default:a(()=>[(o(!0),b(x,null,v(D(g,e,e.dynamicMinField),l=>(o(),c(u,{class:"series-select-option",key:l.id,label:l.name,value:l.id,disabled:E.chart.type==="table-info"&&l.deType===7},{default:a(()=>[n(f,{style:{"margin-right":"8px"}},{default:a(()=>[n(r,null,{default:a(()=>[(o(),c(q(i(j)[i(J)[l.deType]]),{class:$([`field-icon-${i(J)[[2,3].includes(l.deType)?2:0]}`,"svg-icon"])},null,8,["class"]))]),_:2},1024)]),_:2},1024),A(" "+S(l.name),1)]),_:2},1032,["label","value","disabled"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&k(e)&&C(e)?(o(),c(p,{key:8,class:"minValue",span:2,style:{"padding-left":"0 !important"}},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[n(h,{modelValue:e.dynamicMinField.summary,"onUpdate:modelValue":l=>e.dynamicMinField.summary=l,onChange:y},{default:a(()=>[(o(!0),b(x,null,v(z(e.dynamicMinField.fieldId),l=>(o(),c(u,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):V("",!0),k(e)&&C(e)?(o(),c(p,{key:9,class:"term",span:2,style:{"margin-top":"4px","text-align":"center"}},{default:a(()=>[O("span",qe," ≤ "+S(i(d)("chart.drag_block_label_value"))+" ≤ ",1)]),_:1})):V("",!0),N(e)&&k(e)&&C(e)?(o(),c(p,{key:10,class:"maxField",span:3},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[n(h,{modelValue:e.dynamicMaxField.fieldId,"onUpdate:modelValue":l=>e.dynamicMaxField.fieldId=l,onChange:l=>F(e)},{default:a(()=>[(o(!0),b(x,null,v(D(g,e,e.dynamicMaxField),l=>(o(),c(u,{class:"series-select-option",key:l.id,label:l.name,value:l.id,disabled:E.chart.type==="table-info"&&l.deType===7},{default:a(()=>[n(f,{style:{"margin-right":"8px"}},{default:a(()=>[n(r,null,{default:a(()=>[(o(),c(q(i(j)[i(J)[l.deType]]),{class:$([`field-icon-${i(J)[[2,3].includes(l.deType)?2:0]}`,"svg-icon"])},null,8,["class"]))]),_:2},1024)]),_:2},1024),A(" "+S(l.name),1)]),_:2},1032,["label","value","disabled"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)]),_:2},1024)):V("",!0),N(e)&&k(e)&&C(e)?(o(),c(p,{key:11,class:"maxValue",span:2,style:{"padding-left":"0 !important"}},{default:a(()=>[n(m,{class:"form-item"},{default:a(()=>[n(h,{modelValue:e.dynamicMaxField.summary,"onUpdate:modelValue":l=>e.dynamicMaxField.summary=l,onChange:y},{default:a(()=>[(o(!0),b(x,null,v(z(e.dynamicMaxField.fieldId),l=>(o(),c(u,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):V("",!0),n(p,{span:3},{default:a(()=>[n(m,{class:"form-item",label:i(d)("chart.textColor")},{default:a(()=>[n(P,{"is-custom":"",size:"large",modelValue:e.color,"onUpdate:modelValue":l=>e.color=l,"show-alpha":"",class:"color-picker-style",predefine:i(K),onChange:y},null,8,["modelValue","onUpdate:modelValue","predefine"])]),_:2},1032,["label"])]),_:2},1024),n(p,{span:3},{default:a(()=>[n(m,{class:"form-item",label:i(d)("chart.backgroundColor")},{default:a(()=>[n(P,{"is-custom":"",size:"large",modelValue:e.backgroundColor,"onUpdate:modelValue":l=>e.backgroundColor=l,"show-alpha":"",class:"color-picker-style",predefine:i(K),onChange:y},null,8,["modelValue","onUpdate:modelValue","predefine"])]),_:2},1032,["label"])]),_:2},1024),n(p,{span:1},{default:a(()=>[O("div",$e,[n(U,{class:"circle-button m-icon-btn",text:"",onClick:l=>ie(g,Y)},{default:a(()=>[n(f,{size:"20px",style:{color:"#646a73"}},{default:a(()=>[n(r,{name:"icon_delete-trash_outlined"},{default:a(()=>[n(i(H),{class:"svg-icon"})]),_:1})]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024),n(U,{style:{"margin-top":"10px"},class:"circle-button",type:"primary",text:"",onClick:e=>re(g)},{icon:a(()=>[n(r,{name:"icon_add_outlined"},{default:a(()=>[n(i(Q),{class:"svg-icon"})]),_:1})]),default:a(()=>[A(" "+S(i(d)("chart.add_style")),1)]),_:2},1032,["onClick"])]))),128))],32),n(U,{class:"circle-button",text:"",type:"primary",style:{"margin-top":"10px"},onClick:de},{icon:a(()=>[n(r,{name:"icon_add_outlined"},{default:a(()=>[n(i(Q),{class:"svg-icon"})]),_:1})]),default:a(()=>[A(" "+S(i(d)("chart.add_condition")),1)]),_:1})]),_:1})}}});const gl=Ae(je,[["__scopeId","data-v-cbbcee7e"]]);export{gl as default};

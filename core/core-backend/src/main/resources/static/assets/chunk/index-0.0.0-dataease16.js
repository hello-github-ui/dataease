import{p as K,n as il,o as nl,L as sl,d as T,s as rl,a as dl,f as ml,x as cl,y as ul,e as pl,h as fl,z as vl,w as hl,r as gl,O as yl,A as xl,P as Cl,a6 as kl,Q as _l,R as bl,k as wl,I as El,J as Sl,G as Al,m as Fl,v as Il}from"./element-plus-secondary-0.0.0-dataease.js";import{d as Tl,r as z,k as U,t as ql,R as Nl,e as Dl,b as Ol,l as Aa,w as Ke,ah as vt,ak as Vl,o as c,c as F,a as p,u as o,Z as y,_ as n,Y as h,W as ht,a0 as i,z as g,a1 as j,al as Ml,aa as Bl,M as ce,n as Ne,q as gt,a2 as C,a3 as Xe,$ as Qe,ab as Le,a4 as D}from"./@vue-0.0.0-dataease.js";import{d as zl}from"./dv-info-0.0.0-dataease.js";import{i as $l}from"./icon_down_outlined-1-0.0.0-dataease.js";import{i as X}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{i as yt}from"./icon_info_outlined-0.0.0-dataease.js";import{i as Fa}from"./icon-filter-0.0.0-dataease.js";import{i as Pl}from"./icon_edit_outlined-0.0.0-dataease.js";import{i as Rl}from"./icon_refresh_outlined-0.0.0-dataease.js";import{i as Ql}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{i as Ia}from"./icon_copy_outlined-0.0.0-dataease.js";import{j as Ll,h as I,l as Jl}from"./ConfigGlobal.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{useAppStoreWithOut as Ul}from"./app-0.0.0-dataease.js";import{a as jl,b as Wl,u as te}from"./index-0.0.0-dataease.js";import{d as ne}from"./vuedraggable-0.0.0-dataease.js";import Ce from"./DimensionItem-0.0.0-dataease.js";import{f as ke}from"./attr-0.0.0-dataease20.js";import Je from"./QuotaItem-0.0.0-dataease.js";import se from"./DragPlaceholder-0.0.0-dataease.js";import{_ as Hl}from"./FilterTree.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import Ta from"./ChartStyle-0.0.0-dataease.js";import qa from"./VQueryChartStyle-0.0.0-dataease.js";import Yl from"./Senior-0.0.0-dataease.js";import Gl from"./QuotaFilterEditor-0.0.0-dataease.js";import Kl from"./ResultFilterEditor-0.0.0-dataease.js";import Xl from"./DrillItem-0.0.0-dataease.js";import{d as Zl}from"./dvMain-0.0.0-dataease.js";import{s as ei}from"./pinia-0.0.0-dataease.js";import{B as ti,n as Na}from"./chart-0.0.0-dataease.js";import ai from"./ChartType-0.0.0-dataease.js";import{u as oi,b as li}from"./vue-router-0.0.0-dataease.js";import ii from"./CompareEdit-0.0.0-dataease.js";import ni from"./ValueFormatterEdit-0.0.0-dataease.js";import si from"./CustomSortEdit-0.0.0-dataease.js";import ri from"./SortPriorityEdit-0.0.0-dataease.js";import{s as di}from"./snapshot-0.0.0-dataease.js";import mi from"./CalcFieldEdit-0.0.0-dataease.js";import{b as ci,g as ui}from"./util-0.0.0-dataease.js";import{z as Da,A as pi}from"./dataset-0.0.0-dataease.js";import{F as fi,G as vi}from"./util-0.0.0-dataease2.js";import{c as Oa}from"./index-0.0.0-dataease12.js";import hi from"./DatasetSelect-0.0.0-dataease.js";import{q as gi}from"./@vueuse-0.0.0-dataease.js";import{_ as Ze}from"./PluginComponent.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{g as yi,c as xi,d as Ci}from"./chart-0.0.0-dataease2.js";import ki from"./ChartTemplateInfo-0.0.0-dataease.js";import{a as _i}from"./chart-list-0.0.0-dataease.js";import{i as xt}from"./field-list-0.0.0-dataease.js";import{i as bi,a as wi}from"./field-calculated-list-0.0.0-dataease.js";import{d as Ei}from"./canvasUtils-0.0.0-dataease.js";import{K as Si,e as qe,C as Ai,g as et,s as tt,v as Va}from"./lodash-es-0.0.0-dataease.js";import{_ as Fi}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./@element-plus-0.0.0-dataease.js";import"./dayjs-0.0.0-dataease.js";import"./@amap-0.0.0-dataease.js";import"./async-validator-0.0.0-dataease.js";import"./@ctrl-0.0.0-dataease.js";import"./@popperjs-0.0.0-dataease.js";import"./escape-html-0.0.0-dataease.js";import"./normalize-wheel-es-0.0.0-dataease.js";import"./memoize-one-0.0.0-dataease.js";import"./jspdf-0.0.0-dataease.js";import"./@babel-0.0.0-dataease.js";import"./fflate-0.0.0-dataease.js";import"./vue-i18n-0.0.0-dataease.js";import"./@intlify-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./qs-0.0.0-dataease.js";import"./side-channel-0.0.0-dataease.js";import"./es-errors-0.0.0-dataease.js";import"./object-inspect-0.0.0-dataease.js";import"./crypto-js-0.0.0-dataease.js";import"./side-channel-list-0.0.0-dataease.js";import"./side-channel-map-0.0.0-dataease.js";import"./get-intrinsic-0.0.0-dataease.js";import"./es-object-atoms-0.0.0-dataease.js";import"./math-intrinsics-0.0.0-dataease.js";import"./gopd-0.0.0-dataease.js";import"./es-define-property-0.0.0-dataease.js";import"./has-symbols-0.0.0-dataease.js";import"./get-proto-0.0.0-dataease.js";import"./dunder-proto-0.0.0-dataease.js";import"./call-bind-apply-helpers-0.0.0-dataease.js";import"./function-bind-0.0.0-dataease.js";import"./hasown-0.0.0-dataease.js";import"./call-bound-0.0.0-dataease.js";import"./side-channel-weakmap-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./vue-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./zrender-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./web-storage-cache-0.0.0-dataease.js";import"./vue-demi-0.0.0-dataease.js";import"./mitt-0.0.0-dataease.js";import"./vue-types-0.0.0-dataease.js";import"./is-plain-object-0.0.0-dataease.js";import"./icon_sort_outlined-0.0.0-dataease.js";import"./icon_right_outlined-0.0.0-dataease.js";import"./icon_done_outlined-0.0.0-dataease.js";import"./icon_visible_outlined-0.0.0-dataease.js";import"./icon_invisible_outlined-0.0.0-dataease.js";import"./utils-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./RowAuth-0.0.0-dataease.js";import"./AuthTree-0.0.0-dataease.js";import"./FilterFiled-0.0.0-dataease.js";import"./icon_close_outlined-0.0.0-dataease.js";import"./TimeDialog-0.0.0-dataease.js";import"./time-format-0.0.0-dataease.js";import"./options-0.0.0-dataease.js";import"./icon_down_outlined-0.0.0-dataease.js";import"./MiscSelector-0.0.0-dataease.js";import"./LabelSelector-0.0.0-dataease.js";import"./StringUtils-0.0.0-dataease.js";import"./TooltipSelector-0.0.0-dataease.js";import"./XAxisSelector-0.0.0-dataease.js";import"./YAxisSelector-0.0.0-dataease.js";import"./DualYAxisSelector-0.0.0-dataease.js";import"./DualYAxisSelectorInner-0.0.0-dataease.js";import"./TitleSelector-0.0.0-dataease.js";import"./icon_letter-spacing_outlined-0.0.0-dataease.js";import"./icon_italic_outlined-0.0.0-dataease.js";import"./icon_right-alignment_outlined-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./less-0.0.0-dataease.js";import"./tslib-0.0.0-dataease.js";import"./copy-anything-0.0.0-dataease.js";import"./is-what-0.0.0-dataease.js";import"./LegendSelector-0.0.0-dataease.js";import"./icon_bottom-align_outlined-0.0.0-dataease.js";import"./CollapseSwitchItem-0.0.0-dataease.js";import"./BasicStyleSelector-0.0.0-dataease.js";import"./CustomColorStyleSelect-0.0.0-dataease.js";import"./icon_admin_outlined-0.0.0-dataease.js";import"./GradientColorSelector-0.0.0-dataease.js";import"./@antv-0.0.0-dataease.js";import"./eventemitter3-0.0.0-dataease.js";import"./@mapbox-0.0.0-dataease.js";import"./pbf-0.0.0-dataease.js";import"./ieee754-0.0.0-dataease.js";import"./supercluster-0.0.0-dataease.js";import"./gl-matrix-0.0.0-dataease.js";import"./topojson-client-0.0.0-dataease.js";import"./viewport-mercator-project-0.0.0-dataease.js";import"./@turf-0.0.0-dataease.js";import"./polygon-clipping-0.0.0-dataease.js";import"./splaytree-0.0.0-dataease.js";import"./robust-predicates-0.0.0-dataease.js";import"./d3-scale-0.0.0-dataease.js";import"./d3-collection-0.0.0-dataease.js";import"./d3-format-0.0.0-dataease.js";import"./d3-time-format-0.0.0-dataease.js";import"./d3-time-0.0.0-dataease.js";import"./d3-color-0.0.0-dataease.js";import"./d3-array-0.0.0-dataease.js";import"./earcut-0.0.0-dataease.js";import"./regl-0.0.0-dataease.js";import"./mapbox-gl-0.0.0-dataease.js";import"./d3-dsv-0.0.0-dataease.js";import"./geojson-vt-0.0.0-dataease.js";import"./hammerjs-0.0.0-dataease.js";import"./element-resize-detector-0.0.0-dataease.js";import"./batch-processor-0.0.0-dataease.js";import"./d3-hexbin-0.0.0-dataease.js";import"./detect-browser-0.0.0-dataease.js";import"./d3-ease-0.0.0-dataease.js";import"./d3-interpolate-0.0.0-dataease.js";import"./d3-timer-0.0.0-dataease.js";import"./fecha-0.0.0-dataease.js";import"./size-sensor-0.0.0-dataease.js";import"./d3-regression-0.0.0-dataease.js";import"./d3-hierarchy-0.0.0-dataease.js";import"./fmin-0.0.0-dataease.js";import"./pdfast-0.0.0-dataease.js";import"./SymbolicStyleSelector-0.0.0-dataease.js";import"./DualBasicStyleSelector-0.0.0-dataease.js";import"./CommonBorderSetting.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./style-0.0.0-dataease.js";import"./translate-0.0.0-dataease.js";import"./mathjs-0.0.0-dataease.js";import"./decimal.js-0.0.0-dataease.js";import"./typed-function-0.0.0-dataease.js";import"./complex.js-0.0.0-dataease.js";import"./imgUtils-0.0.0-dataease.js";import"./html2canvas-0.0.0-dataease.js";import"./file-saver-0.0.0-dataease.js";import"./html-to-image-0.0.0-dataease.js";import"./BackgroundOverallCommon-0.0.0-dataease.js";import"./board-list-0.0.0-dataease.js";import"./ImgViewDialog-0.0.0-dataease.js";import"./TableHeaderSelector-0.0.0-dataease.js";import"./TableHeaderGroupConfig-0.0.0-dataease.js";import"./vue-uuid-0.0.0-dataease.js";import"./uuid-0.0.0-dataease.js";import"./TableCellSelector-0.0.0-dataease.js";import"./TableTotalSelector-0.0.0-dataease.js";import"./CustomAggrEdit-0.0.0-dataease.js";import"./icon_adjustment_outlined-0.0.0-dataease.js";import"./CodeMirror-0.0.0-dataease2.js";import"./@codemirror-0.0.0-dataease.js";import"./@lezer-0.0.0-dataease.js";import"./style-mod-0.0.0-dataease.js";import"./crelt-0.0.0-dataease.js";import"./@marijn-0.0.0-dataease.js";import"./w3c-keyname-0.0.0-dataease.js";import"./codemirror-0.0.0-dataease.js";import"./MiscStyleSelector-0.0.0-dataease.js";import"./IndicatorValueSelector-0.0.0-dataease.js";import"./IndicatorNameSelector-0.0.0-dataease.js";import"./QuadrantSelector-0.0.0-dataease.js";import"./FlowMapLineSelector-0.0.0-dataease.js";import"./FlowMapPointSelector-0.0.0-dataease.js";import"./FunctionCfg-0.0.0-dataease.js";import"./ScrollCfg-0.0.0-dataease.js";import"./AssistLine-0.0.0-dataease.js";import"./AssistLineEdit-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./Threshold-0.0.0-dataease.js";import"./TableThresholdEdit-0.0.0-dataease.js";import"./icon_info_filled-0.0.0-dataease.js";import"./TextLabelThresholdEdit-0.0.0-dataease.js";import"./TextThresholdEdit-0.0.0-dataease.js";import"./LineThresholdEdit-0.0.0-dataease.js";import"./PictureGroupThresholdEdit-0.0.0-dataease.js";import"./MapMapping-0.0.0-dataease.js";import"./LinkageSet-0.0.0-dataease.js";import"./dv-link-target-0.0.0-dataease.js";import"./dv-dashboard-spine-0.0.0-dataease.js";import"./dv-folder-0.0.0-dataease.js";import"./dv-screen-spine-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./EmptyBackground-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./treeSortUtils-0.0.0-dataease.js";import"./dv-empty-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./BubbleAnimateCfg-0.0.0-dataease.js";import"./CarouselSetting.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./vant-0.0.0-dataease.js";import"./@vant-0.0.0-dataease.js";import"./chart-dark-list-0.0.0-dataease.js";import"./icon_drag_outlined-0.0.0-dataease.js";import"./eventBus-0.0.0-dataease.js";import"./snowflake-id-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./exceljs-0.0.0-dataease.js";import"./icon_dataset-0.0.0-dataease.js";import"./ModelUtil-0.0.0-dataease.js";const Ii={key:0,class:"collapse-title"},Ti={style:{"font-size":"14px"}},qi={key:1,style:{width:"240px"},class:"view-panel-row"},Ni={style:{display:"flex","align-items":"center",width:"calc(100% - 24px)"}},Di={style:{"margin-bottom":"4px","font-size":"14px",color:"#646a73"}},Oi={style:{"font-size":"14px",color:"#1f2329"}},Vi={class:"query-style-tab"},Mi={style:{"padding-top":"1px"}},Bi={class:"data-area-label"},zi={class:"data-area-label"},$i={class:"area-tree-select"},Pi={class:"form-draggable-title"},Ri={key:0,class:"required"},Qi={class:"form-draggable-title"},Li={key:0,class:"required"},Ji={class:"form-draggable-title"},Ui={key:0,class:"required"},ji={class:"form-draggable-title"},Wi={key:0,class:"required"},Hi={class:"form-draggable-title"},Yi={key:0,class:"required"},Gi={class:"form-draggable-title"},Ki={key:0,class:"required"},Xi={class:"form-draggable-title"},Zi={class:"data-area-label"},en={style:{"margin-right":"4px"}},tn={key:0,class:"required"},an={class:"form-draggable-title"},on={key:0,class:"required"},ln={class:"form-draggable-title"},nn={key:0,class:"required"},sn={class:"form-draggable-title"},rn={key:0,class:"required"},dn={class:"form-draggable-title"},mn={key:0,class:"required"},cn={class:"form-draggable-title"},un={class:"data-area-label"},pn={style:{"margin-right":"4px"}},fn={key:0,class:"required"},vn={class:"form-draggable-title"},hn={class:"data-area-label"},gn={style:{"margin-right":"4px"}},yn={class:"form-draggable-title"},xn={class:"result-style-input"},Cn={key:0},kn={key:1,style:{"padding-left":"8px"}},_n={style:{"font-size":"12px"}},bn={key:0,class:"collapse-title"},wn={style:{"font-size":"14px"}},En={style:{"font-size":"14px"}},Sn=["onClick","onDragstart"],An=["title"];const Fn=["onClick","onDragstart"],In=["title"];const Tn={class:"text"},qn={class:"dialog-footer"},Nn={class:"dialog-footer"},Dn={class:"dialog-footer"},On={class:"dialog-footer"},Vn={class:"dialog-footer"},Mn={class:"dialog-footer"},Bn={style:{"font-size":"15px","font-weight":"bold",color:"black"}},zn={class:"dialog-footer"},$n=["effect"],Pn=Tl({__name:"index",props:{view:{type:Object,required:!1,default(){return{...ti}}},datasetTree:{type:Array,default:()=>[]},themes:{type:String,default:"dark"}},setup(f){const{wsCache:at}=jl("localStorage"),ot=Wl(),Ee=di(),Ma=Zl(),{canvasCollapse:re,curComponent:q,componentData:Ba,editMode:za,mobileInPc:_e,fullscreenFlag:$a,dvInfo:Ue}=ei(Ma),Ct=li();let je=z(!1),W=z({id:null,name:null}),kt=z(null);const{t:v}=Ll(),Pa=z(!1),_t=z("data"),We=z(null),bt=z(0),wt=z(),{emitter:L}=te({name:"set-table-column-width",callback:e=>qo(e)}),P=f,De=z(!1),lt=z(!0),Oe=z(),Ra=oi(),Qa=()=>{Ee.recordSnapshotCache("onComponentNameChange")},La=()=>{if(je.value=!1,q.value.id===W.value.id&&!(!W.value.name||!W.value.name.trim())&&W.value.name.trim()!==a.value.title){if(W.value.name.trim().length>64||W.value.name.trim().length<2){K.warning("名称字段长度2-64个字符"),Et();return}a.value.title=W.value.name,a.value.type==="VQuery"&&(a.value.customStyle.component.title=W.value.name),q.value&&(q.value.label=W.value.name,q.value.name=W.value.name),W.value.name="",W.value.id=""}},Et=()=>{je.value=!0,W.value.name=a.value.title,W.value.id=a.value.id,Ne(()=>{kt.value.focus()})},R=U(()=>P.themes==="dark"?"ndark":"dark"),St=U(()=>a.value.dataFrom==="template"&&!_e.value),{view:a}=ql(P);let Ve="";const Ja=e=>{e&&e.forEach(t=>Y(t))};Nl(()=>{Ve=Ra.query.id}),Dl(()=>{Ve=""}),Ol(()=>{te({name:"clear-remove",callback:Ja})});const He=Ul(),Ua=U(()=>He.getIsDataEaseBi||He.getIsIframe),ja=Aa({chartShowName:[{required:!0,message:v("commons.input_content"),trigger:"change"},{max:50,message:v("commons.char_can_not_more_50"),trigger:"change"}]}),l=Aa({extData:"",moveId:-1,dimension:[],quota:[],dimensionData:[],quotaData:[],renameItem:!1,itemForm:{name:"",chartShowName:"",index:0,renameType:""},quotaFilterEdit:!1,quotaItem:{},resultFilterEdit:!1,filterItem:{},chartForFilter:{},searchField:"",quotaItemCompare:{},showEditQuotaCompare:!1,showValueFormatter:!1,valueFormatterItem:{},showCustomSort:!1,showSortPriority:!1,sortPriority:[],customSortList:[],customSortField:{},currEditField:{},worldTree:[],areaId:"",chartTypeOptions:[],useless:null}),Wa=U(()=>[...l.dimension,...l.quota].filter(e=>e.id!=="count"&&!!e.summary));gt("filedList",()=>Wa.value),gt("quota",()=>l.quota),Ke([()=>a.value.tableId],()=>{Ne(()=>{var s;if(P.view.type==="picture-group")return;Se(P.view.tableId,P.view.id,P.view.type);const e=a.value.tableId;e&&(Ve=e);const t=(s=We==null?void 0:We.value)==null?void 0:s.getNode(e);t!=null&&t.data&&(bt.value=t.data.weight)})},{deep:!0,immediate:!0});const Se=(e,t,s)=>{e&&t?(ye.value=!0,yi(e,t,{type:s}).then(u=>{l.dimension=u.dimensionList||[],l.quota=u.quotaList||[],l.dimensionData=JSON.parse(JSON.stringify(l.dimension)),l.quotaData=JSON.parse(JSON.stringify(l.quota)),ye.value=!1,L.emit("dataset-change")}).catch(()=>{l.dimension=[],l.quota=[],l.dimensionData=[],l.quotaData=[],ye.value=!1})):(l.dimension=[],l.quota=[],l.dimensionData=[],l.quotaData=[],ye.value=!1)},At=U(()=>!["richText","Picture"].includes(a.value.type)&&q.value&&q.value.component==="UserView"),E=U(()=>Oa.getChartView(a.value.render,a.value.type)),Z=e=>{var t,s;return(s=(t=E.value)==null?void 0:t.axis)==null?void 0:s.includes(e)},it=z(),Ft=z([]);Ke(()=>[a.value.type,a.value],e=>{var t,s,u,x,b,w;Z("area")&&((t=l.worldTree)!=null&&t.length?l.areaId=(x=(u=(s=a.value)==null?void 0:s.customAttr)==null?void 0:u.map)==null?void 0:x.id:fi().then(async k=>{var S,A,ge;const $=(await vi()).data,Q={id:"customRoot",name:"自定义区域",disabled:!0};$.length&&(Q.children=$),l.worldTree.splice(0,l.worldTree.length,k.data,Q),l.areaId=(ge=(A=(S=a.value)==null?void 0:S.customAttr)==null?void 0:A.map)==null?void 0:ge.id}),(b=it.value)==null||b.blur(),Ft.value.splice(0),(w=it.value)==null||w.setCurrentKey(l.areaId)),l.chartTypeOptions.splice(0,l.chartTypeOptions.length,Na(e[0])),l.useless=e[0]},{immediate:!0,deep:!1});const Ha={label:"name",children:"children",disabled:"disabled"},O=e=>{a.value.dataFrom="calc",Ee.recordSnapshotCache(e,a.value.id)},Ya=()=>{a.value.calParams=[],O("calcData")},Ga=(e,t)=>{var s;return e?(s=t.name)==null?void 0:s.includes(e):!0},Ye=U(()=>Si(l.quotaData,l.dimensionData)),Ka=U(()=>{let e=[];return Ba.value.forEach(t=>{t.innerType==="VQuery"&&e.push(t),t.innerType==="DeTabs"&&t.propValue.forEach(s=>{e=[...s.componentData.filter(u=>u.innerType==="VQuery"),...e]})}),e}),nt=U(()=>{var t;let e=JSON.parse(JSON.stringify(l.quota));return((t=a.value)==null?void 0:t.type)==="table-info"&&(e=e==null?void 0:e.filter(s=>s.id!=="-1")),l.searchField&&(e=e.filter(s=>s.name.toLowerCase().includes(l.searchField.toLowerCase()))),e}),st=U(()=>{let e=JSON.parse(JSON.stringify(l.dimensionData));return l.searchField&&(e=e.filter(t=>t.name.toLowerCase().includes(l.searchField.toLowerCase()))),e}),Xa=U(()=>{var t;let e=JSON.parse(JSON.stringify(l.quota));return((t=a.value)==null?void 0:t.type)==="table-info"&&(e=e==null?void 0:e.filter(s=>s.id!=="-1")),e});gt("quotaData",Xa);const Za=(e,t)=>{e.dataTransfer.setData("dimension",JSON.stringify(t.filter(s=>s.id).map(s=>({...qe(o(s)),datasetId:a.value.tableId}))))},ue=e=>{var t,s;O("calcData"),a.value.type==="bar-range"&&(e.axisType==="quota"?(t=a.value.yAxisExt)==null||t.forEach(u=>{u.dateStyle=e.dateStyle,u.datePattern=e.datePattern}):e.axisType==="quotaExt"&&((s=a.value.yAxis)==null||s.forEach(u=>{u.dateStyle=e.dateStyle,u.datePattern=e.datePattern})))},pe=e=>{O("calcData"),e.removeType==="dimension"?a.value.xAxis.splice(e.index,1):e.removeType==="dimensionExt"?a.value.xAxisExt.splice(e.index,1):e.removeType==="dimensionStack"?a.value.extStack.splice(e.index,1):e.removeType==="quota"?a.value.yAxis.splice(e.index,1):e.removeType==="quotaExt"?a.value.yAxisExt.splice(e.index,1):e.removeType==="xAxisExtRight"?a.value.extBubble.splice(e.index,1):e.removeType==="flowMapStartName"?a.value.flowMapStartName.splice(e.index,1):e.removeType==="flowMapEndName"?a.value.flowMapEndName.splice(e.index,1):e.removeType==="extColor"&&a.value.extColor.splice(e.index,1)},Me=(e,t)=>{O("calcData"),L.emit("updateAxis",{axisType:t,axis:[e],editType:"update"})},eo=()=>{O("calcData")},Be=e=>{O("calcData");let t=e.removeType,s;e.removeType==="quota"?(t="yAxis",s=a.value.yAxis.splice(e.index,1)):e.removeType==="quotaExt"?(t="yAxisExt",s=a.value.yAxisExt.splice(e.index,1)):e.removeType==="extLabel"?s=a.value.extLabel.splice(e.index,1):e.removeType==="extTooltip"?s=a.value.extTooltip.splice(e.index,1):e.removeType==="extBubble"&&(s=a.value.extBubble.splice(e.index,1)),te().emitter.emit("removeAxis",{axisType:t,axis:s,editType:"remove"})},It=U(()=>{var e,t;return!!((t=(e=a.value.customFilter)==null?void 0:e.items)!=null&&t.length)}),to=()=>{O("calcData")},ao=e=>{O("calcData"),a.value.drillFields.splice(e.index,1)},fe=z("xAxis"),be=()=>{l.showCustomSort=!0},oo=e=>{l.customSortList=e},Tt=()=>{l.showCustomSort=!1,l.customSortField={},l.customSortList=[]},lo=()=>{a.value[fe.value].forEach(e=>{e.id===l.customSortField.id&&(e.sort="custom_sort",e.customSort=l.customSortList)}),Tt()},qt=e=>{O("render"),l.customSortField=a.value.xAxis[e.index],fe.value="xAxis",be()},io=e=>{O("render"),l.customSortField=a.value.extStack[e.index],fe.value="extStack",be()},rt=e=>{O("render"),l.customSortField=a.value.xAxisExt[e.index],fe.value="xAxisExt",be()},no=e=>{O("render"),l.customSortField=a.value.extBubble[e.index],fe.value="extBubble",be()},so=e=>{O("render"),l.customSortField=a.value.flowMapStartName[e.index],fe.value="flowMapStartName",be()},ro=e=>{O("render"),l.customSortField=a.value.flowMapEndName[e.index],fe.value="flowMapEndName",be()},mo=e=>{O("render"),l.customSortField=a.value.extColor[e.index],fe.value="extColor",be()},co=e=>{O("render"),l.customSortField=a.value.drillFields[e.index],fe.value="drillFields",be()},ae=e=>(O("calcData"),l.moveId=e.draggedContext.element.id,!0),Nt=(e,t)=>{if(e&&e.length>0){let s=!0;for(let u=0;u<e.length;u++)e[u].groupType!==t&&(e.splice(u,1),s=!1);return s||K({message:v(t==="d"?"chart.error_q_2_d":"chart.error_d_2_q"),type:"warning"}),s}},Dt=(e,t,s)=>{if(s==="ds")e.splice(t.newDraggableIndex,1);else{const u=e.filter(function(x){return x.id===l.moveId});if(u&&u.length>1)return e.splice(t.newDraggableIndex,1),u}},uo=(e,t)=>{const s=e.filter(function(u){return u.id===l.moveId});s&&s.length>0&&s[0].summary===""&&e.splice(t.newDraggableIndex,1)},po=U(()=>{if(a.value.type==="bar-range"){const e=a.value.yAxis[0],t=a.value.yAxisExt[0];if(e&&e.groupType==="d"||t&&t.groupType==="d")return!0}return!1}),fo=U(()=>{let e=!1;if(a.value.type==="table-info"||!E.value)return e;const t=E.value.axisConfig;if(!t)return e;for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)){const u=a.value[s];u instanceof Array&&u.forEach(x=>{x.desensitized&&(e=!0)})}return e}),vo=e=>{if(e&&e.length>0){let t=!0;for(let s=0;s<e.length;s++)e[s].deType!==5&&(e.splice(s,1),t=!1);return t||K({message:v("chart.error_d_not_coordinates"),type:"warning"}),t}},ve=(e,t)=>{var $,Q,S,A,ge;O("calcData");const s=($=E.value)==null?void 0:$.axisConfig[t];if(!s)return;const{type:u,limit:x,duplicate:b}=s;let w,k;if(a.value.type==="bar-range"&&(t==="yAxis"||t==="yAxisExt")){const _=a.value[t];if(_&&_.length>0){let B=!0;for(let V=0;V<_.length;V++)_[V].groupType==="d"&&_[V].deType===1&&(_[V].sort="asc"),_[V].groupType==="q"||_[V].groupType==="d"&&_[V].deType===1||(_.splice(V,1),B=!1);B||K({message:v("chart.error_d_not_time_2_q"),type:"warning"}),w=B}}else(a.value.type==="symbolic-map"||a.value.type==="heat-map")&&t==="xAxis"||a.value.type==="flow-map"&&(t==="xAxis"||t==="xAxisExt")?w=vo(a.value[t]):u&&(w=Nt(a.value[t],u));if(w&&u==="q"&&a.value.type==="indicator"){const _=a.value[t];if(_&&_.length>0){let B=!0;for(let V=0;V<_.length;V++)_[V].deType!==2&&_[V].deType!==3&&(_.splice(V,1),B=!1);w=B,w||K({message:v("chart.error_not_number"),type:"warning"})}}if(b||(k=Dt(a.value[t],e,"chart")),a.value[t].length>x){const _=a.value[t].splice(x);e.newDraggableIndex+1<=x&&(L.emit("removeAxis",{axisType:t,axis:_,editType:"remove"}),L.emit("addAxis",{axisType:t,axis:[a.value[t][e.newDraggableIndex]],editType:"add"}))}else if(!k&&w){const _=a.value.type==="gauge"||a.value.type==="liquid",B=qe(l.quotaData);L.emit("addAxis",{axisType:t,axis:[a.value[t][e.newDraggableIndex]],editType:"add",..._?{quotaData:B}:{}})}if(a.value.type==="line"&&(S=(Q=a.value)==null?void 0:Q.xAxisExt)!=null&&S.length&&((ge=(A=a.value)==null?void 0:A.yAxis)==null?void 0:ge.length)>1){const _=a.value.yAxis.splice(1);L.emit("removeAxis",{axisType:"yAxis",axis:_,editType:"remove"})}if(a.value.type.includes("chart-mix")){if(t==="yAxis"){if(a.value.yAxisExt.length>0){const _=a.value.yAxisExt[0].chartType;Va(a.value.yAxis,B=>{_==="bar"?B.chartType="line":_==="line"&&(B.chartType="bar")})}}else if(t==="yAxisExt"&&a.value.yAxis.length>0){const _=a.value.yAxis[0].chartType;Va(a.value.yAxisExt,B=>{_==="bar"?B.chartType="line":_==="line"&&(B.chartType="bar")})}}if(w&&a.value.type==="bar-range"){let _=null,B=null;if(t==="yAxis"&&a.value.yAxisExt[0]?(_=a.value.yAxisExt[0].groupType,B=a.value.yAxisExt[0].deType):t==="yAxisExt"&&a.value.yAxis[0]&&(_=a.value.yAxis[0].groupType,B=a.value.yAxis[0].deType),_!==null){const V=a.value[t];if(V&&V.length>0){let de=!0;for(let xe=0;xe<V.length;xe++)V[xe].groupType===_&&(_==="q"||_==="d"&&V[xe].deType===B)||(V.splice(xe,1),de=!1);de||K({message:v("chart.error_bar_range_axis_type_not_equal"),type:"warning"}),w=de}}}},ho=e=>{ve(e,"xAxis")},go=e=>{ve(e,"xAxisExt")},yo=e=>{ve(e,"extStack")},Ot=e=>{ve(e,"yAxis")},Vt=e=>{ve(e,"yAxisExt")},Mt=e=>{ve(e,"extBubble")},Bt=e=>{O("calcData"),Nt(a.value.drillFields,"d"),Dt(a.value.drillFields,e,""),uo(a.value.drillFields,e)},xo=e=>{ve(e,"flowMapStartName")},Co=e=>{ve(e,"flowMapEndName")},ko=e=>{ve(e,"extColor")},Ae=(e,t)=>{if(e.removed){const{element:s}=e.removed;L.emit("removeAxis",{axisType:t,axis:[s],editType:"remove"})}},Fe=(e,t=!1,s="")=>{if(e.refreshTime===""||parseFloat(e.refreshTime).toString()==="NaN"||parseFloat(e.refreshTime)<1){K.error(v("chart.only_input_number"));return}t?te().emitter.emit("resetDrill-"+e.id,0):_e.value?te().emitter.emit("onMobileStatusChange",{type:"componentStyleChange",value:{type:"calcData",component:JSON.parse(JSON.stringify(e))}}):(te().emitter.emit("calcData-"+e.id,e),Ee.recordSnapshotCache("renderChart",e.id)),Ee.recordSnapshotCache("calcData",e.id),s==="updateQuery"&&Ka.value.forEach(u=>{te().emitter.emit(`updateQueryCriteria${u.id}`)})},_o=e=>{q.value.state="ready",te().emitter.emit("checkShowEmpty",{allFields:Ye.value,view:e}),Fe(e,!0,"updateQuery")},M=e=>{_e.value?te().emitter.emit("onMobileStatusChange",{type:"componentStyleChange",value:{type:"renderChart",component:JSON.parse(JSON.stringify(e))}}):(te().emitter.emit("renderChart-"+e.id,e),Ee.recordSnapshotCache("renderChart",e.id))},bo=e=>{e.id!=="customRoot"&&(a.value.customAttr.map={id:e.id,level:e.level},M(a.value))},wo=(e,t)=>{var x,b,w,k,$;const s=Na(t);s.isPlugin?(a.value.plugin={isPlugin:!0,staticMap:s.staticMap},a.value.isPlugin=!0):(a.value.isPlugin=!1,delete a.value.plugin),a.value.render=e,a.value.type=t,L.emit("chart-type-change"),L.emit("chart-type-change-"+a.value.id);const u=Oa.getChartView(a.value.render,a.value.type);if(u){a.value=u.setupDefaultOptions(a.value);const Q=u.axisConfig;if(Ai(Q).forEach(S=>{const A=a.value[S];if(!(A!=null&&A.length))return;const ge=Q[S],{type:_,limit:B}=ge,V=[];if(_){for(let de=A.length-1;de>=0;de--)if(A[de].groupType!==_){const[xe]=A.splice(de,1);V.push(xe)}}B&&B<A.length&&A.splice(B).forEach(de=>V.push(de)),V.length&&L.emit("removeAxis",{axisType:S,axis:V,editType:"remove"})}),a.value.type==="line"&&(b=(x=a.value)==null?void 0:x.xAxisExt)!=null&&b.length&&((k=(w=a.value)==null?void 0:w.yAxis)==null?void 0:k.length)>1){const S=a.value.yAxis.splice(1);L.emit("removeAxis",{axisType:"yAxis",axis:S,editType:"remove"})}if((a.value.type==="liquid"||a.value.type==="gauge"||a.value.type==="indicator")&&Y("drillFields"),!["line","area","bar","bar-group"].includes(a.value.type)){const S=document.getElementById("point_"+a.value.id);S&&(S.remove(),($=S.parentNode)==null||$.removeChild(S))}}q.value.innerType=t,Fe(a.value,!0)},zt=(e,t)=>{const{data:s,requestData:u}=e,x=et(s,t);tt(a.value.customAttr.basicStyle,t,x),u?Fe(a.value):M(a.value)},$t=e=>{a.value.customAttr.tableHeader=e,M(a.value)},Pt=e=>{a.value.customAttr.tableCell=e,M(a.value)},Rt=e=>{a.value.customAttr.tableTotal=e,M(a.value)},Qt=e=>{a.value.customAttr.color=e,M(a.value)},Lt=e=>{a.value.customAttr.misc=e.data,e.requestData?Fe(a.value):M(a.value)},Jt=(e,t)=>{const{data:s,requestData:u,render:x}=e;let b=s;if(s||(b=e),t){const w=et(b,t);tt(a.value.customAttr.label,t,w)}else a.value.customAttr.label=b;x!==!1&&M(a.value)},Ut=(e,t)=>{(t==="color"||t==="suffixColor")&&(a.value.customAttr.basicStyle.alpha=void 0,e.indicatorName!==void 0&&(a.value.customAttr.indicatorName=e.indicatorName)),a.value.customAttr.indicator=e.indicatorValue,M(a.value)},jt=(e,t)=>{t==="color"&&(a.value.customAttr.basicStyle.alpha=void 0,e.indicatorValue!==void 0&&(a.value.customAttr.indicator=e.indicatorValue)),a.value.customAttr.indicatorName=e.indicatorName,M(a.value)},Wt=(e,t)=>{const{data:s,requestData:u,render:x}=e;let b=s;if(s||(b=e),t){const w=et(b,t);tt(a.value.customAttr.tooltip,t,w)}else a.value.customAttr.tooltip=b;if(u){Fe(a.value);return}x!==!1&&M(a.value)},Ht=e=>{a.value.customStyle.xAxis=e,M(a.value)},Yt=e=>{a.value.customStyle.yAxis=e,M(a.value)},Gt=e=>{a.value.customStyle.yAxisExt=e,M(a.value)},Kt=e=>{a.value.customStyle.misc=e,M(a.value)},Xt=e=>{a.value.customStyle.text=e,q.value&&(q.value.name=a.value.title,q.value.title=a.value.title),_e.value?te().emitter.emit("onMobileStatusChange",{type:"componentStyleChange",value:{type:"updateTitle",component:JSON.parse(JSON.stringify(a.value))}}):(te().emitter.emit("updateTitle-"+a.value.id),Ee.recordSnapshotCache("renderChart",a.value.id))},Zt=e=>{a.value.customStyle.legend=e,M(a.value)},Eo=e=>{a.value.senior.functionCfg=e,M(a.value)},ea=e=>{var t;q.value.id===((t=a.value)==null?void 0:t.id)&&(q.value.commonBackground=e,_e.value&&te().emitter.emit("onMobileStatusChange",{type:"componentStyleChange",value:{type:"commonBackground",component:JSON.parse(JSON.stringify(q.value))}}))},ta=e=>{q.value.style[e.property]=e.value,_e.value&&te().emitter.emit("onMobileStatusChange",{type:"componentStyleChange",value:{type:"style",component:JSON.parse(JSON.stringify(q.value))}})},So=e=>{a.value.senior.assistLineCfg=e.data,e.requestData?Fe(a.value):M(a.value)},Ao=e=>{var s,u;a.value.senior.threshold=e;let t;(u=(s=a.value.senior.threshold)==null?void 0:s.tableThreshold)==null||u.some(x=>x.conditions.some(b=>b.type==="dynamic")?(t="calcData",!0):!1),t||a.value.type==="rich-text"?Fe(a.value):M(a.value)},Fo=e=>{a.value.senior.areaMapping=e,M(a.value)},Io=e=>{a.value.senior.scrollCfg=e,M(a.value)},To=e=>{a.value.senior.bubbleCfg=e,M(a.value)},qo=e=>{za.value==="edit"&&(a.value.customAttr.basicStyle.tableFieldWidth=e,Ee.recordSnapshotCache("renderChart",a.value.id))},aa=e=>{a.value.extTooltip=e},oa=e=>{a.value.customAttr.quadrant=e,M(a.value)},la=(e,t)=>{const s=et(e,t);tt(a.value.customAttr.misc.flowMapConfig.lineConfig,t,s),M(a.value)},ia=e=>{a.value.customAttr.misc.flowMapConfig.pointConfig=e,M(a.value)},H=e=>{O("render"),l.itemForm=JSON.parse(JSON.stringify(e)),l.itemForm.chartShowName||(l.itemForm.chartShowName=l.itemForm.name),l.renameItem=!0},na=()=>{l.renameItem=!1},Y=e=>{var s,u,x,b,w,k,$,Q,S,A;O("calcData");let t=[];switch(e){case"xAxis":t=(s=a.value.xAxis)==null?void 0:s.splice(0);break;case"xAxisExt":t=(u=a.value.xAxisExt)==null?void 0:u.splice(0);break;case"extStack":t=(x=a.value.extStack)==null?void 0:x.splice(0);break;case"yAxis":t=(b=a.value.yAxis)==null?void 0:b.splice(0);break;case"yAxisExt":t=(w=a.value.yAxisExt)==null?void 0:w.splice(0);break;case"extBubble":t=(k=a.value.extBubble)==null?void 0:k.splice(0);break;case"customFilter":a.value.customFilter={};return;case"drillFields":t=($=a.value.drillFields)==null?void 0:$.splice(0);break;case"flowMapStartName":t=(Q=a.value.flowMapStartName)==null?void 0:Q.splice(0);break;case"flowMapEndName":t=(S=a.value.flowMapEndName)==null?void 0:S.splice(0);break;case"extColor":t=(A=a.value.extColor)==null?void 0:A.splice(0);break}t!=null&&t.length&&L.emit("removeAxis",{axisType:e,axis:t,editType:"remove"})},No=e=>{e&&e.validate(t=>{if(t){const{renameType:s,index:u,chartShowName:x}=l.itemForm;let b,w;switch(s){case"quota":b="yAxis",w=a.value.yAxis[u],a.value.yAxis[u].chartShowName=x;break;case"dimension":a.value.xAxis[u].chartShowName=x;break;case"quotaExt":b="yAxisExt",w=a.value.yAxisExt[u],a.value.yAxisExt[u].chartShowName=x;break;case"dimensionExt":a.value.xAxisExt[u].chartShowName=x;break;case"xAxisExtRight":a.value.extBubble[u].chartShowName=x;break;case"dimensionStack":a.value.extStack[u].chartShowName=x;break;case"extBubble":b="extBubble",w=a.value.extBubble[u],a.value.extBubble[u].chartShowName=x;break;case"extLabel":a.value.extLabel[u].chartShowName=x;break;case"extTooltip":a.value.extTooltip[u].chartShowName=x;case"flowMapStartName":b="flowMapStartName",w=a.value.flowMapStartName[u],a.value.flowMapStartName[u].chartShowName=x;break;case"flowMapEndName":b="flowMapEndName",w=a.value.flowMapEndName[u],a.value.flowMapEndName[u].chartShowName=x;break;case"extColor":b="extColor",w=a.value.extColor[u],a.value.extColor[u].chartShowName=x;break;case"drillFields":b="drillFields",w=a.value.drillFields[u],a.value.drillFields[u].chartShowName=x}b&&L.emit("updateAxis",{axisType:b,axis:[w],editType:"update"}),na()}else return!1})},ze=e=>{O("calcData"),l.quotaItem=JSON.parse(JSON.stringify(e)),l.quotaItem.logic||(l.quotaItem.logic="and"),l.quotaFilterEdit=!0},sa=()=>{l.quotaFilterEdit=!1},Do=()=>{for(let e=0;e<l.quotaItem.filter.length;e++){const t=l.quotaItem.filter[e];if(!t.term.includes("null")&&!t.term.includes("empty")&&(!t.value||t.value==="")){K.error(v("chart.filter_value_can_null"));return}if(!t.term.includes("null")&&!t.term.includes("empty")&&isNaN(t.value)){K.error(v("chart.filter_value_can_not_str"));return}}l.quotaItem.filterType==="quota"?(a.value.yAxis[l.quotaItem.index].filter=l.quotaItem.filter,a.value.yAxis[l.quotaItem.index].logic=l.quotaItem.logic):l.quotaItem.filterType==="quotaExt"&&(a.value.yAxisExt[l.quotaItem.index].filter=l.quotaItem.filter,a.value.yAxisExt[l.quotaItem.index].logic=l.quotaItem.logic),sa()},Oo=e=>{a.value.customFilter=qe(e)},ra=z(),da=()=>{ra.value.init(qe(a.value.customFilter))},ma=()=>{l.resultFilterEdit=!1},Vo=()=>{if((l.filterItem.deType===0||l.filterItem.deType===5)&&l.filterItem.filterType!=="enum"||l.filterItem.deType===1||l.filterItem.deType===2||l.filterItem.deType===3)for(let e=0;e<l.filterItem.filter.length;e++){const t=l.filterItem.filter[e];if(!t.term.includes("null")&&!t.term.includes("empty")&&(!t.value||t.value==="")){K.error(v("chart.filter_value_can_null"));return}if((l.filterItem.deType===2||l.filterItem.deType===3)&&!t.term.includes("null")&&!t.term.includes("empty")&&isNaN(t.value)){K.error(v("chart.filter_value_can_not_str"));return}}a.value.customFilter[l.filterItem.index].filter=l.filterItem.filter,a.value.customFilter[l.filterItem.index].logic=l.filterItem.logic,a.value.customFilter[l.filterItem.index].filterType=l.filterItem.filterType,a.value.customFilter[l.filterItem.index].enumCheckField=l.filterItem.enumCheckField,ma()},ca=e=>{re.value[e]=!re.value[e]},$e=z(null),dt=e=>{if($e!=null&&$e.value){const t={methodName:"initOpenHandler",args:e};$e.value.invokeMethod(t)}},Mo=()=>{if(!Ue.value.id){K.warning(v("visualization.save_page_tips"));return}const e=ot.getToken&&He.getIsIframe?"dataset-embedded-form":"/dataset-form";let t=Ct.resolve(e);const s=at.get("open-backend")==="1"?"_self":"_blank",u=window.open(t.href,s);dt(u)},Bo=()=>{const e=ot.getToken&&He.getIsIframe?"dataset-embedded-form":"/dataset-form",t=at.get("open-backend")==="1"?"_self":"_blank";if(t==="_self"&&!Ue.value.id){K.warning(v("visualization.save_page_tips"));return}let s=Ct.resolve({path:e,query:{id:a.value.tableId}});if(t==="_self"){if(!Ue.value.id){K.warning(v("visualization.save_page_tips"));return}Ei(()=>{at.delete("DE-DV-CATCH-"+Ue.value.id);const u=window.open(s.href,t);dt(u)})}else{const u=window.open(s.href,t);dt(u)}},Pe=e=>{O("calcData"),l.quotaItemCompare=JSON.parse(JSON.stringify(e)),l.showEditQuotaCompare=!0},ua=()=>{l.showEditQuotaCompare=!1},zo=()=>{l.quotaItemCompare.calcType==="quota"?a.value.yAxis[l.quotaItemCompare.index].compareCalc=l.quotaItemCompare.compareCalc:l.quotaItemCompare.calcType==="quotaExt"?a.value.yAxisExt[l.quotaItemCompare.index].compareCalc=l.quotaItemCompare.compareCalc:l.quotaItemCompare.calcType==="extLabel"?a.value.extLabel[l.quotaItemCompare.index].compareCalc=l.quotaItemCompare.compareCalc:l.quotaItemCompare.calcType==="extTooltip"&&(a.value.extTooltip[l.quotaItemCompare.index].compareCalc=l.quotaItemCompare.compareCalc),ua()},pa=e=>{switch(O("render"),e.axisType){case"dimension":a.value.xAxis[e.index].hide=e.hide;break;case"quota":a.value.yAxis[e.index].hide=e.hide;break}M(a.value)},ee=()=>{l.showSortPriority=!0},fa=()=>{l.showSortPriority=!1},$o=()=>{a.value.sortPriority=l.sortPriority,fa()},Po=e=>{l.sortPriority=e},he=e=>{O("render"),l.valueFormatterItem=JSON.parse(JSON.stringify(e)),l.showValueFormatter=!0},va=()=>{l.showValueFormatter=!1},Ro=()=>{const e=l.valueFormatterItem.formatterCfg.decimalCount;if(e===void 0||e.toString().indexOf(".")>-1||parseInt(e).toString()==="NaN"||parseInt(e)<0||parseInt(e)>10){K.error(v("chart.formatter_decimal_count_error"));return}l.valueFormatterItem.formatterType==="quota"?a.value.yAxis[l.valueFormatterItem.index].formatterCfg=l.valueFormatterItem.formatterCfg:l.valueFormatterItem.formatterType==="quotaExt"?a.value.yAxisExt[l.valueFormatterItem.index].formatterCfg=l.valueFormatterItem.formatterCfg:l.valueFormatterItem.formatterType==="dimension"&&(a.value.xAxis[l.valueFormatterItem.index].formatterCfg=l.valueFormatterItem.formatterCfg),va()},Qo=U(()=>({height:ot.getToken?"calc(100% - 45px)":"calc(100vh - 110px)"})),Rn=e=>{De.value=!0,lt.value=!0,Ne(()=>{Oe.value.initEdit({groupType:e,id:ui()},l.dimension,l.quota.filter(t=>t.id!=="-1"))})},Lo=e=>{De.value=!0,lt.value=!1,Ne(()=>{Oe.value.initEdit(e,l.dimension,l.quota.filter(t=>t.id!=="-1"))})},ha=()=>{De.value=!1},Jo=()=>{Oe.value.setFieldForm();const e=qe(Oe.value.fieldForm);ya(e),Da(e).then(()=>{Se(a.value.tableId,a.value.id,a.value.type),ha()})},ga=(e,t,s=!1)=>t===2?(s?bi:wi)[e]:xt[ke[e]],Qn=e=>{var t;switch(l.currEditField=JSON.parse(JSON.stringify(e.item)),e.type){case"copy":ya(l.currEditField),l.currEditField.id=null,l.currEditField.originName=e.item.extField===2?e.item.originName:"["+e.item.id+"]",l.currEditField.name=ci(l.dimension.concat(l.quota),e.item.name),Da(l.currEditField).then(()=>{Se(a.value.tableId,a.value.id,a.value.type)});break;case"edit":Lo(e.item);break;case"delete":pi((t=e.item)==null?void 0:t.id).then(()=>{Se(a.value.tableId,a.value.id,a.value.type)});break}},Ln=(e,t)=>({type:t,item:e}),ya=e=>{e.extField=2,e.chartId=a.value.id,e.datasetGroupId=a.value.tableId,e.dataeaseName=null,e.lastSyncTime=null,e.columnIndex=l.dimension.length+l.quota.length,e.deExtractType=e.deType},xa=z(null),mt=z(null),{y:ct,isDragging:Ca}=gi(xa,{initialValue:{x:0,y:400},draggingElement:mt}),Ie=z(0),Uo=()=>{Ne(()=>{Ie.value=mt.value.offsetHeight,ct.value=Ie.value/2+200})},jo=()=>{Ne(()=>{!Ve||a.value.tableId||St.value||["rich-text","picture-group"].includes(a.value.type)||(a.value.tableId=Ve)})};Ke(()=>q.value,e=>{!e||Ie.value||Uo()}),Ke(()=>q.value,e=>{e&&jo()});const Wo=U(()=>{const e=ct.value-200;return e<53?53:e>Ie.value-50?Ie.value-50:e}),Ho=U(()=>{const e=ct.value-200;return e<50?50:e>Ie.value-53?Ie.value-53:e}),Yo=e=>{if(O("render"),e===""||parseFloat(e).toString()==="NaN"||parseFloat(e)<1){K.error(v("chart.only_input_number"));return}},ut=z(!1),Te=z(!1),J=z([]),G=z([]),ka=(e,t="dimension")=>{ut.value&&(ut.value=!1);const s=t==="dimension"?J:G,u=t==="quota"?J:G;u.value=[],s.value=s.value.some(x=>x.id===e.id)?[]:[e]},Ge=(e,t="dimension")=>{ut.value=!0;const s=t==="dimension"?J:G,u=t==="quota"?J:G;u.value=[];const x=s.value.findIndex(b=>b.id===e.id);if(x!==-1){s.value.splice(x,1);return}s.value.push(e)},_a=(e,t="dimension")=>{const s=t==="dimension"?J:G,u=t==="quota"?J:G,x=t==="dimension"?st:nt;u.value=[];const b=x.value.map(k=>k.id),w=s.value.filter(k=>b.includes(k.id));if(w.length){const k=x.value.findIndex(Q=>Q.id===w[w.length-1].id),$=x.value.findIndex(Q=>Q.id===e.id);if(k===$)return;k>$&&(s.value=[...s.value,...x.value.slice($,k)]),k<$&&(s.value=[...s.value,...x.value.slice(k+1,$+1)])}else{const k=s.value.findIndex($=>$.id===e.id);if(k!==-1){s.value.splice(k,1);return}s.value.push(e)}},Re=z(!1),Go=e=>{Re.value=!0,setTimeout(()=>{Te.value=!0},0)},Ko=(e,t,s)=>{const u=s==="dimension"?J:G,x=s==="quota"?J:G;x.value=[],u.value.length||(u.value=[o(t)]),Za(e,o(J.value))},Xo=e=>{Re.value=!0,setTimeout(()=>{Te.value=!0},0)},Zo=(e,t,s)=>{const u=s==="dimension"?J:G,x=s==="quota"?J:G;x.value=[],u.value.length||(u.value=[t]),e.dataTransfer.setData("quota",JSON.stringify(G.value.filter(b=>b.id).map(b=>({...qe(o(b)),datasetId:a.value.tableId}))))},pt=()=>{Re.value=!1,Te.value=!1},ba=()=>{J.value=[],G.value=[],pt()},oe=e=>{e.preventDefault()},le=e=>{e.preventDefault()},ie=(e,t="xAxis")=>{var u;e.preventDefault();const s=J.value.length?J.value:G.value;for(let x=0;x<s.length;x++){const b=qe(s[x]);l.moveId=b.id,(u=a.value)[t]??(u[t]=[]),a.value[t].push(b);const w={newDraggableIndex:a.value[t].length-1};t==="drillFields"?Bt(w):ve(w,t)}},ye=z(!1),wa=e=>{ye.value=!0,xi(e,a.value.id).then(()=>{Se(a.value.tableId,a.value.id,a.value.type)}).catch(()=>{ye.value=!1})},Ea=e=>{ye.value=!0,Ci(e).then(()=>{Se(a.value.tableId,a.value.id,a.value.type)}).catch(()=>{ye.value=!1})};return(e,t)=>{const s=dl,u=il,x=vt("Fold"),b=vt("Expand"),w=ml,k=nl,$=cl,Q=ul,S=pl,A=fl,ge=vl,_=hl,B=gl,V=yl,de=xl,xe=Cl,el=kl,ft=_l,tl=bl,al=wl,Jn=vt("Setting"),Un=El,jn=Sl,Wn=Al,ol=Fl,ll=Il,we=sl,Sa=Vl("loading");return c(),F(ce,null,[p("div",{class:g(["chart-edit","editor-"+f.themes]),onKeydown:t[87]||(t[87]=j(()=>{},["stop"])),onKeyup:t[88]||(t[88]=j(()=>{},["stop"]))},[o(_e)?(c(),y(u,{key:0,direction:"vertical"},{default:n(()=>[i(s,{class:"drag_main_area"},{default:n(()=>{var d,m,r,N,me;return[o(a).type==="VQuery"&&o(q)?(c(),y(qa,{key:0,element:o(q),"common-background-pop":(d=o(q))==null?void 0:d.commonBackground,chart:o(a),themes:f.themes},null,8,["element","common-background-pop","chart","themes"])):(m=o(a).plugin)!=null&&m.isPlugin?(c(),y(o(Ze),{key:1,jsname:o(a).plugin.staticMap["editor-style"],view:o(a),dimension:l.dimension,quota:l.quota,themes:f.themes,emitter:o(L)},null,8,["jsname","view","dimension","quota","themes","emitter"])):(c(),F(ce,{key:2},[At.value?(c(),y(Ta,{key:0,properties:E.value.properties,"property-inner-all":E.value.propertyInner,"selector-spec":E.value.selectorSpec,"common-background-pop":(r=o(q))==null?void 0:r.commonBackground,"common-border-pop":(N=o(q))==null?void 0:N.style,"event-info":(me=o(q))==null?void 0:me.events,chart:o(a),themes:f.themes,"dimension-data":l.dimension,"quota-data":l.quota,"all-fields":Ye.value,onOnColorChange:Qt,onOnMiscChange:Lt,onOnLabelChange:Jt,onOnTooltipChange:Wt,onOnChangeXAxisForm:Ht,onOnChangeYAxisForm:Yt,onOnChangeYAxisExtForm:Gt,onOnTextChange:Xt,onOnIndicatorChange:Ut,onOnIndicatorNameChange:jt,onOnLegendChange:Zt,onOnBackgroundChange:ea,onOnStyleAttrChange:ta,onOnBasicStyleChange:zt,onOnTableHeaderChange:$t,onOnTableCellChange:Pt,onOnTableTotalChange:Rt,onOnChangeMiscStyleForm:Kt,onOnExtTooltipChange:aa,onOnChangeQuadrantForm:oa,onOnChangeFlowMapLineForm:la,onOnChangeFlowMapPointForm:ia},null,8,["properties","property-inner-all","selector-spec","common-background-pop","common-border-pop","event-info","chart","themes","dimension-data","quota-data","all-fields"])):h("",!0)],64))]}),_:1})]),_:1})):h("",!0),o(_e)?h("",!0):ht((c(),y(k,{key:1,class:"de-chart-editor"},{default:n(()=>[p("div",{class:g(["content-area",{"content-area-close":o(re).chartAreaCollapse,"content-area-left-open":!o(re).chartAreaCollapse}])},[i(o(T),{title:o(a).title,class:"custom-icon",size:"20px",onClick:t[0]||(t[0]=d=>ca("chartAreaCollapse"))},{default:n(()=>[o(re).chartAreaCollapse?(c(),y(x,{key:0,class:"collapse-icon"})):(c(),y(b,{key:1,class:"collapse-icon"}))]),_:1},8,["title"]),o(re).chartAreaCollapse?(c(),F("div",Ii,[p("span",Ti,C(o(a).title),1)])):h("",!0),o(re).chartAreaCollapse?h("",!0):(c(),F("div",qi,[i(k,{class:"editor-title"},{default:n(()=>[p("div",Ni,[p("div",{id:"component-name",class:g(["name-area",{"component-name-dark":f.themes==="dark"}]),style:Xe([{"max-width":"180px","text-overflow":"ellipsis","white-space":"nowrap"},{width:o(je)?"300px":"auto"}]),onDblclick:Et},C(o(a).title),39),i(w,{"show-arrow":"",offset:8,placement:"bottom",width:"200",trigger:"click"},{reference:n(()=>[i(o(T),{style:{"margin-left":"4px",cursor:"pointer"}},{default:n(()=>[i(I,null,{default:n(()=>[i(o(zl),{class:"svg-icon"})]),_:1})]),_:1})]),default:n(()=>[p("div",Di,C(o(v)("visualization.view_id")),1),p("div",Oi,C(o(a).id),1)]),_:1})])]),_:1}),i(k,{style:Xe(Qo.value)},{default:n(()=>[o(a).type==="VQuery"&&o(q)?(c(),y(s,{key:0},{default:n(()=>{var d;return[p("div",Vi,[p("div",Mi,[i(qa,{element:o(q),"common-background-pop":(d=o(q))==null?void 0:d.commonBackground,chart:o(a),themes:f.themes},null,8,["element","common-background-pop","chart","themes"])])])]}),_:1})):(c(),y(tl,{key:1,modelValue:_t.value,"onUpdate:modelValue":t[66]||(t[66]=d=>_t.value=d),class:g(["tab-header",{dark:f.themes==="dark"}])},{default:n(()=>[i(ft,{name:"data",label:o(v)("chart.chart_data"),class:"padding-tab"},{default:n(()=>[i(u,{direction:"vertical"},{default:n(()=>[i(s,{class:"has-footer drag_main_area attr-style theme-border-class"},{default:n(()=>{var d;return[["rich-text","Picture","picture-group"].includes(o(a).type)?h("",!0):(c(),y(k,{key:0,class:"drag-data padding-lr"},{default:n(()=>[p("span",Bi,C(o(v)("chart.switch_chart")),1),i(w,{offset:4,placement:"bottom-end",width:"434",trigger:"click","append-to-body":!0,"popper-class":"chart-type-style-"+f.themes,persistent:!1},{reference:n(()=>[i(Q,{modelValue:l.useless,"onUpdate:modelValue":t[1]||(t[1]=m=>l.useless=m),"popper-class":"chart-type-hide-options",class:"chart-type-select","suffix-icon":o($l),effect:f.themes,size:"small"},{prefix:n(()=>{var m,r;return[(m=l.chartTypeOptions[0])!=null&&m.isPlugin?(c(),y(I,{key:0,"class-name":"chart-type-select-icon","static-content":(r=l.chartTypeOptions[0])==null?void 0:r.icon},null,8,["static-content"])):(c(),y(I,{key:1,"class-name":"chart-type-select-icon"},{default:n(()=>[(c(),y(Qe(o(_i)[l.chartTypeOptions[0].icon]),{class:"svg-icon chart-type-select-icon"}))]),_:1}))]}),default:n(()=>[(c(!0),F(ce,null,Le(l.chartTypeOptions,m=>(c(),y($,{key:m.value,label:m.title,value:m.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","suffix-icon","effect"])]),default:n(()=>[i(ai,{themes:f.themes,type:o(a).type,onOnTypeChange:wo},null,8,["themes","type"])]),_:1},8,["popper-class"])]),_:1})),(d=o(a).plugin)!=null&&d.isPlugin?(c(),y(o(Ze),{key:1,jsname:o(a).plugin.staticMap["editor-data"],view:o(a),dimension:l.dimension,quota:l.quota,themes:f.themes,emitter:o(L),onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:H,onOnCustomSort:qt,onValueFormatter:he},null,8,["jsname","view","dimension","quota","themes","emitter"])):(c(),F(ce,{key:2},[Z("area")?(c(),y(k,{key:0,class:"padding-lr drag-data"},{default:n(()=>[p("span",zi,[D(C(o(v)("chart.area"))+" ",1),t[90]||(t[90]=p("i",{class:"required"},null,-1))]),p("div",$i,[i(o(rl),{ref_key:"areaSelect",ref:it,modelValue:l.areaId,"onUpdate:modelValue":t[2]||(t[2]=m=>l.areaId=m),effect:f.themes,data:l.worldTree,props:Ha,filterNodeMethod:Ga,"current-node-key":l.areaId,teleported:!1,"default-expanded-keys":Ft.value,"empty-text":"请选择区域","node-key":"id","check-strictly":"",filterable:"",onNodeClick:bo},null,8,["modelValue","effect","data","current-node-key","default-expanded-keys"])])]),_:1})):h("",!0),Z("xAxis")?(c(),y(k,{key:1,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",Pi,[p("span",null,[D(C(E.value.axisConfig.xAxis.name)+" ",1),(m=E.value.axisConfig.xAxis)!=null&&m.allowEmpty?h("",!0):(c(),F("i",Ri))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[3]||(t[3]=r=>Y("xAxis"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{class:"qw",onDrop:t[4]||(t[4]=r=>ie(r)),onDragenter:oe,onDragover:t[5]||(t[5]=r=>le(r))},[i(o(ne),{list:o(a).xAxis,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:ho},{item:n(({element:r,index:N})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,themes:P.themes,type:"dimension",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:H,onOnCustomSort:qt,onValueFormatter:he,onOnToggleHide:pa,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{themes:f.themes,"drag-list":o(a).xAxis},null,8,["themes","drag-list"])],32)]}),_:1})):h("",!0),Z("xAxisExt")?(c(),y(k,{key:2,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",Qi,[p("span",null,[D(C(E.value.axisConfig.xAxisExt.name)+" ",1),(m=E.value.axisConfig.xAxisExt)!=null&&m.allowEmpty?h("",!0):(c(),F("i",Li))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[6]||(t[6]=r=>Y("xAxisExt"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[7]||(t[7]=r=>ie(r,"xAxisExt")),onDragenter:oe,onDragover:t[8]||(t[8]=r=>le(r))},[i(o(ne),{list:o(a).xAxisExt,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:go},{item:n(({element:r,index:N})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,themes:P.themes,type:"dimensionExt",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:H,onOnCustomSort:rt,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).xAxisExt},null,8,["drag-list"])],32)]}),_:1})):h("",!0),Z("flowMapStartName")?(c(),y(k,{key:3,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",Ji,[p("span",null,[D(C(E.value.axisConfig.flowMapStartName.name)+" ",1),(m=E.value.axisConfig.flowMapStartName)!=null&&m.allowEmpty?h("",!0):(c(),F("i",Ui))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[9]||(t[9]=r=>Y("flowMapStartName"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{class:"qw",onDrop:t[10]||(t[10]=r=>ie(r,"flowMapStartName")),onDragenter:oe,onDragover:t[11]||(t[11]=r=>le(r))},[i(o(ne),{list:o(a).flowMapStartName,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:xo},{item:n(({element:r,index:N})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,themes:P.themes,type:"flowMapStartName",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:H,onOnCustomSort:so,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{themes:f.themes,"drag-list":o(a).flowMapStartName},null,8,["themes","drag-list"])],32)]}),_:1})):h("",!0),Z("flowMapEndName")?(c(),y(k,{key:4,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",ji,[p("span",null,[D(C(E.value.axisConfig.flowMapEndName.name)+" ",1),(m=E.value.axisConfig.flowMapEndName)!=null&&m.allowEmpty?h("",!0):(c(),F("i",Wi))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[12]||(t[12]=r=>Y("flowMapEndName"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{class:"qw",onDrop:t[13]||(t[13]=r=>ie(r,"flowMapEndName")),onDragenter:oe,onDragover:t[14]||(t[14]=r=>le(r))},[i(o(ne),{list:o(a).flowMapEndName,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Co},{item:n(({element:r,index:N})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,themes:P.themes,type:"flowMapEndName",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:H,onOnCustomSort:ro,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{themes:f.themes,"drag-list":o(a).flowMapEndName},null,8,["themes","drag-list"])],32)]}),_:1})):h("",!0),Z("extStack")?(c(),y(k,{key:5,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",Hi,[p("span",null,[D(C(E.value.axisConfig.extStack.name)+" ",1),(m=E.value.axisConfig.extStack)!=null&&m.allowEmpty?h("",!0):(c(),F("i",Yi))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[15]||(t[15]=r=>Y("extStack"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[16]||(t[16]=r=>ie(r,"extStack")),onDragenter:oe,onDragover:t[17]||(t[17]=r=>le(r))},[i(o(ne),{list:o(a).extStack,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:yo},{item:n(({element:r,index:N})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,themes:P.themes,type:"dimensionStack",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:H,onOnCustomSort:io,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).extStack},null,8,["drag-list"])],32)]}),_:1})):h("",!0),Z("extColor")?(c(),y(k,{key:6,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",Gi,[p("span",null,[D(C(E.value.axisConfig.extColor.name)+" ",1),(m=E.value.axisConfig.extColor)!=null&&m.allowEmpty?h("",!0):(c(),F("i",Ki))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[18]||(t[18]=r=>Y("extColor"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{class:"qw",onDrop:t[20]||(t[20]=r=>ie(r,"extColor")),onDragenter:oe,onDragover:t[21]||(t[21]=r=>le(r))},[i(o(ne),{list:o(a).extColor,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:ko,onChange:t[19]||(t[19]=r=>Ae(r,"extColor"))},{item:n(({element:r,index:N})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,themes:P.themes,type:"extColor",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:H,onOnCustomSort:mo,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{themes:f.themes,"drag-list":o(a).extColor},null,8,["themes","drag-list"])],32)]}),_:1})):h("",!0),o(a).type!=="bar-range"?(c(),F(ce,{key:7},[Z("yAxis")?(c(),y(k,{key:0,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",Xi,[p("span",Zi,[p("span",en,[D(C(E.value.axisConfig.yAxis.name)+" ",1),(m=E.value.axisConfig.yAxis)!=null&&m.allowEmpty?h("",!0):(c(),F("i",tn))]),E.value.axisConfig.yAxis.tooltip?(c(),y(S,{key:0,class:"item",effect:R.value,placement:"top"},{content:n(()=>[p("span",null,C(E.value.axisConfig.yAxis.tooltip),1)]),default:n(()=>[i(o(T),{class:g(["hint-icon",{"hint-icon--dark":f.themes==="dark"}])},{default:n(()=>[i(I,{name:"icon_info_outlined"},{default:n(()=>[i(o(yt),{class:"svg-icon"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect"])):h("",!0)]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[22]||(t[22]=r=>Y("yAxis"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[25]||(t[25]=r=>ie(r,"yAxis")),onDragenter:oe,onDragover:t[26]||(t[26]=r=>le(r))},[i(o(ne),{list:o(a).yAxis,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Ot,onChange:t[24]||(t[24]=r=>Ae(r,"yAxis"))},{item:n(({element:r,index:N})=>[i(Je,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,type:"quota",themes:P.themes,onOnQuotaItemChange:t[23]||(t[23]=me=>Me(me,"yAxis")),onOnQuotaItemRemove:Be,onOnNameEdit:H,onEditItemFilter:ze,onEditItemCompare:Pe,onValueFormatter:he,onOnToggleHide:pa,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"margin-top":o(a).type==="stock-line"?"9px":"0","drag-list":o(a).yAxis},null,8,["margin-top","drag-list"])],32)]}),_:1})):h("",!0),Z("xAxisExtRight")?(c(),y(k,{key:1,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",an,[p("span",null,[D(C(E.value.axisConfig.extBubble.name)+" ",1),(m=E.value.axisConfig.extBubble)!=null&&m.allowEmpty?h("",!0):(c(),F("i",on))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[27]||(t[27]=r=>Y("extBubble"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[29]||(t[29]=r=>ie(r,"extBubble")),onDragenter:oe,onDragover:t[30]||(t[30]=r=>le(r))},[i(o(ne),{list:o(a).extBubble,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Mt,onChange:t[28]||(t[28]=r=>Ae(r,"extBubble"))},{item:n(({element:r,index:N})=>[i(Ce,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,themes:P.themes,type:"xAxisExtRight",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:H,onOnCustomSort:no,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).extBubble},null,8,["drag-list"])],32)]}),_:1})):h("",!0),Z("yAxisExt")?(c(),y(k,{key:2,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",ln,[p("span",null,[D(C(E.value.axisConfig.yAxisExt.name)+" ",1),(m=E.value.axisConfig.yAxisExt)!=null&&m.allowEmpty?h("",!0):(c(),F("i",nn))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[31]||(t[31]=r=>Y("yAxisExt"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[34]||(t[34]=r=>ie(r,"yAxisExt")),onDragenter:oe,onDragover:t[35]||(t[35]=r=>le(r))},[i(o(ne),{list:o(a).yAxisExt,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Vt,onChange:t[33]||(t[33]=r=>Ae(r,"yAxisExt"))},{item:n(({element:r,index:N})=>[i(Je,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,type:"quotaExt",themes:P.themes,onOnQuotaItemChange:t[32]||(t[32]=me=>Me(me,"yAxisExt")),onOnQuotaItemRemove:Be,onOnNameEdit:H,onEditItemFilter:ze,onEditItemCompare:Pe,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).yAxisExt},null,8,["drag-list"])],32)]}),_:1})):h("",!0)],64)):o(a).type==="bar-range"?(c(),F(ce,{key:8},[Z("yAxis")?(c(),y(k,{key:0,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",sn,[p("span",null,[D(C(E.value.axisConfig.yAxis.name)+" ",1),(m=E.value.axisConfig.yAxis)!=null&&m.allowEmpty?h("",!0):(c(),F("i",rn))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[36]||(t[36]=r=>Y("yAxis"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[39]||(t[39]=r=>ie(r,"yAxis")),onDragenter:oe,onDragover:t[40]||(t[40]=r=>le(r))},[i(o(ne),{list:o(a).yAxis,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Ot,onChange:t[38]||(t[38]=r=>Ae(r,"yAxis"))},{item:n(({element:r,index:N})=>[r.groupType==="d"?(c(),y(Ce,{key:0,"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,themes:P.themes,type:"quota",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:H,onOnCustomSort:rt,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])):r.groupType==="q"?(c(),y(Je,{key:1,"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,type:"quota",themes:P.themes,onOnQuotaItemChange:t[37]||(t[37]=me=>Me(me,"yAxis")),onOnQuotaItemRemove:Be,onOnNameEdit:H,onEditItemFilter:ze,onEditItemCompare:Pe,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])):h("",!0)]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).yAxis},null,8,["drag-list"])],32)]}),_:1})):h("",!0),Z("yAxisExt")?(c(),y(k,{key:1,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",dn,[p("span",null,[D(C(E.value.axisConfig.yAxisExt.name)+" ",1),(m=E.value.axisConfig.yAxisExt)!=null&&m.allowEmpty?h("",!0):(c(),F("i",mn))]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[41]||(t[41]=r=>Y("yAxisExt"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[44]||(t[44]=r=>ie(r,"yAxisExt")),onDragenter:oe,onDragover:t[45]||(t[45]=r=>le(r))},[i(o(ne),{list:o(a).yAxisExt,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Vt,onChange:t[43]||(t[43]=r=>Ae(r,"yAxisExt"))},{item:n(({element:r,index:N})=>[r.groupType==="d"?(c(),y(Ce,{key:0,"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,themes:P.themes,type:"quotaExt",onOnDimensionItemChange:ue,onOnDimensionItemRemove:pe,onOnNameEdit:H,onOnCustomSort:rt,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])):r.groupType==="q"?(c(),y(Je,{key:1,"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,type:"quotaExt",themes:P.themes,onOnQuotaItemChange:t[42]||(t[42]=me=>Me(me,"yAxisExt")),onOnQuotaItemRemove:Be,onOnNameEdit:H,onEditItemFilter:ze,onEditItemCompare:Pe,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])):h("",!0)]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).yAxisExt},null,8,["drag-list"])],32)]}),_:1})):h("",!0)],64)):h("",!0),Z("extBubble")?(c(),y(k,{key:9,class:"padding-lr drag-data"},{default:n(()=>{var m;return[p("div",cn,[p("span",un,[p("span",pn,[D(C(E.value.axisConfig.extBubble.name)+" ",1),(m=E.value.axisConfig.extBubble)!=null&&m.allowEmpty?h("",!0):(c(),F("i",fn))]),E.value.axisConfig.extBubble.tooltip?(c(),y(S,{key:0,class:"item",effect:R.value,placement:"top"},{content:n(()=>[p("span",null,C(E.value.axisConfig.extBubble.tooltip),1)]),default:n(()=>[i(o(T),{class:g(["hint-icon",{"hint-icon--dark":f.themes==="dark"}])},{default:n(()=>[i(I,{name:"icon_info_outlined"},{default:n(()=>[i(o(yt),{class:"svg-icon"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect"])):h("",!0)]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[46]||(t[46]=r=>Y("extBubble"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[49]||(t[49]=r=>ie(r,"extBubble")),onDragenter:oe,onDragover:t[50]||(t[50]=r=>le(r))},[i(o(ne),{list:o(a).extBubble,move:ae,"item-key":"id",group:"drag",animation:"300",class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Mt,onChange:t[48]||(t[48]=r=>Ae(r,"extBubble"))},{item:n(({element:r,index:N})=>[i(Je,{"dimension-data":l.dimension,"quota-data":l.quota,chart:o(a),item:r,index:N,type:"extBubble",themes:P.themes,onOnQuotaItemChange:t[47]||(t[47]=me=>Me(me,"extBubble")),onOnQuotaItemRemove:Be,onOnNameEdit:H,onEditItemFilter:ze,onEditItemCompare:Pe,onValueFormatter:he,onEditSortPriority:ee},null,8,["dimension-data","quota-data","chart","item","index","themes"])]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).extBubble},null,8,["drag-list"])],32)]}),_:1})):h("",!0),Z("drill")?(c(),y(k,{key:10,class:"padding-lr drag-data"},{default:n(()=>[p("div",vn,[p("span",hn,[p("span",gn,C(o(v)("chart.drill"))+" / "+C(o(v)("chart.dimension")),1),i(S,{class:"item",effect:R.value,placement:"top"},{content:n(()=>[p("span",null,C(o(v)("chart.drill_dimension_tip")),1)]),default:n(()=>[i(o(T),{class:g(["hint-icon",{"hint-icon--dark":f.themes==="dark"}])},{default:n(()=>[i(I,{name:"icon_info_outlined"},{default:n(()=>[i(o(yt),{class:"svg-icon"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect"])]),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[51]||(t[51]=m=>Y("drillFields"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),p("div",{onDrop:t[52]||(t[52]=m=>ie(m,"drillFields")),onDragenter:oe,onDragover:t[53]||(t[53]=m=>le(m))},[i(o(ne),{list:o(a).drillFields,"item-key":"id",group:"drag",animation:"300",move:ae,class:g(["drag-block-style",{dark:f.themes==="dark"}]),onAdd:Bt},{item:n(({element:m,index:r})=>[(c(),y(Xl,{key:m.id,index:r,chart:o(a),item:m,"dimension-data":l.dimension,"quota-data":l.quota,themes:P.themes,onOnDimensionItemChange:to,onOnDimensionItemRemove:ao,onOnNameEdit:H,onOnCustomSort:co,onEditSortPriority:ee},null,8,["index","chart","item","dimension-data","quota-data","themes"]))]),_:1},8,["list","class"]),i(se,{"drag-list":o(a).drillFields},null,8,["drag-list"])],32)]),_:1})):h("",!0),i(k,{class:"padding-lr drag-data no-top-border no-top-padding"},{default:n(()=>[p("div",yn,[p("span",null,C(o(v)("chart.result_filter")),1),i(S,{effect:R.value,placement:"top",content:o(v)("common.delete")},{default:n(()=>[i(o(T),{class:g(["remove-icon",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:t[54]||(t[54]=m=>Y("customFilter"))},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"])]),It.value||f.themes==="dark"?(c(),F("div",{key:0,class:g(["tree-btn",{"tree-btn--dark":f.themes==="dark",active:It.value}]),onClick:da},[i(o(T),{style:{"margin-right":"2px","font-size":"12px"}},{default:n(()=>[i(I,{class:"svg-background",name:"icon-filter"},{default:n(()=>[i(o(Fa),{class:"svg-icon svg-background"})]),_:1})]),_:1}),p("span",null,C(e.$t("chart.filter")),1)],2)):(c(),y(A,{key:1,class:"tree-btn_secondary",secondary:"",onClick:da},{icon:n(()=>[i(I,null,{default:n(()=>[i(o(Fa),{class:"svg-icon svg-background"})]),_:1})]),default:n(()=>[p("span",null,C(e.$t("chart.filter")),1)]),_:1}))]),_:1}),po.value?(c(),y(k,{key:11,class:"refresh-area"},{default:n(()=>[i(_,{class:g(["form-item no-margin-bottom","form-item-"+f.themes])},{default:n(()=>[i(ge,{modelValue:o(a).aggregate,"onUpdate:modelValue":t[55]||(t[55]=m=>o(a).aggregate=m),effect:f.themes,size:"small",onChange:eo},{default:n(()=>[D(C(o(v)("chart.aggregate_time")),1)]),_:1},8,["modelValue","effect"])]),_:1},8,["class"])]),_:1})):h("",!0)],64))]}),_:1}),i(el,{class:g({"refresh-active-footer":o(a).refreshViewEnable})},{default:n(()=>[i(k,{class:"refresh-area"},{default:n(()=>[i(_,{class:g(["form-item no-margin-bottom","form-item-"+f.themes])},{default:n(()=>[i(ge,{modelValue:o(a).refreshViewEnable,"onUpdate:modelValue":t[56]||(t[56]=d=>o(a).refreshViewEnable=d),effect:f.themes,size:"small",onChange:t[57]||(t[57]=d=>O("render"))},{default:n(()=>[D(C(o(v)("visualization.refresh_frequency")),1)]),_:1},8,["modelValue","effect"])]),_:1},8,["class"]),o(a).refreshViewEnable?(c(),y(k,{key:0},{default:n(()=>[i(_,{class:g(["form-item no-margin-bottom select-append","form-item-"+f.themes])},{default:n(()=>[i(B,{modelValue:o(a).refreshTime,"onUpdate:modelValue":t[60]||(t[60]=d=>o(a).refreshTime=d),modelModifiers:{number:!0},effect:f.themes,class:g([f.themes==="dark"&&"dv-dark"]),size:"small",min:1,max:3600,disabled:!o(a).refreshViewEnable,onChange:Yo},{append:n(()=>[i(Q,{modelValue:o(a).refreshUnit,"onUpdate:modelValue":t[58]||(t[58]=d=>o(a).refreshUnit=d),effect:f.themes,size:"small",placeholder:"Select",style:{width:"80px"},onChange:t[59]||(t[59]=d=>O("render"))},{default:n(()=>[i($,{effect:f.themes,label:o(v)("visualization.minute"),value:"minute"},null,8,["effect","label"]),i($,{effect:f.themes,label:o(v)("visualization.second"),value:"second"},null,8,["effect","label"])]),_:1},8,["modelValue","effect"])]),_:1},8,["modelValue","effect","class","disabled"])]),_:1},8,["class"])]),_:1})):h("",!0)]),_:1}),i(k,{class:g(["result-style","result-style-"+f.themes])},{default:n(()=>[p("div",xn,[o(a).type!=="richTextView"?(c(),F("span",Cn,C(o(v)("chart.result_count")),1)):h("",!0),o(a).type!=="richTextView"?(c(),F("span",kn,[i(xe,{modelValue:o(a).resultMode,"onUpdate:modelValue":t[63]||(t[63]=d=>o(a).resultMode=d),effect:f.themes,class:"radio-span",size:"small",onChange:t[64]||(t[64]=d=>O("render"))},{default:n(()=>[i(V,{class:"margin20-radio",label:"all",effect:f.themes},{default:n(()=>[p("span",{class:g(["result-count-label",{dark:f.themes==="dark"}])},C(o(v)("chart.result_mode_all")),3)]),_:1},8,["effect"]),i(V,{label:"custom",effect:f.themes},{default:n(()=>[i(de,{modelValue:o(a).resultCount,"onUpdate:modelValue":t[61]||(t[61]=d=>o(a).resultCount=d),min:1,max:1e6,controls:!1,effect:f.themes,"step-strictly":!0,"value-on-clear":1e3,disabled:o(a).resultMode==="all",class:"result-count",size:"small",onChange:t[62]||(t[62]=d=>O("calcData"))},null,8,["modelValue","effect","disabled"])]),_:1},8,["effect"])]),_:1},8,["modelValue","effect"])])):h("",!0)]),i(A,{disabled:fo.value,type:"primary",class:"result-style-button",onClick:t[65]||(t[65]=d=>_o(o(a)))},{default:n(()=>[p("span",_n,C(o(v)("chart.update_chart_data")),1)]),_:1},8,["disabled"])]),_:1},8,["class"])]),_:1},8,["class"])]),_:1})]),_:1},8,["label"]),i(ft,{name:"style",label:o(v)("chart.chart_style"),class:"padding-tab",style:{width:"100%"}},{default:n(()=>[i(u,{direction:"vertical"},{default:n(()=>[i(s,{class:"drag_main_area"},{default:n(()=>{var d,m,r,N;return[(d=o(a).plugin)!=null&&d.isPlugin?(c(),y(o(Ze),{key:0,jsname:o(a).plugin.staticMap["editor-style"],view:o(a),dimension:l.dimension,quota:l.quota,themes:f.themes,emitter:o(L)},null,8,["jsname","view","dimension","quota","themes","emitter"])):(c(),F(ce,{key:1},[At.value?(c(),y(Ta,{key:0,properties:E.value.properties,"property-inner-all":E.value.propertyInner,"selector-spec":E.value.selectorSpec,"common-background-pop":(m=o(q))==null?void 0:m.commonBackground,"common-border-pop":(r=o(q))==null?void 0:r.style,"event-info":(N=o(q))==null?void 0:N.events,chart:o(a),themes:f.themes,"dimension-data":l.dimension,"quota-data":l.quota,"all-fields":Ye.value,onOnColorChange:Qt,onOnMiscChange:Lt,onOnLabelChange:Jt,onOnTooltipChange:Wt,onOnChangeXAxisForm:Ht,onOnChangeYAxisForm:Yt,onOnChangeYAxisExtForm:Gt,onOnTextChange:Xt,onOnIndicatorChange:Ut,onOnIndicatorNameChange:jt,onOnLegendChange:Zt,onOnBackgroundChange:ea,onOnStyleAttrChange:ta,onOnBasicStyleChange:zt,onOnTableHeaderChange:$t,onOnTableCellChange:Pt,onOnTableTotalChange:Rt,onOnChangeMiscStyleForm:Kt,onOnExtTooltipChange:aa,onOnChangeQuadrantForm:oa,onOnChangeFlowMapLineForm:la,onOnChangeFlowMapPointForm:ia},null,8,["properties","property-inner-all","selector-spec","common-background-pop","common-border-pop","event-info","chart","themes","dimension-data","quota-data","all-fields"])):h("",!0)],64))]}),_:1})]),_:1})]),_:1},8,["label"]),i(ft,{name:"senior",label:o(v)("chart.senior"),class:"padding-tab",style:{width:"100%"}},{default:n(()=>[i(u,{direction:"vertical"},{default:n(()=>[i(s,{class:"drag_main_area"},{default:n(()=>{var d,m;return[(d=o(a).plugin)!=null&&d.isPlugin?(c(),y(o(Ze),{key:0,jsname:o(a).plugin.staticMap["editor-senior"],view:o(a),dimension:l.dimension,quota:l.quota,themes:f.themes,emitter:o(L)},null,8,["jsname","view","dimension","quota","themes","emitter"])):(c(),y(Yl,{key:1,chart:o(a),"quota-data":o(a).yAxis,"quota-ext-data":o(a).yAxisExt,"fields-data":Ye.value,themes:f.themes,properties:E.value.properties,"property-inner-all":E.value.propertyInner,"event-info":(m=o(q))==null?void 0:m.events,onOnFunctionCfgChange:Eo,onOnAssistLineChange:So,onOnScrollCfgChange:Io,onOnThresholdChange:Ao,onOnMapMappingChange:Fo,onOnBubbleAnimateChange:To},null,8,["chart","quota-data","quota-ext-data","fields-data","themes","properties","property-inner-all","event-info"]))]}),_:1})]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue","class"]))]),_:1},8,["style"])]))],2),p("div",{class:g(["dataset-main content-area",{"content-area-close":o(re).datasetAreaCollapse,"content-area-right-open":!o(re).datasetAreaCollapse}])},[i(o(T),{title:e.$t("visualization.dataset"),class:"custom-icon",size:"20px",onClick:t[67]||(t[67]=d=>ca("datasetAreaCollapse"))},{default:n(()=>[o(re).datasetAreaCollapse?(c(),y(x,{key:0,class:"collapse-icon"})):(c(),y(b,{key:1,class:"collapse-icon"}))]),_:1},8,["title"]),o(re).datasetAreaCollapse?(c(),F("div",bn,[p("span",wn,C(o(v)("visualization.dataset")),1)])):h("",!0),o(re).datasetAreaCollapse?h("",!0):(c(),y(u,{key:1,direction:"vertical",class:"dataset-area view-panel-row"},{default:n(()=>[i(al,{class:"editor-title"},{default:n(()=>[p("span",En,C(o(v)("visualization.dataset")),1)]),_:1}),i(ol,{class:"dataset-main-top"},{default:n(()=>[i(k,{class:"dataset-select"},{default:n(()=>[i(hi,{ref_key:"datasetSelector",ref:We,modelValue:o(a).tableId,"onUpdate:modelValue":t[68]||(t[68]=d=>o(a).tableId=d),style:{flex:"1"},"view-id":o(a).id,"state-obj":l,themes:f.themes,onAddDsWindow:Mo,onOnDatasetChange:Ya},null,8,["modelValue","view-id","state-obj","themes"]),i(S,{effect:R.value,content:e.$t("deDataset.edit_dataset"),placement:"top"},{default:n(()=>[bt.value>=7&&!Ua.value?(c(),y(o(T),{key:0,class:g(["field-search-icon-btn",{dark:f.themes==="dark"}]),style:{"margin-left":"8px"},onClick:Bo},{default:n(()=>[i(I,{name:"icon_edit_outlined",class:"el-icon-arrow-down el-icon-delete"},{default:n(()=>[i(o(Pl),{class:"svg-icon el-icon-arrow-down el-icon-delete"})]),_:1})]),_:1},8,["class"])):h("",!0)]),_:1},8,["effect","content"])]),_:1}),i(k,{class:"dataset-search padding-lr"},{default:n(()=>[p("div",{class:g(["dataset-search-label",{dark:f.themes==="dark"}])},[p("span",null,C(o(v)("chart.field")),1),p("span",null,[i(S,{effect:R.value,content:e.$t("visualization.refresh"),placement:"top"},{default:n(()=>[i(o(T),{class:g(["field-search-icon-btn",{dark:f.themes==="dark"}]),onClick:t[69]||(t[69]=d=>Se(o(a).tableId,o(a).id,o(a).type))},{default:n(()=>[i(I,{name:"icon_refresh_outlined",class:"el-icon-arrow-down el-icon-delete"},{default:n(()=>[i(o(Rl),{class:"svg-icon el-icon-arrow-down el-icon-delete"})]),_:1})]),_:1},8,["class"])]),_:1},8,["effect","content"]),h("",!0)])],2),i(B,{modelValue:l.searchField,"onUpdate:modelValue":t[71]||(t[71]=d=>l.searchField=d),size:"middle",effect:f.themes,class:g(["dataset-search-input",{dark:f.themes==="dark"}]),placeholder:o(v)("chart.search")+" "+o(v)("chart.field"),clearable:""},{prefix:n(()=>[i(o(T),{class:"el-input__icon"},{default:n(()=>[i(I,{name:"icon_search-outline_outlined"},{default:n(()=>[i(o(Ql),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","effect","class","placeholder"])]),_:1}),ht((c(),F("div",{ref_key:"elDrag",ref:mt,style:{height:"calc(100% - 137px)","min-height":"120px"}},[p("div",{class:g(["padding-lr field-height first right-dimension",{dark:f.themes==="dark","user-select":o(Ca)}]),style:Xe({height:Wo.value+"px"})},[p("label",null,C(o(v)("chart.dimension")),1),i(s,{class:"drag-list"},{default:n(()=>[(c(!0),F(ce,null,Le(st.value,d=>(c(),F("div",{key:d.id,draggable:!0,class:"item father",onClick:[j(m=>Ge(d),["ctrl"]),j(m=>Ge(d),["meta"]),j(m=>ka(d),["exact"]),j(m=>_a(d),["shift"])],onDragstart:m=>Ko(m,d,"dimension"),onDragend:ba},[p("div",{class:g(["items flex-align-center",["item-dimension--"+f.themes,Te.value&&"is-dragging-item",J.value.map(m=>m.id).includes(d.id)&&"active"]])},[i(o(T),null,{default:n(()=>[i(I,null,{default:n(()=>[(c(),y(Qe(ga(d.deType,d.extField)),{class:g(["svg-icon",`field-icon-${o(ke)[[2,3].includes(d.deType)?2:0]}`])},null,8,["class"]))]),_:2},1024)]),_:2},1024),p("span",{class:g(["field-name ellipsis",{dark:f.themes==="dark"}]),title:d.name},C(d.name),11,An),d.id!=="-1"&&!d.chartId?(c(),y(o(T),{key:0,class:g(["field-setting child",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:j(m=>wa(d.id),["stop"])},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_copy_outlined"},{default:n(()=>[i(o(Ia),{class:"svg-icon inner-class"})]),_:1})]),_:2},1032,["class","onClick"])):h("",!0),d.id!=="-1"&&d.chartId?(c(),y(o(T),{key:1,class:g(["field-setting child",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:j(m=>Ea(d.id),["stop"])},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:2},1032,["class","onClick"])):h("",!0),(d.id,h("",!0))],2),J.value.map(m=>m.id).includes(d.id)?(c(),F("div",{key:0,draggable:!0,class:g(["shadow",Te.value&&"is-dragging"]),onDragstart:Go,onDragend:pt},[Re.value?(c(!0),F(ce,{key:0},Le(J.value,m=>(c(),F("div",{key:m.id,class:"items flex-align-center"},[i(o(T),null,{default:n(()=>[i(I,null,{default:n(()=>[(c(),y(Qe(o(xt)[o(ke)[m.deType]]),{class:g(["svg-icon",`field-icon-${o(ke)[[2,3].includes(m.deType)?2:0]}`])},null,8,["class"]))]),_:2},1024)]),_:2},1024),p("span",{class:g(["field-name ellipsis",{dark:f.themes==="dark"}])},C(m.name),3),(m.id,h("",!0))]))),128)):h("",!0)],34)):h("",!0)],40,Sn))),128))]),_:1}),p("div",{ref_key:"el",ref:xa,style:Xe({top:Ho.value+"px"}),class:g(["drag-vertical",o(Ca)&&"is-hovering"])},null,6)],6),p("div",{class:g(["padding-lr field-height right-dimension",{dark:f.themes==="dark"}])},[t[91]||(t[91]=p("div",{class:"divider"},null,-1)),p("label",null,C(o(v)("chart.quota")),1),i(s,{class:"drag-list"},{default:n(()=>[(c(!0),F(ce,null,Le(nt.value,d=>(c(),F("div",{key:d.id,class:"item father",draggable:!0,onClick:[j(m=>Ge(d,"quota"),["ctrl"]),j(m=>Ge(d,"quota"),["meta"]),j(m=>ka(d,"quota"),["exact"]),j(m=>_a(d,"quota"),["shift"])],onDragstart:m=>Zo(m,d,"quota"),onDragend:ba},[p("div",{class:g(["items flex-align-center",["item-dimension--"+f.themes,Te.value&&"is-dragging-item",G.value.map(m=>m.id).includes(d.id)&&"active"]])},[i(o(T),null,{default:n(()=>[i(I,{"class-name":`field-icon-${o(ke)[d.deType]}`},{default:n(()=>[(c(),y(Qe(ga(d.deType,d.extField,!0)),{class:g(["svg-icon",`field-icon-${o(ke)[d.deType]}`])},null,8,["class"]))]),_:2},1032,["class-name"])]),_:2},1024),p("span",{class:g(["field-name ellipsis",{dark:f.themes==="dark"}]),title:d.name},C(d.name),11,In),d.id!=="-1"&&!d.chartId?(c(),y(o(T),{key:0,class:g(["field-setting child",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:j(m=>wa(d.id),["stop"])},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_copy_outlined"},{default:n(()=>[i(o(Ia),{class:"svg-icon inner-class"})]),_:1})]),_:2},1032,["class","onClick"])):h("",!0),d.id!=="-1"&&d.chartId?(c(),y(o(T),{key:1,class:g(["field-setting child",{"remove-icon--dark":f.themes==="dark"}]),size:"14px",onClick:j(m=>Ea(d.id),["stop"])},{default:n(()=>[i(I,{"class-name":"inner-class",name:"icon_delete-trash_outlined"},{default:n(()=>[i(o(X),{class:"svg-icon inner-class"})]),_:1})]),_:2},1032,["class","onClick"])):h("",!0),(d.id,h("",!0))],2),G.value.map(m=>m.id).includes(d.id)?(c(),F("div",{key:0,draggable:!0,class:g(["shadow",Te.value&&"is-dragging"]),onDragstart:Xo,onDragend:pt},[Re.value?(c(!0),F(ce,{key:0},Le(G.value,m=>(c(),F("div",{key:m.id,class:"items flex-align-center"},[i(o(T),null,{default:n(()=>[i(I,{"class-name":`field-icon-${o(ke)[m.deType]}`},{default:n(()=>[(c(),y(Qe(o(xt)[o(ke)[m.deType]]),{class:"svg-icon","class-name":`field-icon-${o(ke)[m.deType]}`},null,8,["class-name"]))]),_:2},1032,["class-name"])]),_:2},1024),p("span",{class:g(["field-name ellipsis",{dark:f.themes==="dark"}])},C(m.name),3),(m.id,h("",!0))]))),128)):h("",!0)],34)):h("",!0)],40,Fn))),128))]),_:1})],2)])),[[Sa,ye.value&&!o($a)]])]),_:1})]),_:1}))],2)]),_:1})),[[Sa,Pa.value]]),St.value?(c(),y(ki,{key:2,themes:f.themes},null,8,["themes"])):h("",!0),i(we,{modelValue:l.renameItem,"onUpdate:modelValue":t[77]||(t[77]=d=>l.renameItem=d),title:o(v)("chart.show_name_set"),visible:l.renameItem,width:"420px","close-on-click-modal":!1},{footer:n(()=>[p("div",qn,[i(A,{onClick:na},{default:n(()=>[D(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:t[76]||(t[76]=d=>No(wt.value))},{default:n(()=>[D(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[p("div",{onKeydown:t[74]||(t[74]=j(()=>{},["stop"])),onKeyup:t[75]||(t[75]=j(()=>{},["stop"]))},[i(ll,{ref_key:"renameForm",ref:wt,"label-width":"80px","require-asterisk-position":"right",model:l.itemForm,rules:ja,"label-position":"top",onSubmit:t[73]||(t[73]=j(()=>{},["prevent"]))},{default:n(()=>[i(_,{label:o(v)("dataset.field_origin_name"),class:"name-edit-form"},{default:n(()=>[p("span",Tn,C(l.itemForm.name),1)]),_:1},8,["label"]),i(_,{label:o(v)("chart.show_name"),class:"name-edit-form no-margin-bottom",prop:"chartShowName"},{default:n(()=>[i(B,{modelValue:l.itemForm.chartShowName,"onUpdate:modelValue":t[72]||(t[72]=d=>l.itemForm.chartShowName=d),class:"text",clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])],32)]),_:1},8,["modelValue","title","visible"]),l.quotaFilterEdit?(c(),y(we,{key:3,modelValue:l.quotaFilterEdit,"onUpdate:modelValue":t[78]||(t[78]=d=>l.quotaFilterEdit=d),title:o(v)("chart.add_filter"),visible:l.quotaFilterEdit,"close-on-click-modal":!1,width:"600px",class:"dialog-css"},{footer:n(()=>[p("div",Nn,[i(A,{onClick:sa},{default:n(()=>[D(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:Do},{default:n(()=>[D(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(Gl,{item:l.quotaItem},null,8,["item"])]),_:1},8,["modelValue","title","visible"])):h("",!0),l.resultFilterEdit?(c(),y(we,{key:4,modelValue:l.resultFilterEdit,"onUpdate:modelValue":t[79]||(t[79]=d=>l.resultFilterEdit=d),title:o(v)("chart.add_filter"),visible:l.resultFilterEdit,"close-on-click-modal":!1,width:"600px",class:"dialog-css"},{footer:n(()=>[p("div",Dn,[i(A,{onClick:ma},{default:n(()=>[D(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:Vo},{default:n(()=>[D(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(Kl,{chart:l.chartForFilter,item:l.filterItem},null,8,["chart","item"])]),_:1},8,["modelValue","title","visible"])):h("",!0),l.showEditQuotaCompare?(c(),y(we,{key:5,modelValue:l.showEditQuotaCompare,"onUpdate:modelValue":t[80]||(t[80]=d=>l.showEditQuotaCompare=d),title:o(v)("chart.yoy_setting"),visible:l.showEditQuotaCompare,"close-on-click-modal":!1,width:"600px",class:"dialog-css"},{footer:n(()=>[p("div",On,[i(A,{onClick:ua},{default:n(()=>[D(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:zo},{default:n(()=>[D(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(ii,{"compare-item":l.quotaItemCompare,chart:o(a),"dimension-data":st.value,"quota-data":nt.value},null,8,["compare-item","chart","dimension-data","quota-data"])]),_:1},8,["modelValue","title","visible"])):h("",!0),l.showValueFormatter?(c(),y(we,{key:6,modelValue:l.showValueFormatter,"onUpdate:modelValue":t[81]||(t[81]=d=>l.showValueFormatter=d),title:o(v)("chart.value_formatter")+" - "+l.valueFormatterItem.name,visible:l.showValueFormatter,"close-on-click-modal":!1,width:"420px",class:"dialog-css"},{footer:n(()=>[p("div",Vn,[i(A,{onClick:va},{default:n(()=>[D(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:Ro},{default:n(()=>[D(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(ni,{"formatter-item":l.valueFormatterItem,chart:o(a)},null,8,["formatter-item","chart"])]),_:1},8,["modelValue","title","visible"])):h("",!0),l.showCustomSort?(c(),y(we,{key:7,modelValue:l.showCustomSort,"onUpdate:modelValue":t[82]||(t[82]=d=>l.showCustomSort=d),title:o(v)("chart.custom_sort")+o(v)("chart.sort"),visible:l.showCustomSort,"close-on-click-modal":!1,width:"372px",class:"dialog-css custom_sort_dialog"},{footer:n(()=>[p("div",Mn,[i(A,{onClick:Tt},{default:n(()=>[D(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:lo},{default:n(()=>[D(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(si,{chart:o(a),"field-type":fe.value,field:l.customSortField,onOnSortChange:oo},null,8,["chart","field-type","field"])]),_:1},8,["modelValue","title","visible"])):h("",!0),i(we,{modelValue:l.showSortPriority,"onUpdate:modelValue":t[83]||(t[83]=d=>l.showSortPriority=d),"close-on-click-modal":!1,width:"372px",class:"dialog-css custom_sort_dialog","destroy-on-close":""},{header:n(()=>[p("span",Bn,C(o(v)("chart.sort_priority")),1),p("span",null,"("+C(o(v)("chart.sort_priority_tip"))+")",1)]),footer:n(()=>[p("div",zn,[i(A,{onClick:fa},{default:n(()=>[D(C(o(v)("chart.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:$o},{default:n(()=>[D(C(o(v)("chart.confirm")),1)]),_:1})])]),default:n(()=>[i(ri,{chart:o(a),onOnPriorityChange:Po},null,8,["chart"])]),_:1},8,["modelValue"]),i(we,{modelValue:De.value,"onUpdate:modelValue":t[86]||(t[86]=d=>De.value=d),width:"1000px",title:lt.value?o(v)("dataset.add_calc_field"):o(v)("dataset.edit_calc_field"),"close-on-click-modal":!1},{footer:n(()=>[i(A,{secondary:"",onClick:t[84]||(t[84]=d=>ha())},{default:n(()=>[D(C(o(v)("dataset.cancel")),1)]),_:1}),i(A,{type:"primary",onClick:t[85]||(t[85]=d=>Jo())},{default:n(()=>[D(C(o(v)("dataset.confirm")),1)]),_:1})]),default:n(()=>[i(mi,{ref_key:"calcEdit",ref:Oe},null,512)]),_:1},8,["modelValue","title"])],34),i(Hl,{ref_key:"filterTree",ref:ra,onFilterData:Oo},null,512),i(o(Jl),{ref_key:"openHandler",ref:$e,jsname:"L2NvbXBvbmVudC9lbWJlZGRlZC1pZnJhbWUvT3BlbkhhbmRsZXI="},null,512),o(je)?(c(),y(Bl,{key:0,to:"#component-name"},[ht(p("input",{ref_key:"componentNameInput",ref:kt,"onUpdate:modelValue":t[89]||(t[89]=d=>o(W).name=d),effect:f.themes,width:"100%",onChange:Qa,onBlur:La},null,40,$n),[[Ml,o(W).name]])])):h("",!0)],64)}}});const Tc=Fi(Pn,[["__scopeId","data-v-2f124716"]]);export{Tc as default};
